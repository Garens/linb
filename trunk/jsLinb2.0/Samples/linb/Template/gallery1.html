<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="keywords" content="javascript framework, RIA, SPA, client SOA, linb, jsLinb, RAD, IDE, Web IDE, widgets, javascript OOP, opensource, open-source, Ajax, cross-browser, prototype, web2.0, platform-independent, language-independent" />
    <meta name="description" content="Web application powered by LINB framework" />
    <meta name="copyright" content="copyright@www.linb.net" />
    <meta http-equiv="imagetoolbar" content="no" />
    <title>linb.Template sample -- product gallery 1</title>
</head>
<body>
    <div id='loading'>Loading...</div>

    <div id='gallery1' style="margin:0 auto;width:680px;border:solid 1px;padding:4px;margin-top:20px;"></div>
    <div style="text-align:center;padding:10px;"><button id="cmd">reorder</button></div>

    <div id='drop' style="margin:0 auto;width:680px;margin-top:20px;border:solid 1px #CCC;height:32px;height:100px;position:relative;">
        drag a product here
    </div>

    <script type="text/javascript" src="../../../runtime/jsLinb/js/linb.js"></script>
    <script type="text/javascript">
        var tpl;
        //code snippets for linb.Template
        linb.main(function(){
            //hide loading message
            linb('loading').css('display','none');

            //drop
            linb('drop').dropable(true, 'prd').onDrop(function(){
                var pro=linb.DragDrop.getProfile();
                linb(this).html(_.serialize(pro.dragData));
            });

            //reorder
            linb('cmd').onClick(function(){
                if(tpl.rendered){
                    var data=tpl.properties.items, copy=_.copy(data);
                    data.length=0;
                    _.arr.each(copy,function(o){
                        data.push(o);
                    },null,true);
                    tpl.render();
                }
            });

            linb('gallery1').append(
                (tpl=new linb.Template)
                .setTemplate({
                    ""      : "<div><h3 class='gallery1-head'>{head}</h3><ul class='gallery1-ul'>{items}</ul><div style='clear:both;'></div></div>",
                    items : "<li class='gallery1-li' onclick=[$e] onmouseover=[$e] onmousedown=[$e] onmouseout=[$e]><div class='gallery1-left'><div><a href='{href}'><img src='{src}'/><p>{price}</p></a></div></div><div class='gallery1-right'><a href='{href}'><h4>{title}</h4><div>{desc}</div></a></div></li>"
                })
                .setEvents({
                    items:{
                        onMouseover:function(profile,e,src){
                            linb(src).css('backgroundColor','#EEE');
    
                            //here, just use linb.Template to build a html string
                            var item=profile.getItem(src),
                                tpl=new linb.Template({"":"<div style='text-align:center;border:solid 1px;background:#fff;'><h4>{title}</h4><img src='{src}'></div><p>{desc}</p>"},item),
                                html=tpl.build();
                            linb.Tips.show(linb.Event.getPos(e),html);
                        },
                        onMouseout:function(profile,e,src){
                            linb(src).css('backgroundColor','transparent');
                            linb.Tips.hide();
                        },
                        onMousedown:function(profile,e,src){
                            linb(src).startDrag(e,{dragType:"image",dragCursor:"default",shadowFrom:src},'prd',profile.getItem(src));
                            linb(src).css('backgroundColor','transparent');
                            linb.Tips.hide();
                        }
                    }
                })
                .setProperties({
                    head:"On sale products",
                    items:[{
                        id:"a",
                        src:"img/g1_0.gif",
                        href:"#",
                        price:"$ 18.99",
                        title:"product #0",
                        desc:"product #0 is on sale now!"
                    },{
                        id:"b",
                        src:"img/g1_1.jpg",
                        href:"#",
                        price:"$ 23.99",
                        title:"product #1",
                        desc:"product #1 is on sale now!"
                    },{
                        id:"c",
                        src:"img/g1_2.jpg",
                        href:"#",
                        price:"$ 23.99",
                        title:"product #2",
                        desc:"product #2 is on sale now!"
                    },{
                        id:"d",
                        src:"img/g1_3.jpg",
                        href:"#",
                        price:"$ 23.99",
                        title:"product #3",
                        desc:"product #3 is on sale now!"
                    },{
                        id:"e",
                        src:"img/g1_4.jpg",
                        href:"#",
                        price:"$ 23.99",
                        title:"product #4",
                        desc:"product #4 is on sale now!"
                    },{
                        id:"f",
                        src:"img/g1_5.jpg",
                        href:"#",
                        price:"$ 23.99",
                        title:"product #5",
                        desc:"product #5 is on sale now!"
                    }]
                })
            );
        });
        
        //
        //other code, continue to read it if you want
        //
        //add Conditional-CSS here
        linb.main(function(){
            //add css
            linb.CSS.addStyleSheet(''+

             '.gallery1-head{border-bottom:dashed 1px #888;}'+
             '.gallery1-ul{clear:both;padding-top:6px;}'+
             '.gallery1-li{float:left;height:100px;width:200px;overflow:hidden;line-height:15px;margin:3px;cursor:pointer;}'+
             '.gallery1-left{float:left;width:90px;overflow:hidden;}'+
             '.gallery1-left p{text-align:center;font-weight:bold;}'+
             '.gallery1-left img{border:solid 1px #CCC;width:80px;height:80px;}'+
             '.gallery1-right{float:left;width:100px;padding-left:2px;overflow:hidden;}'

            ,'gallery1.css');
        });
    </script>
<style>#linbar a{text-decoration:underline;font-size:12px;margin-right:2px;padding:2px;}#linbar_more a{text-decoration:none;padding:3px;font-size:12px;text-decoration:none;display:block;}#linbar a:hover, #linbar_more a:hover{text-decoration:none;color:#fff!important;background:#598EDD;}#linbar small{font-size:9px;}#linbar_more{position:absolute;display:none;top:19px;width:80px;z-index:6000;border:solid 1px;border-color:#E4F1FD #598EDD #598EDD #598EDD; background:#E4F1FD;}</style><script>var linbar={byId:function(id){return document.getElementById(id).style},get1:function(){return this.byId('linbar')},get2:function(){return this.byId('linbar_more')},get3:function(){return this.byId('linbar_l')},show:function(){var n=this;if(n._t1){clearTimeout(n._t1);delete n._t1;}var s=n.get1();s.height='19px';s.backgroundColor='#E4F1FD';n.get3().display='block';},hide:function(){var n=this;if(n._t1){clearTimeout(n._t1);delete n._t1;}n._t1=setTimeout(function(){var s=n.get1();s.height='3px';s.backgroundColor='#598EDD';n.get3().display='none';n.get2().display='none';},600);},showPop:function(ele){var n=this;if(n._t1){clearTimeout(n._t1);delete n._t1;}if(n._t2){clearTimeout(n._t2);delete n._t2;}if(ele){var s=n.get2();s.left=(ele.offsetLeft-4)+'px';s.display='block';}},hidePop:function(){var n=this;if(n._t2){clearTimeout(n._t2);delete n._t2;}n._t2=setTimeout(function(){n.get2().display='none';},100);n.hide();}};</script><div id='linbar' onmouseout="linbar.hide()"  onmouseover="linbar.show()" style='position:absolute;width:100%;left:0;top:0;height:3px;z-index:5000;background:#598EDD;line-height:19px;overflow:hidden;'><nobr><a href='http://www.linb.net'><strong> Home</strong></a><a href='http://code.google.com/p/linb/downloads/list'>Download</a><a href='http://linb.googlecode.com/svn/trunk/jsLinb2.0/'>SVN</a><a href='http://groups.google.com/group/linb'>forum</a><a href='http://www.linb.net/API'>API</a><a href='http://www.linb.net/CodeSnip'>CodeSnip</a><a href='http://www.linb.net/VisualJS'>UI Builder</a><a href='http://www.linb.net/Samples' onmouseout="linbar.hidePop()"  onmouseover="linbar.showPop(this)">Samples</a><small style="margin-left:-3px;">&#9660;</small><a href='http://www.sigmawidgets.com/'>Commercial Support</a></nobr></div><div id='linbar_l' style="left:0;position:absolute;top:19px;display:none;border-top:1px solid #598EDD;font-size:0;line-height:0;width:100%;z-index:5500;"></div><div id='linbar_more' onmouseout="linbar.hidePop()"  onmouseover="linbar.showPop()"><a href='http://www.linb.net/JSONEditor'>JSONEditor</a><a href='http://www.linb.net/Samples/comb/Themes'>Themes</a><a href='http://www.linb.net/Samples/comb/PicEditor'>PicEditor</a><a href='http://www.linb.net/Samples'>more ...</a></div>
</body>
</html>