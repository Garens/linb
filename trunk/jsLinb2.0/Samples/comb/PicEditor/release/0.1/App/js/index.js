Class("linb.Profile","linb.absProfile",{Constructor:function(H,F,E,G,D,C,B){arguments.callee.upper.apply(this,arguments);var A=this;_.merge(A,B);A.key=F||A.key||"";A.alias=E||A.alias||"",A.properties=D||A.properties||{};A.events=C||A.events||{};A.host=H||A.host||A;A.box=G||A.box||A.constructor;if(A.events){A.setEvents(A.events);delete A.events}A._links={}},Instance:{setEvents:function(B){var A=this.box.$EventHandlers;return _.merge(this,B,"all",function(D,C){return A[C]})},getEvents:function(){var A=this,B,C={};_.each(A.box.$EventHandlers,function(E,D){if(A[D]){C[D]=A[D]}});return C},_applySetAction:function(A,B){return A.call(this,B)},__gc:function(){this.unLinkAll();_.tryF(this.clearCache,[],this);var A=_.get(this,["box","_namePool"]);if(A){delete A[self.alias]}_.breakO(this)},boxing:function(){var A=this,B;if(!((B=A.object)&&B._nodes[0]==A&&B._nodes.length==1)){B=A.object=A.box.pack([A],false)}return B},serialize:function(G,J){var H,I=this,D=(H=I.box._beforeSerialized)?H(I):I,A={alias:D.alias,key:D.key,host:D.host};if(A.host===I){delete A.host}else{if(D.host&&!J){if(G!==false){A.host="@this"}else{delete A.host}}}var F={},C=D.box.$DataStruct,B=linb.absObj.$specialChars;_.merge(F,D.properties,function(L,K){return(K in C)&&C[K]!==L&&!B[K.charAt(0)]});if(!_.isEmpty(F)){A.properties=F}if(!_.isEmpty(H=this.getEvents())){A.events=H}var E=D.box.$EventHandlers;_.filter(A.events,function(L,K){return L!=E[K]});if(_.isEmpty(A.events)){delete A.events}return G===false?A:_.serialize(A)}}});Class("linb.absObj","linb.absBox",{Constructor:function(){arguments.callee.upper.apply(this,arguments);if(arguments[0]!==false&&typeof this._ini=="function"){return this._ini.apply(this,arguments)}},Before:function(B,A,C){linb.absBox.$type[B]=B;return true},After:function(){var M=this,G=arguments.callee,K,L,D,J,B,F,E,C,I,A,H;M._nameId=0;M._namePool={};M._nameTag=(L=M.KEY.split("."))[L.length-1].toLowerCase();M._cache=[];if(M===linb.absObj||M===linb.absObj){return }B=G.a1||(G.a1=_.toArr("$Keys,$DataStruct,$EventHandlers,$DataModel"));for(E=0;I=B[E++];){D={};if((L=M.$parent)&&(F=L.length)){while(F--){_.merge(D,L[F][I])}}M[I]=D}M.setDataModel(M.DataModel);delete M.DataModel;M.setEventHandlers(M.EventHandlers);delete M.EventHandlers;B=G.a5||(G.a5=_.toArr("RenderTrigger,LayoutTrigger"));for(E=0;I=B[E++];){K=[];if((L=M.$parent)&&(C=L.length)){for(F=0;F<C;F++){J=L[F];if(J=J["$"+I]){K.push.apply(K,J)}}}if(M[I]){K.push(M[I])}M["$"+I]=K;delete M[I]}},Static:{$abstract:true,$specialChars:{_:1,$:1},getAll:function(){return this.pack(this._cache)},pickAlias:function(){var B,C=this._namePool,A=this._nameTag;while(C[B=(A+(++this._nameId))]){}return B},setDataModel:function(H){var M=this,K=linb.absObj.$specialChars,E=M.$DataStruct,J=M.$DataModel,B=M.prototype,I,G,L,C,D,F,A;for(I in H){if(!J[I]){J[I]={}}C=H[I];if(null===C||undefined===C){A=_.str.initial(I);delete E[I];delete J[I];delete B["get"+A];delete B["set"+A]}else{L=typeof C;if(L!="object"||C.constructor!=Object){C={ini:C}}E[I]=("ini" in C)?C.ini:(I in E)?E[I]:"";L=J[I];for(G in L){if(!(G in C)){C[G]=L[G]}}J[I]=C}}_.each(H,function(O,N){if(null===O||undefined===O||K[N.charAt(0)]){return }A=_.str.initial(N);if(!(O&&(O.readonly||O.inner))){L=O.set;D="set"+A;F=B[D];B[D]=typeof L=="function"?Class._fun(L,D,M.KEY):typeof F=="function"?F:Class._fun(function(Q,P){return this.each(function(S){if(!S.properties){return }if(S.properties[N]===Q&&!P){return }var T=S.properties[N],R=_.get(S.box.$DataModel,[N,"action"]);S.properties[N]=Q;if(typeof R=="function"&&S._applySetAction(R,Q,T)===false){S.properties[N]=T}})},D,M.KEY);delete O.set;if(B[D]!==F){B[D].$auto$=1}}if(!(O&&O.inner)){L=O.get;D="get"+A;F=B[D];B[D]=typeof L=="function"?Class._fun(L,D,M.KEY):typeof F=="function"?F:Class._fun(function(){return this.get(0).properties[N]},D,M.KEY);delete O.get;if(B[D]!==F){B[D].$auto$=1}}});return M},setEventHandlers:function(B){var A=this;_.each(B,function(E,C){if(null===E){delete A.$EventHandlers[C];delete A.prototype[C]}else{A.$EventHandlers[C]=E;var D=function(G){var F=arguments.length;if(F==1&&(typeof G=="function"||typeof G=="string")){return this.each(function(M){if(M.domNode){M.clearCache()}M[C]=G})}else{if(F==1&&null===G){return this.each(function(M){M.clearCache();delete M[C]})}else{var K=[],I=this.get(0),L=I[C],H=I.host||I,J;if(I.$ignore){return }if(arguments[0]!=I){K[0]=I}for(J=0;J<F;J++){K[K.length]=arguments[J]}I.$lastEvent=C;if(typeof L=="string"){L=H[L]}if(typeof L=="function"){return _.tryF(L,K,H)}}}};D.$event$=1;D.$original$=E.$original$||A.KEY;A.plugIn(C,D)}});return A}},Instance:{alias:function(E){var B=this,D=this.get(0),A;if(E){if(A=D.alias){if(D.host){try{delete D.host[A]}catch(C){D.host[A]=undefined}}delete B.constructor._namePool[A]}B.constructor._namePool[D.alias=E]=1;if(D.host){D.host[E]=B}return B}else{return D.alias}},host:function(C,B){var A=this;if(C){A.get(0).host=C;if(B){A.alias(B);C[B]=A}return A}else{return A.get(0).host}}}});Class("linb.DataBinder","linb.absObj",{Instance:{_ini:function(C,G,F){var H=this,D=H.constructor,A,I,E=D._namePool,B;if(C&&C["linb.Profile"]){A=C;B=A.alias||D.pickAlias()}else{if(C&&C.key&&linb.absBox.$type[C.key]){I=C;C=null;B=I.alias;B=(B&&!E[B])?B:D.pickAlias()}else{B=D.pickAlias()}A=new linb.Profile(F,H.$key,B,D,C,G,I)}E[B]=1;A._n=A._n||[];A.link(D._cache,"self").link(linb._pool,"linb");H._nodes.push(A);return H},destroy:function(){this.each(function(B){var C=B.box,A=B.properties.name;_.arr.each(B._n,function(D){C._unBind(A,D)});delete C._pool[A];B.__gc()})},resetValue:function(A){return this.each(function(C,B){_.arr.each(C._n,function(D){var E=D.properties;D.boxing().resetValue((A&&E.dataField in A)?A[E.dataField]:"")})})},getUI:function(){return linb.UI.pack(this.get(0)._n,false)},checkValid:function(){return linb.absValue.pack(this.get(0)._n,false).checkValid()},getValue:function(){var B=this.get(0);if(this.checkValid()){var A={};_.arr.each(B._n,function(E){var F=E.properties,C=E.boxing(),D;if(E.domNode){C.updateValue()}D=C.getValue();A[F.dataField]=D});return A}else{return null}},host:function(C,B){var A=this;if(C&&B){A.setName(B)}return arguments.callee.upper.apply(A,arguments)}},Static:{_pool:{},destroyAll:function(){this.pack(this._pool,false).destroy();this._pool={}},getFromName:function(A){var B=this._pool[A];return B&&B.boxing()},_bind:function(A,C){var B=this._pool[A];if(!B){B=new linb.DataBinder();B.setName(A);B=B.get(0)}if(C&&_.arr.indexOf(B._n,C)==-1){C.link(B._n,"databinder."+A)}},_unBind:function(A,B){if(this._pool[A]){B.unLink("databinder."+A)}},DataModel:{name:{set:function(D){var E=this.get(0),C=E.properties.name;if(C!==D){var G=linb.DataBinder,A=G._pool,F=A[C],B=A[D];if(F&&B){throw new Error(D+" exists!")}A[E.properties.name=D]=E;if(F&&!B){linb.absValue.pack(E._n).setDataBinder(D);_.arr.each(E._n,function(H){G._unBind(C,H)})}if(B&&!F){E._n=B._n}if(F){delete A[C]}}return this}}}}});Class("linb.UIProfile","linb.Profile",{Instance:{rendered:false,_render:function(){var C=this,E,F=linb.Dom.byId(C.domId);if(!F){return }C.root=linb([C.domNode=F]);linb.cache.dom[C.domId]=linb.cache.dom[C.$domId]=C;if(E=C.RenderTrigger){for(var D=0,A=E.length;D<A;D++){E[D].call(C)}delete C.RenderTrigger}if(arguments[0]===true&&(E=C.LayoutTrigger)){for(var D=0,A=E.length;D<A;D++){E[D].call(C)}}if(C.children){for(var D=0,B;B=C.children[D++];){B[0]._render(true)}}if(C.$attached){for(var D=0,B;B=C.$attached[D++];){if(B["linb.UIProfile"]){B._render(true)}}delete C.$attached}},__gc:function(){var A=this,C;if(A.onDestroy){A.boxing().onDestroy()}if(A.destroyTrigger){A.destroyTrigger()}if(!A.serialId){return }A.clearCache();if(C=A.$dockParent){if(C=A.constructor.getFromDomId(C)){_.tryF(C.clearCache,[],C)}}if(A.nodeVars&&(C=A.domNode)){for(var B in A.nodeVars){C[B]=null}}if(!A.$exID){C=linb.cache.domId;(C[A.key]||(C[A.key]=[])).push(A.serialId)}else{delete A.$exID}delete linb.cache.dom[A.domId];delete linb.cache.dom[A.$domId];delete A.box._namePool[A.alias];A.unLinkAll();_.tryF(A.$ondestory);_.breakO(A)},unlinkParent:function(){var A=this;delete A.parent;delete A.childrenId;A.unLink("$parent");return A},getRootNode:function(){return this.domNode||(this.domNode=document.getElementById(this.domId))},getRoot:function(){return this.root||null},linkParent:function(A,C){var B=this;B.unlinkParent();B.parent=A;B.childrenId=C;B.link(A.children,"$parent",[B,C]);return B},_reg:/^\w[\w_-]*$/,setDomId:function(D){var A=this,C=linb.cache.dom,B=A._reg;if(typeof D=="string"&&(B.test(D)||D==A.$domId)&&!linb.Dom.byId(D)){if(A.domId!=A.$domId){delete C[A.domId]}A.domId=D;if(A.domNode){A.domNode.id=D}if(C[A.$domId]){C[D]=A}}return A},getDomId:function(){return this.domId},clearCache:function(){var E=this,B="$_egetter",A="$_domid",D=E[B];for(var C in D){D[C].length=0}D=E[A];for(var C in D){D[C]=null}E[B]=E[A]=null},_getEV:function(B,A){var K=this,H=B+"+"+A,F=K.$_egetter||(K.$_egetter={});if(F[H]){return F[H]}var D=linb.cache.dom,G=[],J,I;if((J=D[B])&&(J=J.events)&&(J=J[A])){for(var E=0,C=J.length;E<C;E++){if(typeof J[J[E]]=="function"){G[G.length]=J[J[E]]}}}I=B.split(":")[0].split("-")[1];if(typeof (((J=K._CB)&&(I?(J=J[I]):1))&&(J=J[A]))=="function"){G[G.length]=J}else{if(typeof (((J=K.CB)&&(I?(J=J[I]):1))&&(J=J[A]))=="function"){G[G.length]=J}else{if(typeof (((J=K.behavior)&&(I?(J=J[I]):1))&&(J=J[A]))=="function"){G[G.length]=J}}}return F[H]=G},toHtml:function(){var O=this,L=arguments.callee,C=L._reg||(L._reg=/<!--([^>^\s]*)-->/g),J=O.box,G={},K,I="linb.UIProfile",H="linb.Profile",A,F,B,D,N,M,E;E=J._prepareData(O);if(J._dynamicTemplate){J._dynamicTemplate(O)}K=J._build(O,E);if(D=J._getChildren(O)){for(F=0;B=D[F++];){if(B[0][I]){A=B[1]||"";N=G[A]||(G[A]=[]);N[N.length]=B[0].toHtml()}else{if(!B[0][H]){M.ini.call(M,B[0]);B[0]=M.get(0)}}}}return K.replace(C,function(Q,P){return G[P]?G[P].join(""):""})},buildItems:function(C,B){var A=this,E=A.box,F,D=A.toHtml._reg;F=E._rpt(A,linb.UI.$doTemplate(A,_.get(linb.cache.template,[E.KEY,A._hash]),B,C));return F.replace(D,"")},serialize:function(H,K){var I,E,J=this,D=(I=J.box._beforeSerialized)?I(J):J,A={alias:D.alias,key:D.key,host:D.host};if(A.host===J){delete A.host}else{if(D.host&&!K){if(H!==false){A.host="@this"}else{delete A.host}}}if(D.$domId!=D.domId){A.domId=D.domId}var G={},C=D.box.$DataStruct,B=linb.absObj.$specialChars;_.merge(G,D.properties,function(M,L){return(L in C)&&C[L]!==M&&!B[L.charAt(0)]});if(!_.isEmpty(G)){A.properties=G}if(!_.isEmpty(I=this.getEvents())){A.events=I}var F=D.box.$EventHandlers;_.filter(A.events,function(M,L){return M!=F[L]});if(_.isEmpty(A.events)){delete A.events}if(!_.isEmpty(D.CS)){A.CS=_.copy(D.CS)}if(!_.isEmpty(D.CB)){A.CB=_.copy(D.CB)}if(!_.isEmpty(D.CC)){A.CC=_.copy(D.CC)}if(!_.isEmpty(D.CF)){A.CF=_.copy(D.CF)}if(D.children&&D.children.length){D.children.sort(function(L,M){L=parseInt(L[0].properties.tabindex);M=parseInt(M[0].properties.tabindex);return L>M?1:L==M?0:-1});I=A.children=[];_.arr.each(D.children,function(L){E=[L[0].serialize(false,K)];if(L[1]){E[1]=L[1]}I[I.length]=E})}return H===false?A:_.serialize(A)},_applySetAction:function(A,B,C){if(this.domNode){return A.call(this,B,C)}},getKey:function(B){var A;if(B.indexOf(":")==-1){B=(A=linb.cache.dom[B])&&(A.$domId)}return B?B.split(":")[0]:""},getSubId:function(B){var A;if(B.indexOf(":")==-1){B=(A=linb.cache.dom[B])&&(A.$domId)}return B?B.split(":")[2]:""},pickSubId:function(B){var A=this,C,D=A.cache_subid||(A.cache_subid={});if((D[B]||(D[B]=[]))[0]){return D[B].shift()}D=A.subId||(A.subId={});C=(D[B]||(D[B]=new _.id)).next();return C},reclaimSubId:function(C,A){var B=this.cache_subid||(this.cache_subid={});(B[A]||(B[A]=[])).push(C)},getClass:function(C,A){C=this.keys[C]||C;var B=this,E=arguments.callee,G=E._map||(E._map={}),D=E._reg||(E._reg=/\./g),F=C+":"+A;return G[F]||(G[F]=C.replace(D,"-").toLowerCase().replace("linb-ui","linb")+(A||""))},_getSubNodeId:function(C,B){var A=this.$domId.split(":");A[0]=C;A[2]=B||"";C=A.join(":");if(C==this.$domId){return linb.cache.dom[C].domId}else{return C}},getSubNode:function(D,B){var A=this;D=A.keys[D]||D;var G,C,F,E=A.$_domid||(A.$_domid={});if(B===true){G=linb([A.domNode]).query("*","id",D==A.keys.KEY?A.domId:new RegExp("^"+D+":"+A.serialId))}else{if(!B&&E[D]&&E[D]._nodes.length==1){return E[D]}G=(C=linb.Dom.byId(F=A._getSubNodeId(D,B)))?linb([C]):((C=A.domNode)&&linb([C]).query("*","id",F));if(!B){E[D]=G}}return G},getSubNodes:function(A,C){var D=0,B=[],E;for(;E=A[D++];){Array.prototype.push.apply(B,this.getSubNode(E,C).get())}return linb(B)},getSubNodeByItemId:function(A,B){return(B=this.getSubIdByItemId(B))?this.getSubNode(A,B):linb()},getItemByItemId:function(B){var A;if((A=this.ItemIdMapSubSerialId)&&(A=A[B])){return this.SubSerialIdMapItem[A]}},getItemByDom:function(A){return this.SubSerialIdMapItem&&this.SubSerialIdMapItem[this.getSubId(A.id||A)]},getItemIdByDom:function(B){var A;return(A=this.getItemByDom(B))&&A.id},getSubIdByItemId:function(B){var A;return(A=this.ItemIdMapSubSerialId)&&A[B]},queryItems:function(C,B,A,G){var E=[],D=arguments.callee,F=D.f||(D.f=function(J,I,H,L,K){_.arr.each(J,function(M){if(I===true||I.call(null,M)){K.push(M);if(L){return false}}if(H&&M.sub&&M.sub.length){F(M.sub,I,H,L,K)}})});F(C,B,A,G,E);return E}},Static:{getFromDomId:function(A){return linb.cache.dom[A.replace(linb.Event._reg,"$1$3")]}}});Class("linb.UI","linb.absObj",{Before:function(B,A,C){linb.absBox.$type[B.replace("linb.UI.","").replace("linb.","")]=linb.absBox.$type[B]=B;return true},After:function(){linb.absObj.After.apply(this,arguments);var N=this,G=arguments.callee,L,M,A,K,F,C,B,D,I,J,H,E;N._ctrlId=new _.id();N._idCache=[];N.$cssKeys={};M=N.$Keys;M.KEY=M.$key=N.KEY;N.addTemplateKeys(_.toArr(M,true));J="$Behaviors";A={};if((M=N.$parent)&&(D=M.length)){while(D--){H=M[D][J];for(C in H){if(typeof H[C]=="object"){if(H[C].constructor==Array){K=A[C]||(A[C]=[]);K.push.apply(K,H[C])}else{K=A[C]||(A[C]={});_.merge(K,H[C])}}else{A[C]=H[C]}}}}N[J]=A;J="$Templates";A={};if((M=N.$parent)&&(D=M[0])){for(C in D[J]){if(C.charAt(0)!="$"){A[C]=D[J][C]}}}N[J]=_.clone(A);J="$Appearances";A={};if((M=N.$parent)&&(D=M.length)){while(D--){H=M[D];for(C in H[J]){M=H[J][C];K=A[C]||(A[C]={});_.merge(K,M)}}}N[J]=A;N.setTemplate(N.Templates);delete N.Templates;N.setBehavior(N.Behaviors);delete N.Behaviors;N.setAppearance(N.Appearances);delete N.Appearances;if(M=N.PublicAppearance){linb.UI.$cache_css+=N.buildCSSText(M);delete N.PublicAppearance}},Instance:{destroy:function(){this.each(function(A){if(A.beforeDestroy&&false===A.boxing().beforeDestroy()){return }if(A.root){A.root.remove()}else{A.__gc()}})},serialize:function(B,C){var A=[];this.each(function(D){A[A.length]=D.serialize(false,C)});return B===false?A:A.length==1?" new "+A[0].key+"("+_.serialize(A[0])+")":"linb.UI.unserialize("+_.serialize(A)+")"},_toDomElems:function(){this.render();var B,A=[];_.arr.each(this._nodes,function(C){if(B=C.domNode){A.push(B)}});return A},_ini:function(F,O,N,A,H,I,E){var P=this,G=P.constructor,B,M="default",Q,K=G._namePool,D,L;if(F&&F["linb.Profile"]){B=F;D=B.alias||G.pickAlias();linb.UIProfile.apply(B,[N,P.$key,D,G,null,O])}else{if(F&&F.key&&linb.absBox.$type[F.key]){Q=F;F=null;D=Q.alias;D=(D&&!K[D])?D:G.pickAlias()}else{D=G.pickAlias()}B=new linb.UIProfile(N,P.$key,D,G,F,O,Q)}K[D]=1;for(var C in (L=G.$DataStruct)){if(!(C in B.properties)){B.properties[C]=typeof L[C]=="object"?_.copy(L[C]):L[C]}}B.keys=G.$Keys;B.CS=A||B.CS||{};B.CB=I||B.CB||{};B.CC=H||B.CC||{};B.CF=E||B.CF||{};B.template=G.getTemplate();B.behavior=G.$Behaviors;if(!B.serialId){B.serialId=G._pickSerialId()}B.$domId=B.key+":"+B.serialId+":";B.domId=B.domId||B.$domId;B.RenderTrigger=_.copy(G.$RenderTrigger);B.LayoutTrigger=_.copy(G.$LayoutTrigger);B.nodeVars=B.behavior?B.behavior.$eventhandler:null;B.link(linb.UI._cache,"UI").link(G._cache,"self").link(linb._pool,"linb");L=B.children;B.children=[];if(L&&L.length){for(var C=0,J;J=L[C++];){if(!J[0]["linb.UIProfile"]){J[0]=new (linb.SC(J[0].key))(J[0]).get(0)}J[0].linkParent(B,J[1])}}P._nodes.push(B);return P},busy:function(C,B,A){C=C||"Loading...";B=B||'<span style="background:'+linb.UI.$bg("busy.gif"," no-repeat left center")("linb.UI.Public")+';padding-left:16px;">'+C+"</span>";return this.each(function(D){_.resetRun(D.$id+":busy",function(){var H=D.keys;A=H[A]||H.BORDER||H.PANEL||H.KEY;var E=D.getSubNode(A),F=E.cssSize(),G;if(!(G=D.$busy)){G=D.$busy=linb.create('<div style="left:0;top:0;z-index:10;position:absolute;background-color:#DDD;"></div><div style="left:0;top:0;z-index:20;text-align:center;position:absolute;">'+B+"</div>");linb([G.get(0)]).css({opacity:0.5});linb(E).append(G)}G.css({display:"",width:F.width+"px",height:F.height+"px",paddingTop:F.height/2+"px"});linb([G.get(1)]).html(B,false)},50)})},free:function(){return this.each(function(A){_.resetRun(A.$id+":busy");if(A.$busy){A.$busy.css("display","none")}})},resize:function(){return this.each(function(A){_.tryF(A.$resizeFun)})},toHtml:function(){var A=[];_.arr.each(this._nodes,function(B){A[A.length]=B.toHtml()});return A.join("")},render:function(C){var L=this,H=[],G,F,B,K,E,A,I,D=L._nodes,J=[],M=linb.Dom.byId;linb.UI.$applyCSS();for(G=0;B=D[G++];){if(!M(B.domId)){H[H.length]=B}}if(F=H.length){for(G=0;G<F;G++){J[J.length]=H[G].toHtml()}E=_.str.toDom(J.join(""));E=E.get();F=E.length;I=linb.Dom.getEmptyDiv().get(0);K=document.createDocumentFragment?document.createDocumentFragment():I;for(G=0;G<F;G++){K.appendChild(E[G])}if(K!=I){I.appendChild(K)}}for(G=0;B=D[G++];){B._render(C)}return L},renderOnto:function(E,D){E=linb(E);if(E.isEmpty()){return this}var B=this,F=B.get(0),C=arguments.callee,A=C.para||(C.para=function(H){var G=H.cssRegion();G.tabindex=H.attr("tabIndex");G.zIndex=H.css("zIndex");G.position=H.css("position");return G});_.merge(F.properties,A(E),"all");E.outerHTML(F.toHtml());F.boxing().host(D||window,E.get(0).id||F.alias);F._render(true);return B},setDomId:function(A){this.get(0).setDomId(A);return this},hide:function(){return this.each(function(A){if(A.domNode){A.root.hide();A.properties.top=A.properties.left=-10000;A.properties.dockIgnore=true}})},show:function(B,A){return this.each(function(D){if(D.domNode){var C=D.properties;C.dockIgnore=false;D.root.show(B,A);if(C.dock&&C.dock!="none"){linb.UI.$dock(D,true)}}})},clone:function(){var A=[],B=function(D){delete D.alias;delete D.domId;if(D.children){for(var C=0,E;E=D.children[C];C++){B(E)}}};this.each(function(C){C=C.serialize(false,true);B(C);A.push(C)});return this.constructor.unserialize(A)},refreshDom:function(){(function(A){var B=arguments.callee;_.arr.each(A,function(C){if(C.constructor==Array){C=C[0]}C.clearCache();if(C.children&&C.children.length){B(C.children)}})})(this._nodes);return this.each(function(C){if(C.domNode){var A=C.getRoot(),B=A.cssSize();A.outerHTML(C.toHtml());linb.UI.$tryResize(C,B.width,B.height,C.properties.$UIvalue,true)}})},refresh:function(){var I,F,A,H,G,C,E,D,B;return this.each(function(K){if(!K.domNode){return }D=K.box;G=K.$id;C=K.serialId;if(F=!!K.parent){A=K.parent.boxing();I=K.childrenId}else{A=K.root.parent()}var J=linb.create("span");K.root.replace(J,true);B=_.copy(K.children);K.children.length=0;_.arr.each(B,function(L){delete L[0].$dockParent;J.append(L[0].root)});H=K.serialize(false,true);E=K.$addOns;K.$exID=1;K.boxing().destroy();linb.Dom.__gc();_.merge(K,H,"all");K.$id=G;K.serialId=C;K=new D(K).render();if(E){E.call(E.target,K.get(0))}J.empty(false);J.replace(K.get(0).root);if(F){A.append(K,I)}else{A.append(K)}_.arr.each(B,function(L){K.append.apply(K,L)});J.remove()})},append:function(C,B){if(C["linb.UIProfile"]){C=C.boxing()}var D=this.get(0),A;if(B!==false){C.each(function(E){E.linkParent(D,B)})}if(D.domNode){if(B=typeof B=="string"?B:null){B=D.getSubIdByItemId(B)}A=D.keys.PANEL?D.getSubNode(D.keys.PANEL,B):D.root;if(!A.isEmpty()){A.append(C)}}return this},getChildren:function(B){var A=[];_.arr.each(this.get(0).children,function(C){if(B?C[1]==B:1){A.push(C[0])}});return linb.UI.pack(A)},removeChildren:function(A){return this.each(function(B){_.arr.each(B.children,function(C){if(A?C[1]==A:1){C[0].unlinkParent()}if(C[0].root){C[0].root.remove()}else{C[0].__gc()}})})},dragable:function(A,C,B){return this.each(function(D){D.getSubNode(D.keys[B]||"KEY",true).beforeMousedown(A?function(G,E,F){if(G.properties.disabled){return }linb([F]).startDrag(E,{dragKey:A,dragData:typeof C=="function"?C():C,dragCursor:"pointer",dragType:"icon",dragDefer:1})}:null,"_d",-1).beforeDragbegin(A?function(E,F,G){linb([G]).onMouseout(true,{$force:true}).onMouseup(true)}:null,"_d",-1);if(!A){D.clearCache()}})},setCustomFunction:function(A,B){return this.each(function(C){if(typeof A=="string"){if(B){C.CF[A]=B}else{delete C.CF[A]}}else{C.CF=A||{}}})},setCustomClass:function(B,D){var C=arguments.callee,A=(C.fun||(C.fun=function(J,G,H,F){if(!H[G]){return }var I=J.getSubNode(G,true),E;if(!I.isEmpty()){_.arr.each(H[G].split(/\s+/),function(K){I[F?"removeClass":"addClass"](K)})}}));return this.each(function(G){var E=_.copy(G.CC);if(typeof B=="string"){if(G.domNode){if(B in E){A(G,B,E,true)}}if(!D){delete G.CC[B]}else{G.CC[B]=D;if(G.domNode){A(G,B,G.CC)}}}else{if(!!B&&typeof B=="object"){if(G.domNode){for(var F in B){A(G,F,E,true)}for(var F in B){A(G,F,B)}}G.CC=B}else{if(G.domNode){for(var F in E){A(G,F,E,true)}}G.CC={}}}})},setCustomStyle:function(B,D){var C=arguments.callee,A=(C.fun||(C.fun=function(J,G,H,F){if(!H[G]){return }var I=J.getSubNode(G,true),E;if(!I.isEmpty()){_.arr.each(H[G].split(";"),function(M,K){if((E=M.split(":")).length==2){E[0]=E[0].replace(/\-(\w)/g,function(O,N){return N.toUpperCase()});try{I.css(E[0],F?"":E[1])}catch(L){}}})}}));return this.each(function(G){var E=_.copy(G.CS);if(typeof B=="string"){if(G.domNode){if(B in E){A(G,B,E,true)}}if(!D){delete G.CS[B]}else{G.CS[B]=D;if(G.domNode){A(G,B,G.CS)}}}else{if(!!B&&typeof B=="object"){if(G.domNode){for(var F in B){A(G,F,E,true)}for(var F in B){A(G,F,B)}}G.CS=B}else{if(G.domNode){for(var F in E){A(G,F,E,true)}}G.CS={}}}})},setCustomBehavior:function(A,B){return this.each(function(C){if(typeof A=="string"){if(C.keys[A]){C.CB[A]=B||{}}}else{C.CB=A||{}}if(C.CB.KEY){_.merge(C.CB,C.CB.KEY,"all");delete C.CB.KEY}C.clearCache()})}},Initialize:function(){var B=this.prototype;_.arr.each("getSubNode,getDomId,getRootNode,getRoot".split(","),function(D){if(!B[D]){B[D]=function(){var E=this.get(0);return E[D].apply(E,arguments)}}B[D].$original$="linb.UI"});var A=this,C={};_.each(linb.UI.$ps,function(D,E){C[E]={ini:"auto",action:function(I){var G=this,J=G.properties,F=false,H={$type:J.dock};if(G.domNode){switch(J.dock){case"top":if(E!="height"&&E!="top"){return }H.width=H.height=1;break;case"bottom":if(E!="height"&&E!="bottom"){return }H.width=H.height=1;break;case"left":if(E!="width"&&E!="left"){return }H.width=H.height=1;break;case"right":if(E!="width"&&E!="right"){return }H.width=H.height=1;break;case"width":if("width"==E){return }H.width=1;break;case"height":if("height"==E){return }H.height=1;break;case"fill":case"cover":if(E=="width"&&E=="height"){return }H.width=H.height=1;break}G.root[E]?G.root[E](I):linb.Dom._setPxStyle(G.domNode,E,I);if(J.dock!="none"){_.tryF(G.$dock,[G,H],G)}}}}});_.merge(C,{renderer:{ini:null},zIndex:{ini:1,action:function(D){if(this.domNode){this.root.css("zIndex",D)}}},tabindex:{ini:1},position:{ini:"absolute",listbox:["","static","relative","absolute"],action:function(D){if(this.domNode){this.root.css("position",D)}}},visibility:{listbox:["","visible","hidden"],action:function(D){if(this.domNode){this.root.css("visibility",D)}}},display:{listbox:["","none","block","inline","inline-block"],action:function(D){if(this.domNode){if(D=="inline-block"){this.root.setInlineBlock()}else{this.root.css("display",D)}}}}});A.setDataModel(C);linb.UI.$cache_css+=linb.UI.buildCSSText({".ui-ctrl":{},".ui-btn":{background:linb.UI.$bg("button.gif"," repeat-x left -26px",true),border:"solid 1px #616161",padding:"0 3px",cursor:"default","font-size":"12px","vertical-align":"middle"},".ui-icon":{"vertical-align":"middle",width:"16px",height:"16px",margin:"0 4px 0 2px"},".uicmd-close, .uicmd-opt, .uicmd-land, .uicmd-toggle, .uicmd-min, .uicmd-max,.uicmd-restore,.uicmd-pin":{width:"15px",height:"15px",cursor:"default","vertical-align":"middle"},".uicmd-close":{background:linb.UI.$bg("cmds.gif"," no-repeat -64px 0",true)},".uicmd-close-mouseover":{$order:1,"background-position":"-64px -16px"},".uicmd-close-mousedown":{$order:2,"background-position":"-64px -32px"},".uicmd-opt":{background:linb.UI.$bg("cmds.gif"," no-repeat -240px 0",true)},".uicmd-opt-mouseover":{$order:1,"background-position":"-240px -16px"},".uicmd-opt-mousedown":{$order:2,"background-position":"-240px -32px"},".uicmd-land":{background:linb.UI.$bg("cmds.gif"," no-repeat -220px 0",true)},".uicmd-land-mouseover":{$order:1,"background-position":"-220px -16px"},".uicmd-land-mousedown":{$order:2,"background-position":"-220px -32px"},".uicmd-toggle":{background:linb.UI.$bg("cmds.gif"," no-repeat -161px 0",true)},".uicmd-toggle-mouseover":{$order:2,"background-position":"-161px -16px"},".uicmd-toggle-mousedown":{$order:3,"background-position":"-161px -32px"},".uicmd-toggle-checked":{$order:4,"background-position":"-176px top"},".uicmd-toggle-checked-mouseover":{$order:5,"background-position":"-176px -16px"},".uicmd-toggle-checked-mousedown":{$order:6,"background-position":"-176px -32px"},".uicmd-toggle-busy":{$order:7,background:linb.UI.$bg("busy.gif"," no-repeat center center",true)},".uibar-bar":{position:"relative"},".uibar-t":{background:linb.UI.$bg("barvbg.gif"," repeat-x left top",true),border:"solid #C1C1C1","border-collapse":"separate","border-width":"0 1px 0 1px"},".uibar-cmdl":{"-moz-user-select":"none",overflow:"hidden",position:"absolute",left:0,top:"3px",width:"60%","padding-left":"3px","white-space":"nowrap"},".uibar-cmdr":{"-moz-user-select":"none",position:"absolute",top:"3px",right:"4px","text-align":"right"}})+linb.UI.buildCSSText({".uiw-shell":{background:"transparent",display:linb.$inlineBlock,zoom:linb.browser.ie6?1:null,border:0,padding:0,margin:0},".uiw-frame":{$order:1,display:"block",position:"relative",border:0,padding:0,margin:0,width:"100%",height:"100%","-moz-box-flex":"1"},".uiw-border":{$order:2,display:"block",position:"absolute",border:0,padding:0,margin:0,left:0,top:0,width:"100%",height:"100%"},".ui-dirty":{background:linb.UI.$bg("dirty.gif"," no-repeat left top",true)},".ui-disabled, .ui-disabled *":{color:"#808080"},".ui-invalid, .ui-invalid *":{"background-color":"#FFEBCD"},"#linblangkey":{"vertical-align":"baseline"}})+linb.UI.buildCSSText({".uibg-base":{"background-color":"#FFF"},".uibg-bar":{"background-color":"#EBEADB"},".uiborder-inset":{border:"solid 1px","border-color":"#A7A6AA #fff #fff #A7A6AA"},".uiborder-outset":{border:"solid 1px","border-color":"#fff #A7A6AA #A7A6AA #fff"}})},$End:function(){linb.UI.$cache_css+=this.buildCSSText(this.$Appearances)},Static:{$cache_css:"",$css_tag_dirty:"ui-dirty",$css_tag_invalid:"ui-invalid",$tag_left:"{",$tag_right:"}",$tag_special:"#",$ID:"#id#",$DOMID:"#domid#",$CLS:"#cls#",$tag_subId:"_serialId",$childTag:"<!--{id}-->",$theme:"default",$ps:{left:1,top:1,width:1,height:1,right:1,bottom:1},_getChildren:function(A){return A.children},unserialize:function(C,D){if(typeof C=="string"){C=_.unserialize(str)}var B=function(E){if(E&&E.constructor==Array){E=E[0]}delete E.serialId;if(E.children){_.arr.each(E.children,B)}},A=[];_.arr.each(C,function(E){if(!D){B(E)}A.push((new (linb.SC(E.key))(E)).get(0))});return this.pack(A,false)},_ensureValues:function(A){var B=[],F=0,D=0,G,E=this.KEY,C=linb.cache.dom;if(A["linb.absBox"]){A=A._nodes}for(;G=A[F++];){if((G.box&&G.box[E])||((G=C[G.domNode?G.domNode.id:G.id])&&G.box&&G.box[E])){B[D++]=G}}return B.length<=1?B:this._unique(B)},__gc:function(){var C=this,B=C.$key,A=linb.cache;_.breakO([A.template[B],A.domId[B],C._cache,C._idCache,C.$DataModel,C.$Templates,C.$Behaviors,C],2);delete linb.absBox.$type[B.replace("linb.UI.","")];Class.__gc(B)},_pickSerialId:function(){var A=linb.cache.domId[this.$key];if(A&&A[0]){return A.pop()}return this._ctrlId.next()},$bg:function(C,A,B){return function(D){var E=linb.getPath(typeof B=="string"?B:B?"linb.Public":D.replace("UI.",""),null,"appearance/default")+C;_.asyRun(function(){new Image().src=E});return"url("+E+") "+(A||"")}},$ieBg:function(B,A){return function(C){var D=linb.getPath(typeof A=="string"?A:A?"linb.Public":C.replace("UI.",""),"/"+B,"appearance/default");_.asyRun(function(){new Image().src=D});return'progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+D+'",sizingMethod="crop")'}},$doTemplate:function(E,I,H,O,P){var L=arguments.callee,N,K,D,M=H.constructor==Array,J=I[O||""],A=!P,P=P||[];if(M){if(typeof J!="function"){J=L}for(var G=0;K=H[G++];){J(E,I,K,O,P)}}else{if(K=H.object){P[P.length]=K.toHtml()}else{if(typeof J=="function"){J(E,I,H,O,P)}else{O=O?O+".":"";var C=J[0],B=J[1];for(var G=0,F=C.length;G<F;G++){if(D=B[G]){if(D in H){K=H[D];if(I[N=O+D]&&K){L(E,I,K,N,P)}else{P[P.length]=K}}}else{P[P.length]=C[G]}}}}}if(A){return P.join("")}},$buildTemplate:function(E,V,c,H,B){if(V&&String(V.tagName).toLowerCase()=="text"){B[B.length]=V.text;return }var L=arguments.callee,K=E.behavior?c?E.behavior[c]:E.behavior:null,Y=L.map1||(L.map1={tagName:1,text:1}),W=L.map2||(L.map2={image:1,input:1}),Q=L.r2||(L.r2=/[a-z]/),P=L.r3||(L.r3=/^(on|before|after)/),M=L.r7||(L.r7=/([^{}]*)\{([\w]+)\}([^{}]*)/g),F=false,G=linb.UI,J,N,U,C;if(!V){V=E.template}C=c?E.keys[c]:E.key;if(!V.tagName){V.tagName="span"}if(V.id!==null){V.id=c?C+":"+G.$ID+":"+G.$tag_left+G.$tag_subId+G.$tag_right:G.$DOMID}else{delete V.id}if(V.className!==null){J=G.$CLS+(c?"-"+c.toLowerCase():"");U=V.className||"";V["class"]=J+" "+U+" "+(C==E.key?" ui-ctrl ":"")+G.$tag_special+(c||"KEY")+"_CC"+G.$tag_special}delete V.className;V.style=(V.style||"")+";"+G.$tag_special+(c||"KEY")+"_CS"+G.$tag_special;var T=[],S={},D=V.tagName,I=V.text,A=linb.absObj.$specialChars;for(var R in V){if(!V[R]){continue}if(!A[R.charAt(0)]&&!Y[R]){N=V[R];if(!Q.test(R)){if(typeof N=="object"){if(!N.$order){N.$order=0}N.$key=R;T[T.length]=N}}else{S[R]=N}}}T.sort(function(a,b){a=a.$order;b=b.$order;return a>b?1:a==b?0:-1});if(!B){F=true;B=[]}B[B.length]="<"+D+" ";for(var R in S){B[B.length]=R+'="'+S[R]+'" '}if(V.className!==null){V.className=U}delete V["class"];if(K&&(J=K.$eventhandler)){for(var R in J){if(J[R]){B[B.length]=R+'="'+J[R]+'" '}}}B[B.length]="{attributes}>";if(!W[D]&&I){B[B.length]=I}for(var R=0,O=T.length;R<O;){N=T[R++];L(E,N,N.$key,H,B)}if(!W[D]){B[B.length]="</"+D+">"}if(F){var Z=H[0],X=H[1];B.join("").replace(M,function(f,e,h,g){if(e){Z[Z.length]=e}X[Z.length]=Z[Z.length]=h;if(g){Z[Z.length]=g}return""})}},_rpt:function(E,B){var G=arguments.callee,A=linb.UI.$tag_special,F=G._r||(G._r=new RegExp(A+"([A-Z0-9]+)_C([SC])"+A+"|"+A+"([\\w_\\-\\.]*)"+A,"img")),D={id:E.serialId,cls:E.getClass("KEY"),domid:E.domId},C={S:E.CS,C:E.CC};return B.replace(F,function(I,H,K,J){return D[J]||C[K][H]||""})},_build:function(B,G){var I,L,C,J=linb.UI,K=[[],[]],M=this,H=M.KEY,A=linb.cache.template,F=B._hash="b:"+(B.template._subid||"")+";!"+(B._exhash||"");if(!(I=_.get(A,[H,F]))){J.$buildTemplate(B,null,null,K);_.set(A,[H,F,""],K);if(L=B.template.$dynamic){for(var E in L){if(typeof (C=L[E])!="function"){var K=[[],[]];for(var D in C){if(typeof C[D]=="object"){J.$buildTemplate(B,C[D],D,K)}}C=K}_.set(A,[H,F,E],C)}}I=_.get(A,[H,F])}if(!I){return""}return M._rpt(B,J.$doTemplate(B,I,G))},_setDefaultBehavior:function(G){var A=this,D=arguments.callee,F=D._m||(D._m={"":1,KEY:1,$key:1}),E=D._f1||(D._f1=function(I,K,L){var J=function(R,W,M){var Z,P=M.id,Y,X=R.getSubId(P),O=R.properties,N,V,U;if(O.disabled){return }Y=R.SubSerialIdMapItem&&R.SubSerialIdMapItem[X];if(Y&&Y.disabled){return }switch(typeof I){case"string":N=R.getSubNode(I,X).get();break;case"function":V=[I];break;case"object":N=[];V=[];for(var Q,T=0,S=I.length;T<S;T++){Q=I[T];if(typeof Q=="string"){N.push.apply(N,R.getSubNode(Q,X).get())}else{V.push(Q)}}}if(N&&N.length){N=linb(N);U=R.boxing();if(L==1){if(K=="mouseover"&&R.beforeHoverEffect){if(false==U.beforeHoverEffect(R,Y,W,M,"mouseover")){return }}if(K=="mousedown"&&R.beforeClickEffect){if(false==U.beforeClickEffect(R,Y,W,M,"mousedown")){return }}N.tagClass("-"+K)}else{if(K=="mouseup"){if(R.beforeClickEffect&&false==U.beforeClickEffect(R,Y,W,M,"mouseup")){return }N.tagClass("-mousedown",false)}else{if(R.beforeHoverEffect&&false==U.beforeHoverEffect(R,Y,W,M,"mouseout")){return }N.tagClass("(-mouseover|-mousedown)",false)}}N.length=0}if(V&&V.length){_.arr.each(V,function(a){_.tryF(a,[R],R)});V.length=0}};return J}),B={},C;if(!linb.SC.get("linb.absComposed")){Class("linb.absComposed","linb.absObj",{Instance:{addPanel:function(J,L,M){var N=_.copy(linb.UI.Panel.$DataStruct);_.merge(N,J,"with");_.merge(N,{left:0,top:0,dock:"fill",tag:J.tag||J.id},"all");var K=new linb.UI.Panel(N),I=[];this.append(K,M&&M.id);_.arr.each(L,function(O){I.push(O[0])});K.append(linb.UI.pack(I,false))},removePanel:function(){this.destroy()},getPanelPara:function(){return _.copy(this.get(0).properties)},getPanelChildren:function(){return this.get(0).children},e1:function(J,K,L,M,I){},e2:function(K,J,N,I,M,L,O){},e3:function(J,K,I,L){},e4:function(J,M,N,I,L,K){},e5:function(I,J,K){}},Static:{DataModel:{dragKey:"",dropKeys:""},$abstract:true}})}var H=linb.absComposed.prototype;if(G.HoverEffected){_.each(G.HoverEffected,function(J,I){C=F[I]?G:(G[I]||(G[I]={}));if(!J){C.afterMouseover=C.afterMouseout=null}else{C.afterMouseover=E(J,"mouseover",1);C.afterMouseout=E(J,"mouseout",2)}});B.beforeHoverEffect=H.e1}if(G.ClickEffected){_.each(G.ClickEffected,function(J,I){C=F[I]?G:(G[I]||(G[I]={}));if(!J){C.afterMousedown=C.afterMouseup=null}else{C.afterMousedown=E(J,"mousedown",1);C.afterMouseup=E(J,"mouseup",2)}});B.beforeClickEffect=H.e1}if(G.KeyHook){_.merge(G,{afterKeydown:function(J,K,L){if(J.onHotKeydown){var I=linb.Event.getKey(K);return false!==J.boxing().onHotKeydown(J,I[0],!!I[1],!!I[2],!!I[3],K,L)}},afterKeypress:function(J,K,L){if(J.onHotKeypress){var I=linb.Event.getKey(K);return false!==J.boxing().onHotKeypress(J,I[0],!!I[1],!!I[2],!!I[3],K,L)}},afterKeyup:function(J,K,L){if(J.onHotKeyup){var I=linb.Event.getKey(K);return false!==J.boxing().onHotKeyup(J,I[0],!!I[1],!!I[2],!!I[3],K,L)}}},"all");B.onHotKeydown=B.onHotKeypress=B.onHotKeyup=H.e2}if(G.NavKeys){_.each(G.NavKeys,function(J,L){var I=arguments.callee,K,Q=I.m1||(I.m1={KEY:1,$key:1});if(Q[L]){return }var O=I.m2||(I.m2={input:1,textarea:1}),N=I.m3||(I.m3={tab:1,enter:1,up:1,down:1,left:1,right:1}),M=I.m4||(I.m4={tab:1,up:1,down:1,left:1,right:1}),P=G[L]||(G[L]={});if(null===J){P.afterKeydown=null}else{P.afterKeydown=function(U,Y,R){var V=linb.Event.getKey(Y),a=V[0],T=V[2],X=V[3],Z=false;if(O[V=R.tagName.toLowerCase()]){if(N[a]){var S=linb([R]).caret(),W=R.value;switch(a){case"up":if(!/[\n\r]/.test(W.substr(0,S[0]))){Z=true}break;case"left":if(S[0]===0&&(S[1]!==W.length||S[1]===0)){Z=true}break;case"down":if(!/[\n\r]/.test(W.substr(S[1],W.length))){Z=true}break;case"right":if(S[1]===W.length&&(S[0]!==0||S[1]===0)){Z=true}break;default:if(V=="input"||X){Z=true}break;case"tab":Z=true;break}}}else{if(M[a]){Z=true}}if(Z){if(U.beforeNextFocus&&false===U.boxing().beforeNextFocus(U,a,!!T,Y)){return false}if(a!="tab"){linb(R).nextFocus(("up"==a||"left"==a)?false:true)}}}}});B.beforeNextFocus=H.e3}if((C=G.DropableKeys)&&C.length){_.arr.each(C,function(I){A._dropable(I)});C=A.prototype;_.arr.each("addPanel,removePanel,getPanelPara,getPanelChildren,getDropKeys,setDropKeys".split(","),function(I){if(!C[I]){C[I]=H[I]}});A.$DataModel.dropKeys=A.$DataStruct.dropKeys="";B.onDragEnter=B.onDragLeave=B.onDrop=B.onDropTest=B.onDropMarkShow=B.onDropMarkClear=H.e4}if((C=G.DragableKeys)&&C.length){_.arr.each(C,function(I){A._dragable(I)});C=A.prototype;_.arr.each("getDragKey,setDragKey".split(","),function(I){if(!C[I]){C[I]=H[I]}});A.$DataModel.dragKey=A.$DataStruct.dragKey="";B.onStartDrag=B.onDragStop=H.e5}A.setEventHandlers(B)},addTemplateKeys:function(A){var B=this,C=B.KEY,E=arguments.callee,D=E._reg||(E._reg=/\./g);_.arr.each(A,function(F){B.$cssKeys[F]=(B.$Keys[F]=F=="KEY"?C:C+"-"+F).replace(D,"-").toLowerCase().replace("linb-ui","linb")});return B},getTheme:function(){return this.$theme},setTheme:function(A){A=A||"default";if(A!=this.$theme){if(A!="default"){linb.CSS.includeLink(linb.getPath("linb.appearance."+A,"/theme.css"),"theme:"+A)}var B=linb.CSS.get("id","theme:"+this.$theme);if(B){B.disabled=true;linb(B).remove(false)}this.$theme=A}return this},setAppearance:function(A){_.merge(this.$Appearances,A,"all");return this},getAppearance:function(){return this.$Appearances},setTemplate:function(D,K){if(D){var J=this,G=arguments.callee,A=G.r2||(G.r2=/[a-z]/),F=linb.absObj.$specialChars,E=["KEY"],H=G._fun||(G._fun=function(N,L){var O,M;for(M in N){if(!F[M.charAt(0)]){if(!A.test(M)){L[L.length]=M;O=N[M];if(typeof O=="object"){arguments.callee(O,L)}}}}}),I;H(D,E);J.addTemplateKeys(E);I=J.$Templates;if(typeof K=="string"){D._subid=K;I[K]=D}else{I._=D}if(I=D.$dynamic){for(var C in I){for(var B in I[C]){G.call(J,I[C],B)}}}}return this},getTemplate:function(A){return this.$Templates[A||"_"]},setBehavior:function(I){if(I){var P=this,B=linb.absObj.$specialChars,O=linb.Event.$EVENTHANDLER,L="$eventhandler",A=linb.Event._getEventType,K=arguments.callee,E=K.r1||(K.r1=/[a-z]/),D=K.r2||(K.r2=/^(on|before|after)/),N=P.$Behaviors,F,H,G,C,M,J;P._setDefaultBehavior(I);if(I.KEY){_.merge(I,I.KEY,"all");delete I.KEY}for(H in I){C=I[H];if(!B[H.charAt(0)]){if(!E.test(H)){F=N[H]||(N[H]={});for(G in C){M=C[G];if(!B[G.charAt(0)]){J=A(G);if(M){F[G]=M;(F[L]||(F[L]={}))["on"+J]=O}else{delete F[G];if(N[L]){delete N[L]["on"+J]}}}}}else{if(D.test(H)){J=A(H);if(C){N[H]=C;(N[L]||(N[L]={}))["on"+J]=O}else{delete N[H];if(N[L]){delete N[L]["on"+J]}}}else{N[H]=C}}}}}return P},getBehavior:function(){return this.$Behaviors},$applyCSS:function(){var B=linb.UI,A=B.$cache_css;if(A){if(!B.$cssNo){B.$cssNo=1}linb.CSS.addStyleSheet(A,"linb.UI-CSS"+(B.$cssNo++));B.$cache_css=""}},buildCSSText:function(I){var Q=this,M=arguments.callee,D=M._r1||(M._r1=/(^|\s|,)([0-9A-Z_]+)/g),J=[],A=[],K=linb.browser,F=K.ie6,B=K.ie,L=K.gek,N=Q.$cssKeys,P,O,C;for(var H in I){C=I[H];P=H.replace(D,function(S,R,T){return R+"."+(N[T]||T)}).toLowerCase();C.$order=parseInt(C.$order)||0;C.$=P;J[J.length]=C}J.sort(function(R,S){R=R.$order;S=S.$order;return R>S?1:R==S?0:-1});for(var H=0,E=J.length;H<E;){C=J[H++];A[A.length]=C.$+"{";if(P=C.$before){A[A.length]=P}if(P=C.$text){A[A.length]=P}for(var G in C){switch(G.charAt(0)){case"$":continue;break;case"_":if(!F){continue}break;case"*":if(!B){continue}break;case"-":if(!L){continue}break}if((O=C[G])||C[G]===0){switch(typeof O){case"string":case"number":A[A.length]=G+":"+O+";";break;case"function":A[A.length]=G+":"+O(Q.KEY)+";";break;default:_.arr.each(O,function(R){if(R){A[A.length]=G+":"+R+";"}})}}}if(O=C.$after){A[A.length]=O}A[A.length]="}"}return A.join("")},_dropable:function(D){var B=this,C=linb.Event.$EVENTHANDLER2,E=B.$Behaviors,A=D=="KEY"?E:(E[D]||(E[D]={}));_.merge(A,{beforeMouseover:function(H,K,F){if(H.properties.disabled||H.properties.readonly){return }var Q=this,N=linb.DragDrop,G=N.getProfile(),M=G.dragKey,I=G.dragData,P,J,O,L;if(!M||!I||!(new RegExp("\\b"+M+"\\b")).test(H.box.getDropKeys(H,Q))){return }J=H.boxing();if(J.getItemByDom){P=J.getItemByDom(F)}L=[H,K,Q,M,I,P];if((O=H.onDropTest)&&(false===J.onDropTest.apply(J,L))){return }if((O=H.box._onDropTest)&&(false===O.apply(H.host||H,L))){return }N.setDropElement(F);if(H.onDropMarkShow&&(false===J.onDropMarkShow.apply(J,L))){}else{if((O=H.box._onDropMarkShow)&&(false===O.apply(H.host||H,L))){}else{_.resetRun("setDropFace",N.setDropFace,0,[Q],N)}}if(O=H.box._onDragEnter){O.apply(H.host||H,L)}if(H.onDragEnter){J.onDragEnter.apply(J,L)}},beforeMouseout:function(H,K,F){if(H.properties.disabled||H.properties.readonly){return }var P=this,N=linb.DragDrop,G=N.getProfile(),M=G.dragKey,I=G.dragData,O,J,L;if(G.dropElement==F.id){J=H.boxing();if(J.getItemByDom){O=J.getItemByDom(F)}L=[H,K,P,M,I,O];if(H.onDropMarkClear&&(false===J.onDropMarkClear.apply(J,L))){}else{if((t=H.box._onDropMarkClear)&&(false===t.apply(H.host||H,L))){}else{_.resetRun("setDropFace",N.setDropFace,0,[null],linb.DragDrop)}}if(t=H.box._onDragLeave){t.apply(H.host||H,L)}if(H.onDragLeave){J.onDragLeave.apply(J,L)}N.setDropElement(null)}},beforeDrop:function(H,K,F){var Q=this,N=linb.DragDrop,G=N.getProfile(),M=G.dragKey,I=G.dragData,P,O,L,J=H.boxing();if(J.getItemByDom){P=J.getItemByDom(F)}L=[H,K,Q,M,I,P];if(H.onDropMarkClear&&(false===J.onDropMarkClear.apply(J,L))){}else{if((O=H.box._onDropMarkClear)&&(false===O.apply(H.host||H,L))){}}if(H.onDrop&&(false===J.onDrop.apply(J,L))){}else{if((O=H.box._onDrop)&&(false===O.apply(H.host||H,L))){}}}},"all");_.merge(A.$eventhandler||(A.$eventhandler={}),{onmouseover:C,onmouseout:C,ondrop:C});return B},_dragable:function(D){var B=this,C=linb.Event.$EVENTHANDLER2,E=B.$Behaviors,A=D=="KEY"?E:(E[D]||(E[D]={}));_.merge(A,{beforeMousedown:function(H,J,K){if(H.properties.disabled){return }if(!H.properties.dragKey){return }var L=linb.Event.getPos(J),I=H.boxing(),F=[H,J,K],G;if(H.onStartDrag&&(false===I.onStartDrag.apply(I,F))){}else{if((G=H.box._onStartDrag)&&(false===G.apply(H.host||H,F))){}else{linb([K]).startDrag(J,{dragType:"icon",targetLeft:L.left+12,targetTop:L.top+12,dragCursor:"pointer",dragDefer:1,dragKey:H.box.getDragKey(H,this),dragData:H.box.getDragData(H,this)})}}},beforeDragbegin:function(F,G,H){linb(H).onMouseout(true,{$force:true}).onMouseup(true)},beforeDragstop:function(G,H,I){var F;if(G.onDragStop){G.boxing().onDragStop(G.e,I)}if(F=G.box._onDragStop){F.apply(G.host||G,arguments)}}},"all");_.merge(A.$eventhandler||(A.$eventhandler={}),{onmousedown:C,ondragbegin:C});return B},adjustData:function(D,G,C){if(!C){C={}}var B,H,A=linb.wrapRes,F=arguments.callee,E=F._r||(F._r=/\B\$([\w]+[\.][\w\.]+[\w])/g);for(B in G){if(B.charAt(0)=="$"){continue}if(!(B in C)){C[B]=typeof (H=G[B])=="string"?(((H.indexOf("$")!=-1)?(H=H.replace(E,function(J,I){return A(I)})):H)&&((H.charAt(0)=="@")?(linb.SC.get(H.substr(1,H.length))||H):H)):H}}if((typeof (H=C.renderer)=="function")||(typeof (H=G.renderer)=="function")){C.caption=H(G,C,D)}if("disabled" in G){C.disabled=G.disabled?"ui-disabled":""}C.iconDisplay=G.image?"":"display:none";return C},cacheData:function(A,B){_.set(linb.cache,["UIDATA",A],B);return this},getCachedData:function(A){var B=_.get(linb.cache,["UIDATA",A]);if(typeof B=="function"){B=B()}return _.clone(B)},DataModel:{tag:"",tagVar:{ini:{}},disabled:{ini:false,action:function(A){this.root.css("opacity",A?0.5:1)}},dock:{ini:"none",listbox:["none","top","bottom","left","right","center","middle","origin","width","height","fill","cover"],action:function(B){var A=this;if(A.domNode){linb.UI.$dock(A,true)}}},dockIgnore:{ini:false,action:function(B){var A=this;if(!B&&A.domNode&&A.properties.dock!="none"){linb.UI.$dock(A,true,true)}}},dockOrder:{ini:1,action:function(B){var A=this;if(A.domNode&&A.properties.dock!="none"){linb.UI.$dock(A,true,true)}}},dockMargin:{ini:{left:0,top:0,right:0,bottom:0},action:function(B){var A=this;if(A.domNode&&A.properties.dock!="none"){linb.UI.$dock(A,true,true)}}},dockFloat:{ini:false,action:function(B){var A=this;if(A.domNode&&A.properties.dock!="none"){linb.UI.$dock(A,true,true)}}},dockMinW:0,dockMinH:0,tips:""},EventHandlers:{onRender:function(A){},onLayout:function(A){},onDestroy:function(A){},beforeDestroy:function(A){},onShowTips:function(A,B,C){}},RenderTrigger:function(){var B=this,A=B.boxing(),E=B.properties;if(B.box._onresize){var D=B.domNode.style,C;if((C=D.visibility)!="hidden"){B._$v=C;D.visibility="hidden"}linb.UI.$tryResize(B,E.width,E.height)}if(E.disabled){A.setDisabled(true,true)}B.inValid=1;B.rendered=true;if(B.onRender){A.onRender(B)}},$tryResize:function(G,A,F,D,H){var E=G.box,C=E._onresize,B=G.$rs_args;if(C&&(A||F)){if(!B){B=G.$rs_args=[G,null,null];_.asyRun(G.$resizeFun=function(){delete G.$rs_args;delete G.$resizeFun;if(!linb.Dom.byId(G.domId)){return }C.apply(E,B);var I=G.domNode.style;if("_$v" in G){if(I.visibility!="visible"){I.visibility=G._$v}delete G._$v}})}if(A){B[1]=A}if(F){B[2]=F}B[3]=D}if(H){_.tryF(G.$resizeFun)}},LayoutTrigger:function(){var B=this,A=B.boxing(),D=B.properties;if(D.dock&&D.dock!="none"){if(!B.$laidout){B.$laidout=1;var C=B.domNode.style;switch(D.dock){case"top":case"bottom":case"width":C.width=0;break;case"left":case"right":case"height":C.height=0;break;default:C.width=C.height=0}}linb.UI.$dock(this,true)}if(B.onLayout){A.onLayout(B)}},$dock:function(G,M,D){var B=G.properties,I=B.dockMargin,F=G.root,O=B.dock||"none",C=F.parent(),Q="auto",J=C.id(),E=function(R,S){R=parseInt(R.properties.dockOrder)||0;S=parseInt(S.properties.dockOrder)||0;return R>S?1:R==S?0:-1},L=false,N,A="$inMatix",K,P,H=function(R){return linb.browser.ie6?R-R%2:R};if(J&&_.str.startWith(J,linb.Dom._matixid)){return }if(G.$dockParent!=J||G.$dockType!=O||D){G.$dockParent=J;G.$dockType=O;G.unLink("$dock");G.unLink("$dock1");G.unLink("$dock2");switch(O){case"middle":N={right:Q,bottom:Q,left:B.left||"",width:B.width||"",height:B.height||""};break;case"center":N={right:Q,bottom:Q,top:B.top||"",width:B.width||"",height:B.height||""};break;case"origin":N={right:Q,bottom:Q,width:B.width||"",height:B.height||""};break;case"top":N={left:I.left,right:I.right,bottom:Q,height:B.height||""};break;case"bottom":N={left:I.left,right:I.right,top:Q,height:B.height||""};break;case"left":N={right:Q,width:B.width||""};break;case"right":N={left:Q,width:B.width||""};break;case"width":N={bottom:Q,height:B.height||"",top:B.top||""};break;case"height":N={right:Q,width:B.width||"",left:B.left||""};break;case"fill":case"cover":N={right:Q,bottom:Q};break;case"none":N={left:B.left,top:B.top,width:B.width||"",height:B.height||""};break}F.cssRegion(N,true);if(C.get(0)===document.body){C=linb.win;L=true;if(L&&!linb.cache._resizeTime){linb.cache._resizeTime=1}}if(O!="none"){K=C.$getEvent("onSize","dock");if(!K){K=function(T,f){var d=arguments.callee,R=d.map||(d.map={middle:1,center:1}),Z=d.arr,a=d.rePos,V=d.node,S=V.get(0).style,b=d.win,Y,X,W,U,e,c;if(f.$dockid||!b||(_()-linb.cache._resizeTime>100)){Y={left:0,top:0,right:0,bottom:0,width:parseInt(S&&S.width)||V.width(),height:parseInt(S&&S.height)||V.height()};for(W=0;e=Z[W++];){c=d[e];if(c.length){if(!R[e]){f.width=f.height=1}for(X=0;U=c[X++];){if(!U.properties.dockIgnore){a(U,Y,e,f.$dockid,b||f.width,b||f.height)}}}}if(Y.later){_.each(Y.later,function(h){try{h.node.cssRegion(h,true)}catch(g){_.asyRun(function(){h.width+=1;h.height+=1;h.node.cssRegion(h,true)})}})}if(b){linb.cache._resizeTime=_()}}};K.node=C;K.arr=["top","bottom","left","right","center","middle","width","height"];_.arr.each(K.arr,function(R){K[R]=[]});K.win=L;K.rePos=function(S,a,e,d,Z,j){var i=false;if(d&&S.$id!=d){i=true}var R=S.properties,g=R.dockFloat,c=R.dockMargin,f=S.root,k=S.domNode.style,U,b,m,W,l,V,Y=parseInt(R._dockBorderWidth)||0,X=parseInt(R._dockBorderHeight)||0,T={};switch(e){case"middle":f.top((a.height-f.height())/2);break;case"center":f.left((a.width-f.width())/2);break;case"top":if(!i){U=c.left;m=c.right;b=(g?0:a.top)+c.top;if(parseFloat(k.top)!=b){T.top=b}l=a.width-U-m-Y;if(parseFloat(k.width)!=l){T.width=H(l)}if(!_.isEmpty(T)){f.cssRegion(T,true)}}if(!g){a.top+=(f.offsetHeight()+c.top+c.bottom)}break;case"bottom":if(!i){U=c.left;m=c.right;W=(g?0:a.bottom)+c.bottom;if(parseFloat(k.bottom)!=W){T.bottom=W}l=a.width-U-m-Y;if(parseFloat(k.width)!=l){T.width=H(l)}if(!_.isEmpty(T)){f.cssRegion(T,true)}}if(!g){a.bottom+=(f.offsetHeight()+c.top+c.bottom)}break;case"left":if(!i){U=(g?0:a.left)+c.left;b=(g?0:a.top)+c.top;W=(g?0:a.bottom)+c.bottom;if(parseFloat(k.left)!=U){T.left=U}if(parseFloat(k.top)!=b){T.top=b}l=a.height-b-W-X;if(parseFloat(k.height)!=l){T.height=H(l)}if(!_.isEmpty(T)){f.cssRegion(T,true)}}if(!g){a.left+=(f.offsetWidth()+c.left+c.right)}break;case"right":if(!i){m=(g?0:a.right)+c.right;b=(g?0:a.top)+c.top;W=(g?0:a.bottom)+c.bottom;if(parseFloat(k.right)!=m){T.right=m}if(parseFloat(k.top)!=b){T.top=b}l=a.height-b-W-X;if(parseFloat(k.height)!=l){T.height=H(l)}if(!_.isEmpty(T)){f.cssRegion(T,true)}}if(!g){a.right+=(f.offsetWidth()+c.left+c.right)}break;case"width":if(!Z){return }U=(R.dock=="cover"?0:(g?0:a.left))+c.left;m=(R.dock=="cover"?0:(g?0:a.right))+c.right;b=R.dock=="width"?(parseInt(R.top)||0):((R.dock=="cover"?0:(g?0:a.top))+c.top);l=a.width-U-m-Y;a.later=a.later||{};a.later[S.$id]=a.later[S.$id]||{};_.merge(a.later[S.$id],{node:f,width:H(R.dockMinW?Math.max(R.dockMinW,l):l),left:U,top:b},"all");break;case"height":if(!j){return }b=(R.dock=="cover"?0:(g?0:a.top))+c.top;W=(R.dock=="cover"?0:(g?0:a.bottom))+c.bottom;U=R.dock=="height"?(parseInt(R.left)||0):((R.dock=="cover"?0:(g?0:a.left))+c.left);l=a.height-b-W-X;a.later=a.later||{};a.later[S.$id]=a.later[S.$id]||{};_.merge(a.later[S.$id],{node:f,height:H(R.dockMinH?Math.max(R.dockMinH,l):l),left:U,top:b},"all");break}};C.onSize(K,"dock")}if(O=="fill"||O=="cover"){G.link(K.height,"$dock1");G.link(K.width,"$dock2");K.height.sort(E);K.width.sort(E)}else{if(O=="origin"){G.link(K.center,"$dock1");G.link(K.middle,"$dock2")}else{G.link(K[O],"$dock");K[O].sort(E)}}linb.cache._resizeTime=1;G.$dock=K}}if(O!="none"&&M){G.$dock(G,{width:1,height:1,$dockid:_.arr.indexOf(["width","height","fill","cover"],O)!=-1?G.$id:null,$type:O})}},_beforeSerialized:function(D){var E=D.boxing(),A,C,G={};_.merge(G,D,"all");var F=G.properties=_.copy(D.properties);switch(F.dock){case"top":case"bottom":delete F.width;delete F.left;delete F.top;delete F.right;delete F.bottom;break;case"left":case"right":delete F.height;delete F.left;delete F.top;delete F.right;delete F.bottom;break;case"width":delete F.width;delete F.left;delete F.right;break;case"height":delete F.height;delete F.top;delete F.bottom;break;case"fill":case"cover":delete F.width;delete F.height;delete F.left;delete F.top;delete F.right;delete F.bottom;break}for(var B in linb.UI.$ps){if((B in F)&&typeof F[B]!="number"&&F[B]!=""&&F[B]!="auto"){F[B]=isNaN(F[B]=parseFloat(F[B]))?"auto":F[B]}}if(F.items&&F.items.length){C=linb.absObj.$specialChars;F.items=_.clone(F.items,function(I,H){return !C[(H+"").charAt(0)]&&I!=undefined})}if(_.isEmpty(F.tagVar)){delete F.tagVar}if((C=F.dockMargin)&&!C.left&&!C.top&&!C.right&&!C.bottom){delete F.dockMargin}if(F.items&&(F.items.length==0||F.listKey)){delete F.items}return G},getDropKeys:function(A,B){return A.properties.dropKeys},getDragKey:function(A,B){return A.properties.dragKey},getDragData:function(A,B){return{profile:A,domId:B.id}},_prepareData:function(C,F){var A=C.properties,G=this.$DataModel,H=arguments.callee,B=H.map||(H.map=_.toArr("left,top,bottom,right,width,height")),I=[],J=linb.UI.adjustData,K;F=F||{};if(A.id){delete A.id}if("caption" in G&&A.caption!==null){A.caption=A.caption===undefined?C.alias:A.caption}if("$border" in G){F.bWidth=A.width-(K=(A.$border||0)*2);F.bHeight=A.height-K}for(var D=0,E;E=B[D];D++){if(A[E]||A[E]===0){if(String(parseFloat(A[E]))==String(A[E])){I[I.length]=E+":"+(parseInt(A[E])||0)+"px"}else{if(A[E]!="auto"&&A[E]){I[I.length]=E+":"+A[E]}}}}if(A.position){I[I.length]="position:"+A.position}if(A.visibility){I[I.length]="visibility:"+A.visibility}if(A.zIndex){I[I.length]="z-index:"+A.zIndex}if(A.display){I[I.length]="display:"+(A.display=="inline-block"?linb.browser.gek?"-moz-inline-block;display:-moz-inline-box;display:inline-block;":"inline-block":A.display)}F._style=";"+I.join(";")+";";if("href" in G){F.href=A.href||linb.$href}if("tabindex" in G){F.tabindex=A.tabindex||"-1"}if("items" in G){C.ItemIdMapSubSerialId={};C.SubSerialIdMapItem={};F.items=this._prepareItems(C,A.items)}F=J(C,A,F);C.prepared=true;return F},_prepareItems:function(D,K,J,F,H){var O=[],N,A,M,C=linb.UI.$tag_subId,B,G=D.properties.tabindex,L=linb.UI.adjustData;for(var I=0,E=K.length;I<E;I++){if(typeof K[I]!="object"){K[I]={id:K[I]}}N=K[I];if(!("caption" in N)){N.caption=N.id}A={id:N.id};if(J){A._pid=J}B=A[C]=typeof H=="string"?H:D.pickSubId("items");if(false!==F){D.ItemIdMapSubSerialId[N.id]=B;D.SubSerialIdMapItem[B]=N}if(M=N.object){M=A.object=M["linb.absBox"]?M.get(0):M;if(M["linb.UIProfile"]){M.properties.position="relative"}N.$id=M.$id;M.$item=N;M.$holder=D;if(!D.$attached){D.$attached=[]}D.$attached.push(M)}else{A._tabindex=G;L(D,N,A);if(this._prepareItem){this._prepareItem(D,A,N,J,F,H)}}O.push(A)}return O},_showTips:function(A,B,C){if(A.onShowTips){return A.boxing().onShowTips(A,B,C)}}}});Class("linb.absList","linb.absObj",{Instance:{activate:function(){var B=this.get(0),A=B.getSubNode("ITEM",true);if(!A.isEmpty()){A.focus()}return this},insertItems:function(F,B,J){if(!F||!F.length){return }var C,H,G,A,D,E,I=this._afterInsertItems;return this.each(function(L){E=L.box;H=L.properties.items;G=_.arr.subIndexOf(H,"id",B);if(G==-1){H.push.apply(H,F)}else{_.arr.insertAny(H,F,J?G:G+1)}if(L.domNode){D=E._prepareItems(L,F,B);var K=L.buildItems("items",D);if(G==-1){C=L.getSubNode(E.ITEMSKEY||L.keys.ITEMS||L.keys.KEY);if(typeof J=="boolean"){A=_.str.toDom(K);if(J||H.length==1){C.prepend(A)}else{C.append(A)}}else{C.html(K)}}else{A=_.str.toDom(K);C=L.getSubNodeByItemId(E.ITEMKEY||"ITEM",B);if(J===true){C.addPrev(A)}else{C.addNext(A)}}if(I){L.boxing()._afterInsertItems(L,D,B,J)}}})},removeItems:function(B,D){if(!(B instanceof Array)){B=[B]}var E,C,A=this._afterRemoveItems;remove=function(I,F,K,H,J){var G=arguments.callee;if(!H){H=linb()}_.filter(F,function(O){var N,L;if(J||(L=(_.arr.indexOf(K,O.id)!=-1))){if(I.domNode){if(N=I.ItemIdMapSubSerialId[O.id]){delete I.SubSerialIdMapItem[N];delete I.ItemIdMapSubSerialId[O.id];I.reclaimSubId(N,"items");if(!J){if(!(E=I.getSubNode(I.keys[D]?D:"ITEM",N)).isEmpty()){H.merge(E)}if(O.$id){H.get().push(linb.getObject(O.$id).getRootNode())}}}}}if(O.sub){G(I,O.sub,K,H,J||L)}if(L){for(var M in O){O[M]=null}return false}});H.remove()};return this.each(function(F){var G=F.properties;remove(F,G.items,B);if(C=G.value){if((C=C.split(";")).length>1){_.filter(C,function(H){return _.arr.indexOf(B,H)==-1});G.value=C.join(";")}else{if(_.arr.indexOf(B,G.value)!=-1){G.value=null}}}if(A&&F.domNode){F.boxing()._afterRemoveItems(F,B)}})},clearItems:function(A){return this.each(function(B){if(!B.SubSerialIdMapItem){return }B.getSubNode(B.keys[A]||B.keys.ITEMS||"KEY",true).empty();_.each(B.SubSerialIdMapItem,function(D,C){B.reclaimSubId(C,"items")});B.properties.items.length=0;B.SubSerialIdMapItem={};B.ItemIdMapSubSerialId={}})},updateItem:function(A,I){var H=this,C=H.get(0),E=C.box,F=C.properties.items,G=C.queryItems(F,function(J){return J.id==A},true,true),D,B;if(G.length){G=G[0];_.merge(G,I,"all");G.id=A;D=_.get(C,["ItemIdMapSubSerialId",A]);arr=E._prepareItems(C,[G],G._pid,false,D);B=C.getSubNodeByItemId("ITEM",A);if(!B.isEmpty()){if(F.sub){delete G._created;delete G._checked}B.outerHTML(C.buildItems(arguments[2]||"items",arr))}}return H},fireItemClickEvent:function(A){var B=this.get(0),C=B.getSubNodeByItemId("ITEM",A);if(C.isEmpty()){B.boxing().setUIValue(null)}else{C.onClick()}return this}},Initialize:function(){var A=this.prototype;_.arr.each(_.toArr("getItemByItemId,getItemByDom,getSubIdByItemId,getSubNodeByItemId"),function(B){A[B]=function(){var C=this.get(0);return C[B].apply(C,arguments)};Class._fun(A[B],B,A.KEY)})},Static:{$abstract:true,DataModel:{listKey:{set:function(B,A){return this.each(function(D){if(D.properties.listKey!=B||A){var C=D.box.getCachedData(B);if(C){D.boxing().setItems(C)}else{D.boxing().setItems(D.properties.items)}D.properties.listKey=B}})}},items:{ini:[],set:function(A){return this.each(function(B){if(B.domNode){B.boxing().clearItems().insertItems(A)}B.properties.items=A})}}},_showTips:function(C,E,H){if(C.onShowTips){return C.boxing().onShowTips(C,E,H)}var B=C.properties,G=E.id,A=C.getSubId(G),F=C.SubSerialIdMapItem,D=F&&F[A];if(B.disabled){return }if(D&&D.disabled){return }if(D&&D.tips){linb.Tips.show(H,D);return true}else{return false}}}});Class("linb.absValue","linb.absObj",{Instance:{_getCtrlValue:function(){return this.getUIValue()},_setCtrlValue:function(A){return this},_setDirtyMark:function(){return this},getValue:function(){return this.get(0).properties.value},getUIValue:function(){return this.get(0).properties.$UIvalue},resetValue:function(B){var A=this;A.each(function(C){var D;if(typeof (D=C.box._ensureValue)=="function"){B=D.call(C.box,C,B)}C.boxing()._setCtrlValue(C.properties.$UIvalue=C.properties.value=B);if(typeof (D=C.$onValueSet)=="function"){D.call(C,B)}C.inValid=1});A._setDirtyMark();return A},setUIValue:function(C,B){var A=this;this.each(function(D){var H=D.properties,F,G=H.$UIvalue,E=D.boxing();if(G!==C||B){if(false===D.box._checkValid(D,C)||(D.beforeUIValueSet&&false===(F=E.beforeUIValueSet(D,G,C)))){return }if(F!==undefined){C=F}if(typeof (F=D.box._ensureValue)=="function"){C=F.call(D.box,D,C)}if(typeof (F=D.$onValueUpdated)=="function"){F.call(D,C)}if(D.domNode){E._setCtrlValue(C)}H.$UIvalue=C;if(D.domNode){E._setDirtyMark()}if(D.afterUIValueSet){E.afterUIValueSet(D,G,C)}}});return this},updateValue:function(){this.each(function(A){var B=A.properties;if(A.boxing().checkValid()){B.value=B.$UIvalue}});return this._setDirtyMark()},isDirtied:function(){var A=this.get(0).properties;return A.value!==A.$UIvalue},checkValid:function(){var A=true;this.each(function(B){var C=B.properties;A=B.box._checkValid(B,C.$UIvalue)&&A;if(B.domNode){B.boxing()._setDirtyMark()}});return A}},Static:{$abstract:true,DataModel:{dataBinder:{combobox:function(){return _.toArr(linb.DataBinder._pool,true)},set:function(D,A){var C,B;return this.each(function(F){var G=F.properties,E=G.dataBinder;if(E==D&&!A){return }if(E){linb.DataBinder._unBind(E,F)}G.dataBinder=D;linb.DataBinder._bind(D,F)})}},dataField:"",value:{ini:null,set:function(B,A){this.each(function(D){var H=D.properties,F,G=H.value,E=D.boxing(),C=B;if(G!==C||A){if(D.box._checkValid(D,C)===false){return }if(D.beforeValueSet&&false===(F=E.beforeValueSet(D,G,C))){return }if(F!==undefined){C=F}if(typeof (F=D.box._ensureValue)=="function"){C=F.call(D.box,D,C)}if(typeof (F=D.$onValueSet)=="function"){F.call(D,C)}if(D.domNode){E._setCtrlValue(C)}H.value=H.$UIvalue=C;D.inValid=1;if(D.domNode){E._setDirtyMark()}if(D.afterValueSet){E.afterValueSet(D,G,C)}}});return this}}},EventHandlers:{beforeValueSet:function(B,A,C){},afterValueSet:function(B,A,C){},beforeUIValueSet:function(B,A,C){},afterUIValueSet:function(B,A,C){},beforeDirtyMark:function(B,A){}},RenderTrigger:function(){var B=this,A=B.boxing(),E=B.properties,C,D;E.$UIvalue=E.value;if(E.value!==undefined){D=E.value;if(typeof (C=B.box._ensureValue)=="function"){D=C.call(B.box,B,D)}A._setCtrlValue(D)}if(C=E.dataBinder){A.setDataBinder(C,true)}if(C=E.dataField){A.setDataField(C)}},_checkValid:function(A,B){return true}}});new function(){var A="linb.UI";Class(A+".Widget",A,{Static:{Appearances:{KEY:{"font-size":linb.browser.ie?0:null,"line-height":linb.browser.ie?0:null}},Templates:{className:"uiw-shell ",style:"{_style}",FRAME:{className:"uiw-frame ",BORDER:{style:"width:{bWidth}px;height:{bHeight}px;",className:"uiw-border"}}},Behaviors:{KeyHook:true,onSize:function(E,F){var D=E.domNode.style,B=null,C=null;if(F.width){B=parseInt(D.width)||B}if(F.height){C=parseInt(D.height)||C}linb.UI.$tryResize(E,B,C)}},DataModel:{width:100,height:100,$border:0},RenderTrigger:function(){var B=this,C=B.properties,D=B.boxing();_.asyRun(function(){if(!linb.Dom.byId(B.domId)){return }if((!B.$noB)&&C.border&&D._border){D._border(C.border)}if((!B.$noR)&&C.resizer&&D.setResizer){D.setResizer(C.resizer,true)}if((!B.$noS)&&C.shadow&&D._shadow){D._shadow(C.shadow)}})},_onresize:function(G,F,B){var I=G.getSubNode("BORDER"),E=G.properties,D,H=null,C=null;if(null!==F){F-=E.$border*2;if(linb.browser.ie6){F=(parseInt(F/2))*2}H=F}if(null!==B){B-=(E.$border*2);if(linb.browser.ie6){B=(parseInt(B/2))*2}C=B;if(linb.browser.ie6&&null===F){I.ieRemedy()}}D={width:H,height:C};I.cssSize(D);return D}}});Class(A+".Link",A,{Static:{Appearances:{KEY:{"font-size":linb.browser.ie?"12px":null,"line-height":linb.browser.ie?"14px":null}},Templates:{tagName:"a",style:"{_style}",href:"{href}",target:"{target}",tabindex:"{tabindex}",text:"{caption}"},Behaviors:{onClick:function(B,D,E){var C;if(!B.properties.disabled&&B.onClick){C=B.boxing().onClick(B,D,E)}return C!==undefined?C:false}},DataModel:{caption:{ini:undefined,action:function(B){this.root.get(0).innerHTML=B}},href:{ini:linb.$href,action:function(B){if(this.domNode){this.root.attr("href",B)}}},target:{action:function(B){if(this.domNode){this.root.attr("target",B)}}}},EventHandlers:{onClick:function(B,C){}}}});Class(A+".Div",A,{Static:{Appearances:{KEY:{outline:linb.browser.gek?"none":null,zoom:linb.browser.ie6?"1":null,background:linb.browser.ie?"url("+linb.ini.file_bg+") no-repeat left top":null}},Templates:{tagName:"div",style:"{_style}",tabindex:"-1",text:"{html}"+linb.UI.$childTag},DataModel:{disabled:null,width:"100",height:"100",html:{action:function(B){this.domNode.innerHTML=B}}}}});Class(A+".Tag",A+".Div",{Static:{Templates:{tagName:"div",style:"overflow:auto;border:dashed blue 1px;text-align:center;background:#EBEADB;{_style}",text:"{tagKey}"+linb.UI.$childTag},DataModel:{html:null,tagKey:{action:function(B){this.root.html(B)}}},_l:_.toArr("left,top,bottom,right,width,height,zIndex,tabindex,position,dock,dockFloat,dockMinW,dockMinH,dockOrder,dockMargin"),replace:function(D,E,B){_.arr.each(this._l,function(H){if(H in D.properties){E.properties[H]=D.properties[H]}});_.merge(E.CS,D.CS,"all");_.merge(E.CC,D.CC,"all");if(D.parent){var F=D.parent.children,G=F["$"+D.$id],C=_.arr.indexOf(F,G);D.parent.boxing().append(E,G[1]);F[C]=F.pop();D.unLink("$parent");delete D.parent}else{if(B){_.arr.each(B._nodes,function(I,H){if(I===D){B._nodes[H]=E;return false}})}}if(D.domNode){E.boxing().renderOnto(D.domNode)}}}});Class(A+".Pane",A+".Div",{Static:{Behaviors:{DropableKeys:["KEY"]}}})};Class("linb.Tips",null,{Constructor:function(){return null},Initialize:function(){var B=linb.DragDrop,A=this;if(B){B.$reset=function(){A._pos={left:B._profile.x,top:B._profile.y}}}linb.CSS.addStyleSheet(".linb-tips{font-size:0;line-height:0;position:absolute;overflow:visible;} .linb-tips-i{font-size:12px;overflow:hidden;}.linb-tips-i span{display:inline;}",this.KEY);linb.doc.afterMousedown(function(){A._cancel()},"$Tips",-1).afterMousemove(function(F,E,G){if(B.isWorking){return }var C=linb.Event,D,H;if((D=_.resetRun.$cache)&&D["$Tips"]){A._pos=C.getPos(E)}if(A._from){_.resetRun("$Tips3",null);A._showF()}else{if(A._showed&&A.MOVABLE){D=C.getPos(E);H=A._Node.style;H.left=(parseInt(H.left)||0)+(D.left-A._pos.left)+"px";H.top=(parseInt(H.top)||0)+(D.top-A._pos.top)+"px";A._pos=D}}},"$Tips",-1).afterMouseover(function(I,M,C){var D=linb.Event,G=D.$FALSE,F=D.getSrc(M),E,L=M.fromElement||M.relatedTarget,K,N,H,J=0,O;if(!F){return G}try{while((!F.id||F.id==linb.$langId)&&F.parentNode!==document&&J++<10){F=F.parentNode}if(!(E=F.id)){return G}}catch(M){}if((K=D._getProfile(E))&&K.box&&K.KEY=="linb.UIProfile"){N=K.onShowTips?E:E.replace(D._reg,"$1$3$4");if(A._markId&&N==A._markId){return G}A._markId=N;A._pos=D.getPos(M);if(A._showed){A._from=K;A._enode=F;A._showF()}else{_.resetRun("$Tips",function(){A._from=K;A._enode=F;_.resetRun("$Tips3",function(){if(A._from){A._showF()}},100)},A.DELAYTIME)}}else{A._cancel()}return G},"$Tips",-1).afterMouseout(function(G,L,C){if(A._markId){var D=linb.Event,E,M,H,K=A._from,I,J=0,F=L.toElement||L.relatedTarget;if(!F){I=1}else{try{while((!F.id||F.id==linb.$langId)&&F.parentNode!==document&&J++<10){F=F.parentNode}if(!(E=F.id)){I=1}}catch(L){I=1}}if(I){A._cancel()}else{M=(K&&K.onShowTips)?E:E.replace(D._reg,"$1$3$4")}return D.$FALSE}},"$Tips",-1);this._Types={"default":new function(){this._r=/(\$)([\w\.]+)/g;this.show=function(N,J,M){if(!J){return }var O=this,E,D,P,L,H;if(!(E=O.node)){E=O.node=linb.create('<div class="linb-tips"><div class="linb-tips-i"></div></div>');D=O._ruler=linb.create('<div class="linb-tips" style="position:absolute;visibility:hidden;left:-10000px;"><div class="linb-tips-i" style="position:relative;"></div></div>');O.n=E.first();O._n=D.first();if(typeof E.addShadow=="function"){E.addShadow();D.addShadow()}linb("body").append(D)}D=O._ruler;if(document.body.lastChild!=E.get(0)){linb("body").append(E)}P=typeof N=="object"?N[M||linb.Tips.TIPSKEY]:N;if(typeof P=="function"){P=P()}if(P+=""){var G=/^\s*\</.test(P);P=P.replace(O._r,function(R,Q,S){return linb.getRes(S)});linb.Tips._curTips=P;if(!N.transTips||!G){P='<div style="border:solid gray 1px;background-color:#FFF8DC;padding:1px 2px 2px 2px;">'+P+"</div>"}O._n.get(0).innerHTML=P;L=D.get(0).offsetWidth;if(!G){L=Math.min(A.MAXWIDTH,L)}var C=E.get(0).style,I=O.n.get(0),F,K=I.style;C.visibility="hidden";I.innerHTML=P;if(linb.browser.ie){C.width=K.width=L+(L%2)+"px";H=I.offsetHeight;C.height=H-(H%2)+"px"}else{K.width=L+"px"}E.popToTop({left:J.left,top:J.top,region:{left:J.left,top:J.top-12,width:24,height:32}},1)}else{E.css("zIndex",0).hide()}};this.hide=function(){this.node.css("zIndex",0).hide()}}}},Static:{TIPSKEY:"tips",MAXWIDTH:300,MOVABLE:true,DELAYTIME:200,AUTOHIDETIME:5000,_showF:function(){var B=this,E=B._from,D=B._enode,H=B._pos,G,F,C,A=false;B._from=B._enode=null;if(!D||!E||!H||!(F=E.box)){return }B._pos=H;A=((C=E.CF)&&(C=C.showTips)&&C(E,D,H));if(!A){A=(F._showTips&&F._showTips(E,D,H))}if(!A&&((C=E)&&C.tips)||(C&&(C=C.properties)&&(C.tips))){B.show(H,C);A=true}if(!A){B.hide()}else{if(!B.MOVABLE){_.resetRun("$Tips2",B.hide,B.AUTOHIDETIME,null,B)}}},getTips:function(){return this._curTips},show:function(E,D,C){var A=this,B;A._pos=E;if(A._item===D){return }if(typeof D=="string"||(D&&(D[C||linb.Tips.TIPSKEY]))){B=A._tpl=A._Types[D.tipsTemplate]||A._Types["default"];B.show(D,E,C);A._Node=B.node.get(0);A._item=D;A._showed=true}else{A._cancel()}},hide:function(){var A=this;if(A._showed){if(A._tpl){A._tpl.hide()}A._clear()}},_cancel:function(){var A=this;if(A._markId){if(A._showed){A.hide()}else{_.resetRun("$Tips",null);_.resetRun("$Tips3",null);A._clear()}}},_clear:function(){var A=this;A._curTips=A._markId=A._from=A._tpl=A._item=A._showed=null}}});Class("linb.UI.Border","linb.UI",{Instance:{_attachTo:function(F,D){var C=this,B=C.get(0);F.append(C);B.$edgeId=linb(F).id();B.$tieId=D;if(B.properties.borderActive){var E=B.behavior.TAG,A="tag",G=B.domNode;if(linb.Dom.byId(D)){linb(D).afterMouseover(function(I,H){_.tryF(E.afterMouseover,[B,H,G],this)},A).afterMouseout(function(I,H){_.tryF(E.afterMouseout,[B,H,G],this)},A).afterMousedown(function(I,H){_.tryF(E.afterMousedown,[B,H,G],this)},A).afterMouseup(function(I,H){_.tryF(E.afterMouseup,[B,H,G],this)},A)}}return F},_detach:function(){var D=this,C=D.get(0),E,B=null,A="tag";if(E=C.$tieId){if(E=linb.Dom.byId(E)){linb(E).afterMouseover(B,A).afterMouseout(B,A).afterMousedown(B,A).afterMouseup(B,A)}}return D}},Initialize:function(){_.each({addBorder:function(B){var C=linb([this.get(0)]),A=arguments[1]||C.id();return new linb.UI.Border(B)._attachTo(C,A)},$getBorder:function(){var B=this.id(),A;_.arr.each(linb.UI.Border._cache,function(C){if(C.$edgeId==B){A=C;return false}});return A&&A.boxing()},removeBorder:function(){var A=this.id();_.arr.each(linb.UI.Border._cache,function(B){if(B.$edgeId==A){B.boxing()._detach().destroy()}});return this}},function(B,A){linb.Dom.plugIn(A,B)});_.each({_border:function(B,A){return this.each(function(F){var E=F.getSubNode("BORDER");if(E.$getBorder()){return }var D=F.properties._borderSize;A=A||{};_.merge(A,{_borderSize:D,_extend:D},"without");F.$border=E.addBorder(A,F.domId);F.clearCache();if(E.$getShadow){var C=E.$getShadow();if(C){C.setShadowOffset(C.getShadowOffset()+D)}}})},_unBorder:function(){return this.each(function(C){var B=C.getSubNode("BORDER");if(!B.$getBorder()){return }B.removeBorder();delete C.$border;if(B.$getShadow){var A=B.$getShadow();if(A){A.setShadowOffset(A.getShadowOffset()-C.properties._borderSize)}}})}},function(B,A){linb.UI.Widget.plugIn(A,B)});linb.UI.Widget.setDataModel({border:{ini:false,action:function(B){var A=this.boxing();if(B){A._border(B)}else{A._unBorder()}}},_borderSize:this.SIZE})},Static:{SIZE:4,Templates:{tagName:"div",TAG:{},T:{style:"width:100%;left:0;top:-{_extend}px;height:{_borderSize}px;"},RT:{style:"top:-{_extend}px;right:-{_extend}px;width:{_borderSize}px;height:{_borderSize}px;"},R:{style:"height:100%;top:0;right:-{_extend}px;width:{_borderSize}px;"},RB:{style:"right:-{_extend}px;bottom:-{_extend}px;width:{_borderSize}px;height:{_borderSize}px;"},B:{style:"width:100%;left:0;bottom:-{_extend}px;height:{_borderSize}px;"},LB:{style:"left:-{_extend}px;bottom:-{_extend}px;width:{_borderSize}px;height:{_borderSize}px;"},L:{style:"height:100%;top:0;left:-{_extend}px;width:{_borderSize}px;"},LT:{style:"top:-{_extend}px;left:-{_extend}px;width:{_borderSize}px;height:{_borderSize}px;"}},Appearances:{KEY:{width:0,height:0,_display:"inline","font-size":0,"line-height":0},"TAG,T, RT, R, RB, B, LB, L, LT":{position:"absolute",display:"block","font-size":0,"line-height":0},T:{background:linb.UI.$bg("v.gif"," repeat-x left top")},B:{background:linb.UI.$bg("v.gif"," repeat-x left bottom")},"KEY-mouseover T, KEY-mouseover B":{$order:1,"background-image":linb.UI.$bg("v_mouseover.gif")},"KEY-checked T, KEY-checked B, KEY-mousedown T, KEY-mousedown B":{$order:2,"background-image":linb.UI.$bg("v_mousedown.gif")},L:{background:linb.UI.$bg("h.gif"," repeat-y left top")},R:{background:linb.UI.$bg("h.gif"," repeat-y right top")},"KEY-mouseover L, KEY-mouseover R":{$order:1,"background-image":linb.UI.$bg("h_mouseover.gif")},"KEY-checked L, KEY-checked R, KEY-mousedown L, KEY-mousedown R":{$order:2,"background-image":linb.UI.$bg("h_mousedown.gif")},LT:{background:linb.UI.$bg("corner.gif"," no-repeat left top")},RT:{background:linb.UI.$bg("corner.gif"," no-repeat right top")},RB:{background:linb.UI.$bg("corner.gif"," no-repeat right bottom")},LB:{background:linb.UI.$bg("corner.gif"," no-repeat left bottom")},"KEY-mouseover LT, KEY-mouseover RT, KEY-mouseover RB, KEY-mouseover LB":{$order:1,"background-image":linb.UI.$bg("corner_mouseover.gif")},"KEY-checked LT, KEY-checked RT, KEY-checked RB, KEY-checked LB, KEY-mousedown LT, KEY-mousedown RT, KEY-mousedown RB, KEY-mousedown LB":{$order:2,"background-image":linb.UI.$bg("corner_mousedown.gif")}},Behaviors:{HoverEffected:{TAG:"KEY"},ClickEffected:{TAG:"KEY"}},DataModel:{_borderSize:4,_extend:4,borderActive:false}}});Class("linb.UI.Shadow","linb.UI",{Instance:{_attachTo:function(B){B=B.reBoxing();var A=this;A.get(0)._target=B.get(0);B.append(A);return B}},Initialize:function(){_.each({addShadow:function(A){return new linb.UI.Shadow(A)._attachTo(linb([this.get(0)],false))},$getShadow:function(){var B=this.get(0),A;_.arr.each(linb.UI.Shadow._cache,function(C){if(C._target==B){A=C;return false}});return A&&A.boxing()},removeShadow:function(){var A=this.get();_.arr.each(linb.UI.Shadow._cache,function(B){if(_.arr.indexOf(A,linb(B._target).get(0))!=-1){B.boxing().destroy()}});return this}},function(B,A){linb.Dom.plugIn(A,B)});_.each({_shadow:function(A){return this.each(function(E){var C=E.getSubNode("BORDER");if(C.$getShadow()){return }var D=E.properties,B=C.$getBorder();E.$shadow=C.addShadow({shadowSize:D._shadowSize,shadowOffset:B?D._borderSize:D.$border})})},_unShadow:function(){return this.each(function(B){var A=B.getSubNode("BORDER");if(!A.$getShadow()){return }A.removeShadow();delete B.$shadow})}},function(B,A){linb.UI.Widget.plugIn(A,B)});linb.UI.Widget.setDataModel({shadow:{ini:false,action:function(B){var A=this.boxing();if(B){A._shadow(B)}else{A._unShadow()}}},_shadowSize:this.SIZE})},Static:{SIZE:8,Templates:{tagName:"div",R:{tagName:"div",style:"top:{shadowOffset}px;width:{shadowSize}px;right:-{pos}px;"},RB:{tagName:"div",style:"height:{shadowSize}px;width:{shadowSize}px;right:-{rbpos}px;bottom:-{rbpos}px;"},B:{tagName:"div",style:"left:{shadowOffset}px;height:{shadowSize}px;bottom:-{pos}px;"}},Appearances:{KEY:{width:0,height:0,_display:"inline","_font-size":0,"_line-height":0},"B, RB, R":{position:"absolute",display:"block","*font-size":0,"*line-height":0},B:{left:0,width:"100%",background:linb.browser.ie6?"":linb.UI.$bg("B.png","repeat-x left bottom"),_filter:linb.UI.$ieBg("B.png")},RB:{background:linb.browser.ie6?"":linb.UI.$bg("RB.png","left top"),_filter:linb.UI.$ieBg("RB.png")},R:{top:0,height:"100%",background:linb.browser.ie6?"":linb.UI.$bg("R.png","repeat-y right top"),_filter:linb.UI.$ieBg("R.png")}},DataModel:{shadowSize:{ini:8,action:function(C){var B=this,A=B.properties.shadowOffset;B.getSubNode("R").cssRegion({width:C,top:A,right:-C-A});B.getSubNode("RB").cssRegion({width:C,height:C,right:-C-A+1,bottom:-C-A+1});B.getSubNode("B").cssRegion({height:C,left:A,bottom:-C-A})}},shadowOffset:{ini:0,action:function(A){this.boxing().setShadowSize(this.properties.shadowSize,true)}}},_prepareData:function(B){var A=arguments.callee.upper.call(this,B);A.pos=(parseInt(A.shadowSize)||0)+(parseInt(A.shadowOffset)||0);A.rbpos=A.pos-1;return A},LayoutTrigger:function(){if(linb.browser.ie){this.root.ieRemedy()}}}});Class("linb.UI.Resizer","linb.UI",{Instance:{_attachTo:function(D,C){var B=this,A=B.get(0);A._target=linb(D);A._parent=C||linb("body");A._parent.append(B);A.$resizeId=linb(D).id();return B},show:function(){var A=this;A.each(function(B){B.root.css("display",B.$display||"block")});if(linb.browser.ie){A.reBoxing().ieRemedy()}return A},hide:function(){var A=this;A.each(function(B){B.$display=B.root.css("display")});A.reBoxing().css("display","none");return A}},Initialize:function(){this.addTemplateKeys(["HANDLER","HIDDEN","MOVE","L","R","T","B","LT","RB","LB","RB"]);_.each({addResizer:function(B,A){var D=linb([this.get(0)]);B=B||{};_.merge(B,{_attached:true});var C=new linb.UI.Resizer(B)._attachTo(D,D);if(A){C.onUpdate(A)}return C},removeResizer:function(){var A=this.id();_.arr.each(linb.UI.Resizer._cache,function(B){if(B.$resizeId==A){B.boxing().destroy()}});return this},$getResizer:function(){var B=this.id(),A;_.arr.each(linb.UI.Resizer._cache,function(C){if(C.$resizeId==B){A=C;return false}});return A&&A.boxing()}},function(B,A){linb.Dom.plugIn(A,B)});_.each({_resize:function(B,A){return this.each(function(E){var C=E.getSubNode("BORDER"),D=E.properties;if(C.$getResizer()){return }A=A||{};var F=function(N,L,P,H){var J=arguments.callee.profile,I=J.root,G=J.properties,O;if(P){var M=null,K=null;if(O=P.width){I.widthBy(O);G.width=M=I.width()}if(O=P.height){I.heightBy(O);G.height=K=I.height()}linb.UI.$tryResize(J,M,K)}if(H){if((O=H.left)&&!(G.left=="auto"&&parseInt(G.right)>=0)){I.leftBy(O);G.left=I.left()}if((O=H.top)&&!(G.top=="auto"&&parseInt(G.bottom)>=0)){I.topBy(O);G.top=I.top()}}};F.profile=E;E.$resizer=C.addResizer(A,F)})},_unResize:function(){return this.each(function(B){var A=B.getSubNode("BORDER");if(!A.$getResizer()){return }A.removeResizer();delete B.$resizer})}},function(B,A){linb.UI.Widget.plugIn(A,B)});linb.UI.Widget.setDataModel({resizer:{ini:false,action:function(C){var B=this.boxing();if(C){var D=this.properties,A={};_.each("minHeight,minWidth,maxHeight,maxWidth".split(","),function(E){if(E in D){A[E]=D[E]}});B._resize(C,A)}else{B._unResize()}}}})},Static:{Templates:{tagName:"div",style:"{_style};"},Appearances:{KEY:{position:"absolute",margin:"0 -1px -1px 0",visibility:"visible","_font-size":0,"_line-height":0,"*background":"url("+linb.ini.path+"bg.gif)","z-index":60,cursor:"move"},MOVE:{position:"absolute",display:"block","z-index":100,visibility:"visible",background:linb.UI.$bg("icon.gif"," no-repeat -17px top",true),"_font-size":0,"_line-height":0},HANDLER:{$order:0,position:"absolute",display:"block",border:"solid 1px","background-color":"#fff","z-index":100,visibility:"visible","_font-size":0,"_line-height":0},T:{$order:1,left:"50%",cursor:"n-resize"},RT:{$order:1,cursor:"ne-resize","z-index":110},R:{$order:1,top:"50%",cursor:"e-resize"},RB:{$order:1,cursor:"se-resize","z-index":110},B:{$order:1,left:"50%",cursor:"s-resize"},LB:{$order:1,cursor:"sw-resize","z-index":110},L:{$order:1,top:"50%",cursor:"w-resize"},LT:{$order:1,cursor:"nw-resize","z-index":110},HIDDEN:{$order:10,"background-color":"transparent","border-width":0}},Behaviors:{onMousedown:function(A,B,C){A.box._onMousedown(A,B,C,{move:true})},onDragbegin:function(A,B,C){A.box._onDragbegin(A,B,C)},onDrag:function(A,B,C){A.box._onDrag(A,B,C,{move:true})},onDragstop:function(A,B,C){A.box._onDragstop(A,B,C,{move:true})},LT:{onMousedown:function(A,B,C){A.box._onMousedown(A,B,C,{left:true,top:true})},onDragbegin:function(A,B,C){A.box._onDragbegin(A,B,C)},onDrag:function(A,B,C){A.box._onDrag(A,B,C,{left:true,top:true})},onDragstop:function(A,B,C){A.box._onDragstop(A,B,C,{left:true,top:true})}},RT:{onMousedown:function(A,B,C){A.box._onMousedown(A,B,C,{right:true,top:true})},onDragbegin:function(A,B,C){A.box._onDragbegin(A,B,C)},onDrag:function(A,B,C){A.box._onDrag(A,B,C,{right:true,top:true})},onDragstop:function(A,B,C){A.box._onDragstop(A,B,C,{right:true,top:true})}},LB:{onMousedown:function(A,B,C){A.box._onMousedown(A,B,C,{left:true,bottom:true})},onDragbegin:function(A,B,C){A.box._onDragbegin(A,B,C)},onDrag:function(A,B,C){A.box._onDrag(A,B,C,{left:true,bottom:true})},onDragstop:function(A,B,C){A.box._onDragstop(A,B,C,{left:true,bottom:true})}},RB:{onMousedown:function(A,B,C){A.box._onMousedown(A,B,C,{right:true,bottom:true})},onDragbegin:function(A,B,C){A.box._onDragbegin(A,B,C)},onDrag:function(A,B,C){A.box._onDrag(A,B,C,{right:true,bottom:true})},onDragstop:function(A,B,C){A.box._onDragstop(A,B,C,{right:true,bottom:true})}},L:{onMousedown:function(A,B,C){A.box._onMousedown(A,B,C,{left:true})},onDragbegin:function(A,B,C){A.box._onDragbegin(A,B,C)},onDrag:function(A,B,C){A.box._onDrag(A,B,C,{left:true})},onDragstop:function(A,B,C){A.box._onDragstop(A,B,C,{left:true})}},T:{onMousedown:function(A,B,C){A.box._onMousedown(A,B,C,{top:true})},onDragbegin:function(A,B,C){A.box._onDragbegin(A,B,C)},onDrag:function(A,B,C){A.box._onDrag(A,B,C,{top:true})},onDragstop:function(A,B,C){A.box._onDragstop(A,B,C,{top:true})}},R:{onMousedown:function(A,B,C){A.box._onMousedown(A,B,C,{right:true})},onDragbegin:function(A,B,C){A.box._onDragbegin(A,B,C)},onDrag:function(A,B,C){A.box._onDrag(A,B,C,{right:true})},onDragstop:function(A,B,C){A.box._onDragstop(A,B,C,{right:true})}},B:{onMousedown:function(A,B,C){A.box._onMousedown(A,B,C,{bottom:true})},onDragbegin:function(A,B,C){A.box._onDragbegin(A,B,C)},onDrag:function(A,B,C){A.box._onDrag(A,B,C,{bottom:true})},onDragstop:function(A,B,C){A.box._onDragstop(A,B,C,{bottom:true})}}},DataModel:{_attached:false,forceVisible:false,forceMovable:false,singleDir:false,vertical:true,horizontal:true,minHeight:12,minWidth:12,maxHeight:5000,maxWidth:5000,handlerSize:4,handlerOffset:0,left:100,top:100,height:100,width:100,position:"absolute",display:"block"},EventHandlers:{onUpdate:function(C,D,B,A){}},_dynamicTemplate:function(C){var F=C.properties,J,E,H,D=C._exhash="$_attached:"+F._attached+";forceVisible:"+F.forceVisible+";singleDir:"+F.singleDir+";vertical:"+F.vertical+";horizontal:"+F.horizontal+";forceMovable:"+F.forceMovable+";";var A=arguments.callee.map||(arguments.callee.map={MOVE:{tagName:"div",style:"top:50%;left:50%;margin-left:-6px;margin-top:-6px;width:13px;height:13px;"},T:{tagName:"div",style:"top:-{extend}px;margin-left:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},RT:{tagName:"div",style:"top:-{extend}px;right:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},R:{tagName:"div",style:"right:-{extend}px;margin-top:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},RB:{tagName:"div",style:"bottom:-{extend}px;right:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},B:{tagName:"div",style:"bottom:-{extend}px;margin-left:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},LB:{tagName:"div",style:"bottom:-{extend}px;left:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},L:{tagName:"div",style:"left:-{extend}px;margin-top:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},LT:{tagName:"div",style:"left:-{extend}px;top:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},cover:{T:{tagName:"div",style:"width:100%;left:0;top:-{extend}px;height:{handlerSize}px;"},RT:{tagName:"div",style:"top:-{extend}px;right:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},R:{tagName:"div",style:"height:100%;top:0;right:-{extend}px;width:{handlerSize}px;"},RB:{tagName:"div",style:"right:-{extend}px;bottom:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},B:{tagName:"div",style:"width:100%;left:0;bottom:-{extend}px;height:{handlerSize}px;"},LB:{tagName:"div",style:"left:-{extend}px;bottom:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},L:{tagName:"div",style:"height:100%;top:0;left:-{extend}px;width:{handlerSize}px;"},LT:{tagName:"div",style:"top:-{extend}px;left:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"}}});var G=C.box.getTemplate(D);if(!G){var I,B;G=_.clone(C.box.getTemplate());I=F._cover?A.cover:A;if(F._move){G.MOVE=A.MOVE}if(F.vertical){if(!F.singleDir){G.T=I.T}G.B=I.B}if(F.horizontal){if(!F.singleDir){G.L=I.L}G.R=I.R;if(F.vertical){if(!F.singleDir){G.LB=I.LB;G.RT=I.RT;G.LT=I.LT}G.RB=I.RB}}B=C.getClass("KEY","-handler")+" ";if(I=G.T){I.className=B}if(I=G.RT){I.className=B}if(I=G.R){I.className=B}if(I=G.RB){I.className=B}if(I=G.B){I.className=B}if(I=G.LB){I.className=B}if(I=G.L){I.className=B}if(I=G.LT){I.className=B}if(!F._visible){B=C.getClass("KEY","-hidden")+" ";if(I=G.T){I.className+=B}if(I=G.RT){I.className+=B}if(I=G.R){I.className+=B}if(I=G.RB){I.className+=B}if(I=G.B){I.className+=B}if(I=G.LB){I.className+=B}if(I=G.L){I.className+=B}if(I=G.LT){I.className+=B}}C.box.setTemplate(G,D)}C.template=G},_prepareData:function(B){var A=B.properties;A._visible=true;A._cover=false;A._move=true;if(A._attached){A._visible=false;A._cover=true;A._move=false;A.position="static";A.display="inline";A.left=A.top=A.width=A.height=0}if(A.forceVisible){A._visible=true;A._cover=false}if(A.forceMovable){A._move=true}A.extend=(parseInt(A.handlerSize)||0)/2+(parseInt(A.handlerOffset)||0);return arguments.callee.upper.call(this,B)},RenderTrigger:function(){var A=this;A.domNode.zIndexIgnore=true;if(!A.onUpdate){A.onUpdate=A.constructor.onUpdate}},onUpdate:function(D,E,C,A){if(E){if(C){E.widthBy(C.width,true).heightBy(C.height,true)}if(A){var B=E.get(0).style;if(B.left=="auto"&&(parseInt(B.right)>=0)){}else{E.leftBy(A.left)}if(B.top=="auto"&&(parseInt(B.bottom)>=0)){}else{E.topBy(A.top)}}}},_onMousedown:function(B,C,D,A){var E=linb.Event.getPos(C);linb([D]).startDrag(C,{dragDefer:1,targetReposition:false,dragType:"blank",dragCursor:true,targetLeft:E.left,targetTop:E.top})},_onDragbegin:function(C,D){if(C.properties._attached){var E=C._target,F=E.offset(),A=E.offsetWidth(),B=E.offsetHeight();C.proxy=linb.Dom.getEmptyDiv();C.proxy.html(" ",false).css({border:"1px dashed",visibility:"visible"}).offset(F).offsetWidth(A).offsetHeight(B).css("zIndex",linb.Dom.TOP_ZINDEX+20)}else{var E=linb([C.domNode]);C.proxy=E}C.o_pos=C.proxy.cssPos();C.o_w2=C.o_w=E.width();C.o_h2=C.o_h=E.height();C.$onDrag=true},_onDrag:function(D,G,B,L){var C=L;D.oos=D.oos||{};var E=linb.DragDrop.getProfile().offset;if(E.x==D.oos.width&&E.y==D.oos.height){return }D.oos=E;var J,I,K,F,M=D.properties;if(C.left){K=D.o_w-E.x;J=D.o_pos.left+E.x;if(K<M.minWidth){K=M.minWidth;J=D.o_w+D.o_pos.left-K}else{if(K>M.maxWidth){K=M.maxWidth;J=D.o_w+D.o_pos.left-K}}D.proxy.width(K).left(J)}else{if(C.right){K=D.o_w+E.x;if(K<M.minWidth){K=M.minWidth}else{if(K>M.maxWidth){K=M.maxWidth}}D.proxy.width(K)}}if(C.left||C.right){var A=K-D.o_w2;if(D.regions&&A!==0){D.regions.widthBy(A);D.o_w2=K}}if(C.top){F=D.o_h-E.y;I=D.o_pos.top+E.y;if(F<M.minHeight){F=M.minHeight;I=D.o_h+D.o_pos.top-F}else{if(F>M.maxHeight){F=M.maxHeight;I=D.o_h+D.o_pos.top-F}}D.proxy.height(F).top(I)}else{if(C.bottom){F=D.o_h+E.y;if(F<M.minHeight){F=M.minHeight}else{if(F>M.maxHeight){F=M.maxHeight}}D.proxy.height(F)}}if(C.top||C.bottom){var H=F-D.o_h2;if(D.regions&&H!==0){D.regions.heightBy(H);D.o_h2=F}}if(C.move){J=D.o_pos.left+E.x;I=D.o_pos.top+E.y;D.proxy.top(I).left(J)}},_onDragstop:function(D,E,G,B){var A,C,H,F=D.proxy;if(!B.move){C={width:F.width()-D.o_w,height:F.height()-D.o_h}}if(B.left||B.top||B.move){A=F.cssPos();H={left:A.left-D.o_pos.left,top:A.top-D.o_pos.top}}D.boxing().onUpdate(D,D._target,C,H);if(D.properties._attached){if(linb.browser.ie6){D._target.ieRemedy()}D.proxy.html("",false).css({visibility:"hidden",zIndex:"0",width:"0",height:"0"})}D.$onDrag=false}}});Class("linb.UI.Button",["linb.UI.Widget","linb.absValue"],{Instance:{_border:function(B,A){A=A||{};A.borderActive=true;return arguments.callee.upper.call(this,B,A)},activate:function(){var A=this.get(0);A.getSubNode("FOCUS").focus();return this},_setCtrlValue:function(A){if(_.isNull(A)||!_.exists(A)){A=false}return this.each(function(D){var C=D.properties;if(C.type!="status"){return }D.getSubNode("BORDER").tagClass("-checked",A);if(C.border){var B=D.getSubNode("BORDER").$getBorder();if(B){B.get(0).root.tagClass("-checked",A)}}})}},Initialize:function(){this.addTemplateKeys(["DROP","CUSTOM"]);var A=this.getTemplate();_.merge(A.FRAME.BORDER,{FOCUS:{tagName:"a",href:"{href}",tabindex:"{tabindex}",TB:{cellpadding:"0",cellspacing:"0",width:"100%",height:"100%",border:"0",tagName:"table",TR:{tagName:"tr",TDL:{tagName:"td"},TD:{$order:1,align:"{hAlign}",valign:"{vAlign}",tagName:"td",width:"100%",height:"100%",BOX:{ICON:{$order:1,className:"ui-icon",style:"background:url({image}) transparent no-repeat  {imagePos};{iconDisplay}"},CAPTION:{$order:2,text:"{caption}"}}},TDR:{$order:2,tagName:"td",className:"{dropCls}",TDRI:{}}}}}},"all");A.className="{customCls}";this.setTemplate(A)},Static:{Appearances:{KEY:{"font-size":"12px","line-height":"12px"},CUSTOM:{background:"transparent"},"CUSTOM BOX":{"white-space":"normal"},"CUSTOM td":{$order:20,background:"none"},"CUSTOM BORDER":{"background-color":"#FBFBFB"},BORDER:{"font-size":0,"line-height":0},TDL:{background:linb.UI.$bg("button.gif"," no-repeat left top",true),"padding-left":"3px"},TD:{background:linb.UI.$bg("button.gif"," repeat-x left -25px",true)},TDR:{background:linb.UI.$bg("button.gif"," no-repeat right -50px",true),"padding-left":"3px"},DROP:{$order:10,background:linb.UI.$bg("button.gif"," no-repeat right -225px",true),"padding-left":"16px"},"BORDER-mouseover DROP":{$order:11,"background-position":"right -250px"},"BORDER-mouseover DROP-mousedown":{$order:12,"background-position":"right -275px"},"BORDER-mouseover TDL":{$order:1,"background-position":"left -75px"},"BORDER-mouseover TD":{$order:1,"background-position":"left -100px"},"BORDER-mouseover TDR":{$order:1,"background-position":"right -125px"},"BORDER-mousedown TDL, BORDER-checked TDL":{$order:2,"background-position":"left -150px"},"BORDER-mousedown TD, BORDER-checked TD":{$order:2,"background-position":"left -175px"},"BORDER-mousedown TDR, BORDER-checked TDR":{$order:2,"background-position":"right -200px"},FOCUS:{overflow:"hidden",display:"block",position:"absolute",left:0,top:0,"z-index":"20",width:"100%",height:"100%","-moz-outline-offset":"-1px !important"},BOX:{display:"inline","white-space":"nowrap"},CAPTION:{cursor:"pointer","vertical-align":"middle",display:"inline","font-size":"12px","line-height":"14px"}},Behaviors:{HoverEffected:{KEY:["BORDER"]},ClickEffected:{KEY:["BORDER"]},NavKeys:{FOCUS:1},onClick:function(B,D,E){var C=B.properties;if(C.disabled){return false}B.getSubNode("FOCUS").focus();var A=B.boxing();if(C.type=="status"){A.setUIValue(!C.$UIvalue);if(B.onChecked){A.onChecked(B,D,C.$UIvalue)}}if(B.onClick){A.onClick(B,D,E,C.$UIvalue)}},TDR:{onMousedown:function(A){if(A.properties.type!="drop"){return }linb([this]).addClass(A.getClass("DROP","-mousedown"));return false},onMouseup:function(A){if(A.properties.type!="drop"){return }linb([this]).removeClass(A.getClass("DROP","-mousedown"));return false},onClick:function(A,B,C){if(A.properties.type!="drop"){return }A.boxing().onClickDrop(A,B,C);return false}}},DataModel:{caption:{ini:undefined,action:function(A){this.getSubNode("CAPTION").get(0).innerHTML=A}},image:{action:function(A){this.getSubNode("ICON").css("display",A?"":"none").css("backgroundImage","url("+(A||"")+")")}},imagePos:{action:function(A){this.getSubNode("ICON").css("backgroundPosition",A)}},hAlign:{ini:"center",listbox:["left","center","right"],action:function(B){var A=this,D=A.getSubNode("TD"),C=A.properties;D.attr("align",B)}},vAlign:{ini:"middle",listbox:["top","middle","bottom"],action:function(B){var A=this,D=A.getSubNode("TD"),C=A.properties;D.attr("valign",B)}},tabindex:{action:function(A){this.getSubNode("FOCUS").attr("tabIndex",A)}},href:linb.$href,value:false,type:{ini:"normal",listbox:["normal","status","drop","custom"],action:function(F){var C=this,A=C.getRoot(),D=C.getSubNode("TDR"),B=C.getClass("DROP"),E=C.getClass("CUSTOM");if(F=="drop"){D.addClass(B)}else{D.removeClass(B)}if(F=="custom"){A.addClass(E)}else{A.removeClass(E)}C.box._onresize(C)}},width:120,height:22,$border:0},_ensureValue:function(A,B){return !!B},_prepareData:function(A){var B=arguments.callee.upper.call(this,A);B.customCls=B.type=="custom"?A.getClass("CUSTOM"):"";B.dropCls=B.type=="drop"?A.getClass("DROP"):"";return B},RenderTrigger:function(){var A=this,B=A.properties,C=A.boxing();if(B.type=="status"&&B.value){C.setValue(true,true)}},EventHandlers:{onClick:function(A,C,D,B){},onClickDrop:function(A,B,C){},onChecked:function(A,C,B){}},_onresize:function(C,B,A){if(C.properties.type!="custom"){C.domNode.style.height=(C.properties.height=A=22)+"px"}arguments.callee.upper.apply(this,[C,B,A])}}});Class("linb.UI.Block","linb.UI.Widget",{Initialize:function(){var A=this,B=A.getTemplate();_.merge(B.FRAME.BORDER,{className:"uiw-border uibg-bar {clsBorderType1}",PANEL:{tagName:"div",className:"{clsBorderType2}",style:"{background}",text:"{html}"+linb.UI.$childTag}},"all");A.setTemplate(B);B=A.getAppearance();_.merge(B,{PANEL:{position:"relative",overflow:"auto"}});A.setAppearance(B)},Static:{Behaviors:{DropableKeys:["PANEL"]},DataModel:{disabled:null,tips:null,html:{action:function(A){this.getSubNode("PANEL").html(A)}},borderType:{ini:"outset",listbox:["none","inset","outset","groove","ridge"],action:function(I){var G=this,A=G.properties,F=G.getSubNode("BORDER"),D=G.getSubNode("PANEL"),C=/^uiborder-/,E="uiborder-inset",B="uiborder-outset",H=G.root;F.removeClass(C);D.removeClass(C);switch(I){case"inset":F.addClass(E);break;case"outset":F.addClass(B);break;case"groove":F.addClass(E);D.addClass(B);break;case"ridge":F.addClass(B);D.addClass(E);break}G.box._setB(G);linb.UI.$tryResize(G,H.width(),H.height())}},background:{ini:"",action:function(A){this.getSubNode("PANEL").css("background",A)}},width:100,height:100},_setB:function(B){var C=B.properties,A=C.borderType;C.$border=C.$iborder=0;if(A=="inset"||A=="outset"){C.$border=1;C.$iborder=0}else{if(A=="groove"||A=="ridge"){C.$border=C.$iborder=1}}},LayoutTrigger:function(){var A=this.properties.borderType;if(A!="none"){this.boxing().setBorderType(A,true)}},_prepareData:function(A){var B=arguments.callee.upper.call(this,A);B.background=B.background?"background:"+B.background:"";return B},_onresize:function(E,D,B){var C=arguments.callee.upper.apply(this,arguments),F=E.properties,A=(F.$iborder||0)*2;if(C.width){C.width-=A}if(C.height){C.height-=A}E.getSubNode("PANEL").cssSize(C,true)}}});Class("linb.UI.PopMenu",["linb.UI.Widget","linb.absList"],{Instance:{_adjustSize:function(){this.each(function(A){var F=A.root,E=A.getSubNode("ITEMS"),B=A.getSubNode("BORDER"),J=F.cssSize(),H=B.cssSize(),I=A.properties,C=Math.min(I._maxHeight,E.height()+J.height-H.height+1),G=Math.min(I._maxWidth,E.width()+J.width-H.width+1);I.width=G;I.height=C;F.cssSize({width:G,height:C});linb.UI.$tryResize(A,G,C,null,true);if(I.shadow){A.$noS=true;var D=A.boxing();if(D._shadow){D._shadow(true)}}});return this._setScroll()},_setScroll:function(){return this.each(function(E){var F=E.getSubNode("ITEMS"),C=F.offsetTop(),D=F.offsetHeight(),A=E.getSubNode("BORDER"),B=A.offsetHeight();E.getSubNode("TOP").css("display",C===0?"none":"block");E.getSubNode("BOTTOM").css("display",(B>D+C)?"none":"block")})},_scrollToBottom:function(){return this.each(function(E){var G=E.getSubNode("ITEMS"),C=E.getSubNode("BORDER"),H=G.offsetTop(),F,D=G.offsetHeight(),A=false,B=C.height();if(B<D+H){if(!E.$scrollStep){E.$scrollStep=1}if(E.$scrollStep<30){E.$scrollStep=E.$scrollStep*1.1}H-=E.$scrollStep;if(B>D+H){H=B-D;A=true}G.top(H);if(A){E.getSubNode("BOTTOM").css("display","none");E.$scrollTobottom=false;E.$scrollStep=null}else{E.getSubNode("TOP").css("display","block");if(E.$scrollTobottom){_.asyRun(arguments.callee,0,[E],this)}}}})},_scrollToTop:function(){return this.each(function(B){var C=B.getSubNode("ITEMS"),D=C.offsetTop(),A=false;if(D<0){if(!B.$scrollStep){B.$scrollStep=1}if(B.$scrollStep<10){B.$scrollStep=B.$scrollStep*1.03}D+=B.$scrollStep;if(D>=-1){D=0;A=true}C.top(D);if(A){B.getSubNode("TOP").css("display","none");B.$scrollToTop=false;B.$scrollStep=null}else{B.getSubNode("BOTTOM").css("display","block");if(B.$scrollToTop){_.asyRun(arguments.callee,0,[B],this)}}}})},pop:function(F,D,C){var B=this.get(0);if(!B.rendered){var G=B.boxing().render(true);linb.Dom.getEmptyDiv().append(G)}var A=B.root;if(B.$highLight){linb([B.$highLight]).tagClass("-mouseover",false)}B._conainer=C;A.popToTop(F,D,C);var E=function(){var H=arguments.callee.profile;H.boxing().hide();H.$popGrp.length=0};E.profile=B;if(!B.$popGrp||!B.$popGrp.length){B.$popGrp=[A.get(0)];A.setBlurTrigger(B.$id,null);A.setBlurTrigger(B.$id,E,B.$popGrp)}return this},hide:function(H){var C,E=this.get(0),B=E.root,D="$subPopMenuShowed",A="$childPopMenu";if(false!==H){if(false===E.boxing().beforeHide(E)){return this}}if(!B||B.css("display")=="none"){return }B.setBlurTrigger(E.$id,null);if(E.$hideMenuPool){E.$hideMenuPool.append(B)}else{B.css("display","none")}var G=E[A],F;if(C=E[D]){C.hide()}while(G){G.boxing().hide();G=(F=G)[A];F[A]=F[D]=null}E[A]=E[D]=null;if(C=E.$parentPopMenu){C[D]=null}_.arr.removeValue(E.$popGrp,B.get(0));if(false!==H){E.boxing().onHide(E)}return this}},Initialize:function(){var A=this.getTemplate();_.merge(A.FRAME.BORDER,{TOP:{},BOTTOM:{},BOX:{tagName:"div",ITEMS:{tagName:"div",className:"{itemClass}",style:"{itemStyle}",text:"{items}"}},POOL:{tagName:"div",style:"display:none;"}},"all");A.$dynamic={items:function(G,F,D,C,B){var E;C=C+"."+D.type;if(E=D.object){B[B.length]=E.build(D)}else{if(F[C]){linb.UI.$doTemplate(G,F,D,C,B)}}},"items.split":{ITEMSPLIT:{tagName:"a"}},"items.button":{ITEM:{tagName:"a",href:linb.$href,tabindex:1,className:"{cls} {disabled}",ICON:{style:"background:url({image}) transparent  no-repeat {imagePos};",className:"ui-icon",$order:0},CAPTION:{text:"{caption}",$order:1},RULER:{style:"{displayAdd}",$order:2},ADD:{tagName:"div",style:"{displayAdd}",text:"{add}",$order:2},SUB:{style:"{tagClass}"}}},"items.checkbox":{ITEM:{tagName:"a",href:linb.$href,tabindex:1,className:"{cls}",CHECKBOX:{$order:0,className:"ui-icon {checkboxCls}"},CAPTION:{text:"{caption}",$order:1},RULER:{style:"{displayAdd}",$order:2},ADD:{tagName:"div",style:"{displayAdd}",text:"{add}",$order:2}}}};this.setTemplate(A)},Static:{$noDomRoot:true,Appearances:{KEY:{"font-size":"12px",visibility:"hidden"},BORDER:{border:"1px solid","border-color":"#FFF #ACA899 #ACA899 #FFF"},BOX:{"background-color":"#EBEADB",overflow:"hidden",position:"absolute",left:0,top:0,"font-size":"12px","z-index":"3"},ITEMS:{position:"absolute",top:0,left:0,overflow:"visible",background:linb.UI.$bg("bg.gif"," repeat-y left top")},ITEM:{display:"block",position:"relative",overflow:"visible","white-space":"nowrap",color:"#000","font-family":'"Verdana", "Helvetica", "sans-serif"',cursor:"pointer",padding:"2px 20px 2px 2px"},ITEMSPLIT:{display:"block",position:"relative",overflow:"visible","white-space":"nowrap","font-size":"1px","line-height":"1px",padding:"1px",margin:"2px 2px 2px 26px",background:linb.UI.$bg("hsplit.gif"," repeat-x left top",true)},"ITEM-mouseover":{$order:1,"background-color":"#B6BDD2"},"ITEM-checked":{$order:2,"background-color":"#B6BDD2"},CHECKBOX:{background:linb.UI.$bg("cmds.gif"," no-repeat -112px 1px",true),margin:0},ICON:{margin:0},"CHECKBOX-checked":{$order:1,background:linb.UI.$bg("cmds.gif"," no-repeat -96px 1px",true)},TOP:{cursor:"pointer",display:"none",position:"absolute","margin-left":"-8px",right:0,height:"16px",width:"16px","z-index":"10",top:0,background:linb.UI.$bg("icon.gif"," no-repeat -33px 0",true)},BOTTOM:{cursor:"pointer",display:"none",position:"absolute","margin-left":"-8px",right:0,height:"16px",width:"16px","z-index":"10",bottom:0,background:linb.UI.$bg("icon.gif"," no-repeat -33px -17px",true)},"CHECKBOX, CHECKBOX-checked":{cursor:"pointer","vertical-align":"middle",width:"16px",height:"16px"},CAPTION:{"vertical-align":"middle","padding-left":"6px"},RULER:{width:"100px","font-size":0,"line-height":0},ADD:{position:"absolute",top:"3px",right:0,width:"80px","padding-right":"20px","text-align":"right","z-index":"10"},SUB:{position:"absolute",top:"4px",right:0,width:"8px",height:"16px",background:linb.UI.$bg("icon.gif"," no-repeat left -16px",true)}},Behaviors:{ITEM:{onMouseover:function(F,H,B){var D="$subPopMenuShowed",L="$allPops",E="$highLight",K="$showpops",G="$popGrp";if(F[E]==B){return }var I=F.properties,P=F.getItemByDom(B),J=P.id,O=false,M,C,N;if(N=F[D]){if(N==_.get(F,[L,J])){O=true}else{N.hide();F[D]=null}}if(!O){if(N=F[E]){linb([N]).tagClass("-mouseover",false)}F[E]=B;linb([B]).tagClass("-mouseover");try{B.focus()}catch(H){}}if(!O&&P.sub){if(P.sub.constructor==Array&&P.sub.length){F[L]=F[L]||{};if(!(M=F[L][J])){M=(new linb.UI.PopMenu({position:"absolute",items:P.sub,autoHide:F.properties.autoHide})).render(true);M.onMenuSelected(function(S,Q,R){F.boxing().onMenuSelected(F,Q,R)});C=M.get(0);C.$hideMenuPool=F.$hideMenuPool||F.getSubNode("POOL");F[L][J]=M;F[K]=F[K]||[F];C[K]=F[K];F[K].push(C)}else{C=M.get(0)}F[G].push(C.root.get(0));C[G]=F[G];C.$parentPopMenu=F;F.$childPopMenu=C;M.pop(B,2);F[D]=M}else{if(F.onShowSubMenu){var A=F["$sub:"+P.id];if(A&&A["linb.UI"]&&!A.isEmpty()){}else{A=F.boxing().onShowSubMenu(F,P,B)}if(A&&A["linb.UI"]&&!A.isEmpty()){F[D]=A;A=A.reBoxing();A.onMouseout(function(R,Q,S){F.box._mouseout(F,Q,S)},null,-1);F[G].push(A.get(0));A.popToTop(B,2,F._conainer)}}}}},onMouseout:function(C,F,A){var G=C.properties,J=C.getItemByDom(A),H=J.id,D=true,K;if(K=C.$subPopMenuShowed){var B=F.toElement||F.relatedTarget,E=K.get(0).root.get(0);try{do{if(B==E){return }}while((B&&(B=B.parentNode)))}catch(I){}}linb([A]).tagClass("-mouseover",false);C.$highLight=null},onClick:function(A,C,E){var F=A.properties,B=A.getItemByDom(E),D=B.id;if(F.disabled||B.disabled){return false}if(!B.sub){if(B.type=="checkbox"){A.getSubNodeByItemId("CHECKBOX",B.id).tagClass("-checked",B.value=!B.value)}if(A.onMenuSelected){A.boxing().onMenuSelected(A,B,E)}if(F.hideAfterClick){linb([E]).tagClass("-mouseover",false);_.asyRun(function(){var H=A,G;while(H){H.boxing().hide();H=(G=H).$parentPopMenu;G.$parentPopMenu=G.$subPopMenuShowed=null}A.$subPopMenuShowed=null;A.$popGrp.length=0},100)}}return false},onFocus:function(B,E,F){var C=B.getSubNode("BOX"),D=C.scrollTop(),A=C.scrollHeight(),G=linb([F]).offsetTop();if(G<D||G>D+A){linb(F).offsetTop(D)}linb(F).onMouseover()},onKeydown:function(D,F,B){var L=D.getItemByDom(B),G=D.properties.items,J=linb.Event.getKey(F)[0],I=L.id,H,A,E,C,K;switch(J){case"up":A=true;H=false;_.arr.each(G,function(N,M){if(N.type=="split"){return }if(H){E=N.id;return A=false}if(N.id==I){H=true}},null,true);if(A){E=G[G.length-1].id}C=D.getSubNodeByItemId("ITEM",E).get(0);break;case"down":A=true;H=false;_.arr.each(G,function(N,M){if(N.type=="split"){return }if(H){E=N.id;return A=false}if(N.id==I){H=true}});if(A){E=G[0].id}C=D.getSubNodeByItemId("ITEM",E).get(0);break;case"left":if(K=D.$parentPopMenu){if(K=D.$parentPopMenu.$highLight){C=K}}break;case"right":if((K=D.$subPopMenuShowed)&&K==D.$allPops[I]){K.activate()}break}if(C&&C.tagName){try{C.focus()}catch(F){}}}},TOP:{onMouseover:function(A,B,C){A.$scrollToTop=true;A.boxing()._scrollToTop()},onMouseout:function(A,B,C){A.$scrollToTop=false;A.$scrollStep=null},onClick:function(A,B,C){A.$scrollStep=1000}},BOTTOM:{onMouseover:function(A,B,C){A.$scrollTobottom=true;A.boxing()._scrollToBottom()},onMouseout:function(A,B,C){A.$scrollTobottom=false;A.$scrollStep=null},onClick:function(A,B,C){A.$scrollStep=1000}},ITEMS:{beforeKeydown:function(B,C){var A=linb.Event.getKey(C)[0];if(A=="tab"||A=="enter"){return true}else{if(A=="esc"){do{B.boxing().hide()}while(B=B.$parentPopMenu);return false}else{return false}}}},BORDER:{onMouseout:function(A,B,C){A.box._mouseout(A,B,C)}}},DataModel:({dock:null,tabindex:null,tips:null,border:null,resizer:null,shadow:true,_maxHeight:260,_maxWidth:300,left:-10000,hideAfterClick:true,autoHide:false,height:100,width:300,position:"absolute",$border:1}),EventHandlers:{onShowSubMenu:function(A,B,C){},beforeHide:function(A){},onHide:function(A){},onMenuSelected:function(A,B,C){}},RenderTrigger:function(){this.boxing()._adjustSize()},_mouseout:function(C,E,G){if(C.properties.autoHide){var F=linb.Event.getPos(E),B,D,A;_.arr.each(C.$popGrp,function(H){H=linb([H]);D=H.offset();B=H.cssSize();if(F.left>D.left&&F.top>D.top&&F.left<D.left+B.width&&F.top<D.top+B.height){return A=1}});if(!A){while(A=C.$parentPopMenu){C=A}C.boxing().hide();C.$popGrp.length=0}}},_prepareItem:function(A,B){B.add=B.add||"";B.displayAdd=B.add?"":"display:none";B.tagClass=B.sub?"":"display:none";B.type=B.type||"button";if(B.type=="checkbox"){B.checkboxCls=A.getClass("CHECKBOX",B.value?"-checked":"")}},_onresize:function(D,C,A){var B=arguments.callee.upper.apply(this,arguments);D.getSubNode("BOX").cssSize(B)}}});Class("linb.UI.Input",["linb.UI.Widget","linb.absValue"],{Instance:{_setTB:function(C){var B=this.get(0),D=B.properties,E,A;if(!B.host||!D.tipsBinder){return }A=B.tips=B.tips||D.tips||"";E=B.host[D.tipsBinder];if(E&&E.KEY=="linb.UI.Div"){E.get(0).domNode.innerHTML=A.charAt(0)=="$"?linb.wrapRes(A):A;E.reBoxing().css("color",C==1?"gray":C==2?"red":"#000")}},activate:function(){var A=this.get(0);if(A.domNode){var B=A.getSubNode("INPUT").get(0);B.focus();if(!B.readOnly&&B.select){B.select()}}return this},_setCtrlValue:function(A){if(_.isNull(A)||!_.exists(A)){A=""}return this.each(function(B){B.getSubNode("INPUT").attr("value",A+"")})},_getCtrlValue:function(){var A=this.get(0);return A.getSubNode("INPUT").attr("value")},_setDirtyMark:function(){return this.each(function(B){var F=B.properties,A=B.getSubNode("INPUT"),I=B.box,D=B.boxing(),E=linb.UI.$css_tag_dirty,H=linb.UI.$css_tag_invalid,G=F.value!==F.$UIvalue;if(B.beforeDirtyMark&&false===D.beforeDirtyMark(B,G)){}else{if(G){A.addClass(E)}else{A.removeClass(E)}}if(B.beforeFormatMark&&false===D.beforeFormatMark(B,B.inValid==2)){}else{var C=B.getSubNode("ERROR");if(B.inValid==2){A.addClass(H);C.css("display","block")}else{A.removeClass(H);C.css("display","none")}}if(B.inValid==2){B.tips=F.tipsErr||F.tips;if(F.mask){_.asyRun(function(){D.setUIValue(A.get(0).value=B.$Mask)})}}else{if(B.inValid==1){B.tips=F.tips}else{B.tips=F.tipsOK||F.tips}}D._setTB(B.inValid)})}},Initialize:function(){var A=this.getTemplate();_.merge(A.FRAME.BORDER,{BOX:{tagName:"div",INPUT:{tagName:"input",type:"{type}",tabindex:"{tabindex}",cursor:"{cursor}",style:"{_css}"}}},"all");A.FRAME.ERROR={};this.setTemplate(A)},Static:{_maskMap:{"~":"[+-]","1":"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},_maskSpace:"_",Appearances:{KEY:{"font-family":'"Verdana", "Helvetica", "sans-serif"',position:"relative"},BORDER:{"line-height":"0px","font-size":"0px","background-color":"#fff",border:"1px solid #7F9DB9"},"BORDER-focus, BORDER-mouseover":{$order:1,border:"1px solid #FFD700"},BOX:{left:0,top:0,position:"absolute",overflow:linb.browser.gek?"auto":"","z-index":"10"},INPUT:{border:0,padding:0,margin:0,"font-size":"12px",position:"relative",overflow:"auto","background-color":"transparent","overflow-y":(linb.browser.gek||linb.browser.ie)?"auto":"","overflow-x":(linb.browser.gek||linb.browser.ie)?"hidden":""},ERROR:{width:"16px",height:"16px",position:"absolute",right:0,top:0,display:"none","font-size":0,background:linb.UI.$bg("icon.gif"," no-repeat left top",true),"z-index":"50"}},Behaviors:{HoverEffected:{KEY:["BORDER"]},NavKeys:{INPUT:1},INPUT:{onChange:function(A,B,D){var C=A.inValid;A.boxing().setUIValue(D.value);A.properties.$UIvalue=D.value;if(C!==A.inValid){if(A.domNode){A.boxing()._setDirtyMark()}}},onKeydown:function(E,G,H){var F=E.properties,B=F.multiLines,A=E.box,C=linb.Event,D=C.getKey(G);if(D[0]=="enter"&&(!B||D[3])){linb([H]).onChange()}if(F.mask){if(D[0].length>1){E.$ignore=true}else{delete E.$ignore}switch(D[0]){case"backspace":A._changeMask(E,H,"",false);return false;case"delete":A._changeMask(E,H,"");return false}}},onKeypress:function(D,G,H){var F=D.properties,B=D.box,E=B._maskMap;if(F.mask){if(D.$ignore){delete D.$ignore;return true}var A=linb.Event,C=A.getKey(G);if(C[1]||C[3]){return true}B._changeMask(D,H,C[0],true);return false}},onKeyup:function(A,C,D){var B=A.properties;if(B.dynCheck){A.box._checkValid(A,D.value);A.boxing()._setDirtyMark()}},onFocus:function(B,D,E){var C=B.properties,A=B.box;if(C.disabled){return false}if(B.onFocus){B.boxing().onFocus(B)}B.getSubNode("BORDER").tagClass("-focus");if(C.mask){if(linb.browser.opr||linb.browser.kde){A._maskF(B,E)}if(!E.value){_.asyRun(function(){B.boxing().setUIValue(E.value=B.$Mask);A._setCaret(B,E)})}}B.boxing()._setTB(3)},onBlur:function(A,C,D){var B=A.properties;if(B.disabled){return false}if(A.onBlur){A.boxing().onBlur(A)}A.getSubNode("BORDER").tagClass("-focus",false);if(B.$UIvalue==D.value){A.box._checkValid(A,D.value)}A.boxing()._setDirtyMark()}}},DataModel:{tipsErr:"",tipsOK:"",dynCheck:false,valueFormat:{helpinput:[{caption:"required",id:"[^.*]"},{caption:"email",id:"^[\\w\\.=-]+@[\\w\\.-]+\\.[\\w\\.-]{2,4}$"},{caption:"charOnly",id:"^[a-zA-Z]*$"},{caption:"words",id:"^[\\w ]*$"},{caption:"integer",id:"^-?\\d\\d*$"},{caption:"positiveInteger",id:"^\\d\\d*$"},{caption:"number",id:"^-?(\\d\\d*\\.\\d*$)|(^-?\\d\\d*$)|(^-?\\.\\d\\d*$)"},{caption:"filepath",id:"([\\/]?[\\w_]+)+\\.\\w{1,9}$"},{caption:"URL",id:"^(http|https|ftp)\\:\\/\\/[\\w\\-\\_\\.]+[\\w\\-\\_](:[\\w]*)?\\/?([\\w\\-\\._\\?\\,\\'\\/\\\\\\+&amp;%\\$#\\=~])*$"},{caption:"color",id:"^\\#[0-9A-Fa-f]{6}$"},{caption:"HH:MM",id:"^(([0-1][0-9])|([2][0-3])):([0-5][0-9])$"},{caption:"HH:MM:SS",id:"^(([0-1][0-9])|([2][0-3])):([0-5][0-9])\\:([0-5][0-9])$"},{caption:"YYYY-MM-DD",id:"^([0-9]{4})\\-(([0][0-9])|([1][0-2]))\\-([0-3][0-9])$"},{caption:"DD/MM/YYYY",id:"^(([0-2][0-9])|([3][0-1]))/(([0][0-9])|([1][0-2]))/([0-9]{4})$"}]},mask:{action:function(D){var B=this,A=B.box;if(D){B.$MaskFormat=function(J,I){var G=J._maskMap,H=[],K=/[A-Za-z0-9]/;_.arr.each(I.split(""),function(M,L){H.push(G[M]||(K.test(M)?"":"\\")+M)});return"^"+H.join("")+"$"}(A,D);B.$Mask=function(K,I){var G=K._maskMap,H=[],J=K._maskSpace;_.arr.each(I.split(""),function(M,L){H.push(G[M]?J:M)});return H.join("")}(A,D);if(B.domNode){var F=linb.browser.ie,E=B.getSubNode("INPUT").get(0),C=function(G){A._maskF(B,E,F&&G.propertyName)};if(F){E.attachEvent("onpropertychange",C);E.attachEvent("ondrop",C);B.$ondestory=function(){E.detachEvent("onpropertychange",C);E.detachEvent("ondrop",C)}}else{E.addEventListener("input",C,false);if(linb.browser.gek){E.addEventListener("dragdrop",C,false)}B.$ondestory=function(){E.removeEventListener("input",C,false);E.addEventListener("dragdrop",C,false)}}}}else{delete B.$MaskFormat;delete B.$Mask;if(B.domNode){_.tryF(B.$ondestory)}}}},value:"",width:120,height:20,tabindex:{action:function(A){if(this.domNode){this.getSubNode("INPUT").attr("tabIndex",A)}}},disabled:{ini:false,action:function(A){this.root.css("opacity",A?0.5:1);this.getSubNode("INPUT").attr("disabled",A)}},readonly:{ini:false,action:function(A){this.getSubNode("INPUT").attr("readonly",A).css("cursor",A?"default":"")}},type:{ini:"text",listbox:["text","password"],action:function(A){this.getSubNode("INPUT").attr("type",A)}},multiLines:{ini:false,action:function(B){var C=this.getSubNode("INPUT").outerHTML();C=C.replace(/^(<)[a-zA-Z]+(\s)/i,"$1"+(B?"textarea":"input")+"$2");var A=this.boxing().getValue();this.getSubNode("INPUT").outerHTML(C);this.boxing().setUIValue(A)}},tipsBinder:"",$border:1},EventHandlers:{onFocus:function(A){},onBlur:function(A){},beforeFormatCheck:function(A,B){},beforeFormatMark:function(A,B){}},_prepareData:function(A){var B=arguments.callee.upper.call(this,A);B.cursor=B.readonly?"default":"";B.type=B.type||"";if(linb.browser.kde){B._css="resize:none;"}return B},_dynamicTemplate:function(C){var A=C.properties,D=C._exhash="$multiLines:"+A.multiLines,B=C.box.getTemplate(D);A.$UIvalue=A.value;if(!B){B=_.clone(C.box.getTemplate());if(A.multiLines){B.FRAME.BORDER.BOX.INPUT.tagName="textarea";delete B.FRAME.BORDER.BOX.INPUT.type}C.box.setTemplate(B,D)}C.template=B},RenderTrigger:function(){var A=this,B=A.properties;_.asyRun(function(){A.boxing()._setTB(1)});A.getSubNode("BOX").$firfox2()},LayoutTrigger:function(){var A=this.properties;if(A.mask){this.boxing().setMask(A.mask,true)}},_changeMask:function(C,E,F,K){var R=this,J=C.properties,Q=R._maskMap,L=R._maskSpace,A=J.mask,B=C.$Mask,G=linb([E]),H=G.caret();if(K===false&&H[0]==H[1]&&H[0]>0){G.caret(H[0]-1,H[0])}if(K===undefined&&H[0]==H[1]){G.caret(H[0],H[0]+1)}if(K===true){if(B.charAt(H[0])!=L){var N=H[0]+B.substr(H[0],B.length).indexOf(L);G.caret(N,Math.max(H[1],N))}}var H=G.caret(),M=E.value,D=R._maskMap[J.mask.charAt(H[0])],O,I;if(D&&new RegExp("^"+D+"$").test(F)||F==""){I=M;if(H[0]!=H[1]){I=I.substr(0,H[0])+B.substr(H[0],H[1]-H[0])+I.substr(H[1],I.length-H[1])}if(F){I=I.substr(0,H[0])+F+I.substr(H[0]+1,I.length-H[0]-1)}var P=[];_.arr.each(A.split(""),function(T,S){P.push((new RegExp("^"+(Q[T]?Q[T]:"\\"+T)+"$").test(I.charAt(S)))?I.charAt(S):B.charAt(S))});if(K===true){F=B.substr(H[0]+1,M.length-H[0]-1);O=F.indexOf(L);O=H[0]+(O==-1?0:O)+1}else{O=H[0]}if(linb.browser.opr){if(K===undefined){_.arr.insertAny(P,L,O)}if(K===false){_.arr.insertAny(P,L,O++)}}C.boxing().setUIValue(E.value=P.join(""));R._setCaret(C,E,O)}},_setCaret:function(A,B,C){if(A.properties.mask){if(typeof C!="number"){C=B.value.indexOf(this._maskSpace)}linb([B]).caret(C,C)}},_checkValid:function(C,D){var E=C.properties,B=(E.mask&&C.$MaskFormat),A=E.valueFormat||C.$valueFormat;if((C.beforeFormatCheck&&(C.boxing().beforeFormatCheck(C,D)===false))||(B&&typeof B=="string"&&!(new RegExp(B)).test(D||""))||(A&&typeof A=="string"&&!(new RegExp(A)).test(D||""))){C.inValid=2;return false}C.inValid=3;return true},_maskF:function(A,C,B){var D=C.id;_.resetRun(A.$id+"_mask",function(){if(linb.browser.ie&&B!="value"){return }var E=linb.Dom.byId(D);if(E.value.length!=A.$Mask.length){A.box._changeMask(A,E,"",true)}})},_onresize:function(F,E,B){var D=arguments.callee.upper.apply(this,arguments),C=F.getSubNodes(["INPUT","BOX"]),A=linb.browser;if(null!==E){C.width(D.width)}if(null!==B){C.height(D.height)}return D}}});Class("linb.UI.ComboInput","linb.UI.Input",{Instance:{_setCtrlValue:function(E,B){var D=arguments.callee,C=D._r1||(D._r1=/\</),A=D._r2||(D._r2=/\<\/?[^>]+\>/g);return this.each(function(G){var H=G.getSubNode("INPUT"),F=G.properties.type;E=B?E:G.boxing()._getShowValue(E);if(F!=="none"&&!G.properties.multiLines&&typeof E=="string"&&C.test(E)){E=E.replace(A,"")}H.attr("value",E||"");if(F=="colorpicker"){G.getSubNode("BORDER").css("backgroundColor",E);H.css("color",linb.UI.ColorPicker.getTextColor(E))}})},_compareValue:function(D,C){var B=this.get(0),A;if(A=B.$compareValue||B.CF.compareValue){return A(B,D,C)}return D===C},_getShowValue:function(D){var C=this.get(0),E=C.properties,A,B;if(B=C.$getShowValue||C.CF.getShowValue){A=B(C,D)}else{if("listbox"==E.type||"combobox"==E.type){if((A=_.arr.subIndexOf(E.items,"id",D))!=-1){A=E.items[A].caption;A=A.charAt(0)=="$"?linb.getRes(A.slice(1)):A}else{A=""}}else{A=C.$showValue}}A=A||D||"";if(A!==D){C.$caption=A}else{delete C.$caption}return A},_getEditValue:function(C){var B=this.get(0),D=B.properties,A;if(A=B.$getEditValue||B.CF.getEditValue){return A(B,C)}return C},_fromEditValue:function(C){var B=this.get(0),D=B.properties,A;if(A=B.$fromEditValue||B.CF.fromEditValue){return A(B,C)}return C},_cache:function(){var B=this.get(0),A=B.$drop;if(A){if(linb.browser.opr){A.root.css("display","none")}_.asyRun(function(){B.getSubNode("POOL").append(A.root)})}delete B.$poplink},clearPopCache:function(){var A=this.get(0);if(A.domNode){A.getSubNode("POOL").empty()}delete A.$drop;return this},getUploadObj:function(){var A=this.get(0);if(A.domNode&&A.properties.type=="upload"){var B=A.getSubNode("UPLOAD"),C=B.clone();delete A.$_domid[A.keys.UPLOAD];B.addPrev(C).remove(false);this.setValue("",true);return B.get(0)}},resetValue:function(A){this.each(function(B){if(B.properties.type=="upload"){B.getSubNode("UPLOAD").attr("value","")}});return arguments.callee.upper.apply(this,arguments)},_drop:function(A,B){return this.each(function(E){var J=E.properties;if(J.disabled){return }if(J.type=="upload"||J.type=="none"||J.type=="spin"){return }if(E.$poplink){return }var C,K,G=E.boxing(),F=E.root,I=F.offset(),M=F.cssSize();M.width+=2;I.top+=F.offsetHeight();switch(J.type){case"getter":case"cmdbox":case"popbox":G.onClickButton(E,I,A,B);return }var H;switch(J.type){case"timepicker":case"datepicker":case"colorpicker":H=J.type;break;default:if(J.listKey){if(typeof _.get(linb.cache,["UIDATA",J.listKey])=="function"){E.$drop=H=null}else{H=J.listKey}}else{H=E.$id}}if(H){_.filter(E.box.$drop,function(N){return !!N.domNode});E.$drop=E.box.$drop[H]}if(!E.$drop){switch(J.type){case"combobox":case"listbox":case"helpinput":linb.SC("linb.UI.List");C=linb.create("List");C.host(E).setItems(_.copy(J.items)).setListKey(J.listKey||"").adjustSize();C.beforeUIValueSet(function(Q,P,O){var N=this.boxing();N.setUIValue(O);N._cache();N.activate();return false});break;case"timepicker":linb.SC("linb.UI.TimePicker");C=linb.create("TimePicker");C.host(E);C.beforeClose(function(){this.boxing()._cache();return false});C.beforeUIValueSet(function(O,P,N){this.boxing().setUIValue(N)._cache()});break;case"datepicker":linb.SC("linb.UI.DatePicker");C=linb.create("DatePicker");C.host(E);C.beforeClose(function(){this.boxing()._cache();return false});C.beforeUIValueSet(function(O,P,N){this.boxing().setUIValue(String(N.getTime()))._cache()});break;case"colorpicker":linb.SC("linb.UI.ColorPicker");C=linb.create("ColorPicker");C.host(E);C.beforeClose(function(){this.boxing()._cache();return false});C.beforeUIValueSet(function(O,P,N){this.boxing().setUIValue("#"+N)._cache()});break}E.$drop=C.get(0);if(H){E.box.$drop[H]=E.$drop}}C=E.$drop.boxing();C.host(E);switch(J.type){case"combobox":case"listbox":case"helpinput":C.setWidth(E.root.width());case"timepicker":C.setValue(G.getUIValue(),true);break;case"datepicker":var L=E.$drop.properties;L.WEEK_FIRST=J.WEEK_FIRST;if(L=G.getUIValue()){C.setValue(new Date(parseInt(L)),true)}break;case"colorpicker":C.setValue(G.getUIValue().replace("#",""),true);break}E.$poplink=C.get(0);var D=C.reBoxing();D.popToTop(E.root);_.tryF(C.activate,[],C);D.setBlurTrigger(E.key+":"+E.$id,function(){G._cache()},null,E.$id);linb.Event.keyboardHook("esc",0,0,0,function(){G._cache();G.activate();linb.Event.keyboardHook("esc")})})}},Initialize:function(){this.addTemplateKeys(["UPLOAD","BTN","TOP","MID","RBTN","R1","R1T","R1B","R2","R2T","R2B"]);var A=this.getTemplate();_.merge(A.FRAME.BORDER,{SBTN:{$order:5,style:"{saveDisplay}",STOP:{},SMID:{}}},"all");A.FRAME.POOL={};this.setTemplate(A)},Static:{_iniType:function(B){var F=B.properties,C=F.type;if(C=="listbox"||C=="upload"){B.boxing().setReadonly(true)}if(C!="listbox"&&C!="combobox"){if(!F.items){F.items=[]}}if(C=="timepicker"){var E=linb.SC("linb.UI.TimePicker");_.merge(B,{$compareValue:null,$getShowValue:function(G,H){return H?E._ensureValue(G,H):""},$getEditValue:null,$fromEditValue:function(G,H){return E._ensureValue(G,H)}},"all");if(F.value){F.$UIvalue=F.value=E._ensureValue(B,F.value)}}else{if(C=="datepicker"){var A=linb.Date;_.merge(B,{$compareValue:function(I,H,G){return String(H)==String(G)},$getShowValue:function(G,H){return H?A.getText(new Date(parseInt(H)),"ymd"):""},$getEditValue:function(H,I){var G=new Date(parseInt(I));return I?(A.get(G,"m")+1)+"/"+A.get(G,"d")+"/"+A.get(G,"y"):""},$fromEditValue:function(H,I){var G=linb.Date.parse(I);if(G){G=linb.Date.getTimSpanStart(G,"d",1)}return G?String(G.getTime()):"0"}},"all");if(F.value){var D=new Date(parseInt(F.value)||0);F.$UIvalue=F.value=String(A.getTimSpanStart(D,"d",1).getTime())}}else{delete B.$compareValue;delete B.$getShowValue;delete B.$getEditValue;delete B.$fromEditValue;if(_.isDate(F.value)){F.$UIvalue=F.value=String(F.value)}}}},$drop:{},Appearances:{POOL:{position:"absolute",left:0,top:0,width:0,height:0,display:"none",visibility:"hidden"},UPLOAD:{opacity:0,"*filter":"alpha(opacity=0)","z-index":"3",border:0,height:"100%",position:"absolute",top:0,right:0,cursor:"pointer","font-size":"12px",overflow:"hidden"},"RBTN,SBTN,BTN":{display:"block","z-index":"1",cursor:"pointer",width:"13px","font-size":0,"line-height":0,position:"relative","float":"right"},"SBTN,BTN":{background:linb.UI.$bg("combo.gif"," left bottom no-repeat",true)},"R1,R2":{display:"block","font-size":0,"line-height":0,cursor:"pointer",width:"13px",position:"absolute",height:"50%",background:linb.UI.$bg("combo.gif"," left bottom no-repeat",true)},R1:{top:0},R2:{bottom:0},"BTN-mouseover, SBTN-mouseover, R1-mouseover, R2-mouseover":{$order:1,"background-position":"-14px bottom"},"BTN-mousedown, SBTN-mousedown, R1-mousedown, R2-mousedown":{$order:2,"background-position":"-27px bottom"},"STOP, TOP, R1T, R2T":{cursor:"pointer",width:"13px","font-size":0,"line-height":0,position:"absolute",top:0,left:0,height:"4px",background:linb.UI.$bg("combo.gif"," left -104px no-repeat",true)},"BTN-mouseover TOP,SBTN-mouseover STOP, R1-mouseover R1T, R2-mouseover R2T":{$order:1,"background-position":"-14px -104px"},"BTN-mousedown TOP,SBTN-mousedown STOP, R1-mousedown R1T, R2-mousedown R2T":{$order:2,"background-position":"-27px -104px"},"R1B,R2B":{cursor:"pointer",width:"13px","font-size":0,"line-height":0,position:"absolute",left:0,top:"50%","margin-top":"-3px",height:"6px"},R1B:{background:linb.UI.$bg("combo.gif"," -14px -31px no-repeat",true)},R2B:{background:linb.UI.$bg("combo.gif"," left -5px no-repeat",true)},"SMID,MID":{cursor:"pointer",width:"13px","font-size":0,"line-height":0,position:"absolute",bottom:"3px",left:0,height:"13px",background:linb.UI.$bg("combo.gif"," left top no-repeat",true)},SMID:{$order:3,"background-position":"-14px -14px"}},Behaviors:{HoverEffected:{KEY:"BORDER",BTN:"BTN",SBTN:"SBTN",R1:"R1",R2:"R2"},ClickEffected:{BTN:"BTN",SBTN:"SBTN",R1:"R1",R2:"R2"},UPLOAD:{onClick:function(A,B,C){if(A.onFileDlgOpen){A.boxing().onFileDlgOpen(A,C)}},onChange:function(A,B,C){A.getSubNode("INPUT").attr("value",C.value).onChange()}},BTN:{onClick:function(A,B,C){A.boxing()._drop(B,C)}},SBTN:{onClick:function(A,B,C){if(A.onSave){A.boxing().onSave(A,C)}}},INPUT:{onChange:function(C,E,G){if(C.$_onedit||C.$_inner){return }var F=C.inValid,A=C.boxing(),B=A._fromEditValue(G.value),D=C.properties.$UIvalue;if(!A._compareValue(D,B)){C.$_inner=1;delete C.$_inner;if(B===null){A._setCtrlValue(D)}else{A.setUIValue(B);C.properties.$UIvalue=B;if(F!==C.inValid){if(C.domNode){A._setDirtyMark()}}}}},onKeyup:function(A,C,D){var B=A.properties;if(B.dynCheck){if(B.$UIvalue!=D.value){A.box._checkValid(A,D.value)}A.boxing()._setDirtyMark()}},onFocus:function(C,F,G){var E=C.properties,D=E.$UIvalue;if(E.disabled){return false}var A=C.boxing(),B=A._getEditValue(D);if(B!==D){C.$_onedit=true;G.value=B;delete C.$_onedit}if(C.onFocus){C.boxing().onFocus(C)}C.getSubNode("BORDER").tagClass("-focus");C.boxing()._setTB(3)},onBlur:function(C,F,G){var E=C.properties,A=C.boxing(),D=E.$UIvalue,B=A._fromEditValue(G.value);if(E.disabled){return false}if(C.onFocus){A.onFocus(C)}C.getSubNode("BORDER").tagClass("-focus",false);if(A._compareValue(E.$UIvalue,B)){C.box._checkValid(C,B);A._setCtrlValue(D)}A._setDirtyMark()},onKeydown:function(C,D,E){var F=C.properties,A=F.multiLines,B=linb.Event.getKey(D);if(B[0]=="enter"&&(!A||B[3])){linb([E]).onChange()}if(B[0]=="down"||B[0]=="up"){if(F.type=="spin"){C.box._spin(C,B[0]=="up");return false}if(B[1]&&F.type){C.boxing()._drop(D,E);return false}}},onKeyup:function(B,C,D){var E=B.properties,A=linb.Event.getKey(C);if(A[0]=="down"||A[0]=="up"){if(E.type=="spin"){linb.Thread.abort(B.$id+":spin");return false}}},onClick:function(A,B,C){if(C.readOnly){A.boxing()._drop(B,C)}}},R1:{onMousedown:function(A){A.box._spin(A,true)},onMouseout:function(A){linb.Thread.abort(A.$id+":spin")},onMouseup:function(A){linb.Thread.abort(A.$id+":spin")}},R2:{onMousedown:function(A){A.box._spin(A,false)},onMouseout:function(A){linb.Thread.abort(A.$id+":spin")},onMouseup:function(A){linb.Thread.abort(A.$id+":spin")}}},EventHandlers:{onFileDlgOpen:function(A,B){},onSave:function(A,B){},onClickButton:function(A,D,B,C){}},_posMap:{none:"",combobox:"left top",listbox:"left top",upload:"-16px top",getter:"left -27px",helpinput:"left -91px",cmdbox:"left -14px",popbox:"left -40px",timepicker:"left -53px",datepicker:"left -66px",colorpicker:"left -79px"},DataModel:{listKey:{set:function(A){var B=this.constructor.getCachedData(A);return this.each(function(C){C.boxing().setItems(B?B:C.properties.items);C.properties.listKey=A})}},items:{ini:[],action:function(B){var A=this;A.boxing().setValue(null,true);A.SubSerialIdMapItem={};A.ItemIdMapSubSerialId={};A.box._prepareItems(A,B);if(B.domNode){A.boxing().clearPopCache()}}},readonly:{ini:false,action:function(A){if(!A&&this.properties.type=="listbox"){return }this.getSubNode("INPUT").css("cursor",A?"pointer":"default").attr("readonly",A)}},type:{ini:"combobox",listbox:_.toArr("none,combobox,listbox,upload,getter,helpinput,cmdbox,popbox,timepicker,datepicker,colorpicker,spin"),set:function(B,A){return this.each(function(C){if(C.properties.type!=B||A){C.properties.type=B;C.box._iniType(C);if(C.domNode){C.boxing().refresh()}}})}},scale:2,increment:0.01,min:0,max:1,saveBtn:{ini:false,action:function(A){this.boxing().refresh()}},$border:1},RenderTrigger:function(){var B=this,A=B.boxing(),C=B.properties;B.box._iniType(B);if(C.readonly){A.setReadonly(true,true)}},_spin:function(D,B){var G=D.$id+":spin";if(linb.Thread.isAlive(G)){return }var F=D.properties,E=F.increment*(B?1:-1),C={delay:300},A=function(){D.boxing().setUIValue(String((+F.$UIvalue||0)+E));C.delay*=0.9};C.task=A;linb.Thread(G,[C],500,null,A,null,true).start()},_dynamicTemplate:function(D){var B=D.properties,E=D._exhash="$multiLines:"+B.multiLines+";type:"+B.type+";",C=D.box.getTemplate(E);B.$UIvalue=B.value;if(!C){C=_.clone(D.box.getTemplate());var A=C.FRAME.BORDER;if(B.multiLines){A.BOX.INPUT.tagName="textarea";delete A.BOX.INPUT.type}switch(B.type){case"spin":A.RBTN={$order:5,style:"{rDisplay}",R1:{R1T:{},R1B:{}},R2:{R2T:{},R2B:{}}};break;case"none":break;case"upload":A.UPLOAD={$order:2,tagName:"input",type:"file",size:"1"};default:A.BTN={$order:4,style:"{popbtnDisplay}",TOP:{},MID:{style:"{typePos}"}}}D.box.setTemplate(C,E)}D.template=C},_prepareData:function(A){var B=arguments.callee.upper.call(this,A),C=A.box._posMap;if(C[B.type]){B.typePos="background-position:"+C[B.type]}B.saveDisplay=B.saveBtn?"":"display:none";B.popbtnDisplay=B.type!="none"?"":"display:none";return B},_ensureValue:function(B,D){var C=arguments.callee,A=C._reg||(C._reg=/^#[\w]{6}$/),F=B.properties;switch(B.properties.type){case"datepicker":return(D.constructor==Date?D.getTime():D)+"";case"colorpicker":return"#"+linb.UI.ColorPicker._ensureValue(null,D);case"timepicker":return linb.UI.TimePicker._ensureValue(null,D);case"spin":var E=Math.pow(10,F.scale);D=+D||0;D=Math.ceil((D-3e-13)*E)/E;return String(D>F.max?F.max:D<F.min?F.min:D);default:return typeof D!=="string"?D:(D||D===0)?String(D):""}},_onresize:function(D,B,J){var K=linb.UI.Widget._onresize.apply(this,arguments),A=D.properties,I="px",E=function(L){return L?D.getSubNode(L)._nodes[0]:null},G=A.type,H=E("INPUT"),F=E(A.saveBtn?"SBTN":null),C=E(G=="spin"?"RBTN":G=="none"?null:"BTN");if(!_.isNull(B)){H.style.width=(K.width-(F?F.offsetWidth:0)-(C?C.offsetWidth:0))+I}if(!_.isNull(J)){J=K.height+I;H.style.height=J;if(F){F.style.height=J}if(C){C.style.height=J}if(A.type=="spin"){J=K.height/2+I;E("R1").style.height=J;E("R2").style.height=J}}}}});Class("linb.UI.ColorPicker",["linb.UI","linb.absValue"],{Instance:{_setCtrlValue:function(A){return this.each(function(F){if(!F.domNode){return }var J=F.box,D=F.properties,E=F.$hex=J._to3(A),C=F.$hex.join(""),I=F.$rgb=J.hex2rgb(A),G=F.$hsv=J.rgb2hsv(I),H=function(L,K){F.getSubNode(L).get(0).firstChild.nodeValue=String(K)},B=function(K){return parseInt(K*100)};H("R",I[0]);H("G",I[1]);H("B",I[2]);H("H",E[0]);H("E",E[1]);H("X",E[2]);if(F.$hexinhsv!=C){H("HH",G[0]);H("S",B(G[1]));H("V",B(G[2]));delete F.$hexinhsv}J._setClrName(F,C);J._updateDftTip(F);if(D.advance&&F.$hexinadv!=C){J._updateMarks(F,A,true,G[0]);delete F.$hexinadv}})},getColorName:function(){return this.get(0).$clrN||""}},Initialize:function(){var H=this,F=linb.Event.$EVENTHANDLER,A=linb.UI.$ID,K=linb.UI.$CLS,I=H.KEY,G=H._slist,B=G.length,D,C,E=[],J=' unselectable="on" onmousedown="'+F+'" ondrag="'+F+'" ondragstop="'+F+'" ';H.addTemplateKeys(["TXT","DD1","DD2","DD3","R","G","B","HH","S","V","H","E","X"]);for(D=0;D<B;D++){E.push('<a  id="'+I+"-SC:"+A+":"+G[D]+'" href='+linb.$href+' onmouseover="'+F+'"  onkeydown="'+F+'" onclick="'+F+'" style="background-color:#'+G[D]+'">'+G[D]+"</a>")}C='<div><span class="'+K+'-txt">R: </span><span id="'+I+"-R:"+A+':" class="'+K+'-dd2 ui-dragable #DD2_CC#" '+J+'>R</span><span style="width:8px;height:8px"  unselectable="on" ></span><span class="'+K+'-txt">H: </span><span id="'+I+"-HH:"+A+':" class="'+K+'-dd2 ui-dragable #DD2_CC#" '+J+'>H</span><span>\xB0</span></div><div><span class="'+K+'-txt">G: </span><span id="'+I+"-G:"+A+':" class="'+K+'-dd2 ui-dragable #DD2_CC#" '+J+'>G</span><span style="width:8px;height:8px"  unselectable="on" ></span><span class="'+K+'-txt">S: </span><span id="'+I+"-S:"+A+':" class="'+K+'-dd2 ui-dragable #DD2_CC#"  '+J+'>S</span><span>%</span></div><div><span class="'+K+'-txt">B: </span><span id="'+I+"-B:"+A+':" class="'+K+'-dd2 ui-dragable #DD2_CC#" '+J+'>B</span><span style="width:8px;height:8px"  unselectable="on" ></span><span class="'+K+'-txt">V: </span><span id="'+I+"-V:"+A+':" class="'+K+'-dd2 ui-dragable #DD2_CC#" '+J+'>V</span><span>%</span></div><div><span style="width:38px">HEX: #</span><span id="'+I+"-H:"+A+':" class="'+K+'-dd3 ui-dragable #DD3_CC#" '+J+'>H</span><span id="'+I+"-E:"+A+':" class="'+K+'-dd3 ui-dragable #DD3_CC#" '+J+'>E</span><span id="'+I+"-X:"+A+':" class="'+K+'-dd1 ui-dragable #DD1_CC#" '+J+">X</span></div>";H.setTemplate({style:"{_style};width:{_width}px;",tagName:"div",onselectstart:"return false",BORDER:{tagName:"div",BAR:{tagName:"div",className:"uibar-bar",style:"{barDisplay};height:22px",BART:{cellpadding:"0",cellspacing:"0",width:"100%",height:"100%",border:"0",tagName:"table",className:"uibar-t",BARTR:{tagName:"tr",BARTDL:{tagName:"td",className:"uibar-tdl"},BARTDM:{$order:1,width:"100%",tagName:"td",className:"uibar-tdm"},BARTDR:{$order:2,tagName:"td",className:"uibar-tdr"}}},BARCMDL:{tagName:"div",className:"uibar-cmdl"},BARCMDR:{tagName:"div",className:"uibar-cmdr",onselectstart:"return false",unselectable:"on",CLOSE:{className:"uicmd-close ",style:"{closeDisplay}"}}},CON:{$order:1,tagName:"div",className:"uibg-base",SIMPLE:{tagName:"div",TOP:{$order:1,tagName:"div",DATA:{$order:0,tagName:"div",onselectstart:"return false",text:C},EXAM:{$order:1,tagName:"div"}},LIST:{$order:2,tagName:"div",text:E.join("")},SUBMIT:{$order:3,tagName:"div",OK:{tagName:"a",href:linb.$href,className:"ui-btn",style:"{submitDispay}",text:linb.wrapRes("inline.ok")},CANCEL:{$order:1,className:"ui-btn",style:"{submitDispay}",tagName:"a",href:linb.$href,text:linb.wrapRes("inline.cancel")},TOGGLE:{$order:2,tagName:"a",href:linb.$href,className:"ui-btn",text:">>"}}},ADV:{$order:2,style:"{advDispay}",tagName:"div",ADVWHEEL:{$order:0,tagName:"div"},ADVCLR:{$order:1,tagName:"div"},ADVMARK1:{$order:3,tagName:"div"},ADVMARK2:{$order:4,tagName:"div"}}}}})},Static:{_radius:84,_square:100,_bigRadius:97,DataModel:{height:230,value:"FFFFFF",displayBar:{ini:true,action:function(A){this.getSubNode("BAR").css("display",A?"":"none")}},closeBtn:{ini:true,action:function(A){this.getSubNode("CLOSE").css("display",A?"":"none")}},advance:{ini:false,action:function(A){var B=this;B.getSubNode("ADV").css("display",A?"":"none");B.getSubNode("TOGGLE").text(A?"<<":">>");B.root.width(A?400:200);if(A){B.box._updateMarks(B,B.properties.$UIvalue,true,B.$hsv[0])}}},cmdBtns:{ini:true,action:function(A){var C=A?"":"none",B=this;B.getSubNode("OK").css("display",C);B.getSubNode("CANCEL").css("display",C)}},$borderW:1},Appearances:{KEY:{"-moz-user-select":"none"},BORDER:{overflow:"visible",position:"relative"},CON:{height:"200px",border:"solid 1px #C1C1C1",padding:"3px","margin-top":"-1px"},DATA:{"float":"left",width:"112px",height:"86px"},"DATA span":{"float":"left"},"DATA div":{"padding-top":"3px",clear:"both"},TXT:{width:"16px"},EXAM:{"float":"left",height:"80px",width:"80px",background:"red","padding-top":"2px","white-space":"normal","text-align":"center"},"DD1, DD2, DD3":{display:"block",height:"16px",border:"1px solid #7F9DB9","padding-right":"2px",cursor:"e-resize","text-align":"right",background:"#FFFACD"},DD1:{width:"16px",border:"1px solid #7F9DB9"},DD2:{width:"24px",border:"1px solid #7F9DB9"},DD3:{$order:2,width:"16px","border-right":"none"},TOP:{width:"192px"},LIST:{width:"192px",overflow:"hidden","padding-top":"4px","line-height":linb.browser.ie6?"0":null,clear:"both"},SIMPLE:{"float":"left"},ADV:{"float":"right",width:"195px",height:"195px",position:"relative"},"ADV div":{cursor:"crosshair",position:"absolute"},ADVCLR:{background:linb.browser.ie6?null:linb.UI.$bg("bg.png","no-repeat left top"),_filter:linb.UI.$ieBg("bg.png"),height:"101px",left:"47px",top:"47px",width:"101px"},ADVWHEEL:{background:linb.browser.ie6?null:linb.UI.$bg("clr.png"," no-repeat left top"),_filter:linb.UI.$ieBg("clr.png"),height:"195px",width:"195px"},"ADVMARK1, ADVMARK2":{background:linb.browser.ie6?null:linb.UI.$bg("picker.png"," no-repeat left top"),_filter:linb.UI.$ieBg("picker.png"),height:"17px",margin:"-8px 0pt 0pt -8px",overflow:"hidden",width:"17px"},"LIST a":{height:"9px",width:"9px","font-size":linb.browser.ie6?"0":null,"float":"left",display:"block",overflow:"hidden","text-indent":"100px",margin:"0",cursor:"pointer",border:"1px solid #F6F7EE"},"LIST a:hover":{border:"1px solid black"},SUBMIT:{"margin-top":"1px","text-align":"right",padding:"4px"},"OK, CANCEL":{"margin-right":"5px"}},Behaviors:{HoverEffected:{CLOSE:"CLOSE"},ClickEffected:{CLOSE:"CLOSE"},KEY:{onClick:function(){return false}},SC:{onMouseover:function(C,B,A){C.box._setTempUI(C,C.getSubId(A.id))},onClick:function(D,C,B){var A=D.getSubId(B.id);D.boxing()._setCtrlValue(D.$tempValue=A);if(!D.properties.advance){D.boxing().setUIValue(A)}return false}},LIST:{onMouseout:function(C,B,A){C.box._updateDftTip(C)}},OK:{onClick:function(B,A,C){B.boxing().setUIValue(B.$tempValue)}},CANCEL:{onClick:function(B,A,C){B.getSubNode("CLOSE").onClick(true)}},TOGGLE:{onClick:function(B,A,C){B.boxing().setAdvance(!B.properties.advance)}},R:{onMousedown:function(B,A,C){B.box._dd1(B,A,C)},onDrag:function(B,A,C){B.box._dd2(B,A,C,0)},onDragstop:function(B,A,C){B.box._dd3(B,A,C,0)}},G:{onMousedown:function(B,A,C){B.box._dd1(B,A,C)},onDrag:function(B,A,C){B.box._dd2(B,A,C,1)},onDragstop:function(B,A,C){B.box._dd3(B,A,C,1)}},B:{onMousedown:function(B,A,C){B.box._dd1(B,A,C)},onDrag:function(B,A,C){B.box._dd2(B,A,C,2)},onDragstop:function(B,A,C){B.box._dd3(B,A,C,2)}},HH:{onMousedown:function(B,A,C){B.box._dd1(B,A,C,true)},onDrag:function(B,A,C){B.box._dd2(B,A,C,0,"hsv1")},onDragstop:function(B,A,C){B.box._dd3(B,A,C,0,true,"hsv1")}},S:{onMousedown:function(B,A,C){B.box._dd1(B,A,C,true)},onDrag:function(B,A,C){B.box._dd2(B,A,C,1,"hsv2")},onDragstop:function(B,A,C){B.box._dd3(B,A,C,1,true,"hsv2")}},V:{onMousedown:function(B,A,C){B.box._dd1(B,A,C,true)},onDrag:function(B,A,C){B.box._dd2(B,A,C,2,"hsv2")},onDragstop:function(B,A,C){B.box._dd3(B,A,C,2,true,"hsv2")}},H:{onMousedown:function(B,A,C){B.box._dd1(B,A,C)},onDrag:function(B,A,C){B.box._dd2(B,A,C,0,"hex")},onDragstop:function(B,A,C){B.box._dd3(B,A,C,0)}},E:{onMousedown:function(B,A,C){B.box._dd1(B,A,C)},onDrag:function(B,A,C){B.box._dd2(B,A,C,1,"hex")},onDragstop:function(B,A,C){B.box._dd3(B,A,C,1)}},X:{onMousedown:function(B,A,C){B.box._dd1(B,A,C)},onDrag:function(B,A,C){B.box._dd2(B,A,C,2,"hex")},onDragstop:function(B,A,C){B.box._dd3(B,A,C,2)}},CLOSE:{onClick:function(C,D,E){var B=C.properties,A=C.boxing();if(B.disabled){return }if(false===A.beforeClose(C)){return }A.destroy();return false}},ADVWHEEL:{onMousedown:function(C,B,D){var A=C.box;A._prepareAdv(C,B);A._updateClrByPos(C,B,true);C.getSubNode("ADVMARK1").startDrag(B,{dragType:"none"})}},ADVMARK1:{onMousedown:function(C,B,D){var A=C.box;A._prepareAdv(C,B);A._updateClrByPos(C,B,true);C.getSubNode("ADVMARK1").startDrag(B,{dragType:"none"})},onDrag:function(C,B,D){var A=C.box;A._updateClrByPos(C,B,true)},onDragstop:function(C,B,D){var A=C.box;A._updateValueByPos(C,B)}},ADVCLR:{onMousedown:function(C,B,D){var A=C.box;A._prepareAdv(C,B);A._updateClrByPos(C,B);C.getSubNode("ADVMARK2").startDrag(B,{dragType:"none"});return false}},ADVMARK2:{onMousedown:function(C,B,D){var A=C.box;A._prepareAdv(C,B);A._updateClrByPos(C,B);C.getSubNode("ADVMARK2").startDrag(B,{dragType:"none"});return false},onDrag:function(C,B,D){var A=C.box;A._updateClrByPos(C,B)},onDragstop:function(C,B,D){var A=C.box;A._updateValueByPos(C,B,true)}}},_prepareData:function(B){var C=arguments.callee.upper.call(this,B);var A="display:none";C.displayBar=C.displayBar?"":A;C.closeDisplay=C.closeBtn?"":A;C._width=C.advance?"400":"200";C.advDispay=C.advance?"":"display:none;";C.submitDispay=C.cmdBtns?"":"display:none;";return C},EventHandlers:{beforeClose:function(A,B){}},RenderTrigger:function(){this.$onValueSet=this.$onValueUpdated=function(A){this.box._setClrName(this,A)}},_setClrName:function(C,B){var E=C,A="color.LIST.",D=linb.getRes(A+B);if(D==B){E.$clrN2=E.$clrN="#"+B}else{E.$clrN=D;E.$clrN2=linb.wrapRes(A+B)}},_slist:"FFFFFF,FFFFF0,FFFFE0,FFFF00,FFFAFA,FFFAF0,FFFACD,FFF8DC,FFF5EE,FFF0F5,FFEFD5,FFEBCD,FFE4E1,FFE4C4,FFE4B5,FFDEAD,FFDAB9,FFD700,FFC0CB,FFB6C1,FFA500,FFA07A,FF8C00,FF7F50,FF69B4,FF6347,FF4500,FF1493,FF00FF,FF00FF,FF0000,FDF5E6,FAFAD2,FAF0E6,FAEBD7,FA8072,F8F8FF,F5FFFA,F5F5F5,F5DEB3,F4A460,F0FFFF,F0FFF0,F0F8FF,F0E68C,F08080,EEE8AA,EE82EE,E9967A,E6E6FA,E1FFFF,DEB887,DDA0DD,DCDCDC,DC143C,DB7093,DAA520,DA70D6,D8BFD8,D3D3D3,D2B48C,D2691E,CD853F,CD5C5C,C71585,C0C0C0,BDB76B,BC8F8F,BA55D3,B22222,B0E0E6,B0C4DE,AFEEEE,ADFF2F,ADD8E6,A9A9A9,A52A2A,A0522D,9932CC,98FB98,9400D3,9370DB,90EE90,8FBC8F,8B4513,8B008B,8B0000,8A2BE2,87CEFA,87CEEB,808080,808000,800080,800000,7FFFAA,7FFF00,7CFC00,7B68EE,778899,708090,6B8E23,6A5ACD,696969,6495ED,5F9EA0,556B2F,4B0082,48D1CC,483D8B,4682B4,4169E1,40E0D0,3CB371,32CD32,2F4F4F,2E8B57,228B22,20B2AA,1E90FF,191970,00FFFF,00FFFF,00FF7F,00FF00,00FA9A,00CED1,00BFFF,008B8B,008080,008000,006400,0000FF,0000CD,00008B,000080,000000".split(","),_C16:"0123456789ABCDEF",_dd1:function(C,F,G,B){var E=C.properties,A=C.box,D=function(){var H=A.hex2rgb(E.$UIvalue);return B?A.rgb2hsv(H):H};linb([G]).css("background","red").startDrag(F,{dragType:"blank",targetReposition:false,widthIncrement:2,dragCursor:true});C.$temp=0;C.$start=D();C.$temp2=D()},_dd2:function(E,I,A,F,J){var G,D=linb.DragDrop.getProfile().offset,B=E.properties,C=E.$temp2,L=E.box,H=J=="hsv1"?361:J=="hsv2"?101:256,K;G=(J=="hsv2"?parseInt(E.$start[F]*100):parseInt(E.$start[F]))+parseInt(D.x/2);G=(G%H+H)%H;if(E.$temp!=G){C[F]=E.$temp=J=="hsv2"?G/100:G;K=(J=="hsv1"||J=="hsv2")?L.hsv2rgb(C):C;K=L.rgb2hex(K);L._setTempUI(E,K);linb([A]).text(J=="hex"?L._toFF(G):G)}},_dd3:function(D,G,A,E,F){if(D.$start[E]!==D.$temp){var B=D.properties,I=D.box,C=D.$start,H;C[E]=D.$temp;H=F?I.hsv2rgb(C):C;H=I.rgb2hex(H);if(F){D.$hexinhsv=H}D.boxing()._setCtrlValue(D.$tempValue=H);delete D.$hexinhsv}linb([A]).css("background","");D.$temp=D.$start=0},_setTempUI:function(H,C){var B=this,E=B.hex2rgb(C),A=H.boxing(),F=A.getSubNode("EXAM"),D=B.rgb2hsv(E),G=linb.getRes("color.LIST."+C);F.css({backgroundColor:"#"+C,color:D[2]>0.6?"#000":"#FFF"});F.text(H.show_color=G==C?"#"+C:G)},_updateDftTip:function(C){var A=C.box,B=C.boxing().getSubNode("EXAM");B.css({backgroundColor:"#"+C.$hex.join(""),color:C.$hsv[2]>0.6?"#000":"#FFF"});B.html(C.$clrN2||"",false)},_to3:function(A){if(!A){A="FFFFFF"}return[A.substr(0,2),A.substr(2,2),A.substr(4,2)]},_toFF:function(B){var A=this._C16;B=parseInt(B)||0;B=(B>255||B<0)?0:B;return A.charAt((B-B%16)/16)+A.charAt(B%16)},_to255:function(C){var B=this._C16,A=C.split("");return B.indexOf(A[0].toUpperCase())*16+B.indexOf(A[1].toUpperCase())},_webSafe:function(D,C,A){var B=arguments.callee,E=B.f||(B.f=function(F){return parseInt(F/51)*51});if(typeof D=="object"){C=D[1];A=D[2];D=D[0]}return[E(D),E(C),E(A)]},_updateMarks:function(B,A,G,F){var J=this,E=J.hex2rgb(A),D=J.rgb2hsv(E),C=(D[0]/360)*6.28,K=B.getSubNode("ADVCLR");if(G){var I=B.getSubNode("ADVMARK1"),H=B.getSubNode("ADVMARK2");I.cssPos({left:Math.round(Math.sin(C)*J._radius+J._bigRadius),top:Math.round(-Math.cos(C)*J._radius+J._bigRadius)});H.cssPos({left:Math.round(J._square*(D[1]-0.5)+J._bigRadius),top:Math.round(J._square*(0.5-D[2])+J._bigRadius)})}if(F!==undefined){K.css("backgroundColor","#"+J.rgb2hex(J.hsv2rgb([F,1,1])))}J._setTempUI(B,A)},_updateClrByPos:function(C,H,I){var P=this,E=linb.Event.getPos(H),K=C.$tpos,B=E.left-K.left,L=E.top-K.top,D,O,N,G,Q,M,F,J,A;if(I){O=C.getSubNode("ADVMARK1");D=Math.atan2(B,-L);O.cssPos({left:Math.round(Math.sin(D)*P._radius+P._bigRadius),top:Math.round(-Math.cos(D)*P._radius+P._bigRadius)});G=Math.floor((D/6.28)*360);if(G<0){G+=360}F=[G,C.$hsv[1],C.$hsv[2]];J=P.hsv2rgb(F);A=P.rgb2hex(J);P._updateMarks(C,C.$t_hex=A,false,G)}else{N=C.getSubNode("ADVMARK2");Q=Math.max(0,Math.min(1,(B/P._square)+0.5));M=Math.max(0,Math.min(1,0.5-(L/P._square)));N.cssPos({left:Math.round(P._square*(Q-0.5)+P._bigRadius),top:Math.round(P._square*(0.5-M)+P._bigRadius)});F=[C.$hsv[0],Q,M];J=P.hsv2rgb(F);A=P.rgb2hex(J);P._updateMarks(C,C.$t_hex=A)}},_updateValueByPos:function(B,C,A){B.$hexinadv=B.$t_hex;B.boxing()._setCtrlValue(B.$tempValue=B.$t_hex);delete B.$hexinadv},_prepareAdv:function(B,C){var A=this,D=B.getSubNode("ADVWHEEL").offset();B.$tpos={left:D.left+A._bigRadius,top:D.top+A._bigRadius}},_ensureValue:function(C,I){var G=this,F=arguments.callee,A=F.map||(F.map=(function(){var J={};_.arr.each(G._C16.split(""),function(L,K){J[L]=1});return J}())),B=F._r||(F._r=/rgb\(([^)]*)\)/);if(!I||typeof I!="string"){return"FFFFFF"}if(B.test(I)){I=I.replace(B,"$1");I=I.split(",");I[0]=parseInt(I[0])||0;I[1]=parseInt(I[1])||0;I[2]=parseInt(I[2])||0;I=G.rgb2hex(I)}if(I.charAt(0)=="#"){I=I.substr(1,I.length)}var H="",D;for(var E=0;E<6;E++){D=I.charAt(E).toUpperCase();H+=(A[D]?D:"F")}return H},hsv2rgb:function(F,M,K){if(F instanceof Array){M=F[1];K=F[2];F=F[0]}var I=arguments.callee,H=I.f||(I.f=function(N){return Math.min(255,Math.round(N*256))}),A,G,J,E,D,C,B,L;if(M==0){return[K=H(K),K,K]}else{E=Math.floor((F/60)%6);D=(F/60)-E;C=K*(1-M);B=K*(1-D*M);L=K*(1-(1-D)*M);switch(E){case 0:A=K;G=L;J=C;break;case 1:A=B;G=K;J=C;break;case 2:A=C;G=K;J=L;break;case 3:A=C;G=B;J=K;break;case 4:A=L;G=C;J=K;break;case 5:A=K;G=C;J=B;break}return M==0?[K=H(K),K,K]:[H(A),H(G),H(J)]}},rgb2hsv:function(A,D,E){if(A instanceof Array){D=A[1];E=A[2];A=A[0]}A=A/255;D=D/255;E=E/255;var B=Math.min(A,D,E),F=Math.max(A,D,E),G=F-B,I=(F===0)?0:1-(B/F),H=F,C;switch(F){case B:C=0;break;case A:C=60*(D-E)/G;if(D<E){C+=360}break;case D:C=(60*(E-A)/G)+120;break;case E:C=(60*(A-D)/G)+240;break}return[Math.round(C),I,H]},rgb2hex:function(D,C,A){var B=this;if(D instanceof Array){C=D[1];A=D[2];D=D[0]}return B._toFF(D)+B._toFF(C)+B._toFF(A)},hex2rgb:function(B){var A=this;if(!B){B="FFFFFF"}if(B.charAt(0)=="#"){B=B.slice(1)}return[A._to255(B.substr(0,2)),A._to255(B.substr(2,2)),A._to255(B.substr(4,2))]},getTextColor:function(A){A=this.hex2rgb(A);A=this.rgb2hsv(A);return(A&&A[2])>0.6?"#000000":"#FFFFFF"}}});Class("linb.UI.List",["linb.UI","linb.absList","linb.absValue"],{Instance:{_setCtrlValue:function(A){return this.each(function(D){if(!D.domNode){return }var I=D.boxing(),N=I.getUIValue(),B=D.properties,F="ITEM",G=function(P,Q){return D.getSubNode(P,Q)},J=function(P){return D.getSubIdByItemId(P)};if(B.selMode=="single"){var M=J(N);if(N!==null&&M){G(F,M).tagClass("-checked",false)}M=J(A);if(M){G(F,M).tagClass("-checked")}if(M){var C=G(F,M);if(C){var L=C.offsetTop(),K=G("ITEMS"),H=K.scrollHeight(),O=K.scrollTop(),E=K.height();if(H>E){if(L<O||L>O+E){K.scrollTop(L)}}}}}else{if(B.selMode=="multi"){N=N?N.split(";"):[];A=A?A.split(";"):[];_.arr.each(N,function(P){if(_.arr.indexOf(A,P)==-1){G(F,J(P)).tagClass("-checked",false)}});_.arr.each(A,function(P){if(_.arr.indexOf(N,P)==-1){G(F,J(P)).tagClass("-checked")}})}}})},adjustSize:function(){return this.each(function(D){var B=D.getSubNode("ITEMS"),A=D.properties;B.height("auto");var C=Math.min(A.maxHeight,B.offsetHeight());A.height=C;B.height(C);D.root.height(C)})},activate:function(){return linb.absList.prototype.activate.call(this)},_setDirtyMark:function(){return this.each(function(B){var F=B.domId,C=B.properties,A=C.value!==C.$UIvalue,E=linb.UI.$css_tag_dirty;if(B.beforeDirtyMark&&false===B.boxing().beforeDirtyMark(B,A)){}else{var D=B.getSubNode("ITEMS");if(A){D.addClass(E)}else{D.removeClass(E)}}})}},Static:{Templates:{tagName:"div",style:"{_style}",ITEMS:{$order:10,tagName:"div",className:"uibg-base",text:"{items}"},$dynamic:{items:{ITEM:{className:"{itemClass}",style:"{itemStyle}",tagName:"a",href:linb.$href,tabindex:"{_tabindex}",ICON:{style:"background:url({image}) transparent  no-repeat {imagePos};{iconDisplay}",className:"ui-icon",$order:0},CAPTION:{tagName:"text",text:"{caption}&nbsp;",$order:1}}}}},Appearances:{KEY:{"font-size":"12px"},ITEMS:{position:"relative",border:"1px solid #91A7B4",overflow:"auto","overflow-x":(linb.browser.ie||linb.browser.gek)?"hidden":""},ITEM:{display:"block",zoom:linb.browser.ie?1:null,"font-family":'"Verdana", "Helvetica", "sans-serif"',border:0,cursor:"pointer","font-size":"12px",padding:"0 2px 0 2px",position:"relative"},"ITEM-mouseover":{$order:1,"background-color":"#d9e8fb"},"ITEM-checked":{$order:2,"background-color":"#316AC5",color:"#fff"}},Behaviors:{HoverEffected:{ITEM:"ITEM"},ClickEffected:{ITEM:"ITEM"},DragableKeys:["ITEM"],DropableKeys:["ITEM","ITEMS"],onSize:function(C,D){var E=C.domNode.style,A=null,B=null;if(D.height){B=parseInt(E.height)||A}if(D.width){A=parseInt(E.width)||B}linb.UI.$tryResize(C,A,B)},ITEM:{onDblclick:function(B,D,E){var A=B.properties,C=B.getItemByDom(E);B.boxing().onDblclick(B,C,E)},onClick:function(C,J,A){var L=C.properties,P=C.getItemByDom(A),M=C.getSubId(A.id),I=C.boxing(),N=linb.Event.getKey(J),E,B;if(L.disabled||P.disabled){return false}switch(L.selMode){case"none":E=I.onItemSelected(C,P,A);break;case"multi":var O=I.getUIValue(),H=O?O.split(";"):[];if(H.length&&(N[1]||N[2]||L.$checkbox)){B=false;if(N[2]){var K=L.items,F=_.arr.subIndexOf(K,"id",C.$firstV.id),D=_.arr.subIndexOf(K,"id",P.id),G;H.length=0;for(G=Math.min(F,D);G<=Math.max(F,D);G++){H.push(K[G].id)}}else{if(_.arr.indexOf(H,P.id)!=-1){_.arr.removeValue(H,P.id)}else{H.push(P.id)}}H.sort();O=H.join(";");if(I.getUIValue()!=O){I.setUIValue(O);if(I.getUIValue()==O){E=I.onItemSelected(C,P,A)||B}}break}case"single":if(I.getUIValue()==P.id){E=false}else{C.$firstV=P;I.setUIValue(P.id);if(I.getUIValue()==P.id){E=I.onItemSelected(C,P,A)}}break}linb(A).focus();return E},onKeydown:function(C,F,A){var J=linb.Event.getKey(F),I=J[0],B=J[2],H=linb(A),E=C.root.nextFocus(true,true,false),G=C.root.nextFocus(false,true,false);switch(linb.Event.getKey(F)[0]){case"tab":if(B){if(A!=E.get(0)){E.focus();return false}}else{if(A!=G.get(0)){G.focus();return false}}break;case"left":case"up":var D=H.nextFocus(false,true,false);if(H.get(0)==E.get(0)){G.focus()}else{H.nextFocus(false)}return false;break;case"right":case"down":var D=H.nextFocus(true,false,false);if(H.get(0)==G.get(0)){E.focus()}else{H.nextFocus()}return false;break;case"enter":linb(A.id).onClick();return false;break}}}},DataModel:({tabindex:{action:function(A){if(this.domNode){this.getSubNode("ITEM",true).attr("tabIndex",A)}}},selMode:{ini:"single",listbox:["single","none","multi"]},width:120,height:150,maxHeight:300}),EventHandlers:{onDblclick:function(A,B,C){},onItemSelected:function(A,B,C){}},_ensureValue:function(B,C){if(B.properties.selMode=="multi"){var A=(C||"").split(";");A.sort();return A.join(";")}else{return C}},_onStartDrag:function(A,B,C,D){var D=linb.Event.getPos(B);linb([C]).startDrag(B,{dragType:"icon",shadowFrom:C,targetLeft:D.left+12,targetTop:D.top+12,dragCursor:"pointer",dragDefer:1,dragKey:A.box.getDragKey(A,C),dragData:A.box.getDragData(A,C)});return false},_onDropTest:function(B,F,H,A,D,C){var G=D&&D.domId,E=H.id;if(G){if(G==E){return false}if(_.get(H,["previousSibling","id"])==G){return false}}},_onDrop:function(D,H,B,I,G,K){linb.DragDrop.setDragIcon("none");var F=D.getKey(B.id),C=G.profile,A=G.domId,E,J=linb.absObj.$specialChars;E=_.clone(C.getItemByDom(A),function(M,L){return !J[(L+"").charAt(0)]});C.boxing().removeItems([E.id]);if(F==D.keys.ITEM){D.boxing().insertItems([E],K.id,true)}else{D.boxing().insertItems([E],null,false)}return false},_onresize:function(F,E,A){var D=F.properties,C,B=F.getSubNode("ITEMS");if(!parseInt(F.domNode.style.height)){return }B.height(A)}}});Class("linb.UI.Tabs",["linb.UI","linb.absList","linb.absValue"],{Instance:{_setCtrlValue:function(A){this.each(function(C){var B=C.domId,E=C.boxing(),I=E.getUIValue(),F=C.properties,G=C.getSubIdByItemId(I),J,K;if(I&&C.getSubIdByItemId(I)){C.getSubNodes(["ITEM","BOX"],G).tagClass("-checked",false);if(E.KEY!="linb.UI.Tabs"||F.hasPanel){E.getPanel(I).hide()}}G=C.getSubIdByItemId(A);if(G){C.getSubNodes(["ITEM","BOX"],G).tagClass("-checked");if(E.KEY!="linb.UI.Tabs"||F.hasPanel){E.getPanel(A).show("auto",C.getSubNode("LIST").offsetHeight()+"px");K=C.root.cssSize();linb.UI.$tryResize(C,parseInt(K.width)||null,parseInt(K.height)||null,A);if(F.dynRender){var D=C.children,H=[];_.arr.each(D,function(L){if(L[1]==A&&!L[0]["parent:"+C.$id]){H.push(L[0]);L[0]["parent:"+C.$id]=1}});if(H.length){E.append(linb.UI.pack(H),A)}}}}})},append:function(C,A){var B=this.get(0).properties;if(A=A||B.$UIvalue||B.value){arguments.callee.upper.call(this,C,A)}return this},getCurPanel:function(){var A=this.get(0);return this.getPanel(A.properties.$UIvalue)},getPanel:function(A){var B=this.get(0);return B.getSubNodeByItemId("PANEL",A)},addPanel:function(B,E,F){var D={},G=F&&F.id;if(!G){var C=this.getItems();if(C.length){G=C[C.length-1].id}}_.merge(D,{caption:B.caption,image:B.image,closeBtn:B.closeBtn||false,landBtn:B.landBtn||false,optBtn:B.optBtn||false,imagePos:B.imagePos,dragKey:B.dragKey,dropKeys:B.dropKeys,id:B.id||B.tag||_.id()});this.insertItems([D],G);var A=[];_.arr.each(E,function(H){A.push(H[0])});this.append(linb.UI.pack(A,false),D.id)},removePanel:function(C){var A=this,B=A.getItemByDom(C);return A.removeItems([B.id])},getPanelPara:function(E){var C=this.get(0),B=C.properties,D=C.getItemByDom(E),A=_.clone(D);if(!A.dragKey){A.dragKey=B.dragKey}if(!A.dropKeys){A.dropKeys=B.dropKeys}return A},getPanelChildren:function(C){var B=this.get(0),D=B.getItemIdByDom(C),A=[];if(D){_.arr.each(B.children,function(E){if(E[1]==D){A.push(E)}})}return A},fireItemClickEvent:function(A){var B=this.get(0),C=B.getSubNodeByItemId("ITEM",A);if(C.isEmpty()){B.boxing().setUIValue(null)}else{C.onMousedown()}return this},_afterInsertItems:function(C,E,A,G){var F=C.box,D,H,B=C.properties;if(B.hasPanel&&(D=C.root)){D.append(_.str.toDom(C.buildItems("panels",E)));if(!(H=this.getUIValue())){this.fireItemClickEvent((H=B.items[0])&&(H=H.id))}var I=C.domNode.style;linb.UI.$tryResize(C,parseInt(I.width)||null,parseInt(I.height)||null,H)}},removeItems:function(A){var B=this,D,C;if(!_.isArr(A)){A=[A]}B.each(function(E){if(E.properties.hasPanel){_.arr.each(A,function(F){C=E.getSubIdByItemId(F);if(C&&!(D=E.getSubNode("PANEL",C)).isEmpty()){D.remove()}})}});arguments.callee.upper.apply(B,arguments);B.each(function(F){if(F.properties.hasPanel){if(_.arr.indexOf(A,F.boxing().getUIValue())!=-1){var E;F.boxing().fireItemClickEvent((E=F.properties.items[0])&&E.id)}linb.UI.$tryResize(F,F.root.width(),F.root.height(),F.boxing().getUIValue())}});return B},clearItems:function(){var A=this;A.each(function(B){if(B.properties.hasPanel){B.getSubNode("PANEL",true).remove()}});A.setValue(null,true);arguments.callee.upper.apply(A,arguments);return A},markItemCaption:function(B,F,D){var C=this.get(0);B=C.getItemByItemId(B);if((B._dirty!=F)||D){var E=B.id,A=C.getItemByItemId(E).caption;C.getSubNodeByItemId("CAPTION",E).html(C.getItemByItemId(E).caption=F?("*"+A):A.replace(/^\*/,"")).css("fontStyle",F?"italic":"normal");B._dirty=F}return this}},Static:{Templates:{tagName:"div",style:"{_style};",LIST:{$order:0,tagName:"div",ITEMS:{tagName:"div",text:"{items}",style:"{HAlign}"}},PNAELS:{$order:1,tagName:"text",text:"{panels}"},$dynamic:{items:{ITEM:{className:"{itemClass}",style:"{itemStyle}",BOX:{HANDLE:{tagName:"a",href:"{href}",tabindex:"{_tabindex}",IBWRAP:{tagName:"div",style:"white-space:nowrap;",RULER:{},ICON:{style:"background:url({image}) transparent  no-repeat {imagePos};{iconDisplay}",className:"ui-icon",$order:0},CAPTION:{text:"{caption}",$order:1},CMDS:{$order:2,OPT:{$order:1,className:"uicmd-opt",style:"{_opt}"},LAND:{className:"uicmd-land",style:"{landDisplay}",$order:1},CLOSE:{className:"uicmd-close ",style:"{closeDisplay}",$order:2}}}}}}},panels:{PANEL:{tagName:"div",className:"uibg-base",text:linb.UI.$childTag}}}},Appearances:{KEY:{position:"absolute",overflow:"hidden"},LIST:{position:"relative"},ITEMS:{"padding-left":"4px","padding-right":"4px",position:"relative",background:linb.UI.$bg("dot.gif"," repeat-x center bottom",true)},ITEM:{$order:0,"font-family":'"Verdana", "Helvetica", "sans-serif"',cursor:"pointer","padding-right":"6px","vertical-align":"top","border-bottom":"1px solid #91A7B4",background:linb.UI.$bg("top.gif"," no-repeat right top")},"ITEM-mouseover":{$order:1,"background-position":"right -100px"},"ITEM-mousedown":{$order:2,"background-position":"right -200px","border-bottom":"1px solid #fff"},"ITEM-checked":{$order:3,"background-position":"right -200px","border-bottom":"1px solid #fff"},BOX:{$order:0,padding:"6px 0 2px 6px",border:0,"vertical-align":"top","text-align":"center",background:linb.UI.$bg("top.gif"," no-repeat left -50px")},"BOX-mouseover":{$order:1,"background-position":"left -150px"},"BOX-mousedown":{$order:2,"background-position":"left -250px"},"BOX-checked":{$order:3,"background-position":"left -250px"},HANDLE:{display:linb.$inlineBlock,zoom:linb.browser.ie6?1:null,cursor:"pointer","vertical-align":"middle","font-size":"12px"},RULER:{height:"18px",width:"1px","vertical-align":"middle"},PANEL:{position:"absolute",visibility:"hidden",top:"-10000px",left:"-10000px",width:"100%",overflow:"auto"},CAPTION:{"vertical-align":"middle"},CMDS:{"vertical-align":"top"},"CMDS  span":{"margin-left":"4px"}},Behaviors:{DropableKeys:["PANEL","KEY","ITEM"],DragableKeys:["ITEM"],HoverEffected:{ITEM:["ITEM","BOX"],OPT:"OPT",CLOSE:"CLOSE",LAND:"LAND"},ClickEffected:{ITEM:["ITEM","BOX"],OPT:"OPT",CLOSE:"CLOSE",LAND:"LAND"},onSize:function(C,D){var E=C.domNode.style,A=null,B=null;if(D.height){B=parseInt(E.height)||null}if(D.width){A=parseInt(E.width)||null}linb.UI.$tryResize(C,A,B,C.properties.$UIvalue)},OPT:{onMousedown:function(){return false},onClick:function(A,B,C){A.boxing().onShowOptions(A,A.getItemByDom(C),B,C);return false}},CAPTION:{onMousedown:function(B,E,F){if(linb.Event.getBtn(E)!="left"){return }var A=B.properties,D=B.getItemByDom(F),C=B.boxing();if(A.disabled){return false}if(C.getUIValue()==D.id){if(B.onCaptionActive){B.boxing().onCaptionActive(B,B.getItemByDom(F),F)}}}},ITEM:{onClick:function(A,B,C){return false},onMousedown:function(B,E,G){if(linb.Event.getBtn(E)!="left"){return false}if(B.getKey(linb.Event.getSrc(E).parentNode.id)==B.keys.CMDS){return false}var A=B.properties,F=B.getSubId(G.id),D=B.getItemByDom(G),C=B.boxing();if(A.disabled){return false}if(C.getUIValue()==D.id){return }B.getSubNode("HANDLE",F).focus();C.setUIValue(D.id);if(C.getUIValue()==D.id){C.onItemSelected(B,D,G);return false}}},HANDLE:{onClick:function(A,B,C){return !!linb.Event.getKey(B)[2]},onKeydown:function(C,F,A){var K=linb.Event.getKey(F),J=K[0],B=K[2];if(J==" "||J=="enter"){C.getSubNode("ITEM",C.getSubId(A.id)).onMousedown();return false}var I=linb([A]),G=C.getSubNode("ITEMS"),E=G.nextFocus(true,true,false),H=G.nextFocus(false,true,false);switch(J){case"tab":if(B){if(A!=E.get(0)){E.focus();return false}}else{if(A!=H.get(0)){H.focus();return false}}break;case"left":case"up":var D=I.nextFocus(false,true,false);if(I.get(0)==E.get(0)){H.focus()}else{I.nextFocus(false)}return false;break;case"right":case"down":var D=I.nextFocus(true,false,false);if(I.get(0)==H.get(0)){E.focus()}else{I.nextFocus()}return false;break}}},CLOSE:{onMousedown:function(){return false},onClick:function(D,F,G){var C=D.properties,E=D.getItemByDom(G),B;if(C.disabled){return }var A=D.boxing();if(false===A.beforePageClose(D,E,G)){return }B=_.copy(E);A.removeItems(E.id);A.afterPageClose(D,B);linb.UI.$tryResize(D,D.root.width(),D.root.height(),C.$UIvalue);return false}},LAND:{onMousedown:function(){return false},onClick:function(D,F,A){var H=D.properties,K=D.getItemByDom(A),C=K.id;if(H.disabled){return }var B=D.boxing().getPanel(C),I=D.root.offset(),L=D.root.cssSize(),J=_.copy(linb.UI.Dialog.$DataStruct);_.merge(J,K,"with");_.merge(J,{dragKey:K.dragkey||H.dragKey,dock:"none",tag:K.tag||K.id,width:Math.max(L.width,200),height:Math.max(L.height,100),left:I.left,top:I.top},"all");var G=new linb.UI.Dialog(J);linb("body").append(G);var E=[];_.arr.each(D.children,function(M){if(M[1]==C){E.push(M[0])}},null,true);if(E.length){G.append(linb.UI.pack(E,false))}D.boxing().removeItems(C);return false}}},DataModel:{dataBinder:null,dataField:null,dock:"fill",hasPanel:true,width:200,height:200,position:"absolute",HAlign:{ini:"left",listbox:["left","center","right"],action:function(A){if(this.domNode){this.getSubNode("ITEMS").css("textAlign",A)}}},tabindex:{action:function(A){if(this.domNode){this.getSubNode("HANDLE",true).attr("tabIndex",A)}}},dynRender:true,dropKeysPanel:"",value:{ini:""},items:{set:function(A){return this.each(function(H){if(H.domNode){var F=H.boxing(),G,C=linb.Dom.getEmptyDiv(),E=_.copy(H.children);H.children.length=0;_.arr.each(E,function(I){delete I[0].$dockParent;C.append(I[0].root)});var B=H.properties.value;F.clearItems();linb.Dom.__gc();F.insertItems(A);_.arr.each(E,function(I){F.append.apply(F,I)});C.empty();F.setValue(B,true);var D=H.root.cssSize();linb.UI.$tryResize(H,D.width,D.height,H.properties.$UIvalue)}else{H.properties.items=A}})}}},EventHandlers:{beforePageClose:function(A,B,C){},afterPageClose:function(A,B){},onShowOptions:function(A,B,C,D){},onItemSelected:function(A,B,C){},onCaptionActive:function(A,B,C){}},RenderTrigger:function(){var B=this,A,D,C;if(A=B.properties.value){(C=B.boxing()).setUIValue(A);if(D=B.getItemByItemId(A)){C.onItemSelected(B,D)}}},_getChildren:function(A){if(!A.properties.dynRender){return A.children}},_prepareData:function(A){var B=arguments.callee.upper.call(this,A);B.panels=B.items;B.HAlign="text-align:"+B.HAlign+";";return B},_prepareItem:function(A,B){var C="display:none";B.closeDisplay=B.closeBtn?"":C;B.landDisplay=B.landBtn?"":C;B._opt=B.optBtn?"":C;B.href=B.href||linb.$href},getDropKeys:function(A,B){return A.properties[A.getKey(B.id)==A.keys.PANEL?"dropKeys":"dropKeysPanel"]},_showTips:function(B,D,G){var F=D.id,E=B.properties,C=B.keys,A=B.getKey(F);if(!F){return false}if(B.onShowTips){return B.boxing().onShowTips(B,D,G)}else{return arguments.callee.upper.apply(this,arguments)}},_onresize:function(D,A,J,I){var L=D.properties,C=D.boxing().getPanel(I),K=D.getItemByItemId(I),F=D.getSubNode("LIST"),B=0,H;if(!C||C.isEmpty()){return }if(!parseInt(D.domNode.style.height)){J=null}var E=null,G=null;if(A&&K._w!=A){J=D.domNode.offsetHeight||D.getRoot().offsetHeight();B=1}if((J&&K._h!=J)||B){K._h=J;H=F.get(0).offsetHeight||F.offsetHeight();J=J-H+(linb.browser.ie6?2:1);if(J>0){G=J}}if(H){C.top(H)}if(G){C.height(G).onSize()}}}});Class("linb.UI.Stacks","linb.UI.Tabs",{Static:{Appearances:{KEY:{overflow:"visible"},LIST:{position:"static"},ITEMS:{position:"static"},ITEM:{$order:0,display:"block",position:"absolute",cursor:"pointer",background:linb.UI.$bg("barvbg.gif"," repeat-x left top",true),height:"22px",width:"100%",left:0},BOX:{display:"block"},"ITEM-mouseover":{$order:1,"background-position":"right -22px"},"ITEM-mousedown":{$order:1,"background-position":"right -44px"},"ITEM-checked":{$order:1,"background-position":"right -44px"},HANDLE:{cursor:"pointer",display:"block","font-size":"12px",height:"100%","padding-left":"6px","white-space":"nowrap"},CAPTION:{margin:"2px"},PANEL:{position:"absolute",visibility:"hidden",top:"-10000px",left:"-10000px",overflow:"auto"},CMDS:{position:"absolute",top:"3px",right:"2px","text-align":"right","vertical-align":"middle"}},_onresize:function(C,A,L,J){var M=C.properties,K,H,F,E,I,D=null,G=null,B=C.boxing().getPanel(J);if(!B||B.isEmpty()){return }if(L){F=H=0;_.arr.each(M.items,function(N){E=C.getSubNodeByItemId("ITEM",N.id);E.cssRegion({bottom:"auto",top:H});H+=E.height();if(N.id==J){return false}});_.arr.each(M.items,function(N){if(N.id==J){return false}E=C.getSubNodeByItemId("ITEM",N.id);E.cssRegion({top:"auto",bottom:F});F+=E.height()},null,true);K=L-H-F;if(K>0){I=H;G=K}}if(A){D=A}B.cssRegion({width:D?D:null,height:G?G:null,top:I,left:0},true);if(D){C.getSubNode("LIST").width(D)}}}});Class("linb.UI.Panel","linb.UI.Div",{Static:{Templates:{tagName:"div",style:"{_style}",BORDER:{tagName:"div",BAR:{tagName:"div",className:"uibar-bar",style:"{barDisplay};height:{barHeight}px",BART:{cellpadding:"0",cellspacing:"0",width:"100%",height:"100%",border:"0",tagName:"table",className:"uibar-t",BARTR:{tagName:"tr",BARTDL:{tagName:"td",className:"uibar-tdl"},BARTDM:{$order:1,width:"100%",tagName:"td",className:"uibar-tdm"},BARTDR:{$order:2,tagName:"td",className:"uibar-tdr"}}},BARCMDL:{tagName:"div",className:"uibar-cmdl",TOGGLE:{className:"uicmd-toggle {toggleCls}",style:"{toggleDisplay}",$order:0},ICON:{style:"background:url({image}) transparent  no-repeat {imagePos}; {iconDisplay}",className:"ui-icon",$order:0},CAPTION:{tagName:"a",href:"{href}",tabindex:"{tabindex}",text:"{caption}",$order:1}},BARCMDR:{tagName:"div",className:"uibar-cmdr",onselectstart:"return false",unselectable:"on",OPT:{className:"uicmd-opt",style:"{optDisplay}",$order:1},LAND:{className:"uicmd-land",style:"{landDisplay}",$order:1},CLOSE:{className:"uicmd-close ",style:"{closeDisplay}",$order:2}}},PANEL:{$order:1,tagName:"div",className:"uibg-base",style:"{panelDisplay}",text:"{html}"+linb.UI.$childTag}}},Appearances:{KEY:{overflow:"hidden",background:"transparent"},"KEY BORDER":{zoom:linb.browser.ie6?1:null},PANEL:{position:"relative",left:0,top:0,overflow:"auto",zoom:linb.browser.ie6?1:null},CAPTION:{"font-size":"12px",display:"inline","vertical-align":"middle"}},Behaviors:{DropableKeys:["PANEL"],DragableKeys:["BAR"],HoverEffected:{OPT:"OPT",CLOSE:"CLOSE",LAND:"LAND",TOGGLE:"TOGGLE"},ClickEffected:{CLOSE:"CLOSE",OPT:"OPT",LAND:"LAND",TOGGLE:"TOGGLE"},onSize:function(C,D){var E=C.root,A=null,B=null;if(D.height){B=E.height()}if(D.width){A=E.width()}linb.UI.$tryResize(C,A,B)},OPT:{onClick:function(A,B,C){A.boxing().onShowOptions(A,B,C)}},TOGGLE:{onClick:function(A,B,C){A.box._toggle(A,!A.properties.toggle);return false}},CAPTION:{onClick:function(A,B,C){if(!A.onClickBar||false===A.boxing().onClickBar(A,C)){return !!linb.Event.getKey(B)[2]}}},CLOSE:{onClick:function(C,D,E){var B=C.properties;if(B.disabled){return }var A=C.boxing();if(false===A.beforeClose(C)){return }A.destroy();return false}},LAND:{onClick:function(B,D,A){var E=B.properties;if(E.disabled){return }var G=B.root.offset(),I=B.root.cssSize();var H=_.copy(linb.UI.Dialog.$DataStruct);_.merge(H,E,"with");_.merge(H,{dock:"none",width:Math.max(I.width,200),height:Math.max(I.height,100),left:G.left,top:G.top},"all");var F=new linb.UI.Dialog(H),C=[];linb("body").append(F);_.arr.each(B.children,function(J){C.push(J[0])});F.append(linb.UI.pack(C,false));B.boxing().destroy();return false}}},DataModel:{position:"absolute",zIndex:0,dock:"fill",caption:{ini:undefined,action:function(A){this.getSubNode("CAPTION").get(0).innerHTML=A}},image:{action:function(A){this.getSubNode("ICON").css("display",A?"":"none").css("backgroundImage","url("+(A||"")+")")}},imagePos:{action:function(A){this.getSubNode("ICON").css("backgroundPosition",A)}},tabindex:{action:function(A){if(this.domNode){this.getSubNode("CAPTION").attr("tabIndex",A)}}},href:{ini:linb.$href,action:function(A){if(this.domNode){this.getSubNode("CAPTION").attr("href",A)}}},html:{action:function(A){this.getSubNode("PANEL").html(A)}},barHeight:{ini:22,action:function(A){this.getSubNode("TB").height(A);this.getSubNode("BAR").css("display",A?"":"none")}},toggle:{ini:true,action:function(A){this.box._toggle(this,A)}},optBtn:{ini:false,action:function(A){this.getSubNode("OPT").css("display",A?"":"none")}},toggleBtn:{ini:false,action:function(A){this.getSubNode("TOGGLE").css("display",A?"":"none")}},closeBtn:{ini:false,action:function(A){this.getSubNode("CLOSE").css("display",A?"":"none")}},landBtn:{ini:false,action:function(A){this.getSubNode("LAND").css("display",A?"":"none")}}},EventHandlers:{beforeClose:function(A,B){},onIniPanelView:function(A){},onFold:function(A){},onExpend:function(A){},onShowOptions:function(A,B,C){},onClickBar:function(A,B){}},LayoutTrigger:function(){var B=this,C=B.properties,A=B.box;if(C.toggle){A._toggle(B,C.toggle)}},_prepareData:function(B){var C=arguments.callee.upper.call(this,B);var A="display:none";C.panelDisplay=C.toggle?"":A;C.toggleCls=C.toggle?"":B.getClass("TOGGLE","-checked");C.toggleDisplay=C.toggleBtn?"":A;C.optDisplay=C.optBtn?"":A;C.closeDisplay=C.closeBtn?"":A;C.landDisplay=C.landBtn?"":A;C.barDisplay=C.barHeight?"":A;return C},_onresize:function(C,B,A){if(A&&parseInt(C.domNode.style.height)){C.getSubNode("BORDER").height(A);C.getSubNode("PANEL").height(A-C.properties.barHeight)}if(B&&parseInt(C.domNode.style.width)){C.getSubNode("PANEL").width(B)}},_toggle:function(B,C){var D=B.properties,A=B.boxing();D.toggle=C;if(C&&!B.$ini){if(A.onIniPanelView){if(A.onIniPanelView(B)!==false){B.$ini=true}}}if(C){if(false===A.onExpend(B)){return }}else{if(false===A.onFold(B)){return }}B.getSubNode("PANEL").css("display",C?"":"none");if(D.toggleBtn){B.getSubNode("TOGGLE").tagClass("-checked",!C)}}}});Class("linb.UI.Image","linb.UI",{Instance:{getRate:function(){return parseFloat(this.get(0)._rate)||1}},Static:{Templates:{tagName:"image",style:"{_style}",border:"0",width:"{width}",height:"{height}"},Behaviors:{HoverEffected:{KEY:"KEY"},ClickEffected:{KEY:"KEY"},DragableKeys:["KEY"],onError:function(A,B,C){A.boxing().onError(A)},onLoad:function(C,E,F){var B=new Image(),D=B.src=F.src,A=C.box._adjust(C,B.width,B.height);C.boxing().afterLoad(C,D,A[0],A[1])}},RenderTrigger:function(){var B=this,C=B.properties,A=C.src;if(A){C.value=C.$UIvalue="";B.boxing().setSrc(A,true)}},EventHandlers:{onError:function(A){},beforeLoad:function(A){},afterLoad:function(C,D,B,A){}},_adjust:function(E,D,A){var H=E.properties,G=E.getRootNode();if(D>0&&A>0){var C=H.maxWidth/D,B=H.maxHeight/A,F=C<B?C:B;if(F>=1){F=1}E._rate=F;G.width=D*F;G.height=A*F;return[D*F,A*F]}return[0,0]},DataModel:{maxWidth:{ini:800,action:function(A){var B=this.getRootNode();this.box._adjust(this,B.width,B.height)}},maxHeight:{ini:600,action:function(A){var B=this.getRootNode();this.box._adjust(this,B.width,B.height)}},width:{ini:"auto",action:function(A){var B=this.getRootNode();B.width=A}},height:{ini:"auto",action:function(A){var B=this.getRootNode();B.height=A}},src:{action:function(B){var A=this;if(false!==A.boxing().beforeLoad(this)){_.asyRun(function(){A.root.attr({width:"0",height:"0",src:B})})}}}}}});Class("linb.UI.IconList","linb.UI.List",{Instance:{getStatus:function(B){var A=this.get(0).getItemByItemId(B);return(A&&A._status)||"ini"}},Initialize:function(){var A=this.getTemplate();A.$dynamic={items:{ITEM:{className:"{itemClass}",style:"padding:{itemPadding}px;margin:{itemMargin}px;{itemStyle}",IBWRAP:{tagName:"div",IMAGE:{tagName:"img",src:"{image}",width:"{itemWidth}",height:"{itemHeight}"}}}}};this.setTemplate(A)},Static:{Appearances:{KEY:{overflow:"auto","overflow-x":(linb.browser.ie||linb.browser.gek)?"hidden":""},ITEMS:{overflow:"auto","overflow-x":(linb.browser.ie||linb.browser.gek)?"hidden":"",position:"relative","line-height":"14px",zoom:linb.browser.ie6?1:null,background:"url("+linb.ini.file_bg+") no-repeat left top"},ITEM:{display:linb.$inlineBlock,zoom:linb.browser.ie6?1:null,position:"relative",overflow:"hidden",cursor:"pointer","vertical-align":"top"},IMAGE:{border:"1px solid #CDCDCD"}},Behaviors:{IMAGE:{onLoad:function(A,C,D){var B=A.getItemByDom(D);B._status="loaded"},onError:function(A,C,D){var B=A.getItemByDom(D);B._status="error"}}},DataModel:({itemMargin:{ini:6,action:function(A){if(typeof A!="object"){this.getSubNode("ITEM",true).css("margin",(""+parseFloat(A))==(""+A)?A+"px":A)}else{this.getSubNode("ITEM",true).css(A)}}},itemPadding:{ini:2,action:function(A){if(typeof A!="object"){this.getSubNode("ITEM",true).css("padding",(""+parseFloat(A))==(""+A)?A+"px":A)}else{this.getSubNode("ITEM",true).css(A)}}},itemWidth:{ini:16,action:function(A){this.getSubNode("IMAGE",true).width(A)}},itemHeight:{ini:16,action:function(A){this.getSubNode("IMAGE",true).height(A)}},tabindex:{action:function(A){if(this.domNode){this.getSubNode("ITEM",true).attr("tabIndex",A)}}},width:200,height:200}),_prepareItem:function(A,B){var C=A.properties;_.arr.each(_.toArr("itemWidth,itemHeight,itemPadding,itemMargin"),function(D){B[D]=B[D]||C[D]});B._tabindex=C.tabindex},_onresize:function(){}}});Class("linb.UI.Dialog","linb.UI.Widget",{Instance:{show:function(A,B,D,C){A=A||linb("body");return this.each(function(I){var H,J=I.properties,E=I.boxing(),G=function(){A.append(I.boxing());var N=I.box,K=I.root,M=K.topZindex(),L=K.css("zIndex");K.css("zIndex",M>L?M:L).show(D?(parseInt(D)||0)+"px":null,C?(parseInt(C)||0)+"px":null);if(B&&!I.$inModal){N._modal(I)}N._active(I);if(I.onShow){I.boxing().onShow(I)}N._refreshRegion(I);_.asyRun(function(){K.nextFocus()});delete I.inShowing},F=I.root;if(F.get(0)._hide===0){return }if(I.inShowing){return }I.inShowing=1;if(H=J.fromRegion){linb.Dom.animate({border:"dashed 1px #ff0000"},{left:[H.left,J.left],top:[H.top,J.top],width:[H.width,J.width],height:[H.height,J.height]},null,G,360,12,"expoIn").start()}else{G()}})},hide:function(){this.each(function(D){var F=D.properties,E=D.box,B=D.root;if(B.get(0)._hide==1){return }if(D.inHiding){return }D.inHiding=1;if(D.$inModal){E._unModal(D)}if(F.status=="max"||F.status=="min"){E._restore(D)}B.hide();var C=F.fromRegion,A=function(){delete D.inHiding};if(C){linb.Dom.animate({border:"dashed 1px #ff0000"},{left:[F.left,C.left],top:[F.top,C.top],width:[F.width,C.width],height:[F.height,C.height]},null,A,360,12,"expoOut").start()}else{A()}});return this},close:function(){return this.each(function(C){if(C.beforeClose&&false===C.boxing().beforeClose(C)){return }if(C.inClosing){return }C.inClosing=1;var D=C.properties,B=D.fromRegion,A=function(){C.boxing().destroy();delete C.inClosing};if(B){linb.Dom.animate({border:"dashed 1px #ff0000"},{left:[D.left,B.left],top:[D.top,B.top],width:[D.width,B.width],height:[D.height,B.height]},null,A,360,12,"expoOut").start()}else{A()}})}},Initialize:function(){var A=this.getTemplate();_.merge(A.FRAME.BORDER,{BAR:{tagName:"div",className:"uibar-bar",style:"{barDisplay};height:{_barHeight}px;",BART:{cellpadding:"0",cellspacing:"0",width:"100%",height:"100%",border:"0",tagName:"table",className:"uibar-t",BARTR:{tagName:"tr",BARTDL:{tagName:"td",className:"uibar-tdl"},BARTDM:{$order:1,width:"100%",tagName:"td",className:"uibar-tdm"},BARTDR:{$order:2,tagName:"td",className:"uibar-tdr"}}},BARCMDL:{tagName:"div",className:"uibar-cmdl",ICON:{$order:0,className:"ui-icon",style:"background:url({image}) transparent no-repeat  {imagePos};{iconDisplay}"},CAPTION:{$order:1,text:"{caption}"}},BARCMDR:{tagName:"div",className:"uibar-cmdr",onselectstart:"return false",unselectable:"on",OPT:{className:"uicmd-opt",style:"{optDisplay}",$order:1},PIN:{$order:2,className:"uicmd-pin",style:"{pinDisplay}"},LAND:{$order:3,className:"uicmd-land",style:"{landDisplay}"},MIN:{$order:4,className:"uicmd-min",style:"{minDisplay}"},RESTORE:{$order:5,className:"uicmd-restore",style:"display:none;"},MAX:{$order:6,className:"uicmd-max",style:"{maxDisplay}"},CLOSE:{$order:7,className:"uicmd-close ",style:"{closeDisplay}"}}},PANEL:{tagName:"div",$order:2,className:"uibg-base",text:"{html}"+linb.UI.$childTag},STATUS:{tagName:"div",$order:3}},"all");this.setTemplate(A)},Static:{Appearances:{KEY:{overflow:"visible"},PANEL:{position:"absolute",left:0,overflow:"auto","background-color":"#FFF",border:"solid 1px #BBB","border-top":0},STATUS:{position:"absolute",left:0,bottom:0,height:0,"*font-size":0,"*line-height":0},CAPTION:{"font-size":"12px",display:"inline","vertical-align":"middle"},"BAR-focus BART":{$order:1,"background-position":"right -22px"},MIN:{background:linb.UI.$bg("cmds.gif"," -16px 0",true),$order:0},"MIN-mouseover":{$order:1,"background-position":" -16px -16px"},"MIN-mousedown":{$order:2,"background-position":"-16px -32px"},RESTORE:{background:linb.UI.$bg("cmds.gif"," -32px 0",true)},"RESTORE-mouseover":{$order:1,"background-position":"-32px -16px"},"RESTORE-mousedown":{$order:2,"background-position":"-32px -32px"},MAX:{background:linb.UI.$bg("cmds.gif"," -48px 0",true)},"MAX-mouseover":{$order:1,"background-position":"-48px -16px"},"MAX-mousedown":{$order:2,"background-position":"-48px -32px"},PIN:{background:linb.UI.$bg("cmds.gif"," 0 0",true)},"PIN-mouseover":{$order:1,"background-position":"0 -16px"},"PIN-mousedown":{$order:2,"background-position":" 0 -32px"},"PIN-checked, PIN-checked-mouseover":{$order:2,"background-position":"0 -32px"}},Behaviors:{DropableKeys:["PANEL"],DragableKeys:["LAND"],HoverEffected:{OPT:"OPT",PIN:"PIN",MIN:"MIN",MAX:"MAX",RESTORE:"RESTORE",CLOSE:"CLOSE",LAND:"LAND"},ClickEffected:{OPT:"OPT",PIN:"PIN",MIN:"MIN",MAX:"MAX",RESTORE:"RESTORE",CLOSE:"CLOSE",LAND:"LAND"},onMousedown:function(A,B){A.box._active(A)},onDragstop:function(A){var C=A.root.cssPos(),B=A.properties;B.left=C.left;B.top=C.top},BAR:{onMousedown:function(A,B,C){if(A.getKey(linb.Event.getSrc(B).parentNode.id)==A.keys.BARCMDR){return }if(A.properties.movable&&!A._locked){A.box._active(A);A.root.startDrag(B,{dragDefer:1,targetOffsetParent:A.root.parent()})}},onDblclick:function(A,B,C){if(A.getKey(linb.Event.getSrc(B).parentNode.id)==A.keys.BARCMDR){return }if(!A.properties.maxBtn){return }if(A.properties.status=="max"){A.box._restore(A)}else{A.box._max(A)}}},PIN:{onClick:function(C,D,E){var B=C.keys.PIN,A=C.properties;A.pinned=!A.pinned;C.getSubNode("PIN").tagClass("-checked",A.pinned);C._locked=A.pinned;if(A.resizer){if(!A.pinned){if(A.status!="min"&&C.$resizer){C.$resizer.show()}}else{if(C.$resizer){C.$resizer.hide()}}}}},MIN:{onClick:function(A,B,C){A.box._min(A)}},MAX:{onClick:function(A,B,C){A.box._max(A)}},RESTORE:{onClick:function(A,B,C){A.box._restore(A)}},OPT:{onClick:function(A,B,C){A.boxing().onShowOptions(A,B,C)}},CLOSE:{onClick:function(A,B,C){A.boxing().close()}}},DataModel:{$border:0,tips:null,border:null,disabled:null,dock:{hidden:true},html:{action:function(A){this.getSubNode("PANEL").html(A)}},caption:{ini:undefined,action:function(A){this.getSubNode("CAPTION").get(0).innerHTML=A}},image:{action:function(A){this.getSubNode("ICON").css("display",A?"":"none").css("backgroundImage","url("+(A||"")+")")}},imagePos:{action:function(A){this.getSubNode("ICON").css("backgroundPosition",A)}},shadow:true,resizer:true,movable:true,minBtn:{ini:true,action:function(A){var B=this.getSubNode("MIN");if(A){B.setInlineBlock()}else{B.css("display","none")}}},maxBtn:{ini:true,action:function(A){var B=this.getSubNode("MAX");if(A){B.setInlineBlock()}else{B.css("display","none")}}},optBtn:{ini:false,action:function(A){this.getSubNode("OPT").css("display",A?"":"none")}},closeBtn:{ini:true,action:function(A){var B=this.getSubNode("CLOSE");if(A){B.setInlineBlock()}else{B.css("display","none")}}},pinBtn:{ini:true,action:function(A){var B=this.getSubNode("PIN");if(A){B.setInlineBlock()}else{B.css("display","none")}}},landBtn:{ini:false,action:function(A){var B=this.getSubNode("LAND");if(A){B.setInlineBlock()}else{B.css("display","none")}}},width:300,height:300,minWidth:200,minHeight:100,_barHeight:22,position:"absolute",fromRegion:{hidden:true,ini:null},status:{ini:"normal",listbox:["normal","min","max"],action:function(C,D){var B=this,A=B.box;if(C=="min"){A._min(B,D)}else{if(C=="max"){A._max(B,D)}else{A._restore(B,D)}}}}},EventHandlers:{onShow:function(A){},beforeClose:function(A){},onShowOptions:function(A,B,C){}},RenderTrigger:function(){this.destroyTrigger=function(){var A=this;if(A.$inModal){A.box._unModal(A)}}},LayoutTrigger:function(){var B=this,C=B.properties,A=B.box;if(C.status=="min"){A._min(B)}else{if(C.status=="max"){A._max(B)}else{linb.UI.$tryResize(B,C.width,C.height)}}},_prepareData:function(C){var D=arguments.callee.upper.call(this,C),B="display:none";D.minDisplay=D.minBtn?"":B;D.maxDisplay=D.maxBtn?"":B;D.optDisplay=D.optBtn?"":B;D.closeDisplay=D.closeBtn?"":B;D.pinDisplay=D.pinBtn?"":B;D.landDisplay=D.landBtn?"":B;var A=C.properties.status;if(A=="min"||A=="max"){C.$noR=C.$noS=1}return D},_min:function(E){var H=E.root,F=E.box,G=H.parent(),C=E.properties;if(C.status=="max"){F._unMax(E)}else{F._refreshRegion(E)}E.getSubNodes(["PANEL","STATUS"]).css("display","none");if(C.minBtn){E.getSubNode("RESTORE").setInlineBlock();E.getSubNode("MIN").css("display","none")}if(C.resizer&&E.$resizer){E.$resizer.hide()}if(C.shadow){E.boxing()._unShadow(false)}C.status="min";var B=H.height(),A=E.getSubNode("BORDER").height(),D=E.getSubNode("BAR").height();H.cssSize({width:C.minWidth,height:D+B-A},true)},_max:function(C){var F=C.root,D=C.box,A=C.boxing(),E=F.parent(),B=C.properties;if((B.status)=="min"){D._unMin(C)}else{D._refreshRegion(C)}if(B.pinBtn){C.getSubNode("PIN").css("display","none")}if(B.maxBtn){C.getSubNode("MAX").css("display","none");C.getSubNode("RESTORE").setInlineBlock()}C.old_m=B.movable;B.movable=false;if(B.resizer&&C.$resizer){C.$resizer.hide()}if(B.shadow){A._unShadow(false)}B.status="max";A.setDock("fill")},_restore:function(B){var D=B.root,C=B.box,A=B.properties;if(A.status=="max"){C._unMax(B)}if(A.status=="min"){C._unMin(B)}B.getSubNode("RESTORE").css("display","none");A.status="normal"},_unMax:function(C){var B=C.properties,A=C.boxing();C.getSubNode("MAX").setInlineBlock();if(B.pinBtn){C.getSubNode("PIN").setInlineBlock()}B.movable=C.old_m;if(B.shadow){A._shadow()}if(B.resizer&&!B.pinned&&C.$resizer){C.$resizer.show()}A.setDock("none");linb.UI.$tryResize(C,B.width,B.height)},_unMin:function(B){var A=B.properties;B.getSubNodes(["PANEL","STATUS"]).css("display","block");B.getSubNode("MIN").setInlineBlock();if(A.shadow){B.boxing()._shadow()}if(A.resizer&&!A.pinned&&B.$resizer){B.$resizer.show()}B.root.cssSize({width:A.width,height:A.height});linb.UI.$tryResize(B,A.width,A.height)},_active:function(C){var A=this;if(A.activeWndId==C.$id){return }A._deActive();var E=linb(C.domId),D=E.topZindex(),B=E.css("zIndex");E.css("zIndex",D>B?D:B);C.getSubNode("BAR").tagClass("-focus");A.activeWndId=C.$id},_deActive:function(){var A;if(A=linb.UI._cache["$"+this.activeWndId]){A.getSubNode("BAR").tagClass("-focus",false)}delete this.activeWndId},_modal:function(C){var L=C.root,J,A=L.parent(),K;if(!A.isEmpty()){if(!C.$inModal){if(!C.$modalDiv){C.$modalDiv=new linb.UI.Div({position:"absolute"}).setCustomStyle({KEY:"overflow:hidden;display:block;z-index:0;cursor:wait;background-image:url("+linb.ini.path+"bg.gif)"})}K=C.$modalDiv;A.append(K);K.setDock("cover",true);K=K.reBoxing();K.css("display","block").onMousedown(function(){return false}).topZindex(true);L.css("zIndex",(parseInt(K.css("zIndex"))||0)+1);var E={},I=C.root.query("*",function(M){return M.tabIndex>0}).get();for(var F=0,B;B=I[F++];){(E[B.tabIndex]=E[B.tabIndex]||[]).push(B);B.tabIndex=-1}var G=C.$focusHash={},H=linb("body").query("*",function(M){return M.tabIndex>0}).get();for(var F=0,B;B=H[F++];){(G[B.tabIndex]=G[B.tabIndex]||[]).push(B);B.tabIndex=-1}for(var F in E){G=E[F];for(var D in G){G[D].tabIndex=F}}linb.Event.pushTabOutTrigger(C.domNode,function(){linb([C.domNode]).nextFocus()});C.$inModal=true}}},_unModal:function(D){if(D.$inModal){D.$modalDiv.setDock("none");D.root.css("zIndex",0);D.getSubNode("BORDER").append(D.$modalDiv.reBoxing().css("display","none"));D.$inModal=false;var E=D.$focusHash,C;for(var B in E){C=E[B];for(var A in C){C[A].tabIndex=B}}_.breakO(D.$focusHash,2);linb.Event.popTabOutTrigger()}},_refreshRegion:function(A){if(!A.root){return }return _.merge(A.properties,A.root.cssRegion(),"all")},_adjust:function(E,B,H){B=B||"";if(!H){H=B;B=""}var G=E.$div.reBoxing(),A="linb:temp:dialog",F=arguments.callee;if(!linb.Dom.byId(A)){D=F._cache=G.clone(false);linb("body").append(D);D.css({width:"auto",height:"auto",overflow:"visible",position:"absolute",visibility:"visible",left:linb.Dom.HIDE_VALUE}).id(A,true)}var D=F._cache;D.html(H,false);var C=D.cssSize();G.html(H);if(C.width>500){C.width=500;D.width(500);C.height=D.offsetHeight()+10;D.width("auto")}if(C.height>400){C.height=400}if(C.width<150){C.width=150}if(C.height<30){C.height=30}G.cssSize(C).css("overflow","auto").show();E.setCaption(B).setWidth(C.width+30).setHeight(C.height+80);E.$cmd.reBoxing().left((C.width+30-E.$cmd.reBoxing().width())/2)},alert:function(G,E,A){var D=arguments.callee,C;if(!(C=D.dialog)){C=D.dialog=new linb.UI.Dialog({minBtn:false,maxBtn:false,pinBtn:false,resizer:false,left:200,top:200},{beforeClose:function(){C.hide();_.tryF(D.onOK);D.onOK=null;return false}});var F=C.$cmd=new linb.UI.Div({bottom:10,width:60,height:24}),B=C.$btn=new linb.UI.Button({caption:"$inline.ok",width:60,tabindex:1},{onClick:function(){C.hide();_.tryF(A)}});F.append(B);var H=C.$div=new linb.UI.Div({left:10,top:10});C.append(F).append(H).render()}D.onOK=A;this._adjust(C,G,E);C.show(linb("body"),true);_.asyRun(function(){C.$btn.activate()})},confirm:function(F,H,G,I){var E=arguments.callee,D;if(!(D=E.dialog)){D=E.dialog=new linb.UI.Dialog({minBtn:false,maxBtn:false,pinBtn:false,resizer:false,left:200,top:200},{beforeClose:function(){D.hide();_.tryF(E.onNo);E.onYest=E.onNo=null;return false}});var C=D.$cmd=new linb.UI.Div({bottom:10,width:140,height:24}),B=new linb.UI.Button({caption:"$inline.yes",width:60,tabindex:1,left:0},{onClick:function(){D.hide();_.tryF(E.onYes);E.onYest=E.onNo=null}});C.append(B);B=D.$btn=new linb.UI.Button({caption:"$inline.no",tabindex:1,width:60,left:80},{onClick:function(){D.hide();_.tryF(E.onNo);E.onYest=E.onNo=null}});C.append(B);var A=D.$div=new linb.UI.Div({left:10,top:10});D.append(C).append(A).render()}E.onYes=G;E.onNo=I;this._adjust(D,F,H);D.show(linb("body"),true);_.asyRun(function(){D.$btn.activate()})},pop:function(G,B,F,E,D){var A=new linb.UI.Dialog({minBtn:false,maxBtn:false,pinBtn:false,resizer:false,left:200||E,top:200||D}),C=A.$cmd=new linb.UI.Div({bottom:10,width:60,height:24}).append(A.$btn=new linb.UI.Button({caption:F||"$inline.ok",tabindex:1,width:60},{onClick:function(){A.destroy()}})),H=A.$div=new linb.UI.Div({left:10,top:10}).setCustomStyle({KEY:"overflow:visible"});A.append(C).append(H).render();this._adjust(A,G,B);A.show(linb("body"),false,E,D);_.asyRun(function(){A.$btn.activate()});return A},prompt:function(G,J,C,H,K){var D,F=arguments.callee;if(!(D=F.dialog)){var I=function(){F.$inp.setValue("");F.onYes=F.onNo=null;F.dialog.hide();return false};D=F.dialog=new linb.UI.Dialog({minBtn:false,maxBtn:false,pinBtn:false,resizer:false,left:200,top:200,width:300,height:130},{beforeClose:function(){_.tryF(F.onNo);return I()}});var A=F.$con=new linb.UI.Div({top:4,left:10,width:270,height:18}),B=new linb.UI.Div({top:65,width:270,height:24}).setCustomStyle("KEY","text-align:center;").append(new linb.UI.Button({caption:"$inline.yes",width:60,left:70,tabindex:1},{onClick:function(){_.tryF(F.onYes,[F.$inp.getUIValue()]);return I()}}));B.append(new linb.UI.Button({caption:"$inline.no",tabindex:1,left:140,width:60},{onClick:function(){_.tryF(F.onNo);return I()}}));var E=F.$inp=new linb.UI.Input({left:10,top:22,width:270,height:36,multiLines:true});D.append(A).append(B).append(E).render()}D.setCaption(G||"Prompt");F.$con.setHtml(J||"");F.$inp.setValue(C||"");F.onYes=H;F.onNo=K;D.show(linb("body"),true);_.asyRun(function(){F.$inp.activate()})},_onresize:function(B,A,K){var L=arguments.callee.upper.apply(this,arguments),G={},J=B.getSubNode("BAR"),I=B.getSubNode("PANEL"),H=B.getSubNode("STATUS"),C,F,E,D;if(K){C=L.height,E=J.height(),D=H.height();G.top=E;if(C-E-D>0){G.height=C-E-D}}if(A){F=L.width;G.width=F-2}I.cssRegion(G,true);if(F){H.width(F)}}}});Class("linb.UI.Range",["linb.UI","linb.absValue"],{Instance:{_setCtrlValue:function(A){return this.each(function(E){var C=E.properties,J=C.captionTpl,K=function(O){return E.getSubNode(O)},G=function(O,P){O.cssPos({left:E[P],top:I._x2y(E[P])})},F=function(P,O){P.get(0).style.width=O+"px"},M=K("CAPTION"),N=K("IND1"),L=K("IND2"),D=K("RULER1"),B=K("RULER3"),I=E.box,H=I._v2a(A);E._rate=300/(C.max-C.min);E._v1=Math.round((H[0]-C.min)/(C.max-C.min)*300);E._v2=Math.round((1-(C.max-H[1])/(C.max-C.min))*300);M.html(I._buildTpl(C.singleValue,J,H,C.unit),false);G(N,"_v1");G(L,"_v2");F(D,E._v1+8);F(B,300-E._v2+8)})},_setDirtyMark:function(){return this.each(function(D){if(!D.domNode){return }var C=D.properties,E=D.getSubNode("BOX"),B=C.value!==C.$UIvalue,A=linb.UI.$css_tag_dirty;if(D.beforeDirtyMark&&false===D.boxing().beforeDirtyMark(D,B)){return }if(B){E.addClass(A)}else{E.removeClass(A)}})}},Static:{Templates:{style:"{_style}",BOX:{tagName:"div",RULER:{tagName:"div",IND1:{tagName:"a",href:linb.$href,tabindex:"{tabIndex}",style:"{_single}"},IND2:{tagName:"a",href:linb.$href,tabindex:"{tabIndex}"},RULER1:{style:"{_single}"},RULER3:{}},TAIL:{tagName:"div",CAPTION:{tagName:"div"},MIN:{text:"{min}"},MAX:{text:"{max}"}}}},Appearances:{"KEY, RULER, IND1, IND1":{"font-size":0,"line-height":0,position:"relative"},BOX:{position:"absolute",left:0,top:0,width:"316px"},"CAPTION, IND1, TAIL, MIN":{"font-size":"12px","line-height":"12px"},RULER:{$order:1,position:"relative",height:"30px",overflow:"visible","margin-bottom":"3px",background:linb.UI.$bg("cmds.gif"," no-repeat left -241px",true)},"RULER1, RULER3":{position:"absolute",top:0,height:"30px",width:"300px"},RULER1:{left:0,background:linb.UI.$bg("cmds.gif"," no-repeat left -271px",true)},RULER3:{right:0,background:linb.UI.$bg("cmds.gif"," no-repeat right -271px",true)},"IND1,IND2":{display:linb.$inlineBlock,zoom:linb.browser.ie6?1:null,"z-index":"2",width:"15px",height:"14px",position:"absolute"},IND1:{background:linb.UI.$bg("cmds.gif"," no-repeat left -225px",true),left:"0px",top:"11px"},IND2:{background:linb.UI.$bg("cmds.gif"," no-repeat -15px -225px",true),left:"300px",top:"1px"},TAIL:{$order:2,width:"300px",position:"relative"},CAPTION:{position:"relative","text-align":"center"},MIN:{position:"absolute",left:0,top:0},MAX:{position:"absolute",right:0,top:0}},Behaviors:{IND1:{onKeydown:function(A,B,C){A.box._keydown.apply(A.box,[A,B,C,0])},onMousedown:function(B,E,F){var D=B.properties,C=B.box,A=C._v2a(D.$UIvalue);linb([F]).startDrag(E,{widthIncrement:D.steps?D.width/D.steps:null,dragType:"move",targetReposition:true,horizontalOnly:true,maxLeftOffset:Math.floor(B._v1),maxRightOffset:Math.floor(B._v2-B._v1),dragCursor:"default"});linb([F]).css("zIndex",10).focus();B.getSubNode("IND2").css("zIndex",5)},onDrag:function(A,B,D){var C=linb.DragDrop.getProfile();A.box._ondrag.apply(A.box,[A,C.curPos.left,D,0])},onDragstop:function(C,G,A){var B=C.properties,E=C.boxing(),H=C._rate,I=linb.DragDrop.getProfile(),F,D=B.$UIvalue.split(":");C._v1=I.curPos.left;D[0]=Math.floor((C._v1)/H+B.min);E.setUIValue(D.join(":"));if(C._v1==C._v2){linb([A]).css("zIndex",10);C.getSubNode("IND2").css("zIndex",5)}}},IND2:{onKeydown:function(A,B,C){A.box._keydown.apply(A.box,[A,B,C,1])},onMousedown:function(B,E,F){var D=B.properties,C=B.box,A=C._v2a(D.$UIvalue);linb([F]).startDrag(E,{widthIncrement:D.steps?D.width/D.steps:null,dragType:"move",targetReposition:true,horizontalOnly:true,maxLeftOffset:Math.floor(B._v2-B._v1),maxRightOffset:Math.floor(300-B._v2),dragCursor:"default"});linb([F]).css("zIndex",10).focus();B.getSubNode("IND1").css("zIndex",5)},onDrag:function(A,B,D){var C=linb.DragDrop.getProfile();A.box._ondrag.apply(A.box,[A,C.curPos.left,D,1])},onDragstop:function(C,G,A){var B=C.properties,E=C.boxing(),H=C._rate,I=linb.DragDrop.getProfile(),F,D=B.$UIvalue.split(":");C._v2=I.curPos.left;D[1]=Math.floor((C._v2)/H+B.min);E.setUIValue(D.join(":"))}}},DataModel:{position:"absolute",width:300,height:46,min:{ini:0,action:function(){var B=this,C,D=B.properties,A=B.boxing();A.refresh();if(D.$UIvalue!=(C=this.box._ensureValue(B,D.$UIvalue))){A.setValue(C)}}},max:{ini:100,action:function(){var B=this,C,D=B.properties,A=B.boxing();A.refresh();if(D.$UIvalue!=(C=this.box._ensureValue(B,D.$UIvalue))){A.setValue(C)}}},unit:{ini:"",action:function(){this.boxing()._setCtrlValue(this.properties.$UIvalue)}},steps:0,captionTpl:{ini:"{fromvalue}{unit} - {tovalue}{unit}",action:function(){this.boxing()._setCtrlValue(this.properties.$UIvalue)}},value:"0:100",singleValue:{ini:false,action:function(A){this.boxing().refresh()}}},_prepareData:function(B){var D=arguments.callee.upper.call(this,B);var C=B.properties,A=B.box._v2a(C.value);D._single=C.singleValue?"display:none":"";C.min=parseFloat(C.min);C.max=parseFloat(C.max);D.min=D.min+C.unit;D.max=D.max+C.unit;return D},_ensureValue:function(B,I){var A=B.properties,H=I.split(":"),D=A.min,F=A.max,G=[],E=function(J){return parseFloat(J)},C=function(J){return Math.min(F,Math.max(D,J))};G[0]=E(H[0]);G[1]=E(H[1]);G[0]=Math.min(G[0],G[1]);if(!D){D=G[0]}if(!F){F=G[1]}G[0]=C(G[0]);G[1]=C(G[1]);return G.join(":")},_v2a:function(A){return typeof A=="string"?A.split(":"):A},_buildTpl:function(D,B,A,C){return D?A[1]+C:B.replace(/\{fromvalue\}/g,A[0]).replace(/\{tovalue\}/g,A[1]).replace(/\{unit\}/g,C)},_x2y:function(A){return Math.floor(15+1-(A)*(15/300))},_keydown:function(C,G,A,H){var M=linb.Event.getKey(G);if(M[0]=="left"||M[0]=="right"){var N=A.style,B=parseInt(N.left),L=C.properties,I=L.steps,J=300/I,K,E=function(O){return parseInt(C.getSubNode(O).get(0).style.left)};B+=M[0]=="left"?-1:1;if(I){B=B-B%J;if(M[0]=="right"){B+=J}}if(!L.singleValue){if(H===0){K=E("IND2");if(B>K){B=K}}else{K=E("IND1");if(B<K){B=K}}}if(B<0){B=0}if(B>300){B=300}N.left=B+"px";C.box._ondrag.apply(C.box,[C,B,A,1]);var F=C._rate,D=L.$UIvalue.split(":");if(H===0){C._v1=B;D[0]=Math.floor((C._v1)/F+L.min)}else{C._v2=B;D[1]=Math.floor((C._v2)/F+L.min)}C.boxing().setUIValue(D.join(":"))}},_ondrag:function(F,E,A,O){var C=F.properties,K=linb.DragDrop.getProfile(),I=F.box,L=function(P){return F.getSubNode(P)},G=function(Q,P){Q.get(0).style.width=P+"px"},M=L("CAPTION"),D=L("RULER1"),B=L("RULER3"),N,J,H=this._v2a(C.$UIvalue);A.style.top=this._x2y(E)+"px";N=Math.floor((E)/F._rate+C.min);if(O){H[1]=N;G(B,300-E+8)}else{H[0]=N;G(D,E+8)}M.html(I._buildTpl(C.singleValue,C.captionTpl,H,C.unit),false)}}});CONF={basePath:"imglib/",service:"request.php",workingPath:"working/",ComFactoryProfile:{uploader:{cls:"App.Upload"}}};Class("App","linb.Com",{Instance:{events:{onReady:"_onready",onRender:"_onRender"},paras:{sessionname:"",filename:"",tag:"",fileext:"jpg"},getPath:function(A){return CONF.basePath+CONF.workingPath+(A.origin=="demos"?"demos":A.origin=="upload"?("upload/"+A.sessionname):(A.logindate+"/"+A.sessionname))+"/"+A.filename+(A.origin?"":("/"+A.tag))+"."+A.fileext},iniComponents:function(){var C=this,B=[],A=function(D){B.push(D.get(0))};A((new linb.UI.Pane).host(C,"paneTop").setDomId("paneTop").setWidth("auto").setHeight(36).setPosition("relative"));C.paneTop.append((new linb.UI.Pane).host(C,"paneTopRight").setDomId("paneTopRight").setTop(6).setWidth("auto").setHeight(20).setRight(10));C.paneTopRight.append((new linb.UI.Link).host(C,"linkLangEn").setLeft(15).setTop(0).setWidth(66).setPosition("relative").setCaption("English").onClick("_linklangen_onclick").setCustomClass({KEY:"btn-lang"}));C.paneTopRight.append((new linb.UI.Link).host(C,"linkLangCn").setLeft(10).setTop(0).setPosition("relative").setCaption("\u4e2d\u6587").onClick("_linklangcn_onclick").setCustomClass({KEY:"btn-lang"}));C.paneTop.append((new linb.UI.Div).host(C,"vLogo").setDomId("vLogo").setLeft(8).setTop(4).setWidth(32).setHeight(32));C.paneTop.append((new linb.UI.Pane).host(C,"panelTopLeft").setDomId("panelTopLeft").setLeft(50).setTop(10).setWidth(300).setHeight(20).setHtml("$app.caption.logo"));A((new linb.UI.Pane).host(C,"paneMain").setDomId("paneMain").setWidth("auto").setHeight("auto").setPosition("relative").setCustomStyle({KEY:"margin-left:100px;"}));C.paneMain.append((new linb.UI.Tabs).host(C,"tabsCmds").setDomId("tabsCmds").setItems([{id:"basic",caption:"$app.tasks.basic",tips:"$app.tasks.basicTips"},{id:"crop",caption:"$app.tasks.crop",tips:"$app.tasks.cropTips"},{id:"frm",caption:"$app.tasks.frm",tips:"$app.tasks.frmTips"},{id:"frm2",caption:"$app.tasks.frm2",tips:"$app.tasks.frm2Tips"},{id:"text",caption:"$app.tasks.text",tips:"$app.tasks.textTips"},{id:"resize",caption:"$app.tasks.resize",tips:"$app.tasks.resizeTips"}]).setDock("none").setWidth("auto").setHeight(95).setPosition("relative").setHAlign("center").onItemSelected("_tb_onitemseltected").setCustomStyle({PANEL:"border-left:solid 1px #91A7B4;border-right:solid 1px #91A7B4;",KEY:"border-bottom:solid 1px #91A7B4;"}));C.tabsCmds.append((new linb.UI.Button).host(C,"btnRot").setLeft(661).setTop(6).setWidth(110).setCaption("$app.basic.rot").beforeHoverEffect("_btnrot_beforehovereffect"),"basic");C.tabsCmds.append((new linb.UI.Button).host(C,"btnMir").setLeft(781).setTop(6).setWidth(110).setCaption("$app.basic.mir").beforeHoverEffect("_btnmir_beforehovereffect"),"basic");C.tabsCmds.append((new linb.UI.Button).host(C,"btnOne").setLeft(661).setTop(36).setWidth(110).setCaption("$app.basic.one").beforeHoverEffect("_btnone_beforehovereffect"),"basic");C.tabsCmds.append((new linb.UI.Button).host(C,"btnFilter").setLeft(781).setTop(36).setWidth(110).setCaption("$app.basic.filter").beforeHoverEffect("_btnfilter_beforehovereffect"),"basic");C.tabsCmds.append((new linb.UI.Button).host(C,"btnApply").setLeft(11).setTop(36).setCaption("$app.caption.applyCrop").onClick("_crop_onclick"),"crop");C.tabsCmds.append((new linb.UI.Button).host(C,"btnResizeApply").setLeft(10).setTop(36).setCaption("$app.caption.applyResize").onClick("_resize_onclick"),"resize");C.tabsCmds.append((new linb.UI.Div).host(C,"vFont").setLeft(351).setTop(21).setHeight(20).setHtml("$app.addtext.font").setCustomClass({KEY:"app-label"}),"text");C.tabsCmds.append((new linb.UI.Div).host(C,"vFontSize").setLeft(141).setTop(8).setWidth(80).setHeight(20).setHtml("$app.addtext.fontsize").setCustomClass({KEY:"app-label"}),"text");C.tabsCmds.append((new linb.UI.Div).host(C,"vFontColor").setLeft(121).setTop(41).setHeight(20).setHtml("$app.addtext.fontcolor").setCustomClass({KEY:"app-label"}),"text");C.tabsCmds.append((new linb.UI.Button).host(C,"btnAddText").setLeft(11).setTop(34).setWidth(100).setCaption("$app.caption.addtext").onClick("_btnaddtext_onclick"),"text");C.tabsCmds.append((new linb.UI.ComboInput).host(C,"ciFontSize").setLeft(231).setTop(7).setWidth(101).setValueFormat("^\\d\\d*$").setType("helpinput").setValue("32").afterUIValueSet("_fontsize_us"),"text");C.tabsCmds.append((new linb.UI.ComboInput).host(C,"ciFontColor").setLeft(231).setTop(40).setWidth(101).setReadonly(true).setType("colorpicker").setValue("#FFFF00").beforeUIValueSet("_cifontcolor_beforeuivalueset"),"text");C.tabsCmds.append((new linb.UI.Range).host(C,"rangeCon").setLeft(10).setTop(11).setZIndex("10").setMin(-100).setSingleValue(true).setValue("-100:0").afterUIValueSet("_rangecon_afteruivalueset"),"basic");C.tabsCmds.append((new linb.UI.Range).host(C,"rangeBri").setLeft(331).setTop(11).setZIndex("10").setMin(-100).setSingleValue(true).setValue("-100:0").afterUIValueSet("_rangebri_afteruivalueset"),"basic");C.tabsCmds.append((new linb.UI.Div).host(C,"div39").setLeft(21).setTop(3).setWidth(180).setHeight(30).setHtml("$app.basic.con"),"basic");C.tabsCmds.append((new linb.UI.Div).host(C,"div40").setLeft(347).setTop(3).setWidth(180).setHeight(30).setHtml("$app.basic.bri"),"basic");C.tabsCmds.append((new linb.UI.Button).host(C,"button12").setLeft(21).setTop(36).setZIndex("10").setCaption("$app.caption.applyIcon").onClick("_button12_onclick"),"frm2");C.tabsCmds.append((new linb.UI.Button).host(C,"button25").setLeft(171).setTop(38).setZIndex("10").setCaption("$app.caption.applyFrm").onClick("_button13_onclick"),"frm");C.tabsCmds.append((new linb.UI.Div).host(C,"div46").setLeft(11).setTop(43).setWidth(80).setHeight(20).setZIndex("10").setHtml("$app.caption.frmbg").setCustomClass({KEY:"app-label"}),"frm");C.tabsCmds.append((new linb.UI.ComboInput).host(C,"iBGFrm").setDomId("iBGFrm").setLeft(97).setTop(43).setWidth(70).setZIndex("10").setType("colorpicker").setValue("#FFFFFF").afterUIValueSet("_btnbgfrm_onclick"),"frm");C.tabsCmds.append((new linb.UI.Div).host(C,"divFont").setLeft(455).setTop(10).setWidth("auto").setHeight("40").setCustomStyle("KEY","overflow:visible;"),"text");C.paneMain.append((new linb.UI.Pane).host(C,"paneInfo").setDomId("paneInfo").setWidth("auto").setHeight("40").setPosition("relative"));C.paneInfo.append((new linb.UI.Div).host(C,"vInfo").setDomId("vInfo").setLeft(12).setWidth("auto").setHeight("auto").setPosition("relative"));C.paneInfo.append((new linb.UI.Div).host(C,"vInfo2").setDomId("vInfo2").setLeft(12).setWidth("auto").setHeight("auto").setPosition("relative"));C.paneMain.append((new linb.UI.Pane).host(C,"panePic").setDomId("panePic").setWidth("auto").setHeight("auto").setPosition("relative"));C.panePic.append((new linb.UI.Pane).host(C,"paneImageBorder").setDomId("paneImageBorder").setWidth("auto").setHeight("auto").setPosition("relative"));C.paneImageBorder.append((new linb.UI.Image).host(C,"imgBig").setDomId("imgBig").setPosition("relative").onError("_imgbig_onerror").beforeLoad("_imgbig_beforeload").afterLoad("_imgbig_afterload"));C.paneMain.append((new linb.UI.Pane).host(C,"paneBottom").setDomId("paneBottom").setWidth("auto").setHeight("auto").setPosition("relative"));A((new linb.UI.Dialog).host(C,"dlgHistory").setDomId("dlgHistory").setTop(132).setWidth(200).setRight(0).setShadow(false).setCaption("$app.caption.history").setMaxBtn(false).setCloseBtn(false).setPinBtn(false));C.dlgHistory.append((new linb.UI.IconList).host(C,"ilHistory").setDomId("ilHistory").setDock("fill").setItemWidth(32).setItemHeight(32).onItemSelected("_il_onitemseletcted"));A((new linb.UI.Pane).host(C,"paneDemo").setDomId("paneDemo").setLeft(4).setTop(155).setWidth(91).setHeight(385));C.paneDemo.append((new linb.UI.Stacks).host(C,"stack").setItems([{id:"files",caption:"$app.caption.upload_short"},{id:"demos",caption:"$app.caption.demos_short"}]).setValue("demos"));C.stack.append((new linb.UI.IconList).host(C,"ilDemo").setDock("fill").setSelMode("none").setItemWidth(50).setItemHeight(38).onItemSelected("_ildemo_onitemselected"),"demos");C.stack.append((new linb.UI.IconList).host(C,"ilPhoto").setDock("fill").setSelMode("none").setItemWidth(50).setItemHeight(38).onItemSelected("_ilphoto_onitemselected"),"files");A((new linb.UI.Button).host(C,"btnUpload").setLeft(7).setTop(70).setWidth(85).setHeight(28).setType("custom").setBorder(true).setCaption("$app.caption.upload").setVAlign("middle").onClick("_btnupload_click"));A((new linb.UI.Button).host(C,"btnSave").setDomId("btnSave").setLeft(7).setTop(116).setWidth(85).setHeight(28).setType("custom").setBorder(true).setCaption("$app.caption.save").setVAlign("middle").onClick("_btnsave_click"));A((new linb.UI.ComboInput).host(C,"iBGC").setDomId("iBGC").setLeft(4).setTop(40).setWidth(91).setType("colorpicker").afterUIValueSet("_btnbgc_onclick"));return B},_onRender:function(){linb.CSS.includeLink(linb.getPath("css","main.css","default/"));linb("imgBig").setSelectable(false);SPA.tabsCmds.fireItemClickEvent("basic");var A=SPA.ilDemo.getItems()[parseInt(Math.random()*6)];SPA.ilDemo.fireItemClickEvent(A.id);SPA.iBGC.setValue(linb("body").css("backgroundColor"))},_tb_onitemseltected:function(A,B){linb("imgBig").onClick(null).attr({width:null,height:null});SPA.hideResizer();SPA.hideFrm();SPA.hideCrop();SPA.hideIcon();SPA.hideText();switch(SPA.curView=B.id){case"resize":SPA.showResizer();break;case"crop":SPA.showCrop();break;case"text":SPA.showText();var C=_.copy(SPA.paras);C.action="get_font_list";SPA.request1(C,function(E){var D=[],F=function(G){return"<img src="+G.path+" alt="+G.caption+">"};_.each(E.data,function(I,G){var H=CONF.basePath+"font/"+I.preview;D.push({id:G,_obj:I,caption:G,path:H,renderer:F})});SPA.divFont.getRoot().onMouseover(SPA._divfont_mover).onMouseout(SPA._divfont_mout);SPA.$fontFamilies=D;SPA.$fontFamily=D[0].caption;SPA.AddText.getSubNode("INPUT").css("fontFamily",SPA.$fontFamily);SPA.divFont.setHtml('<img style="border:solid 1px #ccc;cursor:pointer;" src='+D[0].path+" alt="+D[0].caption+"/>")});break;case"frm":if(!SPA.ilFrm){SPA.ilFrm=new linb.UI.IconList({selMode:"none",position:"relative",width:"auto",height:"auto",itemWidth:16,itemHeight:16});SPA.ilFrm.onItemSelected(function(D,E){if(D.boxing().getStatus(E.id)=="loaded"){SPA.showFrm(E.image);SPA.$frmId=E.id}else{delete SPA.$frmId}});A.boxing().append(SPA.ilFrm,"frm");var C=_.copy(SPA.paras);C.action="get_modern_list";SPA.request1(C,function(E){var D=[];_.each(E.data,function(H,F){var G=CONF.basePath+"template/modern/"+H.filename;D.push({id:F,_obj:H,image:G,transTips:true,tips:"<img border=0 height=300 src="+G+">"})});SPA.ilFrm.setItems(D)})}break;case"frm2":if(!SPA.ilFrm2){SPA.ilFrm2=new linb.UI.IconList({selMode:"none",position:"relative",width:"auto",height:"auto",itemWidth:16,itemHeight:16});SPA.ilFrm2.onItemSelected(function(D,E){if(D.boxing().getStatus(E.id)=="loaded"){SPA.showIcon(E.image);SPA.$iconId=E.id}else{delete SPA.$iconId}});A.boxing().append(SPA.ilFrm2,"frm2");var C=_.copy(SPA.paras);C.action="get_avatar_list";SPA.request1(C,function(E){var D=[];_.each(E.data,function(H,F){var G=CONF.basePath+"template/avatar/"+H.filename;D.push({id:F,_obj:H,image:G,transTips:true,tips:"<img border=0 height=100 src="+G+">"})});SPA.ilFrm2.setItems(D)})}break}},_linklangen_onclick:function(A,B){linb.setLang("en");linb.Cookies.set("lang","en")},_linklangcn_onclick:function(A,B){linb.setLang("cn");linb.Cookies.set("lang","cn")},_onready:function(){SPA=this;var E=function(F){SPA.request1({action:"listphotos",sessionname:F},function(G){if(G.data.length>0){SPA.stack.setValue("files",true)}SPA.ilPhoto.setItems(G.data)})};var A=linb.Cookies.get("csession");if(!A){SPA.request1({action:"getsession"},function(F){linb.Cookies.set("csession",SPA.paras.sessionname=F.data);E(SPA.paras.sessionname)})}else{E(SPA.paras.sessionname=A)}linb.ComFactory.setProfile(CONF.ComFactoryProfile).prepareComs(_.toArr(CONF.ComFactoryProfile,true));var D=CONF.basePath+CONF.workingPath+"demos/";var B=[{id:"1",big:D+"1.jpg",image:D+"1s.jpg"},{id:"2",big:D+"2.jpg",image:D+"2s.jpg"},{id:"3",big:D+"3.jpg",image:D+"3s.jpg"},{id:"4",big:D+"4.jpg",image:D+"4s.jpg"},{id:"5",big:D+"/5.jpg",image:D+"5s.jpg"},{id:"6",big:D+"6.jpg",image:D+"6s.jpg"},{id:"7",big:D+"7.jpg",image:D+"7s.jpg"}];SPA.ilDemo.setItems(B);SPA.paneBottom.setHtml(linb.wrapRes("app.info"));var C=[];_.arr.each([6,8,10,12,14,16,18,24,32,48],function(F){C.push({id:""+F,caption:'<div style="font-size:'+F+'px">'+F+"px</div>"})});SPA.ciFontSize.setItems(C)},_iniSome:function(){SPA.hideFrm()},_il_onitemseletcted:function(B,C,D){var A=B.boxing();SPA.paras=_.copy(C._obj);SPA.imgBig.setSrc(SPA.getPath(SPA.paras));SPA._iniSome()},_ildemo_onitemselected:function(A,B,C){if(SPA.$curID!=B.id){SPA.$curID=B.id;SPA.vInfo.setHtml(linb.wrapRes("$app.caption.demos")+" : "+B.id+".jpg");SPA.imgBig.setSrc(B.big);_.merge(SPA.paras,{origin:"demos",tag:"",filename:B.id,fileext:"jpg"},"all");SPA._iniSome()}},_ilphoto_onitemselected:function(A,B,C){if(SPA.$curID!=B.id){SPA.$curID=B.id;SPA.vInfo.setHtml(linb.wrapRes("$app.caption.upload")+" : "+B.id+"."+B.ext);SPA.imgBig.setSrc(B.big);_.merge(SPA.paras,{origin:"upload",tag:"",filename:B.id,fileext:B.ext},"all");SPA._iniSome()}},_imgbig_beforeload:function(A){_.resetRun("$changCon",function(){SPA.vInfo2.setHtml('<image src="img/loading.gif"/>');_.resetRun("$imgvisible",function(){SPA.imgBig.setDisplay("none")})})},_imgbig_afterload:function(C,D,B,A){_.resetRun("$changCon",function(){SPA.vInfo2.setHtml(linb.wrapRes("app.caption.width")+' <span class="val-size">'+B+'</span><span style="width:10px;"></span>'+linb.wrapRes("app.caption.height")+' <span class="val-size">'+A+"</span>")});_.resetRun("$imgvisible",function(){SPA.imgBig.setDisplay("")});SPA.$width=B;SPA.$height=A},_imgbig_onerror:function(A){SPA.vInfo2.setHtml('<image src="img/error.gif"/>'+linb.wrapRes("app.imageErr"))},_btnbgc_onclick:function(A,C,B){linb.doc.query("html").css("backgroundColor",B)},_btnbgfrm_onclick:function(A,C,B){if(SPA.frm&&SPA.$frmId){SPA.frm.css("background",B);SPA.$frmBg=B.slice(1)}},showResizer:function(){var A;if(!(A=SPA.resizer)){A=SPA.resizer=linb.create("div").css({zIndex:1001,position:"absolute"});A.addResizer({forceVisible:true,minHeight:50,minWidth:50,maxWidth:800,maxHeight:800,handlerSize:8},function(C,D){var B=C.proxy.cssSize();D.cssSize(B);linb("imgBig").attr("width",B.width).attr("height",B.height)});linb("panePic").append(A)}A.cssPos(linb("imgBig").offset(null,linb("panePic"))).cssSize(linb("imgBig").cssSize())},hideResizer:function(){if(SPA.resizer){SPA.resizer.hide()}},showIcon:function(A){var B;if(!(B=SPA.icon)){B=SPA.icon=linb.create("div").css({zIndex:1001,left:0,top:0,width:"100px",height:"100px",position:"absolute",border:"solid 1px #00ff00"});B.append(linb.create("img"));B.addResizer({forceVisible:true,forceMovable:true,minHeight:10,minWidth:10,maxWidth:800,maxHeight:800,handlerSize:6},function(D,E,C,F){D.box.onUpdate(D,E,C,F);B.first().cssSize(E.cssSize())});linb("panePic").append(B)}B.first().css({width:"auto",height:"auto"}).attr("src",A);B.cssRegion({left:0,top:0,width:B.first().attr("width"),height:B.first().attr("height")});if(linb.browser.ie6){B.first().fixPng("scale")}},hideIcon:function(){delete SPA.$iconId;if(SPA.icon){SPA.icon.hide()}},showFrm:function(A){var D;if(!(D=SPA.frm)){var F,E;D=SPA.frm=linb.create("div").css({cursor:"move",zIndex:1001,left:0,top:0,position:"relative",overflow:"hidden"});D.append(F=linb.create("img"));D.append(E=linb.create("img"));linb("panePic").append(D);F.css({position:"absolute",left:0,top:0,zIndex:1});E.css({position:"absolute",left:0,top:0,zIndex:2});D._left=D._top=0;D.onMousedown(function(I,H,G){linb([this]).startDrag(H,{dragType:"none"})}).onDrag(function(I,H,G){var J=linb.DragDrop.getProfile();F.left(D.$left+J.offset.x).top(D.$top+J.offset.y)}).onDragstop(function(I,H,G){D.$left=F.left();D.$top=F.top()});SPA.imgBig.setDisplay("none")}D.$left=D.$top=0;D.first().cssPos({left:0,top:0});D.last().cssSize({width:"auto",height:"auto"}).attr("src",A);var B={width:D.last().attr("width"),height:D.last().attr("height")};if(linb.browser.ie6){D.last().fixPng("scale")}D.first().attr("src",linb("imgBig").attr("src"));var C=SPA.iBGFrm.getUIValue();SPA.frm.css("background",C);SPA.$frmBg=C.slice(1);D.cssSize(B).cssPos({left:0,top:0});_.resetRun("$imgvisible",function(){SPA.imgBig.setDisplay("none")})},hideFrm:function(){delete SPA.$frmBg;delete SPA.$frmId;SPA.iBGFrm.setValue("#FFFFFF",true);_.resetRun("$imgvisible",function(){SPA.imgBig.setDisplay("")});if(SPA.frm){SPA.frm.hide()}},showCrop:function(){var A;if(!(A=SPA.crop)){A=SPA.crop=linb.create("div").css({zIndex:1001,left:0,top:0,width:"100px",height:"100px",position:"absolute",border:"solid 1px #00ff00"});A.addResizer({forceVisible:true,forceMovable:true,minHeight:10,minWidth:10,maxWidth:800,maxHeight:800,handlerSize:6},function(C,D,B,E){C.box.onUpdate(C,D,B,E)});linb("panePic").append(A)}A.cssRegion({left:0,top:0,width:100,height:100})},hideCrop:function(){if(SPA.crop){SPA.crop.hide()}},showText:function(){var A;if(!(A=SPA.AddText)){A=SPA.AddText=new linb.UI.Input({multiLines:true,resizer:true}).setCustomStyle({BORDER:"background:transparent",INPUT:"background:transparent"});linb("panePic").append(A);_.asyRun(function(){var B=A.getSubNode("BORDER").$getResizer();_.merge(B.get(0).properties,{forceVisible:true,forceMovable:true,minHeight:10,singleDir:true,minWidth:10,maxWidth:800,maxHeight:800,handlerSize:8},"all");B.refreshDom()},100);SPA.AddText.getSubNode("INPUT").css({fontSize:"32px",color:"#FFFF00",fontFamily:SPA.$fontFamily||""})}A.setLeft(0).setTop(0).setWidth(300).setHeight(100).setValue("freedom")},hideText:function(){if(SPA.AddText){SPA.AddText.hide()}},_btnsave_click:function(){var B="ifr_for_download";if(!linb.Dom.byId(B)){linb("body").append(linb.create('<iframe id="'+B+'" name="'+B+'" style="display:none;"/>'))}var A=_.copy(SPA.paras);A.action="download";linb.Dom.submit(CONF.service,{key:"ImgProcess",para:A},"get",B)},_btnupload_click:function(A,B,C){linb.ComFactory.getCom("uploader",function(){if(!SPA.com_uploader){var G=SPA.com_uploader=this.getUIComponents();linb("body").append(G)}var H=function(I){SPA.stack.setValue("files",true);SPA.ilPhoto.insertItems([I.data],null,false);SPA.ilPhoto.fireItemClickEvent(I.data.id);SPA.ilHistory.clearItems().setTag(I.data.filename);SPA.popMsg(linb.getRes("app.message.uploadOK"))};this.onUpload=function(I){var J={action:"upload",sessionname:SPA.paras.sessionname};SPA.request1(J,H,I);SPA.com_uploader.hide()};this.onOpenWeb=function(I){var J={action:"openweb",sessionname:SPA.paras.sessionname,url:I};SPA.request1(J,H);SPA.com_uploader.hide()};var D=SPA.com_uploader.getRoot(),F=D.cssSize(),E=linb(C).cssSize();D.popToTop(C,4).setBlurTrigger(_(),function(){SPA.com_uploader.hide()})})},base:[],required:["linb.UI.Pane","linb.UI.Link","linb.UI.Div","linb.UI.ComboInput","linb.UI.Tabs","linb.UI.Button","linb.UI.Image","linb.UI.Dialog","linb.UI.IconList","linb.UI.Panel","linb.UI.Range","linb.UI.Stacks"],_showpopmenu:function(F,D,H){var A="__"+H,C="com_"+H;if(D=="mouseover"){_.resetRun(A,null);if(!SPA[C]){var B=[],G=linb.getRes("app."+H);_.each(G,function(J,I){B.push({id:I,caption:"$app."+H+"."+I})});var E=SPA[C]=new linb.UI.PopMenu({autoHide:true,items:B}).render(true);E.getRoot().onMouseover(function(){_.resetRun(A,null)}).onMouseout(function(){_.resetRun(A,function(){SPA[C].hide()})});E.onMenuSelected(function(I,J,L){var K=_.copy(SPA.paras);K.action=J.id;SPA.request2(K)})}SPA[C].pop(F)}else{if(SPA[C]){_.resetRun(A,function(){SPA[C].hide()})}}},_btnrot_beforehovereffect:function(B,C,D,E,A){this._showpopmenu(E,A,"rotation")},_btnmir_beforehovereffect:function(B,C,D,E,A){this._showpopmenu(E,A,"mirror")},_btnfilter_beforehovereffect:function(B,C,D,E,A){this._showpopmenu(E,A,"filter")},_btnone_beforehovereffect:function(B,C,D,E,A){this._showpopmenu(E,A,"onecolor")},_showFontFamily:function(E,C,F){var A="__"+F,B="com_"+F;if(C=="mouseover"){_.resetRun(A,null);if(!SPA[B]){var D=SPA[B]=new linb.UI.List({items:SPA.$fontFamilies,width:"480"}).render(true);D.getRoot().onMouseover(function(){_.resetRun(A,null)}).onMouseout(function(){_.resetRun(A,function(){SPA[B].hide()})});D.onItemSelected(function(G,H,I){SPA[B].hide();SPA.$fontFamily=H.caption;SPA.AddText.getSubNode("INPUT").css("fontFamily",SPA.$fontFamily);SPA.divFont.setHtml('<img style="border:solid 1px #ccc;cursor:pointer;" src='+H.path+" alt="+H.caption+"/>")})}SPA[B].getRoot().popToTop(E)}else{if(SPA[B]){_.resetRun(A,function(){SPA[B].hide()})}}},_divfont_mover:function(A,B,C){SPA._showFontFamily(C,"mouseover","fontfamily")},_divfont_mout:function(A,B,C){SPA._showFontFamily(C,"mouseout","fontfamily")},_fontsize_us:function(B,C,A){if(SPA.AddText){SPA.AddText.getSubNode("INPUT").css("fontSize",A+"px")}},_cifontcolor_beforeuivalueset:function(B,A,C){if(SPA.AddText){SPA.AddText.getSubNode("INPUT").css("color",C)}},_btnaddtext_onclick:function(A){var B=_.copy(SPA.paras);B.action="writetext";B.text=SPA.AddText.getUIValue();B.fontcolor=linb.UI.ColorPicker.hex2rgb(SPA.ciFontColor.getUIValue()).join(",");B.x=SPA.AddText.getLeft();B.fontsize=SPA.ciFontSize.getUIValue();B.fontfile=SPA.$fontFamily;B.y=SPA.AddText.getTop()+Number(B.fontsize);SPA.hideText();SPA.request2(B,function(){SPA.AddText.getSubNode("INPUT").css({fontSize:"32px",color:"#FFFF00"});SPA.AddText.setLeft(0).setTop(0).setWidth(300).setHeight(100);SPA.ciFontSize.setValue("32",true);SPA.ciFontColor.setValue("#FFFF00",true);SPA.showText()})},_crop_onclick:function(B){var A=SPA.imgBig.getRoot(),C=_.copy(SPA.paras);C.action="cut";var D=SPA.crop;reg=D.cssRegion();_.merge(C,reg);SPA.hideCrop();SPA.request2(C,function(){SPA.showCrop()})},_resize_onclick:function(D){var B=SPA.imgBig.getRoot(),A=B.attr("width"),C=B.attr("height"),E=_.copy(SPA.paras);if(A!==SPA.$width||C!=SPA.$height){E.action="resize";E.width=A;E.height=C;SPA.request2(E)}},popMsg:function(B){var A=linb.UI.Dialog.pop(B);_.asyRun(function(){if(A.getRoot()){A.destroy()}A=null},3000)},request1:function(B,C,A){linb.Thread.observableRun(function(F){var E={key:"ImgProcess",para:B},D;if(A){E.file=A;D={method:"post"}}linb.request(CONF.service,E,function(G){var H;if(typeof G=="string"){H=_.unserialize(G)}else{H=G}if(H){if(!H.error){_.tryF(C,[H])}else{SPA.popMsg(_.serialize(H.error))}}else{SPA.popMsg(_.serialize(G))}},function(G){SPA.popMsg(_.serialize(G))},F,D)})},request2:function(A,B){linb.Thread.observableRun(function(C){linb.request(CONF.service,{key:"ImgProcess",para:A},function(I){if(typeof I=="string"){I=_.unserialize(I)}if(I.error){SPA.popMsg(_.serialize(I.error))}else{var F=SPA.ilHistory.getTag();if(SPA.paras.filename!=F){SPA.ilHistory.clearItems().setTag(SPA.paras.filename)}var H=SPA.ilHistory,G=H.getItems(),E=false,D=[];_.each(G,function(L,K){if(E){D.push(L.id)}if(L.id==SPA.paras.tag){E=true}});H.removeItems(D);if(SPA.paras.origin){var J=_.copy(SPA.paras);J.origin=J.tag=SPA.paras.origin;if(SPA.ilHistory.getItems().length===0){SPA.ilHistory.setItems([{id:J.tag,image:SPA.imgBig.getSrc(),_obj:J}])}delete SPA.paras.origin}SPA.paras.logindate=I.data.logindate;SPA.paras.tag=I.data.tag;SPA.imgBig.setSrc(I.data.url);H.insertItems([{id:SPA.paras.tag,image:I.data.url,_obj:_.copy(SPA.paras)}],null,false);H.setValue(null,true);_.tryF(B,[I])}},function(D){linb.message(D)},C)})},_rangecon_afteruivalueset:function(B,A,D){var C=_.copy(SPA.paras);C.action="filter_contrast";C.value=Number(D.split(":")[1]);SPA.request2(C,function(){B.boxing().setValue("-100:0",true)})},_rangebri_afteruivalueset:function(B,A,D){var C=_.copy(SPA.paras);C.action="filter_brightness";C.value=Number(D.split(":")[1]);SPA.request2(C,function(){B.boxing().setValue("-100:0",true)})},_button12_onclick:function(B,E,F,C){if(!SPA.$iconId){return }var D=_.copy(SPA.paras);D.action="avatar";D.value=SPA.$iconId;var A=SPA.icon.cssRegion();D.x=A.left;D.y=A.top;D.width=A.width;D.height=A.height;SPA.request2(D,function(){SPA.hideIcon()})},_button13_onclick:function(A,D,E,B){if(!SPA.$frmId){return }var C=_.copy(SPA.paras);C.action="modern_frame";C.value=SPA.$frmId;C.background=SPA.$frmBg;C.x=SPA.frm.$left;C.y=SPA.frm.$top;C.width=linb("imgBig").width();C.height=linb("imgBig").height();SPA.request2(C,function(){SPA.hideFrm()})}}});(linb.Locale.en||(linb.Locale.en={})).app={info:"<br />Web application created by 'Visual JS', goto <a href='http://www.linb.net'>http://www.linb.net</a>",imageErr:"This image doesn't exist!",message:{uploadOK:"You just uploaded a photo successfule!"},caption:{logo:"LINB online photo editor",upload:"Upload Photo",upload_short:"Upload",openweb:"Open Web Photo",save:"Save",applyIcon:"Apply Icon",applyFrm:"Apply Frame",applyCrop:"Apply Crop",applyResize:"Apply Resizing",addtext:"Apply Text",history:"History",demos:"Demos Photo",demos_short:"Demos",width:"Width : ",height:"Height : ",frmbg:"background"},tasks:{basic:"Basic Tasks",basicTips:"Basic Tasks Tips",crop:"Crop",cropTips:"Crop Tips",frm:"PhotoFrame",frmTips:"PhotoFrame Tips",frm2:"Add Icon",frm2Tips:"Add Icon Tips",text:"Add Text",textTips:"Add Text Tips",resize:"Resizing",resizeTips:"Resizing Tips",mag:"Make Magazine",magTips:"Make Magazine Tips"},basic:{bri:"Brightness",con:"Contrast",rot:"Rotation",mir:"Mirror",one:"One Color",filter:"Filters"},upload:{txtUp:"Upload Photo",txtWeb:"Open From Web"},addtext:{font:"Select Font:",fontsize:"Font Size:",fontcolor:"Font Color"},filter:{filter_grayscale:"grayscale",filter_negate:"negate",filter_edgedetect:"edge detect",filter_embosses:"embosses",filter_gaussian_blur:"gaussian blur",filter_selective_blur:"blur",filter_mean_removal:"mean removal",filter_smooth:"smooth"},onecolor:{onecolor_red:"red",onecolor_green:"green",onecolor_blue:"blue"},rotation:{rotate_90:"90",rotate_180:"180",rotate_270:"270"},mirror:{mirror_v:"vertical",mirror_h:"horizontal"}};Class("App.Upload","linb.Com",{Instance:{base:["linb.UI"],required:["linb.UI.Div","linb.UI.ComboInput","linb.UI.Input","linb.UI.Block","linb.UI.Button"],events:{},iniComponents:function(){var C=this,B=[],A=function(D){B.push(D.get(0))};A((new linb.UI.Block).host(C,"block1").setWidth(520).setHeight(80).setBorder(true).setShadow(true).setCustomStyle({PANEL:"overflow:hidden;background:#fff;"}));C.block1.append((new linb.UI.Div).host(C,"vUpload").setLeft(10).setTop(10).setWidth(100).setHeight(20).setHtml("$app.upload.txtUp").setCustomClass({KEY:"app-label"}));C.block1.append((new linb.UI.Div).host(C,"vFromWeb").setLeft(10).setTop(40).setWidth(100).setHeight(20).setHtml("$app.upload.txtWeb").setCustomClass({KEY:"app-label"}));C.block1.append((new linb.UI.ComboInput).host(C,"iUploader").setLeft(120).setTop(9).setWidth(230).setType("upload"));C.block1.append((new linb.UI.Input).host(C,"iWeb").setLeft(120).setTop(40).setWidth(230).setValueFormat("^(http|https|ftp)\\:\\/\\/[\\w\\-\\_\\.]+[\\w\\-\\_](:[\\w]*)?\\/?([\\w\\-\\._\\?\\,\\'\\/\\\\\\+&amp;%\\$#\\=~])*$"));C.block1.append((new linb.UI.Button).host(C,"btnUp").setLeft(358).setTop(8).setWidth(142).setCaption("$app.caption.upload").setVAlign("middle").onClick("_up_click"));C.block1.append((new linb.UI.Button).host(C,"btnWeb").setLeft(358).setTop(39).setWidth(142).setCaption("$app.caption.openweb").setVAlign("middle").onClick("_btnweb_onclick"));return B},_up_click:function(B){if(this.iUploader.getUIValue()){var A=this.iUploader.getUploadObj();_.tryF(this.onUpload,[A]);this.iUploader.resetValue()}},_btnweb_onclick:function(A){var B=this.iWeb;if(B.checkValid()){_.tryF(this.onOpenWeb,[B.getUIValue()]);B.resetValue()}}}});