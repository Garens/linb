Class("linb.Profile","linb.absProfile",{Constructor:function(h,f,e,g,d,c,b){arguments.callee.upper.apply(this,arguments);var a=this;_.merge(a,b);a.key=f||a.key||"";a.alias=e||a.alias||"",a.properties=d?_.copy(d):(a.properties||{});a.events=c?_.copy(c):(a.events||{});a.host=h||a.host||a;a.box=g||a.box||a.constructor;if(a.events){a.setEvents(a.events);delete a.events}a._links={}},Instance:{setEvents:function(b){var a=this.box.$EventHandlers;return _.merge(this,b,"all",function(d,c){return a[c]})},getEvents:function(){var a=this,b,c={};_.each(a.box.$EventHandlers,function(e,d){if(a[d]){c[d]=a[d]}});return c},getProperties:function(a){var b=this.properties;return a?b[a]:_.copy(b)},setProperties:function(a,b){if(_.isHash(a)){this.properties=a}else{this.properties[a]=b}},_applySetAction:function(a,b){return a.call(this,b)},__gc:function(){var a=this;a.unLinkAll();_.tryF(a.clearCache,[],a);var b=_.get(a,["box","_namePool"]);if(b){delete b[self.alias]}_.breakO([a.properties,a.events,a],2)},boxing:function(){var a=this,b;if(!a.box){return null}if(!((b=a.object)&&b.get(0)==a&&b._nodes.length==1)){b=a.object=a.box.pack([a],false)}return b},serialize:function(h,k){var i,j=this,e=(i=j.box._beforeSerialized)?i(j):j,a={alias:e.alias,key:e.key,host:e.host};if(a.host===j){delete a.host}else{if(e.host&&!k){if(h!==false){a.host="@this"}else{delete a.host}}}if(typeof e.theme=="string"){a.theme=e.theme}var g={},d=e.box.$DataStruct,b=linb.absObj.$specialChars;_.merge(g,e.properties,function(l,c){return(c in d)&&d[c]!==l&&!b[c.charAt(0)]});if(!_.isEmpty(g)){a.properties=g}if(!_.isEmpty(i=this.getEvents())){a.events=i}var f=e.box.$EventHandlers;_.filter(a.events,function(l,c){return l!=f[c]});if(_.isEmpty(a.events)){delete a.events}return h===false?a:_.serialize(a)}}});Class("linb.absObj","linb.absBox",{Constructor:function(){arguments.callee.upper.apply(this,arguments);if(arguments[0]!==false&&typeof this._ini=="function"){return this._ini.apply(this,arguments)}},Before:function(b,a,c){linb.absBox.$type[b]=b;return true},After:function(){var w=this,h=arguments.callee,r,s,e,q,c,g,f,d,p,a,o;w._nameId=0;w._namePool={};w._nameTag=w.$nameTag||("ctl_"+(s=w.KEY.split("."))[s.length-1].toLowerCase());w._cache=[];if(w===linb.absObj||w===linb.absObj){return}c=h.a1||(h.a1=_.toArr("$Keys,$DataStruct,$EventHandlers,$DataModel"));for(f=0;p=c[f++];){e={};if((s=w.$parent)&&(g=s.length)){while(g--){_.merge(e,s[g][p])}}w[p]=e}w.setDataModel(w.DataModel);delete w.DataModel;w.setEventHandlers(w.EventHandlers);delete w.EventHandlers;c=h.a5||(h.a5=_.toArr("RenderTrigger,LayoutTrigger"));for(f=0;p=c[f++];){r=[];if((s=w.$parent)&&(d=s.length)){for(g=0;g<d;g++){q=s[g];if(q=q["$"+p]){r.push.apply(r,q)}}}if(w[p]){r.push(w[p])}w["$"+p]=r;delete w[p]}},Static:{$abstract:true,$specialChars:{_:1,$:1},getAll:function(){return this.pack(this._cache)},pickAlias:function(){var c,d=this._namePool,b=this._nameTag;while(d[c=(b+(++this._nameId))]){}return c},setDataModel:function(h){var s=this,p=linb.absObj.$specialChars,e=s.$DataStruct,l=s.$DataModel,b=s.prototype,k,g,q,c,d,f,a;for(k in h){if(!l[k]){l[k]={}}c=h[k];if(null===c||undefined===c){a=_.str.initial(k);delete e[k];delete l[k];delete b["get"+a];delete b["set"+a]}else{q=typeof c;if(q!="object"||c.constructor!=Object){c={ini:c}}e[k]=("ini" in c)?c.ini:(k in e)?e[k]:"";q=l[k];for(g in q){if(!(g in c)){c[g]=q[g]}}l[k]=c}}_.each(h,function(r,m){if(null===r||undefined===r||p[m.charAt(0)]){return}a=_.str.initial(m);d="set"+a;if(!(r&&(r.readonly||r.inner))){var j=r.set;f=b[d];b[d]=(typeof j!="function"&&typeof f=="function")?f:Class._fun(function(o,i){return this.each(function(w){if(!w.properties){return}if(w.properties[m]===o&&!i){return}var x=w.properties[m];if(w.beforePropertyChanged&&false===w.boxing().beforePropertyChanged(w,m,o,x)){return}if(typeof j=="function"){j.call(w,o,x)}else{var u=_.get(w.box.$DataModel,[m,"action"]);w.properties[m]=o;if(typeof u=="function"&&w._applySetAction(u,o,x)===false){w.properties[m]=x}}if(w.afterPropertyChanged){w.boxing().afterPropertyChanged(w,m,o,x)}})},d,s.KEY,null,"instance");delete r.set;if(b[d]!==f){b[d].$auto$=1}}else{delete b[d]}d="get"+a;if(!(r&&r.inner)){var n=r.get;f=b[d];b[d]=(typeof n!="function"&&typeof f=="function")?f:Class._fun(function(){if(typeof n=="function"){return n.call(this.get(0))}else{return this.get(0).properties[m]}},d,s.KEY,null,"instance");delete r.get;if(b[d]!==f){b[d].$auto$=1}}else{delete b[d]}});return s},setEventHandlers:function(b){var a=this;_.each(b,function(e,c){if(null===e){delete a.$EventHandlers[c];delete a.prototype[c]}else{a.$EventHandlers[c]=e;var d=function(g){var f=arguments.length;if(f==1&&(typeof g=="function"||typeof g=="string")){return this.each(function(j){if(j.renderId){j.clearCache()}j[c]=g})}else{if(f==1&&null===g){return this.each(function(j){j.clearCache();delete j[c]})}else{var n=[],i=this.get(0),o=i[c],h=i.host||i,m;if(i.$inDesign){return}if(arguments[0]!=i){n[0]=i}for(m=0;m<f;m++){n[n.length]=arguments[m]}i.$lastEvent=c;if(typeof o=="string"){o=h[o]}if(typeof o=="function"){return _.tryF(o,n,h)}}}};d.$event$=1;d.$original$=e.$original$||a.KEY;d.$name$=c;d.$type$="event";a.plugIn(c,d)}});return a}},Instance:{setAlias:function(f){var b=this,c=this.get(0),a;if(a=c.alias){if(c.host&&c.host!==c){try{delete c.host[a]}catch(d){c.host[a]=undefined}if(c.host._ctrlpool){delete c.host._ctrlpool[a]}}delete b.constructor._namePool[a]}b.constructor._namePool[c.alias=f]=1;if(c.host&&c.host!==c){c.host[f]=b;if(c.host._ctrlpool){c.host._ctrlpool[f]=b.get(0)}}return b},getAlias:function(){return this.get(0).alias},alias:function(a){return a?this.setAlias(value):this.getAlias()},host:function(b,a){return b?this.setHost(b,a):this.getHost()},setHost:function(c,b){var a=this;a.get(0).host=c;if(b){a.setAlias(b)}return a},getHost:function(){return this.get(0).host}}});Class("linb.DataBinder","linb.absObj",{Instance:{_ini:function(d,h,g){var i=this,e=i.constructor,a,j,f=e._namePool,b;if(d&&d["linb.Profile"]){a=d;b=a.alias||e.pickAlias()}else{if(d&&d.key&&linb.absBox.$type[d.key]){j=d;d=null;b=j.alias;b=(b&&!f[b])?b:e.pickAlias()}else{b=e.pickAlias()}a=new linb.Profile(g,i.$key,b,e,d,h,j)}f[b]=1;a._n=a._n||[];a._valuesMap=a._valuesMap||{};a.link(e._cache,"self").link(linb._pool,"linb");if(!a.name){a.boxing().setName(b)}i._nodes.push(a);return i},destroy:function(){this.each(function(b){var c=b.box,a=b.properties.name;_.arr.each(b._n,function(d){if(d){c._unBind(a,d)}});delete c._pool[a];b.__gc()})},updateValue:function(){return this.each(function(c,a){var b=c._valuesMap;_.arr.each(c._n,function(d){d.boxing().updateValue();b[d.properties.dataField]=d.properties.value})})},resetValue:function(h,f){var e,g,d,i,a;f=f!==false;return this.each(function(c,b){if(!h){h={}}var j=f?h:c._valuesMap;_.arr.each(c._n,function(k){g=k.properties;e=g.dataField;if(f||e in h){d=(h&&e in h)?h[e]:"";j[e]=d;i="";a=k.boxing();if(_.isHash(d)){i=_.isSet(d.caption)?d.caption:null;d=d.value}a.resetValue(d);if(!_.isSet(g.caption)&&a.setCaption&&i!==null){_.tryF(a.setCaption,[i,true],a)}}});c._valuesMap=j})},getUI:function(a){var b;if(!a){b=linb.UI.pack(this.get(0)._n,false)}else{_.arr.each(this.get(0)._n,function(c){if(c.properties.dataField==a){b=c.boxing();return false}})}return b},checkValid:function(){return linb.absValue.pack(this.get(0)._n,false).checkValid()},getValue:function(a,d,g){var c=this,f=c.get(0),b=false;_.arr.each(f._n,function(h){var i=h.properties;if(i.value!==i.$UIvalue){b=true;return false}});if(b&&!c.checkValid()){return null}var e={};_.arr.each(f._n,function(k){var l=k.properties,h=k.boxing(),i=h.getValue(),j=h.getUIValue();if(!a||(a&&(j+" ")!==(i+" "))){if(g&&h.getCaption){e[l.dataField]={value:j,caption:h.getCaption()}}else{e[l.dataField]=j}if(d!==false&&k.renderId){h.updateValue()}}});if(!a){_.merge(e,f._valuesMap,"without")}if(d!==false){_.merge(f._valuesMap,e,"all")}return e},host:function(c,b){var a=this;if(c&&b){a.setName(b)}return arguments.callee.upper.apply(a,arguments)}},Static:{$nameTag:"databinder_",_pool:{},destroyAll:function(){this.pack(this._pool,false).destroy();this._pool={}},getFromName:function(a){var b=this._pool[a];return b&&b.boxing()},_bind:function(d,g){var k,j,f=this._pool[d];if(!f){f=new linb.DataBinder();f.setName(d);f=f.get(0)}var a=f._valuesMap;if(g){if(_.arr.indexOf(f._n,g)==-1){g.link(f._n,"databinder."+d)}var e=g.properties,h,i;if(k=e.dataField){j=(a&&k in a)?a[k]:"";a[k]=j;h="";i=g.boxing();if(_.isHash(j)){h=_.isSet(j.caption)?j.caption:null;j=j.value}i.resetValue(j);if(!_.isSet(e.caption)&&i.setCaption&&h!==null){_.tryF(i.setCaption,[h,true],i)}}}},_unBind:function(a,b){if(b&&b.box&&this._pool[a]){b.unLink("databinder."+a)}},DataModel:{name:{set:function(e,f){var g=this,i=linb.DataBinder,a=i._pool,h=a[f],b=a[e],d;a[g.properties.name=e]=g;if(h&&!b&&g._n.length){d=linb.absValue.pack(_.copy(g._n));_.arr.each(g._n,function(c){i._unBind(f,c)});d.setDataBinder(e)}if(b&&!h){g._n=b._n}if(h){delete a[f]}}}}}});Class("linb.UIProfile","linb.Profile",{Instance:{renderId:null,_render:function(){var f=this,e,h=linb.$cache.profileMap;if(!f.renderId){var g=linb.Dom.byId(f.$domId);if(!g){return}if(f.domId!=f.$domId){g.id=f.domId}h[f.domId]=h[f.$domId]=f;if(!g.$linbid){linb.UI.$addEventsHanlder(g,true)}f.renderId=g.$linbid;g=null}if(e=f.RenderTrigger){for(var d=0,b=e.length;d<b;d++){e[d].call(f)}delete f.RenderTrigger;if(f.onRender){f.boxing().onRender(f)}_.tryF(f.$onrender,[],f)}if(arguments[0]===true&&(e=f.LayoutTrigger)){for(var d=0,b=e.length;d<b;d++){e[d].call(f)}if(f.onLayout){f.boxing().onLayout(f)}}if(!f.properties.lazyAppend){if(f.children){for(var d=0,c;c=f.children[d++];){if(c[0]._render){c[0]._render(true)}}}if(f.$attached){for(var d=0,c;c=f.$attached[d++];){if(c._render){c._render(true)}}delete f.$attached}if(f.exchildren){var a=[];for(var d=0,c;c=f.exchildren[d++];){f.boxing().append(c[0],c[1])}delete f.exchildren}if(f.excoms){var a=[];for(var d=0,c;c=f.excoms[d++];){c[0].show(null,f.boxing(),c[1],false)}delete f.excoms}}},__gc:function(){var c=this,b;if(c.$destroyed){return}if(c.$beforeDestroy){_.tryF(c.$beforeDestroy,[],c);delete c.$beforeDestroy}_.tryF(c.$ondestory,[],c);if(c.onDestroy){c.boxing().onDestroy()}if(c.destroyTrigger){c.destroyTrigger()}if(!c.serialId){return}if(b=c._$composed){_.each(b,function(d){d.__gc()})}c.clearCache();if(b=c.$dockParent){if(b=c.constructor.getFromDom(b)){_.tryF(b.clearCache,[],b)}}if(!c.$noReclaim){b=linb.$cache.reclaimId;(b[c.key]||(b[c.key]=[])).push(c.serialId)}else{delete c.$noReclaim}delete linb.$cache.profileMap[c.domId];delete linb.$cache.profileMap[c.$domId];if(c.box){delete c.box._namePool[c.alias]}c.unLinkAll();if(c.LayoutTrigger){c.LayoutTrigger.length=0}if(c.RenderTrigger){c.RenderTrigger.length=0}if((b=c.children).length){b=_.copy(b);for(var a=0;a<b.length;a++){b[a][0].__gc();b[a].length=0}b.length=0}c.$destroyed=true;_.tryF(c.$afterdestory,[],c);_.breakO([c.properties,c.events,c.CF,c.CB,c.CC,c.CS,c],2);c.$destroyed=true},unlinkParent:function(){var a=this;delete a.parent;delete a.childrenId;a.unLink("$parent");return a},getRootNode:function(){return linb.getNodeData(this.renderId,"element")},getRoot:function(){return linb([this.renderId],false)},linkParent:function(a,c){var b=this;b.unlinkParent();b.parent=a;b.childrenId=c;b.link(a.children,"$parent",[b,c]);return b},_cacheR1:/^\w[\w_-]*$/,setDomId:function(d){var a=this,b=linb.$cache.profileMap;if(typeof d=="string"&&(a._cacheR1.test(d)||d==a.$domId)&&!linb.Dom.byId(d)){if(a.domId!=a.$domId){delete b[a.domId]}a.domId=d;if(a.renderId){a.getRootNode().id=d}if(b[a.$domId]){b[d]=a}}return a},getDomId:function(){return this.domId},clearCache:function(){var c=this,b=c.$_egetter;for(var a in b){b[a].length=0;delete b[a]}b=c.$_domid;for(var a in b){b[a].__gc();delete b[a]}return c},_getEV:function(j,c,b){var o=this,k=c+"+"+b,h=o.$_egetter||(o.$_egetter={}),a;if(h[k]){Array.prototype.push.apply(j,h[k]);return}else{a=h[k]=[]}var e=linb.$cache.profileMap,n,m;if((n=e[c])&&(n=n.events)&&(n=n[b])){for(var f=0,d=n.length;f<d;f++){if(typeof n[n[f]]=="function"){a.push(j[j.length]=n[n[f]])}}}m=c.split(":")[0].split("-")[1];if(typeof(((n=o._CB)&&(m?(n=n[m]):1))&&(n=n[b]))=="function"){a.push(j[j.length]=n)}else{if(typeof(((n=o.CB)&&(m?(n=n[m]):1))&&(n=n[b]))=="function"){a.push(j[j.length]=n)}else{if(typeof(((n=o.behavior)&&(m?(n=n[m]):1))&&(n=n[b]))=="function"){a.push(j[j.length]=n)}}}},_cacheR2:/<!--\x03([^>^\s]*)\x04-->/g,toHtml:function(e){var v=this,q=v.box,l={},r,p="linb.UIProfile",n="linb.Profile",d,k,f,g,u,s,j;j=q._prepareData(v);if(q._dynamicTemplate){q._dynamicTemplate(v)}r=q._build(v,j);if((!v.properties.lazyAppend||e)&&(g=v.children)){for(k=0;f=g[k++];){if(f[0][p]){d=f[1]||"";u=l[d]||(l[d]=[]);u[u.length]=f[0].toHtml(e)}else{if(!f[0][n]){s.ini.call(s,f[0]);f[0]=s.get(0)}}}}return r.replace(v._cacheR2,function(h,c){return l[c]?l[c].join(""):""})},_buildItems:function(c,b,e){var a=this,d=a.box,f=d._rpt(a,linb.UI.$doTemplate(a,_.get(linb.$cache.template,[d.KEY,a._hash]),b,c));return linb.UI.$toDom(f.replace(a._cacheR2,""),e)},serialize:function(i,l){var j,f,k=this,e=(j=k.box._beforeSerialized)?j(k):k,a={alias:e.alias,key:e.key,host:e.host};if(a.host===k){delete a.host}else{if(e.host&&!l){if(i!==false){a.host="@this"}else{delete a.host}}}if(typeof e.theme=="string"){a.theme=e.theme}if(e.$domId!=e.domId){a.domId=e.domId}var h={},d=e.box.$DataStruct,b=linb.absObj.$specialChars;_.merge(h,e.properties,function(m,c){return(c in d)&&d[c]!==m&&!b[c.charAt(0)]});if(!_.isEmpty(h)){a.properties=h}if(!_.isEmpty(j=this.getEvents())){a.events=j}var g=e.box.$EventHandlers;_.filter(a.events,function(m,c){return m!=g[c]});if(_.isEmpty(a.events)){delete a.events}if(!_.isEmpty(e.CB)){a.CB=_.copy(e.CB)}if(!_.isEmpty(e.CC)){a.CC=_.copy(e.CC)}if(!_.isEmpty(e.CF)){a.CF=_.copy(e.CF)}if(!_.isEmpty(e.CS)){a.CS=_.copy(e.CS)}if(typeof e.theme=="string"){a.theme=e.theme}if(e.children&&e.children.length){e.children.sort(function(c,m){c=parseInt(c[0].properties.tabindex);m=parseInt(m[0].properties.tabindex);return c>m?1:c==m?0:-1});j=a.children=[];_.arr.each(e.children,function(c){f=[c[0].serialize(false,l)];if(c[1]){f[1]=c[1]}j[j.length]=f})}if(e.exchildren&&e.exchildren.length){a.exchildren=e.exchildren}return i===false?a:_.serialize(a)},_applySetAction:function(a,b,c){if(this.renderId){return a.call(this,b,c)}},getKey:function(b){var a;if(b.charAt(0)=="!"){b=linb.use(b).id()}if(b.indexOf(":")==-1){b=(a=linb.$cache.profileMap[b])&&(a.$domId)}return b?b.split(":")[0]:""},getSubId:function(b){var a;if(b.charAt(0)=="!"){b=linb.use(b).id()}if(b.indexOf(":")==-1){b=(a=linb.$cache.profileMap[b])&&(a.$domId)}return b?b.split(":")[2]:""},pickSubId:function(b){var a=this,c,d=a.cache_subid||(a.cache_subid={});if((d[b]||(d[b]=[]))[0]){return d[b].shift()}d=a.subId||(a.subId={});c=(d[b]||(d[b]=new _.id)).next();return c},reclaimSubId:function(c,a){var b=this.cache_subid||(this.cache_subid={});(b[a]||(b[a]=[])).push(c)},_cacheR3:/\./g,_cacheH1:{},getClass:function(c,a){c=this.keys[c]||c;var b=this,d=c+":"+(a||"");return b._cacheH1[d]||(b._cacheH1[d]=c.replace(b._cacheR3,"-").toLowerCase().replace("linb-ui","linb")+(a||""))},_getSubNodeId:function(c,b){var a=this.$domId.split(":");a[0]=c;a[2]=_.isSet(b)?(b+""):"";c=a.join(":");return c==this.$domId?linb.$cache.profileMap[c].domId:c},getSubNode:function(d,b){var a=this;if(!a.renderId){return linb()}var d=a.keys[d]||d,g,c,f,e=a.$_domid||(a.$_domid={});if(b===true){g=linb([a.renderId]).query("*","id",d==a.keys.KEY?a.domId:new RegExp("^"+d+":"+a.serialId))}else{if(!_.isSet(b)&&e[d]&&e[d]._nodes.length==1){return e[d]}g=(c=linb.Dom.byId(f=a._getSubNodeId(d,b)))?linb([c]):((c=a.renderId)&&linb.use(c).query("*","id",f));if(!_.isSet(b)){e[d]=g}}return g},getSubNodes:function(b,d){var e=0,c=[],f;for(;f=b[e++];){Array.prototype.push.apply(c,this.getSubNode(f,d).get())}return linb(c)},getSubNodeByItemId:function(a,b){return(b=this.getSubIdByItemId(b))?this.getSubNode(a,b):linb()},getItemByItemId:function(b){var a;if((a=this.ItemIdMapSubSerialId)&&(a=a[b])){return this.SubSerialIdMapItem[a]}},getItemByDom:function(a){return this.SubSerialIdMapItem&&this.SubSerialIdMapItem[this.getSubId(typeof a=="string"?a.charAt(0)=="!"?((a=linb.use(a).get(0))&&a.id):a:a.id)]},getItemIdByDom:function(b){var a;return(a=this.getItemByDom(b))&&a.id},getSubIdByItemId:function(b){var a;return(a=this.ItemIdMapSubSerialId)&&a[b]},queryItems:function(d,c,b,i,a){var g=[],e=arguments.callee,h=e.f||(e.f=function(l,k,j,n,f,m){_.arr.each(l,function(q,p){if(k===true||k.call(null,q,p,l)){m.push(f?[q,p,l]:q);if(n){return false}}if(j&&q.sub&&q.sub.length){h(q.sub,k,j,n,f,m)}})});h(d,c,b,i,a,g);return g}},Static:{getFromDom:function(a){if((a=typeof a=="string"?a.charAt(0)=="!"?((a=linb.use(a).get(0))&&a.id):a:(a&&a.id))&&(a=linb.Event._getProfile(a))&&a["linb.UIProfile"]){return a}}}});Class("linb.UI","linb.absObj",{Before:function(b,a,c){linb.absBox.$type[b.replace("linb.UI.","").replace("linb.","")]=linb.absBox.$type[b]=b;return true},After:function(){linb.absObj.After.apply(this,arguments);var y=this,n=arguments.callee,s,x,a,r,m,g,f,h,p,q,o,l;y._ctrlId=new _.id();y._idCache=[];y.$cssKeys={};x=y.$Keys;x.KEY=x.$key=y.KEY;y.addTemplateKeys(_.toArr(x,true));q="$Behaviors";a={};if((x=y.$parent)&&(h=x.length)){while(h--){o=x[h][q];for(g in o){if(typeof o[g]=="object"){if(_.isArr(o[g])){r=a[g]||(a[g]=[]);r.push.apply(r,o[g])}else{r=a[g]||(a[g]={});_.merge(r,o[g])}}else{a[g]=o[g]}}}}y[q]=a;q="$Templates";a={};if((x=y.$parent)&&(h=x[0])){for(g in h[q]){if(g.charAt(0)!="$"){a[g]=h[q][g]}}}y[q]=_.clone(a);q="$Appearances";a={};if((x=y.$parent)&&(h=x.length)){while(h--){o=x[h];for(g in o[q]){x=o[q][g];r=a[g]||(a[g]={});_.merge(r,x)}}}y[q]=a;y.setTemplate(y.Templates);delete y.Templates;y.setBehavior(y.Behaviors||{});delete y.Behaviors;y.setAppearance(y.Appearances);delete y.Appearances;if(x=y.PublicAppearance){linb.UI.$cache_css+=y.buildCSSText(x);delete y.PublicAppearance}},Instance:{setTheme:function(c){if(typeof c!="string"||!c){c=null}var b,a=[];this.each(function(d){if(c!=d.theme){if(c===null){delete d.theme}else{d.theme=c}a.push(d)}});linb.UI.pack(a,false).refresh();return this},getTheme:function(){return this.get(0)&&this.get(0).theme},destroy:function(){this.each(function(a){if(a.$destroyed){return}if(a.$beforeDestroy){_.tryF(a.$beforeDestroy,[],a);delete a.$beforeDestroy}if(a.beforeDestroy&&false===a.boxing().beforeDestroy()){return}if(a.renderId){a.getRoot().remove()}else{a.__gc()}});this._nodes.length=0},serialize:function(c,d){var b=[];this.each(function(a){b[b.length]=a.serialize(false,d)});return c===false?b:b.length==1?" new "+b[0].key+"("+_.serialize(b[0])+")":"linb.UI.unserialize("+_.serialize(b)+")"},getProperties:function(c){var b={},e=this.get(0),f=e.properties,d;if(c){return _.copy(f)}else{for(var a in f){d="get"+_.str.initial(a);if(typeof this[d]=="function"){b[a]=this[d].call(this)}}return b}},setProperties:function(a,c){if(typeof a=="string"){var b={};b[a]=c;a=b}return this.each(function(d){_.each(a,function(f,e){var h="set"+_.str.initial(e),g=d.boxing();if(typeof g[h]=="function"){g[h].call(g,f)}})})},setEvents:function(a,c){if(typeof a=="string"){var b={};b[a]=c;a=b}return this.each(function(e){var d=e.boxing();_.each(a,function(g,f){if(typeof d[f]=="function"){d[f].call(d,g)}})})},_toDomElems:function(){var a=[];_.arr.each(this._nodes,function(b){if(!b.renderId){a.push(b)}});if(a.length){linb.UI.pack(a,false).render()}a.length=0;_.arr.each(this._nodes,function(b){a.push(b.renderId)});return a},_ini:function(h,d,n,u,a,j,k,g){var o=this,s=o.constructor,e,m="default",f,b=s._namePool,p,r;if(h&&h["linb.Profile"]){e=h;p=e.alias||s.pickAlias();linb.UIProfile.apply(e,[n,o.$key,p,s,null,d])}else{if(h&&h.key&&linb.absBox.$type[h.key]){f=h;h=null;p=f.alias;p=(p&&!b[p])?p:s.pickAlias()}else{p=s.pickAlias()}e=new linb.UIProfile(n,o.$key,p,s,h,d,f)}b[p]=1;for(var q in (r=s.$DataStruct)){if(!(q in e.properties)){e.properties[q]=typeof r[q]=="object"?_.copy(r[q]):r[q]}}e.keys=s.$Keys;e.CS=a?_.copy(a):(e.CS||{});e.CB=k?_.copy(k):(e.CB||{});e.CC=j?_.copy(j):(e.CC||{});e.CF=g?_.copy(g):(e.CF||{});if(typeof u=="string"){e.theme=u}e.template=s.getTemplate();e.behavior=s.$Behaviors;if(!e.serialId){e.serialId=s._pickSerialId()}e.$domId=e.key+":"+e.serialId+":";e.domId=e.domId||e.$domId;e.RenderTrigger=_.copy(s.$RenderTrigger);e.LayoutTrigger=_.copy(s.$LayoutTrigger);e.link(linb.UI._cache,"UI").link(s._cache,"self").link(linb._pool,"linb");r=e.children;e.children=[];if(r&&r.length){for(var q=0,l;l=r[q++];){if(!l[0]["linb.UIProfile"]){l[0]=new (linb.SC(l[0].key))(l[0]).get(0)}l[0].linkParent(e,l[1])}}o._nodes.push(e);return o},busy:function(c,b,a){c=typeof c=="string"?c:"Loading...";b=typeof b=="string"?b:'<span style="background:'+linb.UI.$bg("busy.gif","no-repeat left center")("linb.UI.Public")+';padding-left:16px;">'+c+"</span>";return this.each(function(d){_.resetRun(d.$linbid+":busy",function(){var h=d.keys;a=h[a]||h.BORDER||h.PANEL||h.KEY;var e=d.getSubNode(a),f=e.cssSize(),g;if(!(g=d.$busy)){g=d.$busy=linb.create('<div style="left:0;top:0;z-index:10;position:absolute;background-color:#DDD;"></div><div style="left:0;top:0;z-index:20;text-align:center;position:absolute;"><div>'+b+"</div></div>");linb([g.get(0)]).css({opacity:0.5});linb(e).append(g)}g.css({display:"",width:f.width+"px",height:f.height+"px"});linb([g.get(1).firstChild]).html(b,false).css("paddingTop",f.height/2+"px")},50)})},free:function(){return this.each(function(a){_.resetRun(a.$linbid+":busy");if(a.$busy){a.$busy.css("display","none")}})},reLayout:function(a){return this.each(function(c){if(!c.renderId){return}var b=c.properties;if((!c.$noB)&&b.border&&c.boxing()._border){c.boxing()._border(null,false)}if(b.dock&&b.dock!="none"){c.boxing().adjustDock(a)}else{if(a){c._resize_h=-1;c._resize_w=-1}linb.UI.$tryResize(c,b.width,b.height,a)}})},toHtml:function(c){var b=[];_.arr.each(this._nodes,function(a){b[b.length]=a.toHtml(c)});return b.join("")},render:function(c){var h=this,g=[],f,e,b,d=h._nodes,k,j=[],m=linb.Dom.byId;linb.UI.$applyCSS();for(f=0;b=d[f++];){if(!b.renderId&&!linb.Dom.byId(b.domId)&&!linb.Dom.byId(b.$domId)){g[g.length]=b}}if(e=g.length){for(f=0;f<e;f++){j[j.length]=g[f].toHtml()}linb.UI.$toDom(j.join(""))}for(f=0;b=d[f++];){b._render(c)}j.length=g.length=0;return h},renderOnto:function(e,d){e=linb(e);if(e.isEmpty()){return this}var b=this,f=b.get(0),c=arguments.callee,a=c.para||(c.para=function(i){var h=i.cssRegion();h.tabindex=i.attr("tabIndex");if(h.tabindex<=0){delete h.tabindex}h.zIndex=i.css("zIndex");h.position=i.css("position");return h}),g=e.id();_.merge(f.properties,a(e),"all");f.properties.dock="none";if(!f.alias&&g){f.alias=g}if(f.alias){b.setHost(d||window,f.alias)}b.render(true);e.replace(b.getRoot());if(g){b.setDomId(g)}return b},setDomId:function(a){this.get(0).setDomId(a);return this},hide:function(){return this.each(function(a){if(a.renderId){a.getRoot().hide();a.properties.top=a.properties.left=-10000;a.properties.dockIgnore=true}})},show:function(b,a,d,c){return this.each(function(h){var f=h.properties,e;d=(d||d===0)?(parseInt(d)||0):null;c=(c||c===0)?(parseInt(c)||0):null;if(d!==null){f.left=d}if(c!==null){f.top=c}if(linb.getNodeData(h.renderId,"_linbhide")){e=1;f.dockIgnore=false;h.getRoot().show(d&&(d+"px"),c&&(c+"px"));if(f.dock&&f.dock!="none"){linb.UI.$dock(h,false,true)}}else{if(!b&&(!h.renderId||(h.getRootNode().id||"").indexOf(linb.Dom._emptyDivId)===0)){b=linb("body")}}var g=b,i;if(g){if(g["linb.UIProfile"]){i=g.renderId;g=g.boxing()}else{if(g["linb.UI"]){i=(i=g.get(0))&&i.renderId}else{i=(g=linb(g))&&g._nodes[0]}}if(i){g.append(h.boxing(),a);if(!e){h.getRoot().show(d&&(d+"px"),c&&(c+"px"))}}}})},clone:function(){var a=[],b=function(e){delete e.alias;delete e.domId;if(e.children){for(var d=0,f;f=e.children[d];d++){b(f)}}};this.each(function(c){c=c.serialize(false,true);b(c);a.push(c)});return this.constructor.unserialize(a)},refresh:function(){var l,d,i,a,k,e,f,h,g,c,j;return this.each(function(m){if(!m.renderId){return}g=m.box;e=m.$linbid;f=m.serialId;if(typeof m.boxing().getUIValue=="function"){j=m.boxing().getUIValue();if(m.boxing().getValue()===j){j=null}}if(i=!!m.parent){a=m.parent.boxing();l=m.childrenId}else{a=m.getRoot().parent()}d=linb.$getGhostDiv();m.boxing().getChildren().reBoxing().each(function(n){d.appendChild(n)});d=null;c=_.copy(m.children);m.boxing().removeChildren();k=m.serialize(false,true);h=m.$refreshTrigger;var b=linb.create("span");m.getRoot().replace(b);m.$noReclaim=1;m.boxing().destroy();_.merge(m,k,"all");delete m.$destroyed;m.$linbid=e;m.serialId=f;m=new g(m).render();if(h){h.call(h.target,m.get(0))}if(i){a.append(m,l)}else{a.append(m)}_.arr.each(c,function(n){delete n[0].$dockParent;m.append.apply(m,n)});b.replace(m.get(0).getRoot());b.remove();b=null;if(j){m.setUIValue(j,true)}})},append:function(c,b){if(_.isHash(c)||_.isStr(c)){c=linb.create(c)}if(c["linb.UIProfile"]){c=c.boxing()}var d=this.get(0),a;if(d.beforeAppend&&false===this.beforeAppend(d,c)){return}if(c["linb.Com"]){if(d.renderId){if(b=typeof b=="string"?b:null){b=d.getSubIdByItemId(b)}a=d.keys.PANEL?d.getSubNode(d.keys.PANEL,b):d.getRoot();if(!a.isEmpty()){a.append(c)}}else{(d.excoms||(d.excoms=[])).push([c,b])}}else{if(b!==false){if(c["linb.UI"]){c.each(function(e){e.linkParent(d,b)})}}if(d.renderId){if(b=typeof b=="string"?b:null){b=d.getSubIdByItemId(b)}a=d.keys.PANEL?d.getSubNode(d.keys.PANEL,b):d.getRoot();if(!a.isEmpty()){a.append(c)}}else{if(!c["linb.UI"]){if(!d.exchildren){d.exchildren=[]}d.exchildren.push([c,b])}}}if(d.afterAppend){this.afterAppend(d,c)}return this},getChildren:function(c){var b=[];_.arr.each(this.get(0).children,function(a){if(c?a[1]==c:1){b.push(a[0])}});return linb.UI.pack(b)},removeChildren:function(a,b){return this.each(function(d){var e=_.copy(d.children);_.arr.each(e,function(c){if(a===true?1:a?typeof a=="string"?(c[1]==a):(c[0]==(a["linb.UI"]?a.get(0):a)):1){if(d.beforeRemove&&false===d.boxing().beforeRemove(d,c[0],c[1],b)){return}c[0].unlinkParent();if(d.afterRemove){d.boxing().afterRemove(d,c[0],c[1],b)}if(b){c[0].boxing().destroy()}}})})},dragable:function(b,d,c,a){return this.each(function(e){e.getSubNode(e.keys[c]||"KEY",true).beforeMousedown(b?function(h,f,g){if(linb.Event.getBtn(f)!="left"){return}if(h.properties.disabled){return}a=a||{};a.dragKey=b;a.dragData=typeof d=="function"?d():d;_.merge(a,{dragCursor:"pointer",dragType:"icon",dragDefer:1});linb.use(g).startDrag(f,a)}:null,"_d",-1).beforeDragbegin(b?function(f,g,h){linb.use(h).onMouseout(true,{$force:true}).onMouseup(true)}:null,"_d",-1);if(!b){e.clearCache()}})},setCustomFunction:function(a,b){return this.each(function(c){if(typeof a=="string"){if(b){c.CF[a]=b}else{delete c.CF[a]}}else{c.CF=a||{}}})},setCustomClass:function(b,d){var c=arguments.callee,a=(c.fun||(c.fun=function(l,g,j,f){if(!j[g]){return}var k=l.getSubNode(g,true),e;if(!k.isEmpty()){_.arr.each(j[g].split(/\s+/),function(h){k[f?"removeClass":"addClass"](h)})}}));return this.each(function(g){var e=_.copy(g.CC);if(typeof b=="string"){if(g.renderId){if(b in e){a(g,b,e,true)}}if(!d){delete g.CC[b]}else{g.CC[b]=d;if(g.renderId){a(g,b,g.CC)}}}else{if(!!b&&typeof b=="object"){if(g.renderId){for(var f in b){a(g,f,e,true)}for(var f in b){a(g,f,b)}}g.CC=b}else{if(g.renderId){for(var f in e){a(g,f,e,true)}}g.CC={}}}})},setCustomStyle:function(b,d){var c=arguments.callee,a=(c.fun||(c.fun=function(l,g,j,f){if(!j[g]){return}var k=l.getSubNode(g,true),e;if(!k.isEmpty()){_.arr.each(j[g].split(";"),function(n,h){if((e=n.split(":")).length==2){e[0]=e[0].replace(/\-(\w)/g,function(o,i){return i.toUpperCase()});try{k.css(e[0],f?"":e[1])}catch(m){}}})}}));return this.each(function(g){var e=_.copy(g.CS);if(typeof b=="string"){if(g.renderId){if(b in e){a(g,b,e,true)}}if(!d){delete g.CS[b]}else{g.CS[b]=d;if(g.renderId){a(g,b,g.CS)}}}else{if(!!b&&typeof b=="object"){if(g.renderId){for(var f in b){a(g,f,e,true)}for(var f in b){a(g,f,b)}}g.CS=b}else{if(g.renderId){for(var f in e){a(g,f,e,true)}}g.CS={}}}})},setCustomBehavior:function(a,b){return this.each(function(c){if(typeof a=="string"){if(c.keys[a]){c.CB[a]=b||{}}}else{c.CB=a||{}}if(c.CB.KEY){_.merge(c.CB,c.CB.KEY,"all");delete c.CB.KEY}c.clearCache()})},adjustDock:function(a){return this.each(function(b){if(b.properties.dock&&b.properties.dock!="none"){if(a){b.getRootNode().style.width=0;b.getRootNode().style.height=0;b._resize_h=-1;b._resize_w=-1}linb.UI.$dock(b,true,true)}})}},Initialize:function(){var b=this.prototype;_.arr.each("getSubNode,getDomId,getRootNode,getRoot".split(","),function(d){if(!b[d]){b[d]=function(){var e=this.get(0);return e[d].apply(e,arguments)}}b[d].$original$="linb.UI";b[d].$type$="instance";b[d].$name$=d});var a=this,c={};_.each(linb.UI.$ps,function(d,e){c[e]={ini:"auto",action:function(i){var g=this,j=g.properties,f=false,h;g.getRoot()[e]?g.getRoot()[e](i):linb.Dom._setPxStyle(g.getRootNode(),e,i);if(e=="width"||e=="height"){if(!g.box._onresize&&g.onResize){g.boxing().onResize(g,e=="width"?i:null,e=="height"?i:null)}}else{if(g.onMove){g.boxing().onMove(g,e=="left"?i:null,e=="top"?i:null,e=="right"?i:null,e=="bottom"?i:null)}}if(j.dock!="none"){h={$type:j.dock,$dockid:_.arr.indexOf(["width","height","fill","cover"],j.dock)!=-1?g.$linbid:null};switch(j.dock){case"top":if(e!="height"&&e!="top"){return}h.width=h.height=1;break;case"bottom":if(e!="height"&&e!="bottom"){return}h.width=h.height=1;break;case"left":if(e!="width"&&e!="left"){return}h.width=h.height=1;break;case"right":if(e!="width"&&e!="right"){return}h.width=h.height=1;break;case"width":if("width"==e){return}h.width=1;break;case"height":if("height"==e){return}h.height=1;break;case"fill":case"cover":if(e=="width"&&e=="height"){return}h.width=h.height=1;break}_.tryF(g.$dockFun,[h],g)}}}});_.merge(c,{renderer:{ini:null},zIndex:{ini:1,action:function(d){this.getRoot().css("zIndex",d)}},tabindex:{ini:1,action:function(f){var e=this,d=new RegExp("^"+e.key+"[-\\w]*:"+e.serialId+":");e.getRoot().query("*",function(g){return g.id&&d.test(g.id)&&g.getAttribute("tabIndex")}).attr("tabIndex",f)}},position:{ini:"absolute",listbox:["","static","relative","absolute"],action:function(d){this.getRoot().css("position",d)}},visibility:{listbox:["","visible","hidden"],action:function(d){this.getRoot().css("visibility",d);linb.setNodeData(this.getRootNode(),"_setVisibility",1)}},display:{listbox:["","none","block","inline","inline-block"],action:function(d){if(d=="inline-block"){this.getRoot().setInlineBlock()}else{this.getRoot().css("display",d)}}}});a.setDataModel(c);linb.UI.$cache_css+=linb.UI.buildCSSText({".linbcss-noscroll, .linbcss-noscroll BODY, .linbcss-viewport, .linbcss-viewport BODY":{overflow:"hidden",height:"100%",border:"0 none",margin:"0",padding:"0"},".ui-ctr":{},".ui-dragable":{},".ui-btn, .ui-btni, .ui-btnc":{height:"22px",background:linb.UI.$bg("button.gif","no-repeat",true)},".ui-btn":{$order:1,"white-space":"nowrap","vertical-align":"top",overflow:"hidden","background-position":"right top","padding-right":"4px","font-size":"12px"},".ui-btn *":{cursor:"pointer"},".ui-btnc button, .ui-btnc a":{display:linb.$inlineBlock,zoom:linb.browser.ie?1:null,background:"transparent",border:0,margin:0,padding:0},".ui-btnc a":{padding:"0 4px"},".ui-btni":{$order:1,"background-position":"left -60px","padding-left":"4px","vertical-align":"top"},".ui-btnc":{$order:1,"background-position":"left -30px","background-repeat":"repeat-x","padding-top":"3px","vertical-align":"top"},".ui-btn-mouseover, .ui-btn-focus":{$order:2,"background-position":"right -90px"},".ui-btn-mouseover .ui-btni, .ui-btn-focus .ui-btni":{$order:2,"background-position":"left -150px"},".ui-btn-mouseover .ui-btnc, .ui-btn-focus .ui-btnc":{$order:2,"background-position":"left -120px"},".ui-btn-mousedown, .ui-btn-checked":{$order:3,"background-position":"right -180px"},".ui-btn-mousedown .ui-btni, .ui-btn-checked .ui-btni":{$order:3,"background-position":"left -240px"},".ui-btn-mousedown .ui-btnc, .ui-btn-checked .ui-btnc":{$order:3,"background-position":"left -210px"},".ui-icon":{"vertical-align":"middle",width:"16px",height:"16px","background-repeat":"no-repeat",margin:"0 4px 0 2px"},".uicmd-close, .uicmd-opt, .uicmd-pop, .uicmd-land, .uicmd-refresh, .uicmd-toggle, .uicmd-toggle2, .uicmd-min, .uicmd-max,.uicmd-restore,.uicmd-pin, .uicmd-check, .uicmd-radio, .uicmd-add":{background:linb.UI.$bg("icons.gif","no-repeat 0 0",true),width:"16px",height:"16px","margin-right":"2px",cursor:"default","vertical-align":"middle"},".uicmd-empty":{width:"16px",height:"16px","margin-right":"2px",cursor:"default","vertical-align":"middle"},".uicmd-opt":{$order:1,"background-position":"0 0"},".uicmd-opt-mouseover":{$order:2,"background-position":"0 -20px"},".uicmd-opt-mousedown":{$order:3,"background-position":"0 -40px"},".uicmd-pop, .uicmd-land":{$order:1,"background-position":"-40px 0"},".uicmd-pop-mouseover, .uicmd-land-mouseover":{$order:2,"background-position":"-40px -20px"},".uicmd-pop-mousedown, .uicmd-land-mousedown":{$order:3,"background-position":"-40px -40px"},".uicmd-refresh":{$order:1,"background-position":"-280px 0"},".uicmd-refresh-mouseover":{$order:2,"background-position":"-280px -20px"},".uicmd-refresh-mousedown":{$order:3,"background-position":"-280px -40px"},".uicmd-pin":{$order:1,"background-position":"-80px 0"},".uicmd-pin-mouseover":{$order:2,"background-position":"-80px -20px"},".uicmd-pin-mousedown":{$order:3,"background-position":"-80px -40px"},".uicmd-pin-checked, .uicmd-pin-checked-mouseover, .uicmd-pin-checked-mousedown":{$order:4,"background-position":"-80px -40px"},".uicmd-min":{$order:1,"background-position":"-120px 0"},".uicmd-min-mouseover":{$order:2,"background-position":" -120px -20px"},".uicmd-min-mousedown":{$order:3,"background-position":"-120px -40px"},".uicmd-restore":{$order:1,"background-position":"-160px 0"},".uicmd-restore-mouseover":{$order:2,"background-position":"-160px -20px"},".uicmd-restore-mousedown":{$order:3,"background-position":"-160px -40px"},".uicmd-max":{$order:1,"background-position":"-200px 0"},".uicmd-max-mouseover":{$order:2,"background-position":"-200px -20px"},".uicmd-max-mousedown":{$order:3,"background-position":"-200px -40px"},".uicmd-close":{$order:1,"background-position":"-240px 0"},".uicmd-close-mouseover":{$order:2,"background-position":"-240px -20px"},".uicmd-close-mousedown":{$order:3,"background-position":"-240px -40px"},".uicmd-check":{$order:1,margin:"0 4px 0 2px","background-position":"-20px -70px"},".uicmd-check-mouseover":{$order:2,"background-position":"-20px -90px"},".uicmd-check-mousedown":{$order:3,"background-position":"-20px -110px"},".uicmd-check-checked":{$order:4,"background-position":"0 -70px"},".uicmd-check-checked-mouseover":{$order:5,"background-position":"0 -90px"},".uicmd-check-checked-mousedown":{$order:6,"background-position":"0 -110px"},".uicmd-radio":{$order:1,margin:"0 4px 0 2px","background-position":"-60px -70px"},".uicmd-radio-mouseover":{$order:2,"background-position":"-60px -90px"},".uicmd-radio-mousedown":{$order:3,"background-position":"-60px -110px"},".uicmd-radio-checked":{$order:4,"background-position":"-40px -70px"},".uicmd-radio-checked-mouseover":{$order:5,"background-position":"-40px -90px"},".uicmd-radio-checked-mousedown":{$order:6,"background-position":"-40px -110px"},".uicmd-add":{$order:1,"background-position":"-56px -222px"},".uicmd-add-mouseover":{$order:2,"background-position":"-56px -222px"},".uicmd-add-mousedown":{$order:3,"background-position":"-56px -222px"},".uicmd-toggle":{$order:1,"margin-left":"3px","background-position":"-160px -70px"},".uicmd-toggle-mouseover":{$order:2,"background-position":"-160px -90px"},".uicmd-toggle-mousedown":{$order:3,"background-position":"-160px -110px"},".uicmd-toggle-checked":{$order:4,"background-position":"-180px -70px"},".uicmd-toggle-checked-mouseover":{$order:5,"background-position":"-180px -90px"},".uicmd-toggle-checked-mousedown":{$order:6,"background-position":"-180px -110px"},".uicmd-toggle-busy":{$order:7,background:linb.UI.$bg("busy.gif","no-repeat center center",true)},".uicmd-toggle2":{$order:1,"background-position":"-200px -70px"},".uicmd-toggle2-mouseover":{$order:2,"background-position":"-200px -90px"},".uicmd-toggle2-mousedown":{$order:3,"background-position":"-200px -110px"},".uicmd-toggle2-checked":{$order:4,"background-position":"-220px -70px"},".uicmd-toggle2-checked-mouseover":{$order:5,"background-position":"-220px -90px"},".uicmd-toggle2-checked-mousedown":{$order:6,"background-position":"-220px -110px"},".uibar-top, .uibar-bottom, .uibar-top-s, .uibar-bottom-s":{position:"relative","vertical-align":"baseline","font-size":0,"line-height":0},".uibar-top td, .uibar-top-s td, .uibar-bottom td, .uibar-bottom-s td":{$order:1,background:linb.UI.$bg("bar_vertical.gif","no-repeat 0 0",true)},".uibar-top, .uibar-top .uibar-t":{height:"29px"},".uibar-top .uibar-tdl":{$order:1,"padding-left":"4px",height:"100%","background-position":"0 0"},".uibar-top .uibar-tdm":{$order:1,"background-position":"0 -30px","background-repeat":"repeat-x"},".uibar-top .uibar-tdr":{$order:1,"padding-left":"4px","background-position":"right -60px"},".uibar-top-focus .uibar-tdl":{$order:2,"padding-left":"4px",height:"100%","background-position":"left -90px"},".uibar-top-focus .uibar-tdm":{$order:2,"background-position":"left -120px","background-repeat":"repeat-x"},".uibar-top-focus .uibar-tdr":{$order:2,"padding-left":"4px","background-position":"right -150px"},".uibar-top .uibar-cmdl":{overflow:"hidden",position:"absolute",left:0,top:"6px",width:"92%",height:"22px","padding-left":"8px","white-space":"nowrap"},".uibar-top .uibar-cmdr":{position:"absolute",top:"6px",right:"8px","text-align":"right"},".uicon-main":{position:"relative","padding-left":"5px","font-size":0,"line-height":0,"z-index":1,overflow:"visible",background:linb.UI.$bg("bar_horizontal.gif","repeat-y -595px top",true)},".uicon-maini":{"padding-right":"5px","font-size":0,"line-height":0,background:linb.UI.$bg("container_right.gif","#AAD2FA repeat-y right top",true)},".uibar-bottom, .uibar-bottom .uibar-t":{height:"12px"},".uibar-bottom .uibar-tdl":{$order:1,"padding-left":"5px",height:"100%","background-position":"left -189px"},".uibar-bottom .uibar-tdm":{$order:1,"background-position":"left -211px","background-repeat":"repeat-x"},".uibar-bottom .uibar-tdr":{$order:1,"padding-left":"5px","background-position":"right -233px"},".uibar-top-s, .uibar-top-s .uibar-t":{$order:3,height:"7px"},".uibar-top-s .uibar-tdl":{$order:3,height:"100%","padding-left":"5px","background-position":"left -261px"},".uibar-top-s .uibar-tdm":{$order:3,"background-position":"left -283px","background-repeat":"repeat-x"},".uibar-top-s .uibar-tdr":{$order:3,"padding-left":"5px","background-position":"right -305px"},".uibar-top-s .uibar-cmdl":{$order:3,display:"none"},".uibar-top-s .uibar-cmdr":{$order:3,display:"none"},".uibar-bottom-s, .uibar-bottom-s .uibar-t":{$order:3,height:"6px"},".uibar-bottom-s .uibar-tdl":{$order:3,height:"100%","padding-left":"5px","background-position":"left -327px"},".uibar-bottom-s .uibar-tdm":{$order:3,"background-position":"left -349px","background-repeat":"repeat-x"},".uibar-bottom-s .uibar-tdr":{$order:3,"padding-left":"5px","background-position":"right -371px"}})+linb.UI.buildCSSText({".ui-ctrl":{"-moz-user-select":linb.browser.gek?"-moz-none":null,"vertical-align":"middle"},".uiw-shell":{background:"transparent",display:linb.$inlineBlock,zoom:linb.browser.ie6?1:null,border:0,padding:0,margin:0},".uiw-frame":{$order:1,display:"block",position:"relative",border:0,padding:0,margin:0,width:"100%",height:"100%","-moz-box-flex":"1"},".uiw-border":{$order:2,display:"block",position:"absolute",border:0,padding:0,margin:0,left:0,top:0,width:"100%",height:"100%"}})+linb.UI.buildCSSText({".uibg-base":{"background-color":"#fff"},".uibg-bar":{"background-color":"#aad2fa"},".uiborder-flat":{border:"solid 1px #648cb4"},".uiborder-inset":{border:"solid 1px","border-color":"#648cb4 #c8e1fa #c8e1fa #648cb4"},".uiborder-outset":{border:"solid 1px","border-color":"#c8e1fa #648cb4 #648cb4 #c8e1fa"}});linb.UI.$cache_css2+=linb.UI.buildCSSText({".ui-dirty":{$order:1,"background-image":linb.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"-390px -290px"},".ui-inputdisabled":{color:"#808080"},".ui-itemreadonly":{$order:2,color:"#808080"},".ui-readonly, .ui-readonly *":{$order:2,color:"#808080"},".ui-itemdisabled":{$order:2,cursor:"not-allowed",color:"#808080"},".ui-disabled, .ui-disabled *":{$order:2,color:"#808080"},".ui-invalid, .ui-invalid *":{$order:1,"background-color":"#FFEBCD"},"#linblangkey":{"vertical-align":"baseline"}})},$End:function(){linb.UI.$cache_css+=this.buildCSSText(this.$Appearances)},Static:{$cache_css:"",$cache_css2:"",$css_tag_dirty:"ui-dirty",$css_tag_invalid:"ui-invalid",$tag_left:"{",$tag_right:"}",$tag_subId:"_serialId",$x01:/\x01/img,$x01r:/ \x01 /img,$tag_special:"\x01",$ID:"\x01id\x01",$DOMID:"\x01domid\x01",$CLS:"\x01cls\x01",$childTag:"<!--\x03{id}\x04-->",$onSize:function(b,c){var a=b.getRootNode().style;if(c.width||c.height){linb.UI.$tryResize(b,a.width,a.height)}a=null},$theme:"default",$ps:{left:1,top:1,width:1,height:1,right:1,bottom:1},$toDom:function(g,f){if(f===false){return _.str.toDom(g)}var b=linb.Dom.getEmptyDiv().get(0),e=[];b.innerHTML=g;this.$addEventsHanlder(b);for(var d=0,c=b.childNodes,a=c.length;d<a;d++){linb.$registerNode(c[d]);e[e.length]=c[d].$linbid}b=null;return linb(e,false)},$addEventsHanlder:function(d,o){var a=linb.$cache.UIKeyMapEvents,g=linb.Event._eventHandler,c=_.toArr(d.getElementsByTagName("*")),m,e,h,f,b,p,n;if(o){c.push(d)}if(e=c.length){for(m=0;m<e;m++){if((d=c[m]).nodeType!=1){continue}if(b=d.id){if(p=a[b]||a[b.substr(0,b.indexOf(":"))]){n=linb.$registerNode(d);n=n.eHandlers||(n.eHandlers={});for(h in p){n[h]=p[h];if(f=g[h]){n[f]=d[f]=p[h]}}}}}}c.length=0;d=null},getFromDom:function(a){if(a=linb.UIProfile.getFromDom(a)){return a.boxing()}},unserialize:function(d,e){if(typeof d=="string"){d=_.unserialize(str)}var c=function(a){if(_.isArr(a)){a=a[0]}delete a.serialId;if(a.children){_.arr.each(a.children,c)}},b=[];_.arr.each(d,function(a){if(!e){c(a)}b.push((new (linb.SC(a.key))(a)).get(0))});return this.pack(b,false)},_ensureValues:function(c){var d=[],h=0,f=0,j,g=this.KEY,e=linb.$cache.profileMap,b=linb.getNodeData;if(c["linb.absBox"]){c=c._nodes}for(;j=c[h++];){if((j.box&&j.box[g])||((j=e[b(j.renderId?j.renderId:j,["element","id"])])&&j.box&&j.box[g])){d[f++]=j}}return d.length<=1?d:this._unique(d)},__gc:function(){var c=this,b=c.$key,a=linb.$cache;_.breakO([a.template[b],a.reclaimId[b],c._cache,c._idCache,c.$DataModel,c.$Templates,c.$Behaviors,c],2);delete linb.absBox.$type[b.replace("linb.UI.","")];delete linb.absBox.$type[b];_.filter(linb.$cache.UIKeyMapEvents,function(e,d){return !(d==b||d.indexOf(b+"-")==0)});Class.__gc(b)},_pickSerialId:function(){var a=linb.$cache.reclaimId[this.$key];if(a&&a[0]){return a.pop()}return this._ctrlId.next()},$bg:function(c,a,b){return function(d){var e=linb.ini.path+"appearance/default/"+(typeof b=="string"?b:b?"Public":(e=d.split("."))[e.length-1])+"/"+c;return"url("+e+") "+(a||"")}},$ieBg:function(b,a){return function(c){var d=linb.ini.path+"appearance/default/"+(typeof a=="string"?a:a?"Public":(d=c.split("."))[d.length-1])+"/"+b;return'progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+d+'",sizingMethod="crop")'}},$doTemplate:function(a,v,b,x,c){var g=arguments.callee,e,d,h,k=linb.UI.$x01,m=" \x01 ",j="",q=b.constructor==Array,u=v[x||""],f=!c,c=c||[];if(q){if(typeof u!="function"){u=g}for(var p=0;d=b[p++];){u(a,v,d,x,c)}}else{if(d=b.object){c[c.length]=d.toHtml()}else{if(typeof u=="function"){u(a,v,b,x,c)}else{x=x?x+".":"";var y=u[0],w=u[1];for(var p=0,o=y.length;p<o;p++){if(h=w[p]){if(h in b){d=b[h];if(v[e=x+h]&&d){g(a,v,d,e,c)}else{c[c.length]=(d===undefined||d===null||d===NaN)?j:typeof d=="string"?d.replace(k,m):d}}}else{c[c.length]=(y[p]===undefined||y[p]===null||y[p]===NaN)?j:y[p]}}}}}if(f){return c.join("")}},$buildTemplate:function(g,D,I,k,d){if(D&&String(D.tagName).toLowerCase()=="text"){d[d.length]=D.text;return}var q=arguments.callee,p=g.behavior?I?g.behavior[I]:g.behavior:null,G=q.map1||(q.map1={tagName:1,text:1}),E=q.map2||(q.map2={image:1,input:1,br:1,meta:1,hr:1,abbr:1,embed:1}),B=q.map3||(q.map3={input:1,textarea:1,pre:1,code:1}),x=q.r2||(q.r2=/[a-z]/),w=q.r3||(q.r3=/^(on|before|after)/),r=q.r7||(q.r7=/([^{}]*)\{([\w]+)\}([^{}]*)/g),h=false,j=linb.UI,n,s,C,e;if(!D){D=g.template}e=I?g.keys[I]:g.key;if(!D.tagName){D.tagName="span"}if(D.id!==null){D.id=I?e+":"+j.$ID+":"+j.$tag_left+j.$tag_subId+j.$tag_right:j.$DOMID}else{delete D.id}if(D.className!==null){n=j.$CLS+(I?"-"+I.toLowerCase():"");C=D.className||"";D["class"]=n+" "+C+" "+(e==g.key?"ui-ctrl ":"")+j.$tag_special+(I||"KEY")+"_CT"+j.$tag_special+" "+j.$tag_special+(I||"KEY")+"_CC"+j.$tag_special}delete D.className;D.style=(D.style||"")+";"+j.$tag_special+(I||"KEY")+"_CS"+j.$tag_special;var A=[],z={},f=D.tagName.toLowerCase(),m=D.text,c=linb.absObj.$specialChars;for(var y in D){if(!D[y]){continue}if(!c[y.charAt(0)]&&!G[y]){s=D[y];if(!x.test(y)){if(typeof s=="object"){if(!s.$order){s.$order=0}s.$key=y;A[A.length]=s}}else{z[y]=s}}}A.sort(function(a,b){a=a.$order;b=b.$order;return a>b?1:a==b?0:-1});if(!d){h=true;d=[]}d[d.length]="<"+f+" ";if(!z.unselectable&&!B[f]){z.unselectable="on"}for(var y in z){if(z[y]){d[d.length]=y+'="'+z[y]+'" '}}if(D.className!==null){D.className=C}delete D["class"];d[d.length]=" {attributes}>";if(!E[f]&&m){d[d.length]=m}for(var y=0,v=A.length;y<v;){s=A[y++];q(g,s,s.$key,k,d)}if(!E[f]){d[d.length]="</"+f+">"}if(h){var H=k[0],F=k[1];d.join("").replace(r,function(l,i,u,o){if(i){H[H.length]=i}F[H.length]=H[H.length]=u;if(o){H[H.length]=o}return""})}},_rpt:function(e,b){var g=arguments.callee,h=linb.UI,a=h.$tag_special,f=g._r||(g._r=new RegExp(a+"([0-9A-Z_]+)_C([SCT])"+a+"|"+a+"([\\w_\\-\\.]*)"+a,"img")),d={id:e.serialId,cls:e.getClass("KEY"),domid:e.$domId},c={S:e.CS,C:e.CC,T:e._CT};return b.replace(f,function(j,i,l,k){return d[k]||(c[l]?(c[l][i]||""):"")}).replace(h.$x01r,"\x01")},_build:function(b,k){var o,r,c,p=linb.UI,q=[[],[]],s=this,n=s.KEY,a=linb.$cache.template,g=b._hash="b:"+(b.template._subid||"")+";!"+(b._exhash||"");if(typeof b.theme=="string"){var l=b._CT={},d=b.key.replace(/\./g,"-").toLowerCase().replace("linb-ui","linb")+"-";_.each(b.keys,function(j,h){if(h.charAt(0)!="$"){l[h]=d+b.theme+"-"+h.toLowerCase()}})}if(!(o=_.get(a,[n,g]))){p.$buildTemplate(b,null,null,q);_.set(a,[n,g,""],q);if(r=b.template.$submap){for(var f in r){if(typeof(c=r[f])!="function"){var q=[[],[]];for(var e in c){if(typeof c[e]=="object"){p.$buildTemplate(b,c[e],e,q)}}c=q}_.set(a,[n,g,f],c)}}o=_.get(a,[n,g])}if(!o){return""}return s._rpt(b,p.$doTemplate(b,o,k))},_setDefaultBehavior:function(h){var a=this,d=arguments.callee,g=d._m||(d._m={"":1,KEY:1,$key:1}),e=d._f1||(d._f1=function(f,k,l){var j=function(s,y,m){var B,q=linb.use(m).id(),A,z=s.getSubId(q),p=s.properties,n,x,w;if(p.disabled||p.readonly){return}A=s.SubSerialIdMapItem&&s.SubSerialIdMapItem[z];if(A&&A.disabled){return}if(A&&A.readonly){return}switch(typeof f){case"string":n=s.getSubNode(f,z)._get();break;case"function":x=[f];break;case"object":n=[];x=[];for(var r,v=0,u=f.length;v<u;v++){r=f[v];if(typeof r=="string"){n.push.apply(n,s.getSubNode(r,z)._get())}else{x.push(r)}}}if(n&&n.length){n=linb(n);w=s.boxing();if(l==1){if(k=="mouseover"){if(p.disableHover){return}if(s.beforeHoverEffect){if(false==w.beforeHoverEffect(s,A,y,m,"mouseover")){return}}}if(k=="mousedown"&&s.beforeClickEffect){if(false==w.beforeClickEffect(s,A,y,m,"mousedown")){return}}n.tagClass("-"+k)}else{if(k=="mouseup"){if(s.beforeClickEffect&&false==w.beforeClickEffect(s,A,y,m,"mouseup")){return}n.tagClass("-mousedown",false)}else{if(p.disableHover){return}if(s.beforeHoverEffect&&false==w.beforeHoverEffect(s,A,y,m,"mouseout")){return}n.tagClass("(-mouseover|-mousedown)",false)}}}if(x&&x.length){_.arr.each(x,function(C){_.tryF(C,[s],s)});x.length=0}};return j}),b={},c;if(!linb.SC.get("linb.absComposed")){Class("linb.absComposed","linb.absObj",{Instance:{addPanel:function(j,l,m){var n=_.copy(linb.UI.Panel.$DataStruct);_.merge(n,j,"with");_.merge(n,{dock:"fill",tag:j.tag||j.id},"all");var k=new linb.UI.Panel(n),f=[];this.append(k,m&&m.id);_.arr.each(l,function(p){f.push(p[0])});k.append(linb.UI.pack(f,false));return this},removePanel:function(){this.destroy()},getPanelPara:function(){return _.copy(this.get(0).properties)},getPanelChildren:function(){return this.get(0).children},_e1:function(j,k,l,m,f){},_e2:function(k,j,n,f,m,l,o){},_e3:function(j,k,f,l){},_e4:function(j,m,n,f,l,k){},_e5:function(f,j,k){}},Static:{DataModel:{dragKey:"",dropKeys:""},$abstract:true}})}var i=linb.absComposed.prototype;if(h.HoverEffected){_.each(h.HoverEffected,function(j,f){c=g[f]?h:(h[f]||(h[f]={}));if(!j){c.afterMouseover=c.afterMouseout=null}else{c.afterMouseover=e(j,"mouseover",1);c.afterMouseout=e(j,"mouseout",2)}});b.beforeHoverEffect=i._e1}if(h.ClickEffected){_.each(h.ClickEffected,function(j,f){c=g[f]?h:(h[f]||(h[f]={}));if(!j){c.afterMousedown=c.afterMouseup=null}else{c.afterMousedown=e(j,"mousedown",1);c.afterMouseup=e(j,"mouseup",2)}});b.beforeClickEffect=i._e1}if(h.KeyHook){_.merge(h,{afterKeydown:function(j,k,l){var f=linb.Event.getKey(k);if(f[0].length>1){j.$keyD=f[0]}if(j.onHotKeydown){return false!==j.boxing().onHotKeydown(j,f[0],!!f[1],!!f[2],!!f[3],k,l)}},afterKeypress:function(j,k,l){var f=linb.Event.getKey(k);if(j.$keyD){f[0].length=j.$keyD}if(j.onHotKeypress){return false!==j.boxing().onHotKeypress(j,f[0],!!f[1],!!f[2],!!f[3],k,l)}},afterKeyup:function(j,k,l){if(j.onHotKeyup){var f=linb.Event.getKey(k);return false!==j.boxing().onHotKeyup(j,f[0],!!f[1],!!f[2],!!f[3],k,l)}}},"all");b.onHotKeydown=b.onHotKeypress=b.onHotKeyup=i._e2}if(h.NavKeys){_.each(h.NavKeys,function(j,m){var f=arguments.callee,l,s=f.m1||(f.m1={KEY:1,$key:1});if(s[m]){return}var q=f.m2||(f.m2={input:1,textarea:1}),p=f.m3||(f.m3={tab:1,enter:1,up:1,down:1,left:1,right:1}),n=f.m4||(f.m4={tab:1,up:1,down:1,left:1,right:1}),r=h[m]||(h[m]={});var r=h[m]||(h[m]={});if(null===j){r.afterKeydown=null}else{r.afterKeydown=function(z,D,u){var A=linb.Event.getKey(D),F=A[0],v=A[1],x=A[2],C=A[3],E=false,o=z.properties.tag=="smartnav";if(o){var y=linb.use(u).get(0);if(q[A=y.tagName.toLowerCase()]){if(F&&A=="input"&&y.type.toLowerCase()!="text"&&y.type.toLowerCase()!="password"){E=true}else{if(p[F]){var w=linb.use(u).caret(),B=linb.use(u).get(0).value;switch(F){case"up":if(!/[\n\r]/.test(B.substr(0,w[0]))){E=true}break;case"left":if((v&&!x)||(w[0]===0&&(w[1]!==B.length||w[1]===0))){E=true}break;case"down":if(!/[\n\r]/.test(B.substr(w[1],B.length))){E=true}break;case"right":if((v&&!x)||(w[1]===B.length&&(w[0]!==0||w[1]===0))){E=true}break;case"enter":if(A=="input"||C){E=true}break;case"tab":E=true;break}}}}else{if(n[F]){E=true}}y=null}else{E=F==="tab"}if(E){if(z.beforeNextFocus&&false===z.boxing().beforeNextFocus(z,D,!!A[2],u)){return false}if(o){if(F!="tab"){linb.use(u).nextFocus(("up"==F||"left"==F)?false:true)}}}}}});b.beforeNextFocus=i._e3}if((c=h.DropableKeys)&&c.length){_.arr.each(c,function(f){a._dropable(f)});c=a.prototype;_.arr.each("addPanel,removePanel,getPanelPara,getPanelChildren,getDropKeys,setDropKeys".split(","),function(f){if(!c[f]){c[f]=i[f]}});a.$DataModel.dropKeys=a.$DataStruct.dropKeys="";b.onDragEnter=b.onDragLeave=b.onDrop=b.onDropTest=b.onDropMarkShow=b.onDropMarkClear=i._e4}if((c=h.DragableKeys)&&c.length){_.arr.each(c,function(f){a._dragable(f)});c=a.prototype;_.arr.each("getDragKey,setDragKey".split(","),function(f){if(!c[f]){c[f]=i[f]}});a.$DataModel.dragKey=a.$DataStruct.dragKey="";b.onGetDragData=b.onStartDrag=b.onDragStop=i._e5}if((c=h.NoDragableKeys)&&c.length){a.NoDragableKeys=c}if((c=h.NoDropableKeys)&&c.length){a.NoDropableKeys=c}a.setEventHandlers(b)},addTemplateKeys:function(a){var b=this,c=b.KEY,e=arguments.callee,d=e._reg||(e._reg=/\./g);_.arr.each(a,function(f){b.$cssKeys[f]=(b.$Keys[f]=f=="KEY"?c:c+"-"+f).replace(d,"-").toLowerCase().replace("linb-ui","linb")});return b},$CSSCACHE:{},$getCSSValue:function(a,e){var d=this.$CSSCACHE,b=a+"->"+e,g=arguments.callee;if(b in d){return d[b]}var h=linb.Dom.getEmptyDiv().get(0),f;h.className=a;f=d[b]=parseInt(linb.Dom.getStyle(h,e))||0;h.className="";return f},getTheme:function(){return this.$theme},setTheme:function(a,c){a=a||"default";var b=this;if(a!=b.$theme){if(c!==false){if(a!="default"){linb.CSS.includeLink(linb.getPath("linb.appearance."+a,"/theme.css"),"theme:"+a)}var e=linb.CSS.get("id","theme:"+b.$theme);if(e){e.disabled=true;linb(e).remove(false)}}b.$theme=a;if(c!==false){b.$CSSCACHE={};var d=0;_.asyRun(function(){if(d>10){throw new Error("errLoadTheme:"+a)}d++;var f;try{f=linb.CSS.$getCSSValue(".setting-uikey","fontFamily")}catch(g){}finally{if(f==a||a=="default"){linb.UI.getAll().reLayout(true);d=null}else{_.asyRun(arguments.callee,200*d)}}},200)}}return this},setAppearance:function(a){_.merge(this.$Appearances,a,"all");return this},getAppearance:function(){return this.$Appearances},setTemplate:function(d,m){if(d){var l=this,g=arguments.callee,a=g.r2||(g.r2=/[a-z]/),f=linb.absObj.$specialChars,e=["KEY"],h=g._fun||(g._fun=function(p,j){var q,n;for(n in p){if(!f[n.charAt(0)]){if(!a.test(n)){j[j.length]=n;q=p[n];if(typeof q=="object"){arguments.callee(q,j)}}}}}),k;h(d,e);l.addTemplateKeys(e);k=l.$Templates;if(typeof m=="string"){d._subid=m;k[m]=d}else{k._=d}if(k=d.$submap){for(var c in k){for(var b in k[c]){g.call(l,k[c],b)}}}}return this},getTemplate:function(a){return this.$Templates[a||"_"]},setBehavior:function(b){if(b){var l=this,g=linb.$cache.UIKeyMapEvents,c=l.$key,x=linb.absObj.$specialChars,a=linb.Event.$eventhandler,e=linb.Event._eventMap,y=arguments.callee,w=y.r1||(y.r1=/[a-z]/),s=y.r2||(y.r2=/^(on|before|after)/),h=l.$Behaviors,p,u,r,q,n,f,d;l._setDefaultBehavior(b);if(b.KEY){_.merge(b,b.KEY,"all");delete b.KEY}for(u in b){n=b[u];if(!x[u.charAt(0)]){if(!w.test(u)){p=h[u]||(h[u]={});for(r in n){f=n[r];if(!x[r.charAt(0)]){if(f){p[r]=f}else{delete p[r]}}}}else{if(s.test(u)){if(n){h[u]=n}else{delete h[u]}}else{h[u]=n}}}}_.filter(g,function(k,j){return !(j==c||j.indexOf(c+"-")==0)});for(u in h){n=h[u];if(!x[u.charAt(0)]){if(!w.test(u)){for(r in n){if(!x[r.charAt(0)]&&n[r]){q=c+"-"+u;(g[q]||(g[q]={}))["on"+e[r]]=a}}}else{if(s.test(u)&&n){q=c;(g[q]||(g[q]={}))["on"+e[u]]=a}}}}}return l},getBehavior:function(){return this.$Behaviors},$applyCSS:function(){var e=linb.UI,d=e.$cache_css,c=e.$cache_css2;if(!e.$cssNo){e.$cssNo=1;var a=linb.browser;linb("body").addClass((a.ie?("linbcss-ie linbcss-ie"+a.ver+" "):a.gek?("linbcss-gek linbcss-gek"+a.ver+" "):a.kde?("linbcss-kde linbcss-kde"+a.ver+" "):a.opr?("linbcss-opr linbcss-opr"+a.ver+" "):"")+(a.isSafari?"linbcss-safari ":a.isChrome?"linbcss-chrome ":"")+(a.isMac?"linbcss-mac":a.isLinux?"linbcss-linux ":""));linb("html").addClass(a.isStrict?"linbcss-base linbcss-strict":"linbcss-base ")}if(d){linb.CSS.addStyleSheet(d,"linb.UI-CSS"+(e.$cssNo++));linb.UI.$cache_css=""}if(c){linb.CSS.addStyleSheet(c,"linb.UI-CSS"+(e.$cssNo++),true);linb.UI.$cache_css2=""}},buildCSSText:function(m){var y=this,s=arguments.callee,d=s._r1||(s._r1=/(^|\s|,)([0-9A-Z_]+)/g),n=[],a=[],p=linb.browser,f=p.ie6,b=p.ie,q=p.gek,u=y.$cssKeys,x,w,c;for(var k in m){c=m[k];x=k.replace(d,function(i,h,j){return h+"."+(u[j]||j)}).toLowerCase();c.$order=parseInt(c.$order)||0;c.$=x;n[n.length]=c}n.sort(function(h,i){h=h.$order;i=i.$order;return h>i?1:h==i?0:-1});for(var k=0,e=n.length;k<e;){c=n[k++];a[a.length]=c.$+"{";if(x=c.$before){a[a.length]=x}if(x=c.$text){a[a.length]=x}for(var g in c){switch(g.charAt(0)){case"$":continue;break;case"_":if(!f){continue}break;case"*":if(!b){continue}break;case"-":if(!q){continue}break}if((w=c[g])||c[g]===0){switch(typeof w){case"string":case"number":a[a.length]=g+":"+w+";";break;case"function":a[a.length]=g+":"+w(y.KEY)+";";break;default:_.arr.each(w,function(h){if(h){a[a.length]=g+":"+h+";"}})}}}if(w=c.$after){a[a.length]=w}a[a.length]="}"}return a.join("")},_dropable:function(d){var b=this,c=linb.Event.$eventhandler2,h=b.$Behaviors,a=d=="KEY"?h:(h[d]||(h[d]={})),f=linb.$cache.UIKeyMapEvents,g=d=="KEY"?b.KEY:(b.KEY+"-"+d),e=f[g]||(f[g]={});_.merge(a,{beforeMouseover:function(k,o,i){if(k.properties.disabled||k.properties.readonly){return}if(k.box.NoDropableKeys){var l=k.getKey(linb.Event.getSrc(o).id||"").split("-")[1];if(l&&_.arr.indexOf(k.box.NoDropableKeys,l)!=-1){return}}var q=i,s=linb.DragDrop,j=s.getProfile(),r=j.dragKey,m=j.dragData,v,n,u,p;if(!r||!m||!(new RegExp("\\b"+r+"\\b")).test(k.box.getDropKeys(k,q))){return}n=k.boxing();if(n.getItemByDom){v=n.getItemByDom(i)}p=[k,o,q,r,m,v];if((u=k.onDropTest)&&(false===n.onDropTest.apply(n,p))){return}if((u=k.box._onDropTest)&&(false===u.apply(k.host||k,p))){return}s.setDropElement(i);if(k.onDropMarkShow&&(false===n.onDropMarkShow.apply(n,p))){}else{if((u=k.box._onDropMarkShow)&&(false===u.apply(k.host||k,p))){}else{_.resetRun("setDropFace",s.setDropFace,0,[q],s)}}if(u=k.box._onDragEnter){u.apply(k.host||k,p)}if(k.onDragEnter){n.onDragEnter.apply(n,p)}},beforeMouseout:function(k,n,i){if(k.properties.disabled||k.properties.readonly){return}var q=linb.DragDrop,j=q.getProfile(),p=j.dragKey,l=j.dragData,r,m,o;if(j.dropElement==i){m=k.boxing();if(m.getItemByDom){r=m.getItemByDom(i)}o=[k,n,i,p,l,r];if(k.onDropMarkClear&&(false===m.onDropMarkClear.apply(m,o))){}else{if((t=k.box._onDropMarkClear)&&(false===t.apply(k.host||k,o))){}else{_.resetRun("setDropFace",q.setDropFace,0,[null],linb.DragDrop)}}if(t=k.box._onDragLeave){t.apply(k.host||k,o)}if(k.onDragLeave){m.onDragLeave.apply(m,o)}q.setDropElement(null)}},beforeDrop:function(k,n,i){var q=linb.DragDrop,j=q.getProfile(),p=j.dragKey,l=j.dragData,s,r,o,m=k.boxing();if(m.getItemByDom){s=m.getItemByDom(i)}o=[k,n,i,p,l,s];if(k.onDropMarkClear&&(false===m.onDropMarkClear.apply(m,o))){}else{if((r=k.box._onDropMarkClear)&&(false===r.apply(k.host||k,o))){}}if(k.onDrop&&(false===m.onDrop.apply(m,o))){}else{if((r=k.box._onDrop)&&(false===r.apply(k.host||k,o))){}}}},"all");_.merge(e,{onmouseover:c,onmouseout:c,ondrop:c});return b},_dragable:function(d){var b=this,c=linb.Event.$eventhandler2,h=b.$Behaviors,a=d=="KEY"?h:(h[d]||(h[d]={})),f=linb.$cache.UIKeyMapEvents,g=d=="KEY"?b.KEY:(b.KEY+"-"+d),e=f[g]||(f[g]={});_.merge(a,{beforeMousedown:function(k,n,i){if(linb.Event.getBtn(n)!="left"){return}if(k.properties.disabled){return}if(!k.properties.dragKey){return}if(k.box.NoDragableKeys){var l=k.getKey(linb.Event.getSrc(n).id||"").split("-")[1];if(l&&_.arr.indexOf(k.box.NoDragableKeys,l)!=-1){return}}var p=linb.Event.getPos(n),m=k.boxing(),o=[k,n,i],q;if(k.onStartDrag&&(false===m.onStartDrag.apply(m,o))){}else{if((q=k.box._onStartDrag)&&(false===q.apply(k.host||k,o))){}else{var j=k.box;linb.use(i).startDrag(n,{dragType:"icon",targetLeft:p.left+12,targetTop:p.top+12,dragCursor:"pointer",dragDefer:1,dragKey:j.getDragKey(k,i),dragData:j.getDragData(k,n,i)})}}},beforeDragbegin:function(i,j,k){linb.use(k).onMouseout(true,{$force:true}).onMouseup(true)},beforeDragstop:function(j,k,l){var i;if(j.onDragStop){j.boxing().onDragStop(j.e,l)}if(i=j.box._onDragStop){i.apply(j.host||j,arguments)}}},"all");_.merge(e,{onmousedown:c,ondragbegin:c});return b},adjustData:function(d,k,g){if(!g){g={}}var f=d.box.$DataModel,b=d.properties;var e,c,j=linb.wrapRes,h=arguments.callee,a=h._r||(h._r=/\B\$([\w]+[\.][\w\.]+[\w])/g);for(e in k){if(e.charAt(0)=="$"){continue}if(k.hasOwnProperty(e)&&!g.hasOwnProperty(e)){g[e]=typeof(c=k[e])=="string"?(((c.indexOf("$")!=-1)?(c=c.replace(a,function(l,i){return j(i)})):c)&&((c.charAt(0)=="@")?(linb.SC.get(c.substr(1,c.length))||c):c)):c}}if("disabled" in f){g.disabled=((_.isSet(g.disabled)&&g.disabled)||(_.isSet(b.disabled)&&b.disabled))?"ui-itemdisabled":""}if("readonly" in f){g.readonly=((_.isSet(g.readonly)&&g.readonly)||(_.isSet(b.readonly)&&b.readonly))?"ui-itemreadonly":""}g.imageDisplay=(g.imageClass||g.image)?"":"display:none";if(g.image){g.backgroundImage="background-image:url("+g.image+");"}if(g.imagePos){g.backgroundPosition="background-position:"+g.imagePos+";"}if(g.imageRepeat){g.backgroundRepeat="background-repeat:"+g.imageRepeat+";"}if((typeof(c=g.renderer)=="function")||(typeof(c=k.renderer)=="function")){g.caption=c.call(d,k,g)}return g},cacheData:function(a,b){_.set(linb.$cache,["UIDATA",a],b);return this},getCachedData:function(a){var b=_.get(linb.$cache,["UIDATA",a]);if(typeof b=="function"){b=b()}return _.clone(b)},Behaviors:{onContextmenu:function(a,b,c){if(a.onContextmenu){return a.boxing().onContextmenu(a,b,c)!==false}}},DataModel:{tag:"",tagVar:{ini:{}},disableHover:false,disableTips:false,disabled:{ini:false,action:function(a){var b=this.getRoot();if(a){b.addClass("ui-disabled")}else{b.removeClass("ui-disabled")}}},dock:{ini:"none",listbox:["none","top","bottom","left","right","center","middle","origin","width","height","fill","cover"],action:function(a){linb.UI.$dock(this,true,true)}},dockIgnore:{ini:false,action:function(b){var a=this;if(a.properties.dock!="none"){linb.UI.$dock(a,true,true)}}},dockOrder:{ini:1,action:function(b){var a=this;if(a.properties.dock!="none"){linb.UI.$dock(a,true,true)}}},dockMargin:{ini:{left:0,top:0,right:0,bottom:0},action:function(b){var a=this;if(a.properties.dock!="none"){linb.UI.$dock(a,true,true)}}},dockFloat:{ini:false,action:function(b){var a=this;if(a.properties.dock!="none"){linb.UI.$dock(a,true,true)}}},dockMinW:0,dockMinH:0,tips:""},EventHandlers:{onRender:function(a){},onLayout:function(a){},onResize:function(c,b,a){},onMove:function(c,e,d,b,a){},onDock:function(a,b){},beforePropertyChanged:function(b,a,c,d){},afterPropertyChanged:function(b,a,c,d){},beforeAppend:function(a,b){},afterAppend:function(a,b){},beforeRemove:function(c,d,b,a){},afterRemove:function(c,d,b,a){},onDestroy:function(a){},beforeDestroy:function(a){},onShowTips:function(a,b,c){},onContextmenu:function(a,c,b){}},RenderTrigger:function(){var c=this,a=c.boxing(),f=c.properties;if(c.box._onresize){var e=c.getRootNode().style,d;if((d=e.visibility)!="hidden"){c._$visibility=d;e.visibility="hidden"}linb.UI.$tryResize(c,f.width,f.height);e=null}if(f.disabled){a.setDisabled(true,true)}c.inValid=1},$doResize:function(e,a,d,g,b){if(g||((a||d)&&(e._resize_w!=a||e._resize_h!=d))){if(!e.getRootNode()){return false}e._resize_w=a;e._resize_h=d;_.tryF(e.box._onresize,[e,a,d,g,b],e.box);if(e.onResize){e.boxing().onResize(e,a,d)}}if("_$visibility" in e){var f=e.getRootNode(),c=f.style;if(c.visibility!="visible"&&!linb.getNodeData(f,"_setVisibility")){c.visibility=e._$visibility}f=c=null;clearTimeout(e._$rs_timer);delete e._$rs_timer;delete e._$rs_args;delete e._$visibility}},$tryResize:function(g,a,f,i,d){var e=g.box,c=e._onresize;if(c&&(i||a||f)){a=parseInt(a)||null;f=((f===""||f=="auto")?"auto":parseInt(f))||null;if("_$visibility" in g){var b=g._$rs_args;if(!b){b=g._$rs_args=[g,null,null];g._$rs_timer=_.asyRun(function(){if(g&&g._$rs_args){linb.UI.$doResize.apply(null,g._$rs_args)}})}b[1]=a;b[2]=f;b[3]=i;b[4]=d}else{linb.UI.$doResize(g,a,f,i,d)}}},LayoutTrigger:function(){var c=this,a=c.boxing(),e=c.properties;if(e.dock&&e.dock!="none"){if(!c.$laidout){c.$laidout=1;var d=c.getRootNode().style;switch(e.dock){case"top":case"bottom":case"width":d.width=0;break;case"left":case"right":case"height":d.height=0;break;default:d.width=d.height=0}}linb.UI.$dock(this,false,true)}},$dock_args:["top","bottom","left","right","center","middle","width","height"],$dock_map:{middle:1,center:1},$dock:function(h,c,d){var g=h.getRoot(),b=linb((g.get(0)&&g.get(0).parentNode)||h.$dockParent);if(!b.get(0)){return}var a=h.properties,j=a.dockMargin,s="auto",q=a.dock||"none",l=linb.Event.getId(b.get(0)),e=function(f,p){f=parseInt(f.properties.dockOrder)||0;p=parseInt(p.properties.dockOrder)||0;return f>p?1:f==p?0:-1},o,n="$inMatrix",m,r,k,i=function(f){return linb.browser.ie6?f-f%2:f};if(b.get(0)===document.body||b.get(0)===document||b.get(0)===window){l="!document";k=true}if(l&&(l==linb.Dom._ghostDivId||_.str.startWith(l,linb.Dom._emptyDivId))){return}if(h.$dockParent!=l||h.$dockType!=q||c){h.$dockParent=l;h.$dockType=q;h.unLink("$dockall");h.unLink("$dock");h.unLink("$dock1");h.unLink("$dock2");switch(q){case"middle":o={right:s,bottom:s,left:a.left||"",width:a.width||"",height:a.height||""};break;case"center":o={right:s,bottom:s,top:a.top||"",width:a.width||"",height:a.height||""};break;case"origin":o={right:s,bottom:s,width:a.width||"",height:a.height||""};break;case"top":o={left:j.left,right:j.right,bottom:s,height:a.height||""};break;case"bottom":o={left:j.left,right:j.right,top:s,height:a.height||""};break;case"left":o={right:s,width:a.width||""};break;case"right":o={left:s,width:a.width||""};break;case"width":o={bottom:s,height:a.height||"",top:a.top||""};break;case"height":o={right:s,width:a.width||"",left:a.left||""};break;case"fill":case"cover":o={right:s,bottom:s};break;case"none":o={left:a.left,top:a.top,width:a.width||"",height:a.height||""};break}if(g.get(0)){g.cssRegion(o,true)}if(k){b=linb.win;if(!linb.$cache._resizeTime){linb.$cache._resizeTime=1}}if(q!="none"){m=b.$getEvent("onSize","dock");if(!m){m=function(F){var D=arguments.callee,f=linb.UI.$dock_map,z=linb.UI.$dock_args,A=D.rePos,B=D.pid=="!window"||D.pid=="!document",v=B?linb.win:linb(D.pid);if(!v.get(0)){return}var p=v.get(0).style,y,x,w,u,E,C;if(F.$dockid||!B||(_()-linb.$cache._resizeTime>100)){y={left:0,top:0,right:0,bottom:0,width:parseInt(p&&p.width)||v.width(),height:parseInt(p&&p.height)||v.height()};for(w=0;E=z[w++];){C=D[E];if(C.length){if(!f[E]){F.width=F.height=1}for(x=0;u=C[x++];){if(!u.properties.dockIgnore){A(u,y,E,F.$dockid,B||F.width,B||F.height)}}}}if(y.later){_.each(y.later,function(I){var G;try{I.node.cssRegion(I,true);if(G=linb.UIProfile.getFromDom(I.node.get(0))){delete I.node;if(!G.box._onresize&&G.onResize&&(I.width!==null||I.height!==null)){G.boxing().onResize(G,I.width,I.height)}if(G.onDock){G.boxing().onDock(G,I)}}}catch(H){_.asyRun(function(){I.width+=1;I.height+=1;I.node.cssRegion(I);I.width-=1;I.height-=1;I.node.cssRegion(I,true);if(G=linb.UIProfile.getFromDom(I.node.get(0))){delete I.node;if(!G.box._onresize&&G.onResize&&(I.width!==null||I.height!==null)){G.boxing().onResize(G,I.width,I.height)}if(G.onDock){G.boxing().onDock(G,I)}}})}})}if(B){linb.$cache._resizeTime=_()}}D=v=p=null};m.pid=l;_.arr.each(linb.UI.$dock_args,function(f){m[f]=[]});m.dockall=[];m.rePos=function(p,E,I,H,D,M){var L=false;if(H&&p.$linbid!=H){L=true}var f=p.properties,K=f.dockFloat,G=f.dockMargin,J=p.getRoot(),N=p.getRootNode().style,v,F,P,A,O,z,C=parseInt(f._dockBorderWidth)||0,B=parseInt(f._dockBorderHeight)||0,u={};if(N.display=="none"){return}switch(I){case"middle":J.top((E.height-J.height())/2);break;case"center":J.left((E.width-J.width())/2);break;case"top":if(!L){v=G.left;P=G.right;F=(K?0:E.top)+G.top;if(parseFloat(N.top)!=F){u.top=F}O=E.width-v-P-C;O=i(f.dockMinW?Math.max(f.dockMinW,O):O);if(parseFloat(N.width)!=O){u.width=i(O)}if(!_.isEmpty(u)){J.cssRegion(u,true)}}if(!K){E.top+=(J.offsetHeight()+G.top+G.bottom)}break;case"bottom":if(!L){v=G.left;P=G.right;A=(K?0:E.bottom)+G.bottom;if(parseFloat(N.bottom)!=A){u.bottom=A}O=E.width-v-P-C;O=i(f.dockMinW?Math.max(f.dockMinW,O):O);if(parseFloat(N.width)!=O){u.width=i(O)}if(!_.isEmpty(u)){J.cssRegion(u,true)}}if(!K){E.bottom+=(J.offsetHeight()+G.top+G.bottom)}break;case"left":if(!L){v=(K?0:E.left)+G.left;F=(K?0:E.top)+G.top;A=(K?0:E.bottom)+G.bottom;if(parseFloat(N.left)!=v){u.left=v}if(parseFloat(N.top)!=F){u.top=F}O=E.height-F-A-B;O=i(f.dockMinH?Math.max(f.dockMinH,O):O);if(parseFloat(N.height)!=O){u.height=i(O)}if(!_.isEmpty(u)){J.cssRegion(u,true)}}if(!K){E.left+=(J.offsetWidth()+G.left+G.right)}break;case"right":if(!L){P=(K?0:E.right)+G.right;F=(K?0:E.top)+G.top;A=(K?0:E.bottom)+G.bottom;if(parseFloat(N.right)!=P){u.right=P}if(parseFloat(N.top)!=F){u.top=F}O=E.height-F-A-B;O=i(f.dockMinH?Math.max(f.dockMinH,O):O);if(parseFloat(N.height)!=O){u.height=i(O)}if(!_.isEmpty(u)){J.cssRegion(u,true)}}if(!K){E.right+=(J.offsetWidth()+G.left+G.right)}break;case"width":if(!D){return}v=(f.dock=="cover"?0:(K?0:E.left))+G.left;P=(f.dock=="cover"?0:(K?0:E.right))+G.right;F=f.dock=="width"?(parseInt(f.top)||0):((f.dock=="cover"?0:(K?0:E.top))+G.top);O=E.width-v-P-C;E.later=E.later||{};E.later[p.$linbid]=E.later[p.$linbid]||{};_.merge(E.later[p.$linbid],{node:J,width:i(f.dockMinW?Math.max(f.dockMinW,O):O),left:v,top:F},"all");break;case"height":if(!M){return}F=(f.dock=="cover"?0:(K?0:E.top))+G.top;A=(f.dock=="cover"?0:(K?0:E.bottom))+G.bottom;v=f.dock=="height"?(parseInt(f.left)||0):((f.dock=="cover"?0:(K?0:E.left))+G.left);O=E.height-F-A-B;E.later=E.later||{};E.later[p.$linbid]=E.later[p.$linbid]||{};_.merge(E.later[p.$linbid],{node:J,height:i(f.dockMinH?Math.max(f.dockMinH,O):O),left:v,top:F},"all");break}};b.onSize(m,"dock")}if(q=="fill"||q=="cover"){h.link(m.height,"$dock1");h.link(m.width,"$dock2");m.height.sort(e);m.width.sort(e)}else{if(q=="origin"){h.link(m.center,"$dock1");h.link(m.middle,"$dock2")}else{h.link(m[q],"$dock");m[q].sort(e)}}h.link(m.dockall,"$dockall");linb.$cache._resizeTime=1;h.$dockFun=m}if(k){var m=linb.win.$getEvent("onSize","dock");if(m&&m.dockall&&m.dockall.length){linb("html").addClass("linbcss-viewport");if(r=linb("body").get(0)){r.scroll="no"}}else{linb("html").removeClass("linbcss-viewport");if(r=linb("body").get(0)){r.scroll=""}}}}if(q!="none"&&d){h.$dockFun({width:1,height:1,$dockid:_.arr.indexOf(["width","height","fill","cover"],q)!=-1?h.$linbid:null,$type:q})}},_beforeSerialized:function(e){var f=e.boxing(),a,d,h={};_.merge(h,e,"all");var g=h.properties=_.copy(e.properties);switch(g.dock){case"top":case"bottom":delete g.width;delete g.left;delete g.top;delete g.right;delete g.bottom;break;case"left":case"right":delete g.height;delete g.left;delete g.top;delete g.right;delete g.bottom;break;case"width":delete g.width;delete g.left;delete g.right;break;case"height":delete g.height;delete g.top;delete g.bottom;break;case"fill":case"cover":delete g.width;delete g.height;delete g.left;delete g.top;delete g.right;delete g.bottom;break}for(var c in linb.UI.$ps){if((c in g)&&typeof g[c]!="number"&&g[c]!=""&&g[c]!="auto"){g[c]=isNaN(g[c]=parseFloat(g[c]))?"auto":g[c]}}if(g.items&&g.items.length){d=linb.absObj.$specialChars;g.items=_.clone(g.items,function(j,b){return !d[(b+"").charAt(0)]&&j!=undefined})}if(_.isEmpty(g.tagVar)){delete g.tagVar}if((d=g.dockMargin)&&!d.left&&!d.top&&!d.right&&!d.bottom){delete g.dockMargin}if(g.items&&(g.items.length==0||g.listKey)){delete g.items}return h},getDropKeys:function(a,b){return a.properties.dropKeys},getDragKey:function(a,b){return a.properties.dragKey},getDragData:function(a,c,b){return{profile:a,domId:linb.use(b).id(),data:a.onGetDragData?a.boxing().onGetDragData(a,c,b):null}},_prepareData:function(d,g){var b=d.properties,h=this.$DataModel,k=arguments.callee,c=k.map||(k.map=_.toArr("left,top,bottom,right,width,height")),l=[],m=d.box.adjustData,n;g=g||{};if(b.id){delete b.id}if("caption" in h&&b.caption!==null){b.caption=b.caption===undefined?d.alias:b.caption}if("$hborder" in h){g.bWidth=b.width-(b.$hborder||0)*2}if("$vborder" in h){g.bHeight=b.height-(b.$vborder||0)*2}for(var e=0,f;f=c[e];e++){if(b[f]||b[f]===0){if(String(parseFloat(b[f]))==String(b[f])){l[l.length]=f+":"+(parseInt(b[f])||0)+"px"}else{if(b[f]!="auto"&&b[f]){l[l.length]=f+":"+b[f]}}}}if(b.position){l[l.length]="position:"+b.position}if(b.visibility){l[l.length]="visibility:"+b.visibility}if(b.zIndex){l[l.length]="z-index:"+b.zIndex}if(b.display){l[l.length]="display:"+(b.display=="inline-block"?linb.browser.gek?"-moz-inline-block;display:-moz-inline-box;display:inline-block;":"inline-block":b.display)}g._style=";"+l.join(";")+";";if("readonly" in h){g.readonly=b.readonly?"ui-readonly":""}if("href" in h){g.href=b.href||linb.$DEFAULTHREF}if("tabindex" in h){g.tabindex=b.tabindex||"-1"}if("items" in h){d.ItemIdMapSubSerialId={};d.SubSerialIdMapItem={};b.items=d.box._adjustItems(b.items);g.items=this._prepareItems(d,b.items)}g=m(d,b,g);d.prepared=true;return g},_prepareItems:function(d,m,k,f,h){var q=[],p,a,o,c=linb.UI.$tag_subId,b,g=d.properties.tabindex,n=d.box.adjustData;for(var j=0,e=m.length;j<e;j++){if(typeof m[j]!="object"){m[j]={id:m[j]}}p=m[j];if(!p.hasOwnProperty("caption")){p.caption=p.id}a={id:p.id};if(k){a._pid=k}b=a[c]=typeof h=="string"?h:d.pickSubId("items");if(false!==f){d.ItemIdMapSubSerialId[p.id]=b;d.SubSerialIdMapItem[b]=p}if(o=p.object){o=a.object=o["linb.absBox"]?o.get(0):o;if(o["linb.UIProfile"]){o.properties.position="relative"}p.$linbid=o.$linbid;o.$item=p;o.$holder=d;if(!d.$attached){d.$attached=[]}d.$attached.push(o)}else{a._tabindex=g;if(p.hidden){p.itemDisplay="display:none;"}n(d,p,a);if(this._prepareItem){this._prepareItem(d,a,p,k,f,h)}}q.push(a)}return q},_showTips:function(a,b,c){if(a.properties.disableTips){return}if(a.onShowTips){return a.boxing().onShowTips(a,b,c)}}}});Class("linb.absList","linb.absObj",{Instance:{activate:function(){var b=this.get(0),a=b.getSubNode("ITEM",true);if(!a.isEmpty()){a.focus()}return this},insertItems:function(g,c,l){var d,i,j,h,a,e,f,k=this._afterInsertItems;return this.each(function(n){f=n.box;i=f._adjustItems(g);j=n.properties.items;h=_.arr.subIndexOf(j,"id",c);if(n.renderId){e=f._prepareItems(n,i,c);a=n._buildItems("items",e);if(n.$attached){for(var m=0,b;b=n.$attached[m++];){if(b._render){b._render(true)}}delete n.$attached}if(h==-1){d=n.getSubNode(f._ITEMSKEY||n.keys.ITEMS||n.keys.KEY);if(l){d.prepend(a)}else{d.append(a)}}else{d=n.getSubNodeByItemId(f._ITEMKEY||"ITEM",c);if(l){d.addPrev(a)}else{d.addNext(a)}}}if(h==-1){_.arr.insertAny(j,i,l?0:-1)}else{_.arr.insertAny(j,i,l?h:h+1)}if(k){n.boxing()._afterInsertItems(n,e,c,l)}})},removeItems:function(c,e){if(!(c instanceof Array)){c=[c]}var f,d,a=this._afterRemoveItems;remove=function(i,b,k,h,j){var g=arguments.callee;if(!h){h=linb()}_.filter(b,function(p){var n,l;if(j||(l=(_.arr.indexOf(k,p.id)!=-1))){if(i.renderId){if(n=i.ItemIdMapSubSerialId[p.id]){delete i.SubSerialIdMapItem[n];delete i.ItemIdMapSubSerialId[p.id];i.reclaimSubId(n,"items");if(!j){if(!(f=i.getSubNode(i.keys[e]?e:(i.box._ITEMKEY||"ITEM"),n)).isEmpty()){h.merge(f)}if(p.$linbid){h.get().push(linb.getObject(p.$linbid).getRootNode())}}}}}if(p.sub){g(i,p.sub,k,h,j||l)}if(l){for(var m in p){p[m]=null}return false}});h.remove()};return this.each(function(b){var g=b.properties;remove(b,g.items,c);if(d=g.$UIvalue){if((d=d.split(";")).length>1){_.filter(d,function(h){return _.arr.indexOf(c,h)==-1});g.$UIvalue=d.join(";")}else{if(_.arr.indexOf(c,g.$UIvalue)!=-1){g.$UIvalue=null}}}if(a&&b.renderId){b.boxing()._afterRemoveItems(b,c)}})},clearItems:function(a){return this.each(function(b){if(!b.SubSerialIdMapItem){return}b.getSubNode(b.keys[b.box._ITEMKEY||"ITEM"],true).remove();_.each(b.SubSerialIdMapItem,function(d,c){b.reclaimSubId(c,"items")});b.properties.items.length=0;b.SubSerialIdMapItem={};b.ItemIdMapSubSerialId={}})},updateItem:function(b,m){var l=this,d=l.get(0),g=d.box,h=d.properties.items,i=d.queryItems(h,function(n){return typeof n=="object"?n.id===b:n==b},true,true,true),k,e,f,c,a,j;if(!_.isHash(m)){m={caption:m+""}}delete m.id;if(i.length){i=i[0];if(typeof i[0]!="object"){k=i[2][i[1]]={id:i[0]}}else{k=i[0]}_.merge(k,m,"all");c=d.getSubNodeByItemId("ITEM",b);if(!c.isEmpty()){e=_.get(d,["ItemIdMapSubSerialId",b]);f=g._prepareItems(d,[k],k._pid,false,e);if(m.sub){delete k._created;delete k._checked}else{if(k.sub){a=d.getSubNodeByItemId("SUB",b)}}c.replace(d._buildItems(arguments[2]||"items",f),false);if(a&&!a.isEmpty()){if(!(j=d.getSubNodeByItemId("SUB",b)).isEmpty()){j.replace(a)}}}}return l},getItems:function(f){var e=this.get(0).properties.items;if(f=="data"){return _.clone(e,true)}else{if(f=="min"){var d=_.clone(e,true),c;_.arr.each(d,function(b,a){d[a]=b.id});return d}else{return e}}},fireItemClickEvent:function(a){this.getSubNodeByItemId("ITEM",a).onClick();return this}},Initialize:function(){var a=this.prototype;_.arr.each(_.toArr("getItemByItemId,getItemByDom,getSubIdByItemId,getSubNodeByItemId"),function(b){a[b]=function(){var c=this.get(0);return c[b].apply(c,arguments)};Class._fun(a[b],b,a.KEY,null,"instance")})},Static:{$abstract:true,DataModel:{listKey:{set:function(b){var c=this,a=c.box.getCachedData(b);if(a){c.boxing().setItems(a)}else{c.boxing().setItems(c.properties.items)}c.properties.listKey=b}},items:{ini:[],set:function(a){var b=this;if(b.renderId){b.boxing().clearItems().insertItems(a)}else{b.properties.items=_.copy(a)}}}},RenderTrigger:function(){this.destroyTrigger=function(){_.each(this.SubSerialIdMapItem,function(a){_.breakO(a)});this.properties.items.length=0}},_adjustItems:function(c){if(!c){c=[]}if(_.isStr(c)){c=[c]}var d=_.copy(c),b;_.arr.each(d,function(e,a){if(typeof e!="object"){d[a]={id:e+""}}else{d[a]=_.copy(e);d[a].id=_.isSet(d[a].id)?(d[a].id+""):_.id()}});return d},_showTips:function(c,e,h){if(c.properties.disableTips){return}if(c.onShowTips){return c.boxing().onShowTips(c,e,h)}if(!linb.Tips){return}var b=c.properties,g=e.id,a=c.getSubId(g),f=c.SubSerialIdMapItem,d=f&&f[a];if(d&&d.tips){linb.Tips.show(h,d);return true}else{return false}}}});Class("linb.absValue","linb.absObj",{Instance:{_getCtrlValue:function(){return this.get(0).properties.$UIvalue},_setCtrlValue:function(a){return this},_setDirtyMark:function(a){return this.each(function(e){if(!e.properties.dirtyMark){return}if(!e.renderId){return}var c=e.properties,b=c.value!==c.$UIvalue,g=e.getSubNode(a||"KEY"),f=linb.UI.$css_tag_dirty;if(e._dirtyFlag!==b){if(e.beforeDirtyMark&&false===e.boxing().beforeDirtyMark(e,b)){}else{if(e._dirtyFlag=b){g.addClass(f)}else{g.removeClass(f)}}}})},getValue:function(){return this.get(0).properties.value},getUIValue:function(){return this.get(0).properties.$UIvalue=this._getCtrlValue()},resetValue:function(b){var a=this;a.each(function(c){var d,e=c.properties;if(typeof(d=c.box._ensureValue)=="function"){b=d.call(c.box,c,b)}if(e.value!==b||e.$UIvalue!==b){if(c.box._beforeResetValue){c.box._beforeResetValue(c)}c.boxing()._setCtrlValue(e.value=b);e.$UIvalue=b;if(typeof(d=c.$onValueSet)=="function"){d.call(c,b)}}c.inValid=1});a._setDirtyMark();return a},setUIValue:function(c,b){var a=this;this.each(function(d){var h=d.properties,f,g=h.$UIvalue,e=d.boxing();if(g!==c||b){if(false===d.box._checkValid(d,c)||(d.beforeUIValueSet&&false===(f=e.beforeUIValueSet(d,g,c)))){return}if(f!==undefined&&typeof f!=="boolean"){c=f}if(typeof(f=d.box._ensureValue)=="function"){c=f.call(d.box,d,c)}if(typeof(f=d.$onValueUpdated)=="function"){f.call(d,c)}if(d.renderId){e._setCtrlValue(c)}h.$UIvalue=c;if(d.renderId){e._setDirtyMark()}if(d.afterUIValueSet){e.afterUIValueSet(d,g,c)}if(d.onChange){e.onChange(d,g,c)}}});return this},updateValue:function(){return this.each(function(b){var c=b.properties;if(c.value!==c.$UIvalue){var a=b.boxing();if(a.checkValid()){a.setValue(a.getUIValue(),true);a._setDirtyMark()}}})},isDirtied:function(){var a=false;this.each(function(b){var c=b.properties;a=(c.value+" ")!==(c.$UIvalue+" ");if(a){return false}});return a},checkValid:function(){var a=true;this.each(function(b){var c=b.properties;a=b.box._checkValid(b,c.$UIvalue)&&a;if(b.renderId){b.boxing()._setDirtyMark()}});return a}},Static:{$abstract:true,DataModel:{dataBinder:{combobox:function(){return _.toArr(linb.DataBinder._pool,true)},set:function(b,d){var a=this,c=a.properties;if(d){linb.DataBinder._unBind(d,a)}c.dataBinder=b;linb.DataBinder._bind(b,a)}},dataField:{ini:"",set:function(d,f){var c=this,b,e=c.properties;e.dataField=d;if(!e.dataBinder){return}var a=linb.DataBinder.getFromName(e.dataBinder);if(a&&(b=a.get(0))&&(b=b._valuesMap)&&_.isSet(b=b[d])){c.boxing().setValue(b,true)}}},readonly:{ini:false,action:function(a){var b=this.getRoot();if(a){b.addClass("ui-readonly")}else{b.removeClass("ui-readonly")}}},value:{ini:null,set:function(e){var b=this,g=b.properties,d,f=g.value,c=b.boxing(),a=e;if(b.box._checkValid(b,a)===false){return}if(b.beforeValueSet&&false===(d=c.beforeValueSet(b,f,a))){return}if(d!==undefined){a=d}if(typeof(d=b.box._ensureValue)=="function"){a=d.call(b.box,b,a)}if(typeof(d=b.$onValueSet)=="function"){d.call(b,a)}if(b.renderId){c._setCtrlValue(a)}g.value=g.$UIvalue=a;b.inValid=1;if(b.renderId){c._setDirtyMark()}if(b.afterValueSet){c.afterValueSet(b,f,a)}}},dirtyMark:true},EventHandlers:{beforeValueSet:function(b,a,c){},afterValueSet:function(b,a,c){},beforeUIValueSet:function(b,a,c){},afterUIValueSet:function(b,a,c){},onChange:function(b,a,c){},beforeDirtyMark:function(b,a){}},RenderTrigger:function(){var c=this,a=c.boxing(),e=c.properties,d;if(d=e.dataBinder){a.setDataBinder(d,true)}if(d=e.dataField){a.setDataField(d)}if(e.value!==undefined){if(typeof(d=c.box._ensureValue)=="function"){e.value=d.call(c.box,c,e.value);if(e.$UIvalue){e.$UIvalue=d.call(c.box,c,e.$UIvalue)}}if(!e.$UIvalue){e.$UIvalue=e.value}a._setCtrlValue(e.$UIvalue)}},_checkValid:function(a,b){return true}}});new function(){var a="linb.UI";Class(a+".Widget",a,{Static:{Appearances:{KEY:{"font-size":linb.browser.ie?0:null,"line-height":linb.browser.ie?0:null}},Templates:{className:"uiw-shell ",style:"{_style}",FRAME:{className:"uiw-frame ",BORDER:{style:"width:{bWidth}px;height:{bHeight}px;",className:"uiw-border"}}},Behaviors:{KeyHook:true,onSize:linb.UI.$onSize},DataModel:{width:100,height:100,$hborder:0,$vborder:0},RenderTrigger:function(){var b=this,c=b.properties,d=b.boxing();if(b.renderId){if((!b.$noB)&&c.border&&d._border){d._border()}}if((!b.$noR)&&c.resizer&&d.setResizer){d.setResizer(c.resizer,true)}if((!b.$noS)&&c.shadow&&d._shadow){d._shadow()}},_onresize:function(e,b,j){var k=e.properties,c=e.getSubNode("BORDER"),i,g=b,f=j,d=Math.max(0,(k.$b_lw||0)-(k.$hborder||0)),h=Math.max(0,(k.$b_tw||0)-(k.$vborder||0));if(g&&"auto"!==g){g-=Math.max((k.$hborder||0)*2,(k.$b_lw||0)+(k.$b_rw||0));if(linb.browser.ie6){g=(parseInt(g/2))*2}}if(f&&"auto"!==f){f-=Math.max((k.$vborder||0)*2,(k.$b_lw||0)+(k.$b_rw||0));if(linb.browser.ie6){f=(parseInt(f/2))*2}if(linb.browser.ie6&&null===b){c.ieRemedy()}}i={left:d,top:h,width:g,height:f};c.cssRegion(i);if((e.$border||e.$shadow||e.$resizer)&&linb.browser.ie){c.ieRemedy()}return i}}});Class(a+".Link",a,{Static:{Appearances:{KEY:{"font-size":linb.browser.ie?"12px":null,"line-height":linb.browser.ie?"14px":null}},Templates:{tagName:"a",style:"{_style}",href:"{href}",target:"{target}",tabindex:"{tabindex}",text:"{caption}"},Behaviors:{HoverEffected:{KEY:"KEY"},ClickEffected:{KEY:"KEY"},onClick:function(c,f,g){var d;if(!c.properties.disabled&&c.onClick){d=c.boxing().onClick(c,f,g)}var b=linb.use(g).attr("href");return typeof d=="boolean"?d:(b.indexOf("javascript:")===0||b.indexOf("#")===0)?false:true}},DataModel:{caption:{ini:undefined,action:function(b){this.getRoot().html(b)}},href:{ini:linb.$DEFAULTHREF,action:function(b){this.getRoot().attr("href",b)}},target:{action:function(b){this.getRoot().attr("target",b)}}},EventHandlers:{onClick:function(b,c){}}}});Class(a+".SLabel",a,{Static:{Templates:{style:"{_style}text-align:{hAlign}",text:"{caption}"},Appearances:{KEY:{"padding-right":"6px"}},DataModel:{caption:{ini:undefined,action:function(b){this.getRoot().html(b)}},hAlign:{ini:"right",listbox:["left","center","right"],action:function(b){this.getRoot().css("textAlign",b)}}}}});Class(a+".SButton",a,{Instance:{activate:function(){this.getSubNode("FOCUS").focus();return this}},Static:{Templates:{className:"{_clsName}",style:"{_style}",BTN:{className:"ui-btn",BTNI:{className:"ui-btni",BTNC:{className:"ui-btnc",FOCUS:{tabindex:"{tabindex}",style:"{_align}",text:"{caption}"}}}}},Appearances:{BTN:{overflow:"hidden"},"KEY-auto BTN, KEY-auto BTNI, KEY-auto BTNC, KEY-auto FOCUS":{$order:1,display:linb.$inlineBlock},"BTN,BTNI,BTNC":{display:"block"},"KEY FOCUS":{cursor:"pointer","font-size":"12px","line-height":"14px","text-align":"center",display:"block"}},Behaviors:{HoverEffected:{BTN:["BTN"]},ClickEffected:{BTN:["BTN"]},NavKeys:{FOCUS:1},onClick:function(b,d,f){var c=b.properties;if(c.disabled){return false}b.getSubNode("FOCUS").focus();if(b.onClick){b.boxing().onClick(b,d,f)}}},DataModel:{caption:{ini:undefined,action:function(b){this.getSubNode("FOCUS").html(b)}},hAlign:{ini:"center",listbox:["left","center","right"],action:function(b){this.getSubNode("FOCUS").css("textAlign",b)}},width:{ini:"auto",action:function(b){if(b=="auto"){this.getRoot().width("auto").tagClass("-auto")}else{this.getRoot().width(b).tagClass("-auto",false)}}},height:{readonly:true}},EventHandlers:{onClick:function(b,d,f,c){}},_prepareData:function(b){var c=arguments.callee.upper.call(this,b);c._align="text-align:"+c.hAlign+";";c._clsName=parseInt(c.width)?"":b.getClass("KEY","-auto");return c}}});Class(a+".SCheckBox",[a,"linb.absValue"],{Instance:{activate:function(){this.getSubNode("FOCUS").focus();return this},_setCtrlValue:function(b){return this.each(function(c){c.getSubNode("MARK").tagClass("-checked",!!b)})},_setDirtyMark:function(){return arguments.callee.upper.apply(this,["CAPTION"])}},Static:{Templates:{className:"{_clsName}",style:"{_style}",FOCUS:{tabindex:"{tabindex}",MARK:{className:"uicmd-check"},CAPTION:{$order:1,text:"{caption}"}}},Appearances:{KEY:{overflow:"visible"},FOCUS:{cursor:"default","vertical-align":"middle",padding:"2px 0","font-size":"12px","line-height":"14px"},CAPTION:{"vertical-align":linb.browser.ie6?"baseline":"middle"}},Behaviors:{HoverEffected:{KEY:"MARK"},ClickEffected:{KEY:"MARK"},NavKeys:{FOCUS:1},onClick:function(d,g,h){var f=d.properties,c=d.boxing();if(f.disabled){return false}if(f.readonly){return false}c.setUIValue(!f.$UIvalue);if(d.onChecked){c.onChecked(d,g,f.$UIvalue)}d.getSubNode("FOCUS").focus()},FOCUS:{onKeydown:function(c,d,f){var b=linb.Event.getKey(d)[0];if(b==" "||b=="enter"){c.getRoot().onClick(true);return false}}}},DataModel:{value:false,caption:{ini:undefined,action:function(b){this.getSubNode("CAPTION").html(b)}}},EventHandlers:{onChecked:function(b,d,c){}},_ensureValue:function(b,c){return !!c}}});Class(a+".Div",a,{Static:{Appearances:{KEY:{outline:linb.browser.gek?"none":null,zoom:linb.browser.ie6?"1":null,background:linb.browser.ie?"url("+linb.ini.file_bg+") no-repeat left top":null}},Templates:{tagName:"div",style:"{_style}",tabindex:"-1",text:"{html}"+linb.UI.$childTag},DataModel:{width:"100",height:"100",html:{action:function(b){this.getRoot().html(b)}}}}});Class(a+".Tag",a+".Div",{Static:{Templates:{tagName:"div",style:"overflow:auto;border:dashed blue 1px;text-align:center;background:#EBEADB;{_style}",text:"{tagKey}"+linb.UI.$childTag},DataModel:{html:null,tagKey:{action:function(b){this.getRoot().html(b)}}},_l:_.toArr("left,top,bottom,right,width,height,zIndex,tabindex,position,dock,dockFloat,dockMinW,dockMinH,dockOrder,dockMargin"),replace:function(d,e,b){_.arr.each(this._l,function(h){if(h in d.properties){e.properties[h]=d.properties[h]}});_.merge(e.CS,d.CS,"all");_.merge(e.CC,d.CC,"all");if(typeof d.theme=="string"){e.theme=d.theme}if(d.parent){var f=d.parent.children,g=f["$"+d.$linbid],c=_.arr.indexOf(f,g);d.parent.boxing().append(e,g[1]);f[c]=f.pop();d.unLink("$parent");delete d.parent}else{if(b){_.arr.each(b._nodes,function(j,h){if(j===d){b._nodes[h]=e;return false}})}}if(d.renderId){e.boxing().renderOnto(d.getRootNode())}}}});Class(a+".Pane",a+".Div",{Static:{Behaviors:{DropableKeys:["KEY"]}}})};Class("linb.Tips",null,{Constructor:function(){return null},Initialize:function(){var b=linb.DragDrop,a=this;if(b){b.$reset=function(){a._pos={left:b._profile.x,top:b._profile.y}}}linb.CSS.addStyleSheet(".linb-tips{font-size:0;line-height:0;position:absolute;overflow:visible;} .linb-tips-i{font-size:12px;overflow:hidden;}.linb-tips-i span{display:inline;}",this.KEY);linb.doc.afterMousedown(function(){a._cancel()},"$Tips",-1).afterMousemove(function(g,f){if(b.isWorking){return}var c=linb.Event,d,h;if((d=_.resetRun.$cache)&&d["$Tips3"]){a._pos=c.getPos(f)}if(a._from){_.resetRun("$Tips3",null);a._showF()}else{if(a._showed&&a.MOVABLE){d=c.getPos(f);h=a._Node.style;h.left=(parseInt(h.left)||0)+(d.left-a._pos.left)+"px";h.top=(parseInt(h.top)||0)+(d.top-a._pos.top)+"px";a._pos=d;h=null}}},"$Tips",-1).afterMouseover(function(i,l){var c=linb.Event,g=c.$FALSE,f=c.getSrc(l),d,k,m,h,j=0,n;if(!f){return g}try{while((!f.id||f.id==linb.$localeDomId)&&f.parentNode!==document&&j++<10){f=f.parentNode}if(!(d=f.id)){f=null;return g}}catch(l){}if((k=c._getProfile(d))&&k.box&&k.KEY=="linb.UIProfile"){if(k.properties.disableTips){f=null;return false}m=k.onShowTips?d:d.replace(a._reg,":");if(a._markId&&m==a._markId){return g}a._markId=m;a._pos=c.getPos(l);if(a._showed){a._from=k;a._enode=d;a._showF()}else{_.resetRun("$Tips",function(){a._from=k;a._enode=d;_.resetRun("$Tips3",function(){if(a._from){a._showF()}},100)},a.DELAYTIME)}}else{a._cancel()}f=null;return g},"$Tips",-1).afterMouseout(function(g,l){if(a._markId){var c=linb.Event,d,m,h,k=a._from,i,j=0,f=l.toElement||l.relatedTarget;if(!f){i=1}else{try{while((!f.id||f.id==linb.$localeDomId)&&f.parentNode!==document&&j++<10){f=f.parentNode}if(!(d=f.id)){f=null;i=1}}catch(l){i=1}}if(i){a._cancel()}else{m=(k&&k.onShowTips)?d:d.replace(a._reg,":")}f=null;return c.$FALSE}},"$Tips",-1);this._Types={"default":new function(){this._r=/(\$)([\w\.]+)/g;this.show=function(n,j,m){if(!j){return}var o=this,e,d,p,l,g;if(!(e=o.node)||!e.get(0)){e=o.node=linb.create('<div class="linb-tips"><div class="linb-tips-i"></div></div>');d=o._ruler=linb.create('<div class="linb-tips" style="position:absolute;visibility:hidden;left:-10000px;"><div class="linb-tips-i" style="position:relative;"></div></div>');o.n=e.first();o._n=d.first();if(typeof e.addShadow=="function"){e.addShadow();d.addShadow()}linb("body").append(d)}d=o._ruler;if(document.body.lastChild!=e.get(0)){linb("body").append(e)}p=typeof n=="object"?n[m||linb.Tips.TIPSKEY]:n;if(typeof p=="function"){p=p()}if(p+=""){var f=/^\s*\</.test(p);p=p.replace(o._r,function(q,h,r){return linb.getRes(r)});linb.Tips._curTips=p;if(!n.transTips||!f){p='<div style="border:solid gray 1px;background-color:#FFF8DC;padding:1px 2px 2px 2px;">'+p+"</div>"}o._n.get(0).innerHTML=p;l=d.get(0).offsetWidth;if(!f){l=Math.min(a.MAXWIDTH,l)}var c=e.get(0).style,i=o.n.get(0),k=i.style;c.visibility="hidden";i.innerHTML=p;if(linb.browser.ie){c.width=k.width=l+(l%2)+"px";g=i.offsetHeight;c.height=g-(g%2)+"px"}else{k.width=l+"px"}e.popToTop({left:j.left,top:j.top,region:{left:j.left,top:j.top-12,width:24,height:32}},1);c=k=i=null}else{e.css("zIndex",0).hide()}};this.hide=function(){this.node.css("zIndex",0).hide()}}}},Static:{_reg:/-[\w]+:/,TIPSKEY:"tips",MAXWIDTH:300,MOVABLE:true,DELAYTIME:200,AUTOHIDETIME:5000,_showF:function(){var c=this,f=c._from,e=linb.Dom.byId(c._enode),i=c._pos,h,g,d,a=false;c._from=c._enode=null;if(!e||!f||!i||!(g=f.box)){return}c._pos=i;a=((d=f.CF)&&(d=d.showTips)&&d(f,e,i));if(!a){a=(g._showTips&&g._showTips(f,e,i))}if(!a&&((d=f)&&d.tips)||(d&&(d=d.properties)&&(d.tips))){c.show(i,d);a=true}if(!a){c.hide()}else{if(!c.MOVABLE){_.resetRun("$Tips2",c.hide,c.AUTOHIDETIME,null,c)}}e=i=f=null},getTips:function(){return this._curTips},show:function(e,d,c){var a=this,b;a._pos=e;if(a._item===d){return}if(typeof d=="string"||(d&&(d[c||linb.Tips.TIPSKEY]))){b=a._tpl=a._Types[d.tipsTemplate]||a._Types["default"];b.show(d,e,c);a._Node=b.node.get(0);a._item=d;a._showed=true}else{a._cancel()}},hide:function(){var a=this;if(a._showed){if(a._tpl){a._tpl.hide()}a._clear()}},_cancel:function(){var a=this;if(a._markId){if(a._showed){a.hide()}else{_.resetRun("$Tips",null);_.resetRun("$Tips3",null);a._clear()}}},_clear:function(){var a=this;a._Node=a._curTips=a._markId=a._from=a._tpl=a._item=a._showed=null}}});Class("linb.UI.Border","linb.UI",{Instance:{_attachTo:function(f,d){var c=this,b=c.get(0),e;f.append(c);b.$edgeId=linb(f).id();b.$tieId=d;b.$attached=true;if(e=b.properties){if(b.properties.borderActive){var a="tag",g=b.domId;if(linb(d).get(0)){linb(d).afterMouseover(function(j,i){if(j.properties.disabled){return}var h=linb.$cache.profileMap[g];_.tryF(h.behavior.TAG.afterMouseover,[h,i,h.getRootNode()],this)},a).afterMouseout(function(j,i){if(j.properties.disabled){return}var h=linb.$cache.profileMap[g];_.tryF(h.behavior.TAG.afterMouseout,[h,i,h.getRootNode()],this)},a).afterMousedown(function(j,i){if(j.properties.disabled){return}var h=linb.$cache.profileMap[g];_.tryF(h.behavior.TAG.afterMousedown,[h,i,h.getRootNode()],this)},a).afterMouseup(function(j,i){if(j.properties.disabled){return}var h=linb.$cache.profileMap[g];_.tryF(h.behavior.TAG.afterMouseup,[h,i,h.getRootNode()],this)},a)}}}return f},_detach:function(){var d=this,c=d.get(0),f,e,b=null,a="tag";delete c.$attached;if(f=c.$tieId){if(f=linb.Dom.byId(f)){linb(f).afterMouseover(b,a).afterMouseout(b,a).afterMousedown(b,a).afterMouseup(b,a)}}return d}},Initialize:function(){_.each({addBorder:function(b){var c=linb([this.get(0)]),a=arguments[1]||c.id();return new linb.UI.Border(b)._attachTo(c,a)},$getBorder:function(){var c=this.id(),a;_.arr.each(linb.UI.Border._cache,function(b){if(b.$edgeId==c){a=b;return false}});return a&&a.boxing()},removeBorder:function(){var a=this.id();_.arr.each(linb.UI.Border._cache,function(b){if(b.$edgeId==a){b.boxing()._detach().destroy()}});return this}},function(b,a){linb.Dom.plugIn(a,b)});_.each({_border:function(b,a){return this.each(function(h){var f=h.properties,g=h.getSubNode(f._customBorder||"BORDER"),d;if(!b){b={}}if(f._customBorder){d=(b._bkey=h.getClass("KEY"))}else{d="linb-border"}var e="setting-"+d,c;c="borderLeftWidth";f.$b_lw=linb.UI.$getCSSValue(e,c);c="borderRightWidth";f.$b_rw=linb.UI.$getCSSValue(e,c);c="borderTopWidth";f.$b_tw=linb.UI.$getCSSValue(e,c);c="borderBottomWidth";f.$b_bw=linb.UI.$getCSSValue(e,c);if(a!==false){if(g.$getBorder()){return}h.$border=g.addBorder(b);h.clearCache().boxing().reLayout()}})},_unBorder:function(){return this.each(function(c){var b=c.getSubNode("BORDER"),a=c.properties;if(!b.$getBorder()){return}b.removeBorder();delete c.$border;delete a.$b_lw;delete a.$b_rw;delete a.$b_tw;delete a.$b_bw;c.clearCache().boxing().reLayout()})}},function(b,a){linb.UI.Widget.plugIn(a,b)});linb.UI.Widget.setDataModel({border:{ini:false,action:function(c){var a=this.boxing();if(c){a._border()}else{a._unBorder()}}}})},Static:{Templates:{tagName:"div",TAG:{},T:{className:"{cls_t}"},RT:{className:"{cls_rt}",$order:1},R:{className:"{cls_r}"},RB:{className:"{cls_rb}",$order:1},B:{className:"{cls_b}"},LB:{className:"{cls_lb}",$order:1},L:{className:"{cls_l}"},LT:{className:"{cls_lt}",$order:1}},Appearances:{KEY:{width:0,height:0,_display:"inline","font-size":0,"line-height":0},"TAG,T, RT, R, RB, B, LB, L, LT":{position:"absolute",display:"block","font-size":0,"line-height":0},".setting-linb-border":{"border-style":"solid","border-top-width":"1px","border-bottom-width":"1px","border-left-width":"1px","border-right-width":"1px"},T:{width:"100%",left:0,top:"-1px",height:"3px",background:linb.UI.$bg("vertical.gif","repeat-x left top")},B:{width:"100%",left:0,bottom:"-1px",height:"3px",background:linb.UI.$bg("vertical.gif","repeat-x left bottom")},L:{height:"100%",top:0,left:"-1px",width:"3px",background:linb.UI.$bg("horizontal.gif","repeat-y left top")},R:{height:"100%",top:0,right:"-1px",width:"3px",background:linb.UI.$bg("horizontal.gif","repeat-y right top")},LT:{top:"-1px",left:"-1px",width:"3px",height:"3px",background:linb.UI.$bg("corner.gif","no-repeat left top")},RT:{top:"-1px",right:"-1px",width:"3px",height:"3px",background:linb.UI.$bg("corner.gif","no-repeat right top")},RB:{right:"-1px",bottom:"-1px",width:"3px",height:"3px",background:linb.UI.$bg("corner.gif","no-repeat right bottom")},LB:{left:"-1px",bottom:"-1px",width:"3px",height:"3px",background:linb.UI.$bg("corner.gif","no-repeat left bottom")}},Behaviors:{HoverEffected:{TAG:"KEY"},ClickEffected:{TAG:"KEY"}},DataModel:{_bkey:"",borderActive:false},_prepareData:function(a){var c=arguments.callee.upper.call(this,a),b=a.properties._bkey;c.cls_t=b?b+"-b-t":"";c.cls_rt=b?b+"-b-rt":"";c.cls_r=b?b+"-b-r":"";c.cls_rb=b?b+"-b-rb":"";c.cls_b=b?b+"-b-b":"";c.cls_lb=b?b+"-b-lb":"";c.cls_l=b?b+"-b-l":"";c.cls_lt=b?b+"-b-lt":"";return c}}});Class("linb.UI.Shadow","linb.UI",{Instance:{_attachTo:function(b){b=b.reBoxing();var a=this;a.get(0)._target=b.get(0);b.append(a);return b}},Initialize:function(){_.each({addShadow:function(a){return new linb.UI.Shadow(a)._attachTo(linb([this.get(0)]))},$getShadow:function(){var c=this.get(0),a;_.arr.each(linb.UI.Shadow._cache,function(b){if(b._target==c){a=b;return false}});return a&&a.boxing()},removeShadow:function(){var a=this.get();_.arr.each(linb.UI.Shadow._cache,function(b){if(b&&b.renderId&&b._target){if(_.arr.indexOf(a,linb(b._target).get(0))!=-1){b.boxing().destroy()}}});return this}},function(b,a){linb.Dom.plugIn(a,b)});_.each({_shadow:function(a){return this.each(function(e){var b=e.getSubNode("BORDER");if(b.$getShadow()){return}var c=e.properties;e.$shadow=b.addShadow({shadowSize:c._shadowSize})})},_unShadow:function(){return this.each(function(b){var a=b.getSubNode("BORDER");if(!a.$getShadow()){return}a.removeShadow();delete b.$shadow})}},function(b,a){linb.UI.Widget.plugIn(a,b)});linb.UI.Widget.setDataModel({shadow:{ini:false,action:function(c){var a=this.boxing();if(c){a._shadow()}else{a._unShadow()}}},_shadowSize:this.SIZE})},Static:{SIZE:8,Templates:{tagName:"div",R:{tagName:"div",style:"top:{shadowOffset}px;width:{shadowSize}px;right:-{pos}px;"},RB:{tagName:"div",style:"height:{rbsize}px;width:{rbsize}px;right:-{pos}px;bottom:-{pos}px;"},B:{tagName:"div",style:"left:{shadowOffset}px;height:{shadowSize}px;bottom:-{pos}px;"}},Appearances:{KEY:{width:0,height:0,_display:"inline","_font-size":0,"_line-height":0},"B, RB, R":{position:"absolute",display:"block","*font-size":0,"*line-height":0,"z-index":"-1"},B:{left:0,width:"100%",background:linb.browser.ie6?"":linb.UI.$bg("bottom.png","repeat-x left bottom"),_filter:linb.UI.$ieBg("bottom.png")},RB:{background:linb.browser.ie6?"":linb.UI.$bg("right_bottom.png","left top"),_filter:linb.UI.$ieBg("right_bottom.png")},R:{top:0,height:"100%",background:linb.browser.ie6?"":linb.UI.$bg("right.png","repeat-y right top"),_filter:linb.UI.$ieBg("right.png")}},DataModel:{shadowSize:{ini:8,action:function(c){var b=this,a=b.properties.shadowOffset;b.getSubNode("R").cssRegion({width:c,top:a,right:-c-a});b.getSubNode("RB").cssRegion({width:c,height:c,right:-c-a+1,bottom:-c-a+1});b.getSubNode("B").cssRegion({height:c,left:a,bottom:-c-a})}},shadowOffset:{ini:0,action:function(a){this.boxing().setShadowSize(this.properties.shadowSize,true)}}},_prepareData:function(b){var a=arguments.callee.upper.call(this,b);a.pos=(parseInt(a.shadowSize)||0)+(parseInt(a.shadowOffset)||0);a.rbsize=a.shadowSize+4;return a},LayoutTrigger:function(){if(linb.browser.ie){this.getRoot().ieRemedy()}}}});Class("linb.UI.Resizer","linb.UI",{Instance:{_attachTo:function(d,c){var b=this,a=b.get(0);a._target=linb(d);a._parent=c||linb("body");a._parent.append(b);a.$resizeId=linb(d).id();return b},show:function(){var a=this;a.each(function(b){b.getRoot().css("display",b.$display||"block")});if(linb.browser.ie){a.reBoxing().ieRemedy()}return a},hide:function(){var a=this;a.each(function(b){b.$display=b.getRoot().css("display")});a.reBoxing().css("display","none");return a}},Initialize:function(){this.addTemplateKeys(["HANDLER","HIDDEN","MOVE","L","R","T","B","LT","RT","LB","RB"]);_.each({addResizer:function(b,a){var d=linb([this.get(0)]);b=b||{};_.merge(b,{_attached:true});var c=new linb.UI.Resizer(b)._attachTo(d,d);if(a){c.onUpdate(a)}return c},removeResizer:function(){var a=this.id();_.arr.each(linb.UI.Resizer._cache,function(b){if(b.$resizeId==a){b.boxing().destroy()}});return this},$getResizer:function(){var c=this.id(),a;_.arr.each(linb.UI.Resizer._cache,function(b){if(b.$resizeId==c){a=b;return false}});return a&&a.boxing()}},function(b,a){linb.Dom.plugIn(a,b)});_.each({_resizer:function(b,a){return this.each(function(f){var c=f.getSubNode("BORDER"),e=f.properties;if(c.$getResizer()){return}a=a||{};var g=function(q,o,u,i){var k=arguments.callee.profile,j=k.getRoot(),r=k.boxing(),d=k.properties,s;if(u){var p=null,n=null,m=null,s=null;if(s=u.width){j.widthBy(s);d.width=p=j.width()}if(s=u.height){j.heightBy(s);d.height=n=j.height()}linb.UI.$tryResize(k,p,n,true);if(!k.box._onresize&&k.onResize&&(p!==null||n!==null)){r.onResize(k,p,n)}}if(i){if((s=i.left)&&!(d.left=="auto"&&parseInt(d.right)>=0)){j.leftBy(s);d.left=j.left()}if((s=i.top)&&!(d.top=="auto"&&parseInt(d.bottom)>=0)){j.topBy(s);d.top=j.top()}if(k.onMove&&(m!==null||s!==null)){r.onMove(k,m,s,null,null)}}};g.profile=f;f.$resizer=c.addResizer(a,g);f.$resizer.get(0).$parentUIProfile=f})},_unResizer:function(){return this.each(function(b){var a=b.getSubNode("BORDER");if(!a.$getResizer()){return}a.removeResizer();delete b.$resizer.get(0).$parentUIProfile;delete b.$resizer})}},function(b,a){linb.UI.Widget.plugIn(a,b)});linb.UI.Widget.setDataModel({resizer:{ini:false,action:function(d){var c=this.boxing();if(d){var e=this.properties,a={};_.each("minHeight,minWidth,maxHeight,maxWidth".split(","),function(b){if(b in e){a[b]=e[b]}});c._resizer(d,a)}else{c._unResizer()}}}})},Static:{Templates:{tagName:"div",style:"{_style};"},Appearances:{KEY:{position:"absolute",margin:"0 -1px -1px 0",visibility:"visible","font-size":0,"line-height":0,"*background":"url("+linb.ini.path+"bg.gif)","z-index":60,cursor:"move"},MOVE:{position:"absolute",display:"block","z-index":100,visibility:"visible",background:linb.UI.$bg("icons.gif","no-repeat -17px -244px",true),"font-size":0,"line-height":0},HANDLER:{$order:0,position:"absolute",display:"block",border:"solid 1px","background-color":"#fff","z-index":100,visibility:"visible","font-size":0,"line-height":0},T:{$order:1,left:"50%",cursor:"n-resize"},RT:{$order:1,cursor:"ne-resize","z-index":110},R:{$order:1,top:"50%",cursor:"e-resize"},RB:{$order:1,cursor:"se-resize","z-index":110},B:{$order:1,left:"50%",cursor:"s-resize"},LB:{$order:1,cursor:"sw-resize","z-index":110},L:{$order:1,top:"50%",cursor:"w-resize"},LT:{$order:1,cursor:"nw-resize","z-index":110},HIDDEN:{$order:10,"background-color":"transparent","border-width":0}},Behaviors:{onMousedown:function(a,b,c){a.box._onMousedown(a,b,c,{move:true})},onDragbegin:function(a,b,c){a.box._onDragbegin(a,b,c)},onDrag:function(a,b,c){a.box._onDrag(a,b,c,{move:true})},onDragstop:function(a,b,c){a.box._onDragstop(a,b,c,{move:true})},onDblclick:function(a,b,c){if(a.onDblclick){a.boxing().onDblclick(a,b,c)}},LT:{onMousedown:function(a,b,c){a.box._onMousedown(a,b,c,{left:true,top:true});return false},onDragbegin:function(a,b,c){a.box._onDragbegin(a,b,c)},onDrag:function(a,b,c){a.box._onDrag(a,b,c,{left:true,top:true})},onDragstop:function(a,b,c){a.box._onDragstop(a,b,c,{left:true,top:true})}},RT:{onMousedown:function(a,b,c){a.box._onMousedown(a,b,c,{right:true,top:true});return false},onDragbegin:function(a,b,c){a.box._onDragbegin(a,b,c)},onDrag:function(a,b,c){a.box._onDrag(a,b,c,{right:true,top:true})},onDragstop:function(a,b,c){a.box._onDragstop(a,b,c,{right:true,top:true})}},LB:{onMousedown:function(a,b,c){a.box._onMousedown(a,b,c,{left:true,bottom:true});return false},onDragbegin:function(a,b,c){a.box._onDragbegin(a,b,c)},onDrag:function(a,b,c){a.box._onDrag(a,b,c,{left:true,bottom:true})},onDragstop:function(a,b,c){a.box._onDragstop(a,b,c,{left:true,bottom:true})}},RB:{onMousedown:function(a,b,c){a.box._onMousedown(a,b,c,{right:true,bottom:true});return false},onDragbegin:function(a,b,c){a.box._onDragbegin(a,b,c)},onDrag:function(a,b,c){a.box._onDrag(a,b,c,{right:true,bottom:true})},onDragstop:function(a,b,c){a.box._onDragstop(a,b,c,{right:true,bottom:true})}},L:{onMousedown:function(a,b,c){a.box._onMousedown(a,b,c,{left:true});return false},onDragbegin:function(a,b,c){a.box._onDragbegin(a,b,c)},onDrag:function(a,b,c){a.box._onDrag(a,b,c,{left:true})},onDragstop:function(a,b,c){a.box._onDragstop(a,b,c,{left:true})}},T:{onMousedown:function(a,b,c){a.box._onMousedown(a,b,c,{top:true});return false},onDragbegin:function(a,b,c){a.box._onDragbegin(a,b,c)},onDrag:function(a,b,c){a.box._onDrag(a,b,c,{top:true})},onDragstop:function(a,b,c){a.box._onDragstop(a,b,c,{top:true})}},R:{onMousedown:function(a,b,c){a.box._onMousedown(a,b,c,{right:true});return false},onDragbegin:function(a,b,c){a.box._onDragbegin(a,b,c)},onDrag:function(a,b,c){a.box._onDrag(a,b,c,{right:true})},onDragstop:function(a,b,c){a.box._onDragstop(a,b,c,{right:true})}},B:{onMousedown:function(a,b,c){a.box._onMousedown(a,b,c,{bottom:true});return false},onDragbegin:function(a,b,c){a.box._onDragbegin(a,b,c)},onDrag:function(a,b,c){a.box._onDrag(a,b,c,{bottom:true})},onDragstop:function(a,b,c){a.box._onDragstop(a,b,c,{bottom:true})}}},DataModel:{_attached:false,forceVisible:false,forceMovable:false,singleDir:false,vertical:true,horizontal:true,minHeight:12,minWidth:12,maxHeight:5000,maxWidth:5000,handlerSize:4,handlerOffset:0,left:100,top:100,height:100,width:100,position:"absolute",display:"block"},EventHandlers:{onDblclick:function(a,b,c){},onUpdate:function(c,d,b,a){}},_dynamicTemplate:function(c){var f=c.properties,j,e,h,d=c._exhash="$_attached:"+f._attached+";forceVisible:"+f.forceVisible+";singleDir:"+f.singleDir+";vertical:"+f.vertical+";horizontal:"+f.horizontal+";forceMovable:"+f.forceMovable+";";var a=arguments.callee.map||(arguments.callee.map={MOVE:{tagName:"div",style:"top:50%;left:50%;margin-left:-6px;margin-top:-6px;width:13px;height:13px;"},T:{tagName:"div",style:"top:-{extend}px;margin-left:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},RT:{tagName:"div",style:"top:-{extend}px;right:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},R:{tagName:"div",style:"right:-{extend}px;margin-top:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},RB:{tagName:"div",style:"bottom:-{extend}px;right:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},B:{tagName:"div",style:"bottom:-{extend}px;margin-left:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},LB:{tagName:"div",style:"bottom:-{extend}px;left:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},L:{tagName:"div",style:"left:-{extend}px;margin-top:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},LT:{tagName:"div",style:"left:-{extend}px;top:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},cover:{T:{tagName:"div",style:"width:100%;left:0;top:-{extend}px;height:{handlerSize}px;"},RT:{tagName:"div",style:"top:-{extend}px;right:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},R:{tagName:"div",style:"height:100%;top:0;right:-{extend}px;width:{handlerSize}px;"},RB:{tagName:"div",style:"right:-{extend}px;bottom:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},B:{tagName:"div",style:"width:100%;left:0;bottom:-{extend}px;height:{handlerSize}px;"},LB:{tagName:"div",style:"left:-{extend}px;bottom:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},L:{tagName:"div",style:"height:100%;top:0;left:-{extend}px;width:{handlerSize}px;"},LT:{tagName:"div",style:"top:-{extend}px;left:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"}}});var g=c.box.getTemplate(d);if(!g){var i,b;g=_.clone(c.box.getTemplate());i=f._cover?a.cover:a;if(f._move){g.MOVE=a.MOVE}if(f.vertical){if(!f.singleDir){g.T=i.T}g.B=i.B}if(f.horizontal){if(!f.singleDir){g.L=i.L}g.R=i.R;if(f.vertical){if(!f.singleDir){g.LB=i.LB;g.RT=i.RT;g.LT=i.LT}g.RB=i.RB}}b=c.getClass("KEY","-handler")+" ";if(i=g.T){i.className=b}if(i=g.RT){i.className=b}if(i=g.R){i.className=b}if(i=g.RB){i.className=b}if(i=g.B){i.className=b}if(i=g.LB){i.className=b}if(i=g.L){i.className=b}if(i=g.LT){i.className=b}if(!f._visible){b=c.getClass("KEY","-hidden")+" ";if(i=g.T){i.className+=b}if(i=g.RT){i.className+=b}if(i=g.R){i.className+=b}if(i=g.RB){i.className+=b}if(i=g.B){i.className+=b}if(i=g.LB){i.className+=b}if(i=g.L){i.className+=b}if(i=g.LT){i.className+=b}}c.box.setTemplate(g,d)}c.template=g},_prepareData:function(b){var a=b.properties;a._visible=true;a._cover=false;a._move=true;if(a._attached){a._visible=false;a._cover=true;a._move=false;a.position="static";a.display="inline";a.left=a.top=a.width=a.height=0}if(a.forceVisible){a._visible=true;a._cover=false}if(a.forceMovable){a._move=true}a.extend=(parseInt(a.handlerSize)||0)/2+(parseInt(a.handlerOffset)||0);return arguments.callee.upper.call(this,b)},RenderTrigger:function(){var a=this;linb.setNodeData(a.renderId,"zIndexIgnore",1);if(!a.onUpdate){a.onUpdate=a.box.onUpdate}},onUpdate:function(d,e,c,a){if(e){if(c){e.widthBy(c.width,true).heightBy(c.height,true)}if(a){var b=e.get(0).style;if(b.left=="auto"&&(parseInt(b.right)>=0)){}else{e.leftBy(a.left)}if(b.top=="auto"&&(parseInt(b.bottom)>=0)){}else{e.topBy(a.top)}}}},_onMousedown:function(b,d,f,a){var c=b.$parentUIProfile;if(c&&c["linb.UIProfile"]&&c.beforeResizerDrag&&false===_.tryF(c.beforeResizerDrag,[c,b,a],c.boxing())){return}var g=linb.Event.getPos(d);linb.use(f).startDrag(d,{dragDefer:1,targetReposition:false,dragType:"blank",dragCursor:true,targetLeft:g.left,targetTop:g.top})},_onDragbegin:function(c,d){var f=c.properties._attached?c._target:linb([c.renderId]),a=f.width(),b=f.height();if(c.properties._attached){var g=f.offset();c.proxy=linb.Dom.getEmptyDiv();c.proxy.html(" ",false).css({border:"1px dashed",visibility:"visible"}).offset(g).width(a).height(b).css("zIndex",linb.Dom.TOP_ZINDEX+20)}else{c.proxy=f}c.o_pos=c.proxy.cssPos();c.o_w2=c.o_w=a;c.o_h2=c.o_h=b;c.$onDrag=true},_onDrag:function(d,i,b,n){var c=n;d.oos=d.oos||{};var f=linb.DragDrop.getProfile().offset;if(f.x==d.oos.width&&f.y==d.oos.height){return}d.oos=f;var l,k,m,g,p=d.properties;if(c.left){m=d.o_w-f.x;l=d.o_pos.left+f.x;if(m<p.minWidth){m=p.minWidth;l=d.o_w+d.o_pos.left-m}else{if(m>p.maxWidth){m=p.maxWidth;l=d.o_w+d.o_pos.left-m}}d.proxy.width(m).left(l)}else{if(c.right){m=d.o_w+f.x;if(m<p.minWidth){m=p.minWidth}else{if(m>p.maxWidth){m=p.maxWidth}}d.proxy.width(m)}}if(c.left||c.right){var a=m-d.o_w2;if(d.regions&&a!==0){d.regions.widthBy(a);d.o_w2=m}}if(c.top){g=d.o_h-f.y;k=d.o_pos.top+f.y;if(g<p.minHeight){g=p.minHeight;k=d.o_h+d.o_pos.top-g}else{if(g>p.maxHeight){g=p.maxHeight;k=d.o_h+d.o_pos.top-g}}d.proxy.height(g).top(k)}else{if(c.bottom){g=d.o_h+f.y;if(g<p.minHeight){g=p.minHeight}else{if(g>p.maxHeight){g=p.maxHeight}}d.proxy.height(g)}}if(c.top||c.bottom){var j=g-d.o_h2;if(d.regions&&j!==0){d.regions.heightBy(j);d.o_h2=g}}if(c.move){l=d.o_pos.left+f.x;k=d.o_pos.top+f.y;d.proxy.top(k).left(l)}},_onDragstop:function(d,f,h,b){var a,c,i,g=d.proxy;if(!b.move){c={width:g.width()-d.o_w,height:g.height()-d.o_h}}if(b.left||b.top||b.move){a=g.cssPos();i={left:a.left-d.o_pos.left,top:a.top-d.o_pos.top}}d.boxing().onUpdate(d,d._target,c,i);if(d.properties._attached){if(linb.browser.ie6){d._target.ieRemedy()}d.proxy.html("",false).css({visibility:"hidden",border:"none",zIndex:"0",width:"0",height:"0"})}d.$onDrag=false}}});Class("linb.UI.Button",["linb.UI.Widget","linb.absValue"],{Instance:{activate:function(){this.getSubNode("FOCUS").focus();return this},_setCtrlValue:function(a){if(_.isNull(a)||!_.isDefined(a)){a=false}return this.each(function(e){var d=e.properties;if(d.type!="status"){return}e.getSubNode("BORDER").tagClass("-checked",a);if(d.border){var c=e.getSubNode("BORDER").$getBorder();if(c){c.get(0).getRoot().tagClass("-checked",a)}}})},_setDirtyMark:function(){return arguments.callee.upper.apply(this,["FOCUS"])},resetValue:function(a){this.each(function(b){if(b.properties.type=="drop"){b.boxing().setCaption("",true)}});return arguments.callee.upper.apply(this,arguments)},setUIValue:function(b,a){this.each(function(c){var d=c.properties;if(d.$UIvalue!==b&&d.type=="drop"){c.boxing().setCaption("",true)}});return arguments.callee.upper.apply(this,arguments)}},Initialize:function(){this.addTemplateKeys(["DROP"]);var a=this.getTemplate();_.merge(a.FRAME,{FOCUS:{$order:2,tabindex:"{tabindex}",TB:{cellpadding:"0",cellspacing:"0",width:"100%",height:"100%",border:"0",tagName:"table",TR:{tagName:"tr",TDL:{tagName:"td"},TD:{$order:1,align:"{hAlign}",valign:"{vAlign}",tagName:"td",width:"100%",height:"100%",BOX:{ICON:{$order:1,className:"ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat} {imageDisplay}"},CAPTION:{$order:2,text:"{caption}"}}},TDR:{$order:2,tagName:"td",className:"{dropCls}",TDRI:{}}}}}},"all");this.setTemplate(a)},Static:{Appearances:{KEY:{"font-size":"12px","line-height":"14px"},BORDER:{"font-size":0,"line-height":0,"background-color":"#D2D7DF"},"BORDER-mouseover":{$order:2,"background-color":"#F7D928"},"BORDER-mousedown, BORDER-checked":{$order:2,"background-color":"#F9E56A"},DROP:{$order:10,background:linb.UI.$bg("drop.gif","no-repeat left bottom","Button"),"padding-left":"16px"},"DROP-mouseover":{$order:11,"background-position":"-16px bottom"},"DROP-mousedown":{$order:12,"background-position":"right bottom"},"TDR,TDL":{"padding-left":"6px"},".setting-linb-button":{"border-top-width":"1px","border-bottom-width":"1px","border-left-width":"1px","border-right-width":"1px"},"KEY-b-t":{top:"-1px",height:"10px",background:linb.UI.$bg("vertical.gif","repeat-x left top","Button")},"KEY-b-b":{bottom:"-1px",height:"10px",background:linb.UI.$bg("vertical.gif","repeat-x left bottom","Button")},"BORDER-mouseover KEY-b-t, BORDER-mouseover KEY-b-b":{$order:1,"background-image":linb.UI.$bg("vertical_mouseover.gif","","Button")},"BORDER-checked KEY-b-t, BORDER-checked KEY-b-b, BORDER-mousedown KEY-b-t, BORDER-mousedown KEY-b-b":{$order:2,"background-image":linb.UI.$bg("vertical_mousedown.gif","","Button")},"KEY-b-l":{left:"-1px",width:"4px",background:linb.UI.$bg("horizontal.gif","repeat-y left top","Button")},"KEY-b-r":{right:"-1px",width:"4px",background:linb.UI.$bg("horizontal.gif","repeat-y right top","Button")},"BORDER-mouseover KEY-b-l, BORDER-mouseover KEY-b-r":{$order:1,"background-image":linb.UI.$bg("horizontal_mouseover.gif","","Button")},"BORDER-checked KEY-b-l, BORDER-checked KEY-b-r, BORDER-mousedown KEY-b-l, BORDER-mousedown KEY-b-r":{$order:2,"background-image":linb.UI.$bg("horizontal_mousedown.gif","","Button")},"KEY-b-lt":{top:"-1px",left:"-1px",width:"4px",height:"10px",background:linb.UI.$bg("corner.gif","no-repeat left top","Button")},"KEY-b-rt":{top:"-1px",right:"-1px",width:"4px",height:"10px",background:linb.UI.$bg("corner.gif","no-repeat right top","Button")},"KEY-b-rb":{right:"-1px",bottom:"-1px",width:"4px",height:"10px",background:linb.UI.$bg("corner.gif","no-repeat right bottom","Button")},"KEY-b-lb":{left:"-1px",bottom:"-1px",width:"4px",height:"10px",background:linb.UI.$bg("corner.gif","no-repeat left bottom","Button")},"BORDER-mouseover KEY-b-lt, BORDER-mouseover KEY-b-rt, BORDER-mouseover KEY-b-rb, BORDER-mouseover KEY-b-lb":{$order:1,"background-image":linb.UI.$bg("corner_mouseover.gif","","Button")},"BORDER-checked KEY-b-lt, BORDER-checked KEY-b-rt, BORDER-checked KEY-b-rb, BORDER-checked KEY-b-lb, BORDER-mousedown KEY-b-lt, BORDER-mousedown KEY-b-rt, BORDER-mousedown KEY-b-rb, BORDER-mousedown KEY-b-lb":{$order:2,"background-image":linb.UI.$bg("corner_mousedown.gif","","Button")},FOCUS:{overflow:"hidden",display:"block",left:0,top:0,"z-index":"20",width:"100%",height:"100%",position:"absolute","outline-offset":"-1px","-moz-outline-offset":"-1px !important"},BOX:{display:"inline","white-space":"nowrap"},CAPTION:{cursor:"pointer","vertical-align":linb.browser.ie6?"baseline":"middle",display:"inline","font-size":"12px","line-height":"14px"}},Behaviors:{HoverEffected:{KEY:["BORDER"]},ClickEffected:{KEY:["BORDER"]},NavKeys:{FOCUS:1},onClick:function(c,f,g){var d=c.properties;if(d.disabled){return false}c.getSubNode("FOCUS").focus();var a=c.boxing();if(d.type=="status"){if(d.readonly){return false}a.setUIValue(!d.$UIvalue);if(c.onChecked){a.onChecked(c,f,d.$UIvalue)}}if(c.onClick){a.onClick(c,f,g,d.$UIvalue)}},TDR:{onMousedown:function(a,b,c){if(a.properties.type!="drop"){return}linb.use(c).addClass(a.getClass("DROP","-mousedown"));return false},onMouseup:function(a,b,c){if(a.properties.type!="drop"){return}linb.use(c).removeClass(a.getClass("DROP","-mousedown"));return false},onMouseover:function(a,b,c){if(a.properties.type!="drop"){return}linb.use(c).addClass(a.getClass("DROP","-mouseover"))},onMouseout:function(a,b,c){if(a.properties.type!="drop"){return}linb.use(c).removeClass(a.getClass("DROP","-mouseover")).removeClass(a.getClass("DROP","-mousedown"))},onClick:function(a,b,c){if(a.properties.type!="drop"){return}a.boxing().onClickDrop(a,b,c);return false}}},DataModel:{caption:{ini:undefined,action:function(a){this.getSubNode("CAPTION").get(0).innerHTML=a}},image:{action:function(a){this.getSubNode("ICON").css("display",a?"":"none").css("backgroundImage","url("+(a||"")+")")}},imagePos:{action:function(a){this.getSubNode("ICON").css("backgroundPosition",a)}},hAlign:{ini:"center",listbox:["left","center","right"],action:function(a){this.getSubNode("TD").attr("align",a)}},vAlign:{ini:"middle",listbox:["top","middle","bottom"],action:function(a){this.getSubNode("TD").attr("valign",a)}},value:false,type:{ini:"normal",listbox:["normal","status","drop"],action:function(e){var c=this,a=c.getRoot(),d=c.getSubNode("TDR"),b=c.getClass("DROP");if(e=="drop"){d.addClass(b)}else{d.removeClass(b)}c.box._onresize(c)}},width:120,height:22,_customBorder:"BORDER",border:true},_ensureValue:function(a,b){if(a.properties.type=="status"){return !!b}else{return b}},_prepareData:function(a){var b=arguments.callee.upper.call(this,a);b.dropCls=b.type=="drop"?a.getClass("DROP"):"";return b},RenderTrigger:function(){var a=this,b=a.properties,c=a.boxing();if(b.type=="status"&&b.value){c.setValue(true,true)}},EventHandlers:{onClick:function(a,c,d,b){},onClickDrop:function(a,b,c){},onChecked:function(a,c,b){}}}});Class("linb.UI.Block","linb.UI.Widget",{Initialize:function(){var a=this,b=a.getTemplate();_.merge(b.FRAME.BORDER,{className:"uiw-border {clsBorderType1}",PANEL:{tagName:"div",className:"{clsBorderType2} uibg-bar",style:"{background}",text:"{html}"+linb.UI.$childTag}},"all");a.setTemplate(b);b=a.getAppearance();_.merge(b,{PANEL:{position:"relative",overflow:"hidden"}});a.setAppearance(b)},Static:{Behaviors:{DropableKeys:["PANEL"]},DataModel:{disabled:null,tips:null,html:{action:function(a){this.getSubNode("PANEL").html(a)}},borderType:{ini:"outset",listbox:["none","flat","inset","outset","groove","ridge"],action:function(j){var i=this,c=i.properties,g=i.getSubNode("BORDER"),e=i.getSubNode("PANEL"),d=/^uiborder-/,a="uiborder-flat",f="uiborder-inset",b="uiborder-outset",h=i.getRoot();g.removeClass(d);e.removeClass(d);switch(j){case"flat":g.addClass(a);break;case"inset":g.addClass(f);break;case"outset":g.addClass(b);break;case"groove":g.addClass(f);e.addClass(b);break;case"ridge":g.addClass(b);e.addClass(f);break}i.box._setB(i);linb.UI.$tryResize(i,h.get(0).style.width,h.get(0).style.height,true)}},background:{ini:"",action:function(a){this.getSubNode("PANEL").css("background",a)}},width:100,height:100},_setB:function(b){var c=b.properties,a=c.borderType;c.$hborder=c.$vborder=c.$iborder=0;if(a=="flat"||a=="inset"||a=="outset"){c.$hborder=c.$vborder=1;c.$iborder=0}else{if(a=="groove"||a=="ridge"){c.$hborder=c.$vborder=c.$iborder=1}}},LayoutTrigger:function(){var a=this.properties.borderType;if(a!="none"){this.boxing().setBorderType(a,true)}},_prepareData:function(a){var b=arguments.callee.upper.call(this,a);b.background=b.background?"background:"+b.background:"";return b},_onresize:function(f,e,c){var d=arguments.callee.upper.apply(this,arguments),g=f.properties,a=(g.$iborder||0)*2;if(d.width){d.width-=a}if(d.height&&"auto"!==d.height){d.height-=a}f.getSubNode("PANEL").cssSize(d,true)}}});Class("linb.UI.PopMenu",["linb.UI.Widget","linb.absList"],{Instance:{adjustSize:function(){this.each(function(a){if(a.renderId){var e=a.getRoot(),d=a.getSubNode("ITEMS"),b=a.getSubNode("BORDER"),j=e.cssSize(),g=b.cssSize(),i=a.properties,c=Math.min(i._maxHeight,d.height()+j.height-g.height+1),f=Math.min(i._maxWidth,d.width()+j.width-g.width+1);i.width=f;i.height=c;e.cssSize({width:f,height:c});linb.UI.$doResize(a,f,c,true)}});return this._setScroll()},_setScroll:function(){return this.each(function(f){if(f.renderId){var g=f.getSubNode("ITEMS"),d=g.offsetTop(),e=g.offsetHeight(),a=f.getSubNode("BORDER"),c=a.offsetHeight();f.getSubNode("TOP").css("display",d===0?"none":"block");f.getSubNode("BOTTOM").css("display",(c>e+d)?"none":"block")}})},_scrollToBottom:function(){return this.each(function(f){var i=f.getSubNode("ITEMS"),d=f.getSubNode("BORDER"),j=i.offsetTop(),g,e=i.offsetHeight(),a=false,c=d.height();if(c<e+j){if(!f.$scrollStep){f.$scrollStep=1}if(f.$scrollStep<5){f.$scrollStep=f.$scrollStep*1.01}j-=f.$scrollStep;if(c>e+j){j=c-e;a=true}i.top(j);if(a){f.getSubNode("BOTTOM").css("display","none");f.$scrollTobottom=false;f.$scrollStep=null}else{f.getSubNode("TOP").css("display","block");if(f.$scrollTobottom){_.asyRun(arguments.callee,0,[f],this)}}}})},_scrollToTop:function(){return this.each(function(c){var d=c.getSubNode("ITEMS"),e=d.offsetTop(),a=false;if(e<0){if(!c.$scrollStep){c.$scrollStep=1}if(c.$scrollStep<5){c.$scrollStep=c.$scrollStep*1.01}e+=c.$scrollStep;if(e>=-1){e=0;a=true}d.top(e);if(a){c.getSubNode("TOP").css("display","none");c.$scrollToTop=false;c.$scrollStep=null}else{c.getSubNode("BOTTOM").css("display","block");if(c.$scrollToTop){_.asyRun(arguments.callee,0,[c],this)}}}})},pop:function(g,d,c){var b=this.get(0);if(!b.renderId){var h=b.boxing().render(true);linb.Dom.getEmptyDiv().append(h)}var a=b.getRoot();if(b.$highLight){linb([b.$highLight]).tagClass("-mouseover",false)}b._conainer=c;a.popToTop(g,d,c);var e=function(){var f=arguments.callee.profile;if(f.box){f.boxing().hide();f.$popGrp.length=0}};e.profile=b;if(!b.$popGrp||!b.$popGrp.length){b.$popGrp=[a._get(0)];a.setBlurTrigger(b.$linbid,null);a.setBlurTrigger(b.$linbid,e,b.$popGrp)}return this},hide:function(h){var c,e=this.get(0),b=e.getRoot(),d="$subPopMenuShowed",a="$childPopMenu";if(false!==h){if(false===e.boxing().beforeHide(e)){return this}}if(!b||b.css("display")=="none"){return}b.setBlurTrigger(e.$linbid,null);if(e.$hideMenuPool){e.$hideMenuPool.append(b)}else{b.css("display","none")}var g=e[a],f;if(c=e[d]){c.hide()}while(g){g.boxing().hide();g=(f=g)[a];f[a]=f[d]=null}e[a]=e[d]=null;if(c=e.$parentPopMenu){c[d]=null}_.arr.removeValue(e.$popGrp,b._get(0));if(false!==h){e.boxing().onHide(e)}return this}},Initialize:function(){var a=this.getTemplate();_.merge(a.FRAME.BORDER,{TOP:{},BOTTOM:{},BOX:{tagName:"div",ITEMS:{tagName:"div",text:"{items}"}},POOL:{tagName:"div",style:"display:none;"}},"all");a.$submap={items:function(g,f,d,c,b){var e;c=c+"."+d.type;if(e=d.object){b[b.length]=e.build(d)}else{if(f[c]){linb.UI.$doTemplate(g,f,d,c,b)}}},"items.split":{ITEMSPLIT:{style:"{itemDisplay}"}},"items.button":{ITEM:{tabindex:1,className:"{itemClass} {disabled}",style:"{itemStyle}{itemDisplay}",ICON:{$order:0,className:"ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat}"},CAPTION:{text:"{caption}",$order:1},RULER:{style:"{displayAdd}",$order:2},ADD:{tagName:"div",style:"{displayAdd}",text:"{add}",$order:2},SUB:{style:"{displaySub}"}}},"items.checkbox":{ITEM:{tabindex:1,className:"{itemClass} {disabled}",style:"{itemStyle}{itemDisplay}",CHECKBOX:{$order:0,className:"ui-icon {checkboxCls}"},CAPTION:{text:"{caption}",$order:1},RULER:{style:"{displayAdd}",$order:2},ADD:{tagName:"div",style:"{displayAdd}",text:"{add}",$order:2}}},"items.radiobox":{ITEM:{tabindex:1,className:"{itemClass} {disabled}",style:"{itemStyle}{itemDisplay}",RADIOBOX:{$order:0,className:"ui-icon {radioboxCls}"},CAPTION:{text:"{caption}",$order:1},RULER:{style:"{displayAdd}",$order:2},ADD:{tagName:"div",style:"{displayAdd}",text:"{add}",$order:2}}}};this.setTemplate(a)},Static:{$noDomRoot:true,Appearances:{KEY:{"font-size":"12px",visibility:"hidden"},BORDER:{border:"1px solid","border-color":"#FFF #ACA899 #ACA899 #FFF"},BOX:{"background-color":"#EEF7FF",overflow:"hidden",position:"absolute",left:0,top:0,"font-size":"12px","z-index":"3"},ITEMS:{position:"absolute",top:0,left:0,overflow:"visible",background:linb.UI.$bg("bg.gif","repeat-y left top")},ITEM:{display:"block",position:"relative",overflow:"visible","white-space":"nowrap",color:"#000","font-family":'"Verdana", "Helvetica", "sans-serif"',cursor:"pointer",padding:"2px 20px 2px 2px"},ITEMSPLIT:{display:"block",position:"relative",overflow:"visible","white-space":"nowrap","font-size":"1px","line-height":"1px",padding:"1px",margin:"2px 2px 2px 26px",background:linb.UI.$bg("split_horizontal.gif","repeat-x left top",true)},"ITEM-mouseover":{$order:1,"background-color":"#FFFA9F",border:"solid 1px #94A3A8",padding:"1px 19px 1px 1px"},"ITEM-checked":{$order:2,"background-color":"#FFFA9F",border:"solid 1px #94A3A8",padding:"1px 19px 1px 1px"},ICON:{margin:0},TOP:{cursor:"pointer",display:"none",position:"absolute","margin-left":"-8px",right:0,height:"16px",width:"16px","z-index":"10",top:0,background:linb.UI.$bg("icons.gif","no-repeat -48px -244px",true)},BOTTOM:{cursor:"pointer",display:"none",position:"absolute","margin-left":"-8px",right:0,height:"16px",width:"16px","z-index":"10",bottom:0,background:linb.UI.$bg("icons.gif","no-repeat -66px -244px",true)},"RADIOBOX, CHECKBOX, RADIOBOX-checked, CHECKBOX-checked":{cursor:"pointer","vertical-align":"middle",width:"16px",height:"16px"},CHECKBOX:{background:linb.UI.$bg("icons.gif","no-repeat -20px -70px",true),margin:0},"CHECKBOX-checked":{$order:1,background:linb.UI.$bg("icons.gif","no-repeat -0px -70px",true)},RADIOBOX:{background:linb.UI.$bg("icons.gif","no-repeat -60px -70px",true),margin:0},"RADIOBOX-checked":{$order:1,background:linb.UI.$bg("icons.gif","no-repeat -40px -70px",true)},CAPTION:{"vertical-align":linb.browser.ie6?"baseline":"middle","padding-left":"6px"},RULER:{width:"100px","font-size":0,"line-height":0},ADD:{position:"absolute",top:"3px",right:0,width:"80px","padding-right":"20px","text-align":"right","z-index":"10"},SUB:{position:"absolute",top:"2px",right:"2px",width:"8px",height:"16px",background:linb.UI.$bg("icons.gif","no-repeat -200px -70px",true)}},Behaviors:{ITEM:{onMouseover:function(g,i,b){var d="$subPopMenuShowed",m="$allPops",f="$highLight",l="$showpops",h="$popGrp";if(g[f]==b){return}var j=g.properties,q=g.getItemByDom(b),k=q.id,p=false,n,c,o;if(o=g[d]){if(o==_.get(g,[m,k])){p=true}else{o.hide();g[d]=null}}if(!p){if(o=g[f]){linb([o]).tagClass("-mouseover",false)}g[f]=b;linb.use(b).tagClass("-mouseover");try{linb.use(b).get(0).focus()}catch(i){}}if(!p&&q.sub){if(!(_.isArr(q.sub)&&q.sub.length)){if(g.onShowSubMenu){var a=g["$sub:"+q.id];if(a&&a["linb.UI"]&&!a.isEmpty()){}else{a=g.boxing().onShowSubMenu(g,q,b)}if(a&&a["linb.UI"]&&!a.isEmpty()){g[d]=a;a=a.reBoxing();a.onMouseout(function(s,r,u){g.box._mouseout(g,r,u)},null,-1);g[h].push(a._get(0));a.popToTop(b,2,g._conainer);return}else{if(a&&_.isArr(a)&&a.length){q.sub=a}}}}if(_.isArr(q.sub)&&q.sub.length){g[m]=g[m]||{};if(!(n=g[m][k])){n=(new linb.UI.PopMenu({position:"absolute",items:q.sub,autoHide:g.properties.autoHide})).render(true);n.onShowSubMenu(function(s,e,r){return g.boxing().onShowSubMenu(g,e,r)});n.onMenuSelected(function(s,e,r){return g.boxing().onMenuSelected(g,e,r)});c=n.get(0);c.$hideMenuPool=g.$hideMenuPool||g.getSubNode("POOL");g[m][k]=n;g[l]=g[l]||[g];c[l]=g[l];g[l].push(c)}else{c=n.get(0)}g[h].push(c.getRoot()._get(0));c[h]=g[h];c.$parentPopMenu=g;g.$childPopMenu=c;n.pop(b,2);g[d]=n}}},onMouseout:function(d,h,b){var i=d.properties,l=d.getItemByDom(b),j=l.id,f=true,m;if(m=d.$subPopMenuShowed){var c=h.toElement||h.relatedTarget,g=m.get(0).getRootNode();try{do{if(c==g){return}}while((c&&(c=c.parentNode)))}catch(k){}}linb.use(b).tagClass("-mouseover",false);d.$highLight=null},onClick:function(a,c,f){var g=a.properties,b=a.getItemByDom(f),d=b.id;if(g.disabled||b.disabled){return false}if(!b.sub){if(b.type=="checkbox"){a.getSubNodeByItemId("CHECKBOX",b.id).tagClass("-checked",b.value=!b.value)}else{if(b.type=="radiobox"){a.getSubNode("RADIOBOX",true).tagClass("-checked",false);_.arr.each(g.items,function(e){if(e.type=="radiobox"){e.value=false}});a.getSubNodeByItemId("RADIOBOX",b.id).tagClass("-checked",b.value=true)}}if(a.onMenuSelected){a.boxing().onMenuSelected(a,b,f)}if(g.hideAfterClick){linb.use(f).tagClass("-mouseover",false);_.asyRun(function(){var h=a,e;if(!h.renderId){return}while(h){h.boxing().hide();h=(e=h).$parentPopMenu;e.$parentPopMenu=e.$subPopMenuShowed=null}a.$subPopMenuShowed=null;a.$popGrp.length=0},100)}}return false},onFocus:function(b,f,g){var c=b.getSubNode("BOX"),d=c.scrollTop(),a=c.scrollHeight(),i=linb.use(g).offsetTop();if(i<d||i>d+a){linb.use(g).offsetTop(d)}linb.use(g).onMouseover()},onKeydown:function(d,g,b){var m=d.getItemByDom(b),h=d.properties.items,k=linb.Event.getKey(g)[0],j=m.id,i,a,f,c,l;switch(k){case"enter":linb(b).onClick();break;case"up":a=true;i=false;_.arr.each(h,function(n,e){if(n.type=="split"){return}if(i){f=n.id;return a=false}if(n.id==j){i=true}},null,true);if(a){f=h[h.length-1].id}c=d.getSubNodeByItemId("ITEM",f).get(0);break;case"down":a=true;i=false;_.arr.each(h,function(n,e){if(n.type=="split"){return}if(i){f=n.id;return a=false}if(n.id==j){i=true}});if(a){f=h[0].id}c=d.getSubNodeByItemId("ITEM",f).get(0);break;case"left":if(l=d.$parentPopMenu){if(l=d.$parentPopMenu.$highLight){c=l}}break;case"right":if((l=d.$subPopMenuShowed)&&l==d.$allPops[j]){l.activate()}break}if(c&&c.tagName){try{c.focus()}catch(g){}}}},TOP:{onMouseover:function(a){a.$scrollToTop=true;a.boxing()._scrollToTop()},onMouseout:function(a){a.$scrollToTop=false;a.$scrollStep=null},onClick:function(a){a.$scrollStep*=2}},BOTTOM:{onMouseover:function(a){a.$scrollTobottom=true;a.boxing()._scrollToBottom()},onMouseout:function(a){a.$scrollTobottom=false;a.$scrollStep=null},onClick:function(a){a.$scrollStep*=2}},ITEMS:{beforeKeydown:function(b,c){var a=linb.Event.getKey(c)[0];if(a=="tab"||a=="enter"){return true}else{if(a=="esc"){do{b.boxing().hide()}while(b=b.$parentPopMenu);return false}else{return false}}}},BORDER:{onMouseout:function(a,b,c){a.box._mouseout(a,b,c)}}},DataModel:({dock:null,tabindex:null,tips:null,border:null,resizer:null,shadow:true,_maxHeight:260,_maxWidth:300,left:-10000,hideAfterClick:true,autoHide:false,height:100,width:300,position:"absolute",$hborder:1,$vborder:1}),EventHandlers:{onShowSubMenu:function(a,b,c){},beforeHide:function(a){},onHide:function(a){},onMenuSelected:function(a,b,c){}},RenderTrigger:function(){this.boxing().adjustSize()},_mouseout:function(d,g){if(d.properties.autoHide){var h=linb.Event.getPos(g),c,f,a;_.arr.each(d.$popGrp,function(b){b=linb([b]);f=b.offset();c=b.cssSize();if(h.left>f.left&&h.top>f.top&&h.left<f.left+c.width&&h.top<f.top+c.height){return a=1}});if(!a){while(a=d.$parentPopMenu){d=a}d.boxing().hide();d.$popGrp.length=0}}},_prepareItem:function(b,c){var a="display:none;";c.add=c.add||"";c.displayAdd=c.add?"":a;c.displaySub=c.sub?"":a;c.itemDisplay=c.hidden?a:"";c.type=c.type||"button";if(c.type=="checkbox"){c.checkboxCls=b.getClass("CHECKBOX",c.value?"-checked":"")}else{if(c.type=="radiobox"){c.radioboxCls=b.getClass("RADIOBOX",c.value?"-checked":"")}}},_onresize:function(d,c,a){var b=arguments.callee.upper.apply(this,arguments);d.getSubNode("BOX").cssSize(b)}}});Class("linb.UI.Input",["linb.UI.Widget","linb.absValue"],{Instance:{_setTB:function(c){var b=this.get(0),d=b.properties,e,a;if(!b.host||!d.tipsBinder){return}a=b.tips=b.tips||d.tips||"";e=linb.getObject(d.tipsBinder)||((e=b.host[d.tipsBinder])&&e.get(0));if(e&&(e.key=="linb.UI.Div"||e.key=="linb.UI.SLabel")){if(e.renderId){e.getRootNode().innerHTML=a.charAt(0)=="$"?linb.wrapRes(a):a;e.getRoot().css("color",c==1?"gray":c==2?"red":"#000")}}},activate:function(){var a=this.get(0);if(a.renderId){var b=a.getSubNode("INPUT").get(0);b.focus();if(!b.readOnly&&b.select){try{b.select()}catch(c){}}}return this},_setCtrlValue:function(a){if(_.isNull(a)||!_.isDefined(a)){a=""}return this.each(function(b){b.getSubNode("INPUT").attr("value",a+"")})},_getCtrlValue:function(){return this.getSubNode("INPUT").attr("value")},_setDirtyMark:function(){return this.each(function(b){if(!b.properties.dirtyMark){return}var g=b.properties,a=b.getSubNode("INPUT"),j=b.box,e=b.boxing(),f=linb.UI.$css_tag_dirty,i=linb.UI.$css_tag_invalid,h=g.value!==g.$UIvalue;if(b.inValid==2){b.tips=g.tipsErr||g.tips;if(g.mask){_.asyRun(function(){e.setUIValue(a.get(0).value=b.$Mask)});b.inValid=1;h=false}}else{if(b.inValid==1){b.tips=g.tips}else{b.tips=g.tipsOK||g.tips}}if(b._dirtyFlag!==h){if(b.beforeDirtyMark&&false===e.beforeDirtyMark(b,h)){}else{if(b._dirtyFlag=h){a.addClass(f)}else{a.removeClass(f)}}}if(b.beforeFormatMark&&false===e.beforeFormatMark(b,b.inValid==2)){}else{var c=b.getSubNode("ERROR");if(b.inValid==2){a.addClass(i);c.css("display","block")}else{a.removeClass(i);c.css("display","none")}}e._setTB(b.inValid)})}},Initialize:function(){var a=this.getTemplate();_.merge(a.FRAME.BORDER,{style:"",BOX:{WRAP:{tagName:"div",INPUT:{tagName:"input",type:"{_type}",maxlength:"{maxlength}",tabindex:"{tabindex}",cursor:"{cursor}",style:"{_css}"}}}},"all");a.FRAME.ERROR={};this.setTemplate(a)},Static:{_maskMap:{"~":"[+-]","1":"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},_maskSpace:"_",Appearances:{KEY:{"font-family":'"Verdana", "Helvetica", "sans-serif"',position:"relative"},BORDER:{"line-height":"0px","font-size":"0px"},WRAP:{left:0,position:"absolute",overflow:linb.browser.gek?"auto":"hidden"},BOX:{left:0,top:0,position:"absolute",background:linb.UI.$bg("inputbg.gif","#fff repeat-x","Input"),border:"solid 1px #B5B8C8","z-index":10},"KEY-readonly input":{$order:2,color:"#909090"},"KEY-readonly BOX, KEY-inputreadonly BOX":{$order:2,background:"#eee"},"BOX-focus, BOX-mouseover":{"border-color":"#7EADD9"},INPUT:{"padding-top":"2px","padding-left":"2px","background-color":"transparent","background-image":linb.browser.ie?"url(.)":null,border:0,margin:0,"margin-top":linb.browser.ie?"-1px":null,"font-size":"12px",position:"relative",width:"102px",overflow:"auto","overflow-y":"auto","overflow-x":"hidden"},ERROR:{width:"16px",height:"16px",position:"absolute",right:"2px",top:"2px",display:"none","font-size":0,background:linb.UI.$bg("icons.gif","no-repeat left -244px",true),"z-index":"50"},".setting-linb-input":{"border-style":"solid","border-top-width":"1px","border-bottom-width":"1px","border-left-width":"1px","border-right-width":"1px"},"KEY-b-t":{height:"2px",top:"-1px",background:linb.UI.$bg("vertical.gif","repeat-x left top","Input")},"KEY-b-b":{height:"2px",bottom:"-1px",background:linb.UI.$bg("vertical.gif","repeat-x left bottom","Input")},"BOX-focus KEY-b-t, BOX-focus KEY-b-b, BOX-mouseover KEY-b-t, BOX-mouseover KEY-b-b":{$order:1,"background-image":linb.UI.$bg("vertical_mouseover.gif","","Input")},"KEY-b-l":{width:"2px",left:"-1px",background:linb.UI.$bg("horizontal.gif","repeat-y left top","Input")},"KEY-b-r":{width:"2px",right:"-1px",background:linb.UI.$bg("horizontal.gif","repeat-y right top","Input")},"BOX-focus KEY-b-l, BOX-focus KEY-b-r, BOX-mouseover KEY-b-l, BOX-mouseover KEY-b-r":{$order:1,"background-image":linb.UI.$bg("horizontal_mouseover.gif","","Input")},"KEY-b-lt":{width:"2px",height:"2px",left:"-1px",top:"-1px",background:linb.UI.$bg("corner.gif","no-repeat left top","Input")},"KEY-b-rt":{width:"2px",height:"2px",right:"-1px",top:"-1px",background:linb.UI.$bg("corner.gif","no-repeat right top","Input")},"KEY-b-rb":{width:"2px",height:"2px",right:"-1px",bottom:"-1px",background:linb.UI.$bg("corner.gif","no-repeat right bottom","Input")},"KEY-b-lb":{width:"2px",height:"2px",left:"-1px",bottom:"-1px",background:linb.UI.$bg("corner.gif","no-repeat left bottom","Input")},"BOX-focus KEY-b-lt, BOX-focus KEY-b-rt, BOX-focus KEY-b-rb, BOX-focus KEY-b-lb, BOX-mouseover KEY-b-lt, BOX-mouseover KEY-b-rt, BOX-mouseover KEY-b-rb, BOX-mouseover KEY-b-lb":{$order:1,"background-image":linb.UI.$bg("corner_mouseover.gif","","Input")}},Behaviors:{HoverEffected:{BOX:["BOX"]},NavKeys:{INPUT:1},INPUT:{onChange:function(c,g,i){var f=c.properties,a=c.box,h=c.inValid,d=linb.use(i).get(0).value;c.boxing().setUIValue(d);f.$UIvalue=d;if(h!==c.inValid){if(c.renderId){c.boxing()._setDirtyMark()}}a._asyCheck(c)},onKeydown:function(g,i,j){var h=g.properties,c=g.box,a=h.multiLines,d=linb.Event,f=d.getKey(i);if(h.disabled||h.readonly){return}if(f[0]=="enter"&&(!a||f[3])){linb.use(j).onChange()}if(f[0].length>1){g.$keyD=f[0]}else{delete g.$keyD}c._asyCheck(g);if(h.mask){if(f[0].length>1){g.$ignore=true}else{delete g.$ignore}switch(f[0]){case"backspace":c._changeMask(g,linb.use(j).get(0),"",false);return false;case"delete":c._changeMask(g,linb.use(j).get(0),"");return false}}},onKeypress:function(f,h,a){var d=f.properties,j=f.box,m=f.box,c=m._maskMap,g=linb.Event.getKey(h),l,i=linb.use(a).caret();if(f.$keyD){g[0]=f.$keyD}delete f.$keyD;if(f.beforeKeypress&&false===f.boxing().beforeKeypress(f,i,g[0],g[1],g[2],g[3],h,a)){return false}l=f.CF.beforeKeypress||f.$beforeKeypress;if(l&&false===l(f,i,g[0],g[1],g[2],g[3],h,a)){return false}j._asyCheck(f);if(d.mask){if(f.$ignore){delete f.$ignore;return true}if(g[1]||g[3]){return true}m._changeMask(f,linb.use(a).get(0),g[0],true);return false}},onKeyup:function(c,g,h){var f=c.properties,a=c.box;if(c.$keyD){delete c.$keyD}if(f.dynCheck){var d=linb.use(h).get(0).value;c.box._checkValid(c,d);c.boxing()._setDirtyMark()}a._asyCheck(c)},onFocus:function(c,g,h){var f=c.properties,a=c.box;if(f.disabled){return false}if(c.onFocus){c.boxing().onFocus(c)}c.getSubNode("BORDER").tagClass("-focus");if(f.mask){var d=linb.use(h).get(0).value;if(!d){_.asyRun(function(){c.boxing().setUIValue(d=c.$Mask);a._setCaret(c,linb.use(h).get(0))})}}c.boxing()._setTB(3);a._asyCheck(c)},onBlur:function(c,g,h){var f=c.properties,a=c.box;if(f.disabled){return false}if(c.onBlur){c.boxing().onBlur(c)}c.getSubNode("BORDER").tagClass("-focus",false);var d=linb.use(h).get(0).value;if(f.$UIvalue==d){c.box._checkValid(c,d)}c.boxing()._setDirtyMark();a._asyCheck(c)}}},DataModel:{_customBorder:"BOX",border:false,tipsErr:"",tipsOK:"",dynCheck:false,valueFormat:{helpinput:[{caption:"required",id:"[^.*]"},{caption:"email",id:"^[\\w\\.=-]+@[\\w\\.-]+\\.[\\w\\.-]{2,4}$"},{caption:"charOnly",id:"^[a-zA-Z]*$"},{caption:"words",id:"^[\\w ]*$"},{caption:"integer",id:"^-?\\d\\d*$"},{caption:"positiveInteger",id:"^\\d\\d*$"},{caption:"number",id:"^-?(\\d\\d*\\.\\d*$)|(^-?\\d\\d*$)|(^-?\\.\\d\\d*$)"},{caption:"filepath",id:"([\\/]?[\\w_]+)+\\.\\w{1,9}$"},{caption:"URL",id:"^(http|https|ftp)\\:\\/\\/[\\w\\-\\_\\.]+[\\w\\-\\_](:[\\w]*)?\\/?([\\w\\-\\._\\?\\,\\'\\/\\\\\\+&amp;%\\$#\\=~])*$"},{caption:"color",id:"^\\#[0-9A-Fa-f]{6}$"},{caption:"HH:MM",id:"^(([0-1][0-9])|([2][0-3])):([0-5][0-9])$"},{caption:"HH:MM:SS",id:"^(([0-1][0-9])|([2][0-3])):([0-5][0-9])\\:([0-5][0-9])$"},{caption:"YYYY-MM-DD",id:"^([0-9]{4})\\-(([0][0-9])|([1][0-2]))\\-([0-3][0-9])$"},{caption:"DD/MM/YYYY",id:"^(([0-2][0-9])|([3][0-1]))/(([0][0-9])|([1][0-2]))/([0-9]{4})$"}]},mask:{action:function(d){var c=this,a=c.box;if(d){c.$MaskFormat=function(g,f){var b=g._maskMap,e=[],h=/[A-Za-z0-9]/;_.arr.each(f.split(""),function(k,j){e.push(b[k]||(h.test(k)?"":"\\")+k)});return"^"+e.join("")+"$"}(a,d);c.$Mask=function(h,f){var b=h._maskMap,e=[],g=h._maskSpace;_.arr.each(f.split(""),function(k,j){e.push(b[k]?g:k)});return e.join("")}(a,d);c.boxing()._setCtrlValue(c.$Mask)}else{delete c.$MaskFormat;delete c.$Mask}}},value:"",width:120,height:22,disabled:{ini:false,action:function(a){var b=this.getSubNode("INPUT");if(a){b.addClass("ui-inputdisabled")}else{b.removeClass("ui-inputdisabled")}if((""+b.get(0).type).toLowerCase()!="button"){b.attr("disabled",a)}}},readonly:{ini:false,action:function(b){var c=this.getSubNode("INPUT"),a=this.getClass("KEY","-readonly");c.attr("readonly",b).css("cursor",b?"pointer":"");if(b){this.getRoot().addClass(a)}else{this.getRoot().removeClass(a)}}},type:{ini:"text",listbox:["text","password"],action:function(a){this.getSubNode("INPUT").attr("type",a)}},maxlength:{ini:"",action:function(a){this.getSubNode("INPUT").attr("maxlength",a)}},multiLines:{ini:false,action:function(a){this.boxing().refresh()}},tipsBinder:{ini:"",set:function(a){if(a["linb.UIProfile"]){a=a.$linbid}if(a["linb.UI"]&&(a=a.get(0))){a=a.$linbid}this.properties.tipsBinder=a+""}}},EventHandlers:{onFocus:function(a){},onBlur:function(a){},beforeFormatCheck:function(a,b){},beforeFormatMark:function(a,b){},beforeKeypress:function(c,i,b,d,a,g,f,h){}},_prepareData:function(a){var b=arguments.callee.upper.call(this,a);b.cursor=b.readonly?"pointer":"";b._type=b.type||"";if(linb.browser.kde){b._css="resize:none;"}return b},_dynamicTemplate:function(d){var b=d.properties,a,e=d._exhash="$multiLines:"+b.multiLines,c=d.box.getTemplate(e);b.$UIvalue=b.value;if(!c){c=_.clone(d.box.getTemplate());if(b.multiLines){a=c.FRAME.BORDER.BOX.WRAP.INPUT;a.tagName="textarea";delete a.type}d.box.setTemplate(c,e)}d.template=c},_ensureValue:function(a,b){return""+(_.isSet(b)?b:"")},RenderTrigger:function(){var c=this,e=c.properties;_.asyRun(function(){c.boxing()._setTB(1)});c.getSubNode("WRAP").$firfox2();if(e.readonly){c.boxing().setReadonly(true,true)}if(e.tipsBinder){c.boxing().setTipsBinder(e.tipsBinder,true)}var h=linb.browser.ie,g=c.getSubNode("INPUT").get(0),a=c.box,d=function(b){if(h&&("propertyName" in b)&&b.propertyName!="value"){return}a._asyCheck(c)};if(h){g.attachEvent("onpropertychange",d);g.attachEvent("ondrop",d);c.$ondestory=function(){var b=this,f=b.getSubNode("INPUT").get(0);f.detachEvent("onpropertychange",d);f.detachEvent("ondrop",d);f=null}}else{g.addEventListener("input",d,false);g.addEventListener("drop",d,false);if(linb.browser.gek){g.addEventListener("dragdrop",d,false)}c.$ondestory=function(){var b=this,f=b.getSubNode("INPUT").get(0);f.removeEventListener("input",d,false);f.removeEventListener("drop",d,false);if(linb.browser.gek){f.removeEventListener("dragdrop",d,false)}f=null}}g=null},LayoutTrigger:function(){var a=this.properties;if(a.mask){this.boxing().setMask(a.mask,true)}},_changeMask:function(d,f,g,m){var w=this,l=d.properties,u=w._maskMap,n=w._maskSpace,b=l.mask,c=d.$Mask,h=linb(f),j=h.caret();if(m===false&&j[0]==j[1]&&j[0]>0){h.caret(j[0]-1,j[0])}if(m===undefined&&j[0]==j[1]){h.caret(j[0],j[0]+1)}if(m===true){if(c.charAt(j[0])!=n){var q=j[0]+c.substr(j[0],c.length).indexOf(n);h.caret(q,Math.max(j[1],q))}}var j=h.caret(),o=f.value,e=w._maskMap[l.mask.charAt(j[0])],r,k;if(e&&new RegExp("^"+e+"$").test(g)||g==""){k=o;if(j[0]!=j[1]){k=k.substr(0,j[0])+c.substr(j[0],j[1]-j[0])+k.substr(j[1],k.length-j[1])}if(g){k=k.substr(0,j[0])+g+k.substr(j[0]+1,k.length-j[0]-1)}var s=[];_.arr.each(b.split(""),function(p,a){s.push((new RegExp("^"+(u[p]?u[p]:"\\"+p)+"$").test(k.charAt(a)))?k.charAt(a):c.charAt(a))});if(m===true){g=c.substr(j[0]+1,o.length-j[0]-1);r=g.indexOf(n);r=j[0]+(r==-1?0:r)+1}else{r=j[0]}if(linb.browser.opr){if(m===undefined){_.arr.insertAny(s,n,r)}if(m===false){_.arr.insertAny(s,n,r++)}}d.boxing().setUIValue(f.value=s.join(""));w._setCaret(d,f,r)}},_setCaret:function(a,b,c){if(a.properties.mask){if(typeof c!="number"){c=b.value.indexOf(this._maskSpace)}linb(b).caret(c,c)}},_checkValid:function(c,d){var e=c.properties,b=(e.mask&&c.$MaskFormat),a=e.valueFormat||c.$valueFormat;if((c.beforeFormatCheck&&(c.boxing().beforeFormatCheck(c,d)===false))||(b&&typeof b=="string"&&!(new RegExp(b)).test((d===0?"0":d)||""))||(a&&typeof a=="string"&&!(new RegExp(a)).test((d===0?"0":d)||""))){c.inValid=2;return false}c.inValid=3;return true},_asyCheck:function(a){_.resetRun(a.$linbid+":asycheck",function(){if(!a.renderId){return}var b=a.getSubNode("INPUT"),c=b.get(0);if(!c){return}if(a.properties.dynCheck){a.boxing().setUIValue(c.value)}if(a.properties.mask){if(c.value.length!=a.$Mask.length){a.box._changeMask(a,c,"",true)}}})},_onresize:function(f,b,m){var e=1,l=1,p=linb.UI.$getCSSValue("linb-input-input","paddingTop"),a=linb.UI.$getCSSValue("linb-input-input","paddingTop");var n=f.properties,c=f.getSubNode("BOX"),k=f.getSubNode("INPUT"),j,h=b,g=m,d=Math.max(0,(n.$b_lw||0)-e),i=Math.max(0,(n.$b_tw||0)-l);if(null!==h){h-=Math.max(e*2,(n.$b_lw||0)+(n.$b_rw||0));if(linb.browser.ie6){h=(parseInt(h/2))*2}}if(null!==g){g-=Math.max(l*2,(n.$b_lw||0)+(n.$b_rw||0));if(linb.browser.ie6){g=(parseInt(g/2))*2}if(linb.browser.ie6&&null===b){c.ieRemedy()}}j={left:d,top:i,width:h,height:g};c.cssRegion(j);if(h||g){k.cssSize({width:h?(h-a):null,height:g?(g-p):null})}if((f.$border||f.$shadow||f.$resizer)&&linb.browser.ie){c.ieRemedy()}}}});Class("linb.UI.ComboInput","linb.UI.Input",{Instance:{getValue:function(){var c=this.get(0),b=c.properties,a=arguments.callee.upper.apply(this,arguments);if(c.$isNumber){a=_.isNumb(parseFloat(a))?parseFloat(a):null}else{if(b.type=="datepicker"){a=a?new Date(parseInt(a)):null}}return a},getUIValue:function(){var c=this.get(0),b=c.properties,a=arguments.callee.upper.apply(this,arguments);if(c.$isNumber){a=_.isNumb(parseFloat(a))?parseFloat(a):null}else{if(b.type=="datepicker"){a=a?new Date(parseInt(a)):null}}return a},_getCtrlValue:function(){return this.get(0).properties.$UIvalue},_setCtrlValue:function(e,b){var d=arguments.callee,c=d._r1||(d._r1=/\</),a=d._r2||(d._r2=/\<\/?[^>]+\>/g);return this.each(function(g){if(!g.$typeOK){g.box._iniType(g)}var h=g.getSubNode("INPUT"),f=g.properties.type;e=b?e:g.boxing().getShowValue(e);if(f!=="none"&&!g.properties.multiLines&&typeof e=="string"&&c.test(e)){e=e.replace(a,"")}h.attr("value",e||"");if(f=="colorpicker"){h.css({backgroundColor:e,color:linb.UI.ColorPicker.getTextColor(e)})}})},_compareValue:function(d,c){var b=this.get(0),a;if(a=b.CF.compareValue||b.$compareValue){return a(b,d,c)}return d===c},getShowValue:function(e){var c=this.get(0),f=c.properties,a,b;if(!_.isDefined(e)){e=f.$UIvalue}if(b=c.CF.getShowValue||c.$getShowValue){a=b(c,e)}else{if("listbox"==f.type){var d=(f.listKey)?linb.UI.getCachedData(f.listKey):f.items;if(d&&(b=_.arr.subIndexOf(d,"id",e))!=-1){a=d[b].caption;if(a.length>0){a=a.charAt(0)=="$"?linb.getRes(a.slice(1)):a}}else{a=null}}else{a=c.$showValue}}if(!_.isSet(a)&&(c.$inputReadonly||f.inputReadonly)){a=_.isSet(f.caption)?f.caption:null}return""+(_.isSet(a)?a:_.isSet(e)?e:"")},_toEditor:function(c){var b=this.get(0),d=b.properties,a;if(a=b.CF.toEditor||b.$toEditor){return a(b,c)}return c},_fromEditor:function(c){var b=this.get(0),d=b.properties,a;if(a=b.CF.fromEditor||b.$fromEditor){return a(b,c)}return c},_cache:function(){var c=this.get(0),a=c.$drop,b=c.properties.cachePopWnd;if(a){if(!b){a.boxing().destroy();delete c.$drop}else{if(linb.browser.opr){a.getRoot().css("display","none")}_.asyRun(function(){c.getSubNode("POOL").append(a.getRoot())})}}delete c.$poplink;return b},clearPopCache:function(){var a=this.get(0);if(a.renderId){a.getSubNode("POOL").empty()}delete a.$drop;return this},getUploadObj:function(){var a=this.get(0);if(a.renderId&&a.properties.type=="upload"){var b=a.getSubNode("FILE").get(0);if(!b.value){return null}var d=b.cloneNode(false);d.value="";linb.setNodeData(d.$linbid=b.$linbid,"element",d);d.onclick=b.onclick;d.onchange=b.onchange;if(linb.browser.ie){b.removeAttribute("$linbid")}else{delete b.$linbid}b.id=b.onclick=b.onchange=null;delete a.$_domid[a.keys.FILE];linb([b]).addPrev(d).remove(false);d=null;this.setUIValue(this.getValue());return b}},resetValue:function(a){this.each(function(b){if(b.properties.type=="upload"){b.getSubNode("FILE").attr("value","")}});return arguments.callee.upper.apply(this,arguments)},_drop:function(a,b){return this.each(function(e){var l=e.properties,i=l.type,k=l.cachePopWnd;if(l.disabled||l.readonly){return}if(i=="upload"||i=="none"||i=="spin"||i=="currency"||i=="number"){return}if(e.$poplink){return}var c,m,g=e.boxing(),f=e.getRoot(),j=f.offset(),p=f.cssSize();p.width+=2;j.top+=f.offsetHeight();if((e.beforeComboPop&&false===g.beforeComboPop(e,j,a,b))||i=="getter"||i=="cmdbox"||i=="popbox"){return}var h;if(k){switch(i){case"timepicker":case"datepicker":case"colorpicker":h=i;break;default:if(l.listKey){if(typeof _.get(linb.$cache,["UIDATA",l.listKey])=="function"){e.$drop=h=null}else{h="!"+l.listKey}}else{h="$"+e.$linbid}}if(h){_.filter(e.box.$drop,function(q){return !!q.renderId});e.$drop=e.box.$drop[h]}}if(!e.$drop){switch(i){case"combobox":case"listbox":case"helpinput":c=linb.create("List").render();c.setHost(e).setDirtyMark(false).setItems(_.copy(l.items)).setListKey(l.listKey||"");if(l.dropListHeight){c.setHeight(l.dropListHeight)}else{c.adjustSize()}c.beforeUIValueSet(function(u,s,r){var o=this.boxing();if(i=="combobox"){var q=u.queryItems(u.properties.items,function(v){return v.id==r},false,true);if(q.length){r=q[0].caption}}o.setUIValue(r).activate();return o._cache()});break;case"timepicker":c=linb.create("TimePicker").render();c.setHost(e);c.beforeClose(function(){this.boxing().activate()._cache();return false});c.beforeUIValueSet(function(s,u,r){var q=this.boxing();q.setUIValue(r).activate();return q._cache()});break;case"datepicker":c=linb.create("DatePicker").render();c.setHost(e);c.beforeClose(function(){this.boxing().activate()._cache();return false});c.beforeUIValueSet(function(s,u,r){var q=this.boxing();q.setUIValue(String(r.getTime())).activate();return q._cache()});break;case"colorpicker":c=linb.create("ColorPicker").render();c.setHost(e);c.beforeClose(function(){this.boxing().activate()._cache();return false});c.beforeUIValueSet(function(s,u,r){var q=this.boxing();q.setUIValue("#"+r).activate();return q._cache()});break}e.$drop=c.get(0);if(h){e.box.$drop[h]=e.$drop}}c=e.$drop.boxing();c.setHost(e);switch(i){case"combobox":case"listbox":case"helpinput":c.setWidth(e.properties.dropListWidth||e.getRoot().width());case"timepicker":c.setValue(e.properties.$UIvalue,true);break;case"datepicker":var n=e.$drop.properties;n.WEEK_FIRST=l.WEEK_FIRST;if(n=e.properties.$UIvalue){c.setValue(new Date(parseInt(n)),true)}break;case"colorpicker":c.setValue(e.properties.$UIvalue.replace("#",""),true);break}e.$poplink=c.get(0);var d=c.reBoxing();d.popToTop(e.getRoot());_.tryF(c.activate,[],c);d.setBlurTrigger(e.key+":"+e.$linbid,function(){g._cache()},null,e.$linbid);linb.Event.keyboardHook("esc",0,0,0,function(){g.activate();linb.Event.keyboardHook("esc");g._cache()})})},expand:function(){var a=this.get(0);if(a.renderId){a.boxing()._drop()}},collapse:function(){var a=this.get(0);if(a.renderId&&a.$poplink){a.boxing()._cache()}}},Initialize:function(){this.addTemplateKeys(["FILE","BTN","TOP","MID","RBTN","R1","R1T","R1B","R2","R2T","R2B"]);var a=this.getTemplate();_.merge(a.FRAME.BORDER,{SBTN:{$order:10,style:"{_saveDisplay}",STOP:{},SMID:{className:"{_commandCls}"}}},"all");a.FRAME.POOL={};a.className+=" {typecls}";this.setTemplate(a);this._adjustItems=linb.absList._adjustItems},Static:{_beforeResetValue:function(a){a.properties.caption=undefined},_iniType:function(d){var f=d.properties,e=f.type,g=d.box;delete d.$beforeKeypress;delete d.$inputReadonly;delete d.$isNumber;delete d.$compareValue;delete d.$getShowValue;delete d.$toEditor;delete d.$fromEditor;delete d.$typeOK;if(e=="listbox"||e=="upload"||e=="cmdbox"){d.$inputReadonly=true}if(e!="listbox"&&e!="combobox"&&e!="helpinput"){f.items=[]}if(e=="timepicker"){var b={a:1,c:1,v:1,x:1};_.merge(d,{$beforeKeypress:function(i,l,h,j){return h.length!=1||/[0-9:]/.test(h)||(!!j&&!!b[h])},$getShowValue:function(c,h){return h?linb.UI.TimePicker._ensureValue(c,h):""},$fromEditor:function(h,c){if(c){c=linb.UI.TimePicker._ensureValue(h,c);if(c=="00:00"){c=h.properties.$UIvalue}}return c}},"all")}else{if(e=="datepicker"){var a=linb.Date;var b={a:1,c:1,v:1,x:1};_.merge(d,{$beforeKeypress:function(i,l,h,j){return h.length!=1||/[0-9/\-_ ]/.test(h)||(!!j&&!!b[h])},$compareValue:function(i,h,c){return(!h&&!c)||(String(h)==String(c))},$getShowValue:function(c,h){return h?a.getText(new Date(parseInt(h)),"ymd"):""},$toEditor:function(i,j){var h=new Date(parseInt(j)),c=(a.get(h,"m")+1)+"",k=a.get(h,"d")+"";return j?(a.get(h,"y")+"-"+(c.length==1?"0":"")+c+"-"+(k.length==1?"0":"")+k):""},$fromEditor:function(h,c){if(c){c=linb.Date.parse(c);if(!c){c=h.properties.$UIvalue}c=linb.Date.getTimSpanStart(c,"d",1);if(c.getFullYear()<h.properties.min){c.setTime(h.properties.min)}if(c.getFullYear()>h.properties.max){c.setTime(h.properties.max)}}return c?String(c.getTime()):""}},"all")}else{if(e=="currency"){d.$isNumber=1;var b={a:1,c:1,v:1,x:1};_.merge(d,{$beforeKeypress:function(i,l,h,j){return h.length!=1||/[0-9,.]/.test(h)||(!!j&&!!b[h])},$compareValue:function(i,h,c){return((h===""&&c!=="")||(c===""&&h!==""))?false:i.box._currency(d,h)==i.box._currency(d,c)},$getShowValue:function(h,c){return(_.isSet(c)&&c!=="")?h.box._currency(d,c):""},$fromEditor:function(h,c){return(_.isSet(c)&&c!=="")?h.box._currency(d,c).replace(/,/g,""):""}},"all")}else{if(e=="number"||e=="spin"){d.$isNumber=1;var b={a:1,c:1,v:1,x:1};_.merge(d,{$beforeKeypress:function(i,l,h,j){return h.length!=1||/[-0-9.]/.test(h)||(!!j&&!!b[h])},$compareValue:function(i,h,c){return((h===""&&c!=="")||(c===""&&h!==""))?false:i.box._number(d,h)==i.box._number(d,c)},$getShowValue:function(h,c){return(_.isSet(c)&&c!=="")?h.box._number(d,c):""},$fromEditor:function(h,c){return(_.isSet(c)&&c!=="")?h.box._number(d,c):""}},"all")}}}}if(f.value){f.$UIvalue=f.value=g._ensureValue(d,f.value)}d.$typeOK=true},$drop:{},Appearances:{POOL:{position:"absolute",left:0,top:0,width:0,height:0,display:"none",visibility:"hidden"},FILE:{opacity:0,"*filter":"alpha(opacity=0)","z-index":"3",border:0,height:"100%",position:"absolute",top:0,right:0,cursor:"pointer","font-size":"12px",overflow:"hidden"},"KEY-number INPUT, KEY-spin INPUT, KEY-currency INPUT":{$order:4,"text-align":"right"},"KEY-upload INPUT, KEY-cmdbox INPUT, KEY-listbox INPUT":{$order:4,cursor:"pointer","text-align":"left",overflow:"hidden"},"KEY-upload BORDER, KEY-cmdbox BORDER, KEY-listbox BORDER":{$order:1,background:linb.UI.$bg("inputbgb.gif","#fff left bottom repeat-x","Input")},"KEY-upload BOX, KEY-cmdbox BOX, KEY-listbox BOX":{$order:4,background:"none"},"RBTN,SBTN,BTN":{display:"block","z-index":"1",cursor:"pointer",width:"16px",height:"20px","font-size":0,"line-height":0,position:"relative","float":"right"},"SBTN,BTN,R1,R2":{"margin-top":"2px"},"R1, R2, BTN, SBTN, STOP, TOP, R1T, R2T, R1B, R2B, SMID,MID":{background:linb.UI.$bg("bg.gif")},"SBTN, BTN":{$order:1,"background-position":"left bottom"},"R1,R2":{$order:1,display:"block","font-size":0,"line-height":0,cursor:"pointer",width:"16px",position:"absolute",height:"50%","background-position":"left bottom","margin-top":"2px"},R1:{top:0},R2:{bottom:"-2px"},"BTN-mouseover, SBTN-mouseover, R1-mouseover, R2-mouseover":{$order:2,"background-position":"-16px bottom"},"BTN-mousedown, SBTN-mousedown, R1-mousedown, R2-mousedown":{$order:3,"background-position":"-32px bottom"},"STOP, TOP, R1T, R2T":{$order:1,cursor:"pointer",width:"16px","font-size":0,"line-height":0,position:"absolute",top:"-2px",left:0,height:"4px","background-position":"left -104px"},"BTN-mouseover TOP,SBTN-mouseover STOP, R1-mouseover R1T, R2-mouseover R2T":{$order:2,"background-position":"-16px -104px"},"BTN-mousedown TOP,SBTN-mousedown STOP, R1-mousedown R1T, R2-mousedown R2T":{$order:3,"background-position":"-32px -104px"},"R1B,R2B":{cursor:"pointer",width:"16px","font-size":0,"line-height":0,position:"absolute",left:0,top:"50%","margin-top":"-4px",height:"6px","z-index":2},R1B:{$order:1,"background-position":"-14px -36px"},R2B:{$order:1,"background-position":"left -5px"},"SMID,MID":{$order:2,cursor:"pointer",width:"16px","font-size":0,"line-height":0,position:"absolute",bottom:"0",left:0,height:"16px"},SMID:{$order:3,"background-position":"-16px -16px"},"SMID-save":{$order:8,"background-position":"-32px 0"},"SMID-delete":{$order:8,"background-position":"-32px -16px"},"SMID-add":{$order:8,"background-position":"-32px -32px"},"SMID-remove":{$order:8,"background-position":"-32px -48px"},".setting-linb-comboinput":{"border-style":"solid","border-top-width":"1px","border-bottom-width":"1px","border-left-width":"1px","border-right-width":"1px"}},Behaviors:{HoverEffected:{BOX:"BOX",BTN:"BTN",SBTN:"SBTN",R1:"R1",R2:"R2"},ClickEffected:{BTN:"BTN",SBTN:"SBTN",R1:"R1",R2:"R2"},FILE:{onClick:function(a,b,c){var d=a.properties;if(d.disabled||d.readonly){return}if(a.onFileDlgOpen){a.boxing().onFileDlgOpen(a,c)}},onChange:function(a,b,c){a.boxing().setUIValue(linb.use(c).get(0).value+"")}},BTN:{onClick:function(a,b,c){var d=a.properties;if(d.type=="popbox"||d.type=="getter"){if(a.onClick){a.boxing().onClick(a,b,c,d.$UIvalue)}}if(d.disabled||d.readonly){return}a.boxing()._drop(b,c)}},SBTN:{onClick:function(a,b,c){var d=a.properties;if(d.disabled||d.readonly){return}if(a.onCommand){a.boxing().onCommand(a,c)}}},INPUT:{onChange:function(f,h,j){if(f.$_onedit||f.$_inner){return}var i=f.inValid,c=f.box,a=f.boxing(),d=a._fromEditor(linb.use(j).get(0).value),g=f.properties.$UIvalue;if(!a._compareValue(g,d)){f.$_inner=1;delete f.$_inner;if(d===null){a._setCtrlValue(g)}else{a.setUIValue(d);f.properties.$UIvalue=d;if(i!==f.inValid){if(f.renderId){a._setDirtyMark()}}}}c._asyCheck(f)},onKeyup:function(d,h,i){var g=d.properties,a=d.box;if(d.$keyD){delete d.$keyD}if(g.dynCheck){var f=linb.use(i).get(0).value;d.box._checkValid(d,f);d.boxing()._setDirtyMark()}a._asyCheck(d);var c=linb.Event.getKey(h);if(c[0]=="down"||c[0]=="up"){if(g.type=="spin"){linb.Thread.abort(d.$linbid+":spin");return false}}},onFocus:function(d,f,a){var c=d.properties,g=d.box;if(c.disabled||c.readonly){return false}if(d.onFocus){d.boxing().onFocus(d)}if(d.$inputReadonly||c.inputReadonly){return}d.getSubNode("BORDER").tagClass("-focus");var k=d.boxing(),h=c.$UIvalue,j=k._toEditor(h);if(j!==h){d.$_onedit=true;linb.use(a).get(0).value=j;delete d.$_onedit}if(c.mask){var i=linb.use(a).get(0).value;if(!i){_.asyRun(function(){d.boxing().setUIValue(i=d.$Mask);g._setCaret(d,linb.use(a).get(0))})}}d.boxing()._setTB(3)},onBlur:function(f,i,j){var h=f.properties;if(h.disabled||h.readonly){return false}if(f.onBlur){f.boxing().onBlur(f)}if(f.$inputReadonly||h.inputReadonly){return}var c=f.box,a=f.boxing(),g=h.$UIvalue,d=a._fromEditor(linb.use(j).get(0).value);f.getSubNode("BORDER").tagClass("-focus",false);if(a._compareValue(h.$UIvalue,d)){f.box._checkValid(f,d);a._setCtrlValue(g)}a._setDirtyMark();c._asyCheck(f)},onKeydown:function(g,i,j){var h=g.properties,c=g.box,a=h.multiLines,d=linb.Event,f=d.getKey(i);if(h.disabled||h.readonly){return}if(f[0]=="enter"&&(!a||f[3])&&!h.inputReadonly&&!g.$inputReadonly){linb.use(j).onChange()}if(f[0].length>1){g.$keyD=f[0]}else{delete g.$keyD}c._asyCheck(g);if(h.mask){if(f[0].length>1){g.$ignore=true}else{delete g.$ignore}switch(f[0]){case"backspace":c._changeMask(g,linb.use(j).get(0),"",false);return false;case"delete":c._changeMask(g,linb.use(j).get(0),"");return false}}if(f[0]=="down"||f[0]=="up"){if(h.type=="spin"){g.box._spin(g,f[0]=="up");return false}if(f[1]&&h.type){g.boxing()._drop(i,j);return false}}},onClick:function(a,b,c){var d=a.properties;if(d.type=="cmdbox"){if(a.onClick){a.boxing().onClick(a,b,c,d.$UIvalue)}}else{if(d.inputReadonly||a.$inputReadonly){if(d.disabled||d.readonly){return}a.boxing()._drop(b,c)}}}},R1:{onMousedown:function(a){var b=a.properties;if(b.disabled||b.readonly){return}a.box._spin(a,true)},onMouseout:function(a){linb.Thread.abort(a.$linbid+":spin")},onMouseup:function(a){linb.Thread.abort(a.$linbid+":spin")}},R2:{onMousedown:function(a){var b=a.properties;if(b.disabled||b.readonly){return}a.box._spin(a,false)},onMouseout:function(a){linb.Thread.abort(a.$linbid+":spin")},onMouseup:function(a){linb.Thread.abort(a.$linbid+":spin")}}},EventHandlers:{onFileDlgOpen:function(a,b){},onCommand:function(a,b){},beforeComboPop:function(a,d,b,c){},onClick:function(a,c,d,b){}},_posMap:{none:"",currency:"",number:"",combobox:"left top",listbox:"left top",upload:"-16px top",getter:"left -31px",helpinput:"-16px -46px",cmdbox:"left -16px",popbox:"left -46px",timepicker:"left -60px",datepicker:"left -75px",colorpicker:"-16px -60px"},DataModel:{cachePopWnd:true,listKey:{set:function(b){var a=linb.UI.getCachedData(b),c=this;c.boxing().setItems(a?a:c.properties.items);c.properties.listKey=b}},dropListWidth:0,dropListHeight:0,items:{ini:[],set:function(a){var b=this;a=b.properties.items=b.box._adjustItems(a);if(b.renderId){b.SubSerialIdMapItem={};b.ItemIdMapSubSerialId={};b.box._prepareItems(b,a);if(b.$poplink){b.$poplink.boxing().setItems(a).adjustSize()}else{b.boxing().clearPopCache()}}}},image:{action:function(a){this.getSubNode("MID").css("backgroundImage","url("+(a||"")+")")}},imagePos:{action:function(a){this.getSubNode("MID").css("backgroundPosition",a)}},type:{ini:"combobox",listbox:_.toArr("none,combobox,listbox,upload,getter,helpinput,cmdbox,popbox,timepicker,datepicker,colorpicker,spin,currency,number"),set:function(a){var b=this;b.properties.type=a;if(b.renderId){b.boxing().refresh()}}},precision:2,increment:0.01,min:-Math.pow(10,15),max:Math.pow(10,15),commandBtn:{ini:"none",listbox:_.toArr("none,save,delete,add,remove,custom"),action:function(a){this.boxing().refresh()}},inputReadonly:{ini:false,action:function(b){var c=this.getSubNode("INPUT"),a=this.getClass("KEY","-inputreadonly");if(b){this.getRoot().addClass(a)}else{this.getRoot().removeClass(a)}if(!b&&(this.properties.readonly||this.$inputReadonly)){b=true}c.attr("readonly",b).css("cursor",b?"pointer":"")}},readonly:{ini:false,action:function(b){var c=this.getSubNode("INPUT"),a=this.getClass("KEY","-readonly");if(b){this.getRoot().addClass(a)}else{this.getRoot().removeClass(a)}if(!b&&(this.properties.inputReadonly||this.$inputReadonly)){b=true}c.attr("readonly",b).css("cursor",b?"pointer":"")}},caption:{ini:null,set:function(a,b){var c=this.properties;c.caption=a;if(_.isSet(c.caption)&&this.renderId){if(this.$inputReadonly||c.inputReadonly){this.getSubNode("INPUT").attr("value",this.boxing().getShowValue())}}},get:function(){return this.boxing().getShowValue()}}},RenderTrigger:function(){var b=this,a=b.boxing(),c=b.properties;b.box._iniType(b);if(c.readonly){a.setReadonly(true,true)}else{if(c.inputReadonly){a.setInputReadonly(true,true)}}},_spin:function(d,b){var g=d.$linbid+":spin";if(linb.Thread.isAlive(g)){return}var f=d.properties,e=f.increment*(b?1:-1),c={delay:300},a=function(){d.boxing().setUIValue(String((+f.$UIvalue||0)+e));c.delay*=0.9};c.task=a;linb.Thread(g,[c],500,null,a,null,true).start()},_dynamicTemplate:function(d){var b=d.properties,e=d._exhash="$multiLines:"+b.multiLines+";type:"+b.type+";",c=d.box.getTemplate(e);b.$UIvalue=b.value;if(!c){c=_.clone(d.box.getTemplate());var a=c.FRAME.BORDER;if(b.multiLines){a.BOX.WRAP.INPUT.tagName="textarea";delete a.BOX.WRAP.INPUT.type}switch(b.type){case"none":case"currency":case"number":break;case"spin":a.RBTN={$order:20,style:"{rDisplay}",R1:{R1T:{},R1B:{}},R2:{R2T:{},R2B:{}}};break;case"upload":a.FILE={$order:20,tagName:"input",type:"file",hidefocus:linb.browser.ie?"hidefocus":null,size:"1"};case"listbox":case"cmdbox":a.BOX.WRAP.INPUT.tagName="input";a.BOX.WRAP.INPUT.type="button";default:a.BTN={$order:20,style:"{_popbtnDisplay}",TOP:{},MID:{style:"{_btnStyle}"}}}d.box.setTemplate(c,e)}d.template=c},_prepareData:function(a){var b=arguments.callee.upper.call(this,a),c=a.box._posMap;if(c[b.type]){b._btnStyle=b.image?("background: url("+b.image+")"+(b.imagePos||"")):("background-position:"+c[b.type])}b._type="text";b._saveDisplay=b.commandBtn!="none"?"":"display:none";b._commandCls=a.getClass("SMID","-"+b.commandBtn);b._popbtnDisplay=b.type!="none"?"":"display:none";b.typecls=a.getClass("KEY","-"+b.type);return b},_ensureValue:function(b,e){var c=arguments.callee,a=c._reg||(c._reg=/^#[\w]{6}$/),g=b.properties;if(!_.isSet(e)||e===""){return""}switch(b.properties.type){case"datepicker":var f;if(e){if(_.isDate(e)){f=e}else{if(isFinite(e)){f=new Date(parseInt(e))}}}return f?String(linb.Date.getTimSpanStart(f,"d",1).getTime()):"";case"colorpicker":return"#"+linb.UI.ColorPicker._ensureValue(null,e);case"timepicker":return linb.UI.TimePicker._ensureValue(null,e);case"currency":return this._currency(b,e);case"number":case"spin":return this._number(b,e);default:return typeof e=="string"?e:(e||e===0)?String(e):""}},_number:function(a,b){var c=a.properties;b=parseFloat(b+"")||0;b=b>c.max?c.max:b<c.min?c.min:b;return b.toFixed(c.precision)},_currency:function(b,c){var d=b.properties,a=Math.max(d.min,0);c=parseFloat((c+"").replace(/,/g,""))||0;c=c>d.max?d.max:c<a?a:c;return this.formatCurrency(c)},formatCurrency:function(a){a=a.toFixed(2);a=a.split(".");a[0]=a[0].split("").reverse().join("").replace(/(\d{3})(?=\d)/g,"$1,").split("").reverse().join("");return a.join(".")},_onresize:function(d,p,m){var u=1,b=1,h=linb.UI.$getCSSValue("linb-comboinput-input","paddingTop"),a=linb.UI.$getCSSValue("linb-comboinput-input","paddingLeft");var j=d.properties,n=d.getSubNode("BOX"),l="px",r=function(f){return f?d.getSubNode(f).get(0):null},c=r("INPUT"),q=r(j.commandBtn!="none"?"SBTN":null),i=r(j.type=="spin"?"RBTN":j.type=="none"?null:"BTN"),s=p,e=m,g=Math.max(0,(j.$b_lw||0)-u),k=Math.max(0,(j.$b_tw||0)-b);if(null!==s){s-=Math.max(u*2,(j.$b_lw||0)+(j.$b_rw||0));s-=((q?q.offsetWidth:0)+(i?i.offsetWidth:0));if(linb.browser.ie6){s=(parseInt(s/2))*2}}if(null!==e){e-=Math.max(b*2,(j.$b_lw||0)+(j.$b_rw||0));if(linb.browser.ie6){e=(parseInt(e/2))*2}if(linb.browser.ie6&&null===p){n.ieRemedy()}}if(null!==s&&s-a>0){c.style.width=(s-a)+l}if(null!==e&&e-h>0){c.style.height=(e-h)+l}if(m-2>0){if(i){i.style.height=(m-2)+l}if(q){q.style.height=(m-2)+l}}if(j.type=="spin"){if(m/2-2>0){m=(m/2-2)+l;r("R1").style.height=m;r("R2").style.height=m}}n.cssRegion({left:g,top:k,width:s,height:e});if((d.$border||d.$shadow||d.$resizer)&&linb.browser.ie){n.ieRemedy()}}}});Class("linb.UI.ColorPicker",["linb.UI","linb.absValue"],{Instance:{activate:function(){this.getSubNode("TOGGLEA").focus();return this},_setCtrlValue:function(b,a){return this.each(function(h){if(!h.renderId){return}var l=h.box,e=h.properties,g=h.$hex=l._to3(b),d=h.$hex.join(""),k=h.$rgb=l.hex2rgb(b),i=h.$hsv=l.rgb2hsv(k),j=function(m,f){h.getSubNode(m).get(0).firstChild.nodeValue=String(f)},c=function(f){return parseInt(f*100)};j("R",k[0]);j("G",k[1]);j("B",k[2]);j("H",g[0]);j("E",g[1]);j("X",g[2]);if(h.$hexinhsv!=d){j("HH",i[0]);j("S",c(i[1]));j("V",c(i[2]));delete h.$hexinhsv}l._setClrName(h,d);l._updateDftTip(h);if(e.advance&&h.$hexinadv!=d){l._updateMarks(h,b,true,i[0]);delete h.$hexinadv}if(a!=false){h.getSubNode("CAPTION").html("#"+b,false)}})},getColorName:function(){return this.get(0).$clrN||""}},Initialize:function(){var g=this,a=linb.UI.$ID,k=linb.UI.$CLS,m=linb.UI.$tag_special,h=g.KEY,f=g._slist,b=f.length,d,c,e=[],j=linb.IEUNSELECTABLE;g.addTemplateKeys(["TXT","DD1","DD2","DD3","R","G","B","HH","S","V","H","E","X"]);for(d=0;d<b;d++){e.push('<span  id="'+h+"-SC:"+a+":"+f[d]+'" style="background-color:#'+f[d]+'" '+j+">"+f[d]+"</span>")}c="<div "+j+'><span class="'+k+'-txt"'+j+'>R: </span><span id="'+h+"-R:"+a+':" class="'+k+"-dd2 ui-dragable "+m+"DD2_CC"+m+'" '+j+'>R</span><span style="width:8px;height:8px" '+j+' ></span><span class="'+k+'-txt"'+j+'>H: </span><span id="'+h+"-HH:"+a+':" class="'+k+"-dd2 ui-dragable "+m+"DD2_CC"+m+'" '+j+">H</span><span "+j+">\xB0</span></div><div "+j+'><span class="'+k+'-txt"'+j+'>G: </span><span id="'+h+"-G:"+a+':" class="'+k+"-dd2 ui-dragable "+m+"DD2_CC"+m+'" '+j+'>G</span><span style="width:8px;height:8px" '+j+' ></span><span class="'+k+'-txt"'+j+'>S: </span><span id="'+h+"-S:"+a+':" class="'+k+"-dd2 ui-dragable "+m+"DD2_CC"+m+'"  '+j+">S</span><span "+j+">%</span></div><div "+j+'><span class="'+k+'-txt"'+j+'>B: </span><span id="'+h+"-B:"+a+':" class="'+k+"-dd2 ui-dragable "+m+"DD2_CC"+m+'" '+j+'>B</span><span style="width:8px;height:8px" '+j+' ></span><span class="'+k+'-txt"'+j+'>V: </span><span id="'+h+"-V:"+a+':" class="'+k+"-dd2 ui-dragable "+m+"DD2_CC"+m+'" '+j+">V</span><span "+j+">%</span></div><div "+j+'><span style="width:38px"'+j+">HEX: "+m+'</span><span id="'+h+"-H:"+a+':" class="'+k+"-dd3 ui-dragable "+m+"DD3_CC"+m+'" '+j+'>H</span><span id="'+h+"-E:"+a+':" class="'+k+"-dd3 ui-dragable "+m+"DD3_CC"+m+'" '+j+""+j+'>E</span><span id="'+h+"-X:"+a+':" class="'+k+"-dd1 ui-dragable "+m+"DD1_CC"+m+'" '+j+">X</span></div>";g.setTemplate({style:"{_style};height:auto;width:{_width}px;",tagName:"div",onselectstart:"return false",BORDER:{tagName:"div",BAR:{tagName:"div",className:"{classBar}",BART:{cellpadding:"0",cellspacing:"0",width:"100%",border:"0",className:"uibar-t",tagName:"table",BARTR:{tagName:"tr",BARTDL:{tagName:"td",className:"uibar-tdl"},BARTDM:{$order:1,width:"100%",tagName:"td",className:"uibar-tdm"},BARTDR:{$order:2,tagName:"td",className:"uibar-tdr"}}},BARCMDL:{tagName:"div",className:"uibar-cmdl"},BARCMDR:{tagName:"div",className:"uibar-cmdr",CLOSE:{className:"uicmd-close ",style:"{closeDisplay}"}}},MAIN:{$order:2,tagName:"div",className:"uicon-main",MAINI:{tagName:"div",className:"uicon-maini",CON:{$order:1,tagName:"div",SIMPLE:{tagName:"div",TOP:{$order:1,tagName:"div",DATA:{$order:0,tagName:"div",onselectstart:"return false",text:c},EXAM:{$order:1,tagName:"div",EXAMI:{tagName:"div"}}},LIST:{$order:2,tagName:"div",text:e.join("")}},ADV:{$order:2,style:"{advDispay}",tagName:"div",ADVWHEEL:{$order:0,tagName:"div"},ADVCLR:{$order:1,tagName:"div"},ADVMARK1:{$order:3,tagName:"div"},ADVMARK2:{$order:4,tagName:"div"}}}}},TAIL:{$order:3,tagName:"div",className:"uicon-main",TAILI:{tagName:"div",className:"uicon-maini",CAPTION:{text:"{caption}"},SET:{className:"ui-btn",SETI:{className:"ui-btni",SETC:{className:"ui-btnc",SETA:{tabindex:"{tabindex}",text:linb.wrapRes("inline.set")}}}},TOGGLE:{className:"ui-btn",TOGGLEI:{className:"ui-btni",TOGGLEC:{className:"ui-btnc",TOGGLEA:{tabindex:"{tabindex}",text:">>"}}}}}},BBAR:{$order:4,tagName:"div",className:"uibar-bottom-s",BBART:{cellpadding:"0",cellspacing:"0",width:"100%",border:"0",tagName:"table",className:"uibar-t",BBARTR:{tagName:"tr",BBARTDL:{tagName:"td",className:"uibar-tdl"},BBARTDM:{$order:1,width:"100%",tagName:"td",className:"uibar-tdm"},BBARTDR:{$order:2,tagName:"td",className:"uibar-tdr"}}}}}})},Static:{_radius:84,_square:100,_bigRadius:97,DataModel:{height:{ini:"auto",readonly:true},width:{ini:"auto",readonly:true},value:"FFFFFF",barDisplay:{ini:true,action:function(a){if(a){this.getSubNode("BAR").replaceClass("uibar-top-s","uibar-top")}else{this.getSubNode("BAR").replaceClass("uibar-top","uibar-top-s")}}},closeBtn:{ini:true,action:function(a){this.getSubNode("CLOSE").css("display",a?"":"none")}},advance:{ini:false,action:function(a){var b=this;b.getSubNode("ADV").css("display",a?"":"none");b.getSubNode("TOGGLEA").text(a?"<<":">>");b.getRoot().width(a?410:210);if(a){b.box._updateMarks(b,b.properties.$UIvalue,true,b.$hsv[0])}}}},Appearances:{KEY:{},MAINI:{padding:"4px 5px 4px 0"},CON:{height:"196px",padding:"3px",position:"relative",border:"solid 1px #648CB4"},DATA:{"float":"left",width:"112px",height:"86px"},"DATA span":{"float":"left"},"DATA div":{"padding-top":"3px",clear:"both"},TXT:{width:"16px"},CAPTION:{"font-size":"12px","vertical-align":linb.browser.ie6?"baseline":"middle"},EXAM:{"float":"left","margin-top":"2px",padding:"3px",border:"solid 1px #648CB4","background-color":"#E5EBFB"},EXAMI:{height:"70px",width:"70px","white-space":"normal","text-align":"center",border:"solid 1px #648CB4"},"DD1, DD2, DD3":{display:"block",height:"16px",border:"1px solid #779EBF","padding-right":"2px",cursor:"e-resize","text-align":"right",background:"#F8FBFF"},DD1:{width:"16px"},DD2:{width:"24px"},DD3:{$order:2,width:"16px","border-right":"none"},TOP:{height:"90px",position:"relative"},LIST:{height:"106px",position:"relative",overflow:"hidden",margin:"0 2px","line-height":linb.browser.ie6?"0":null,clear:"both"},TAILI:{position:"relative","padding-top":"4px",height:"22px","text-align":"center"},SIMPLE:{"float":"left",width:"192px",position:"relative"},ADV:{"float":"right",width:"195px",height:"195px",position:"relative"},"ADV div":{cursor:"crosshair",position:"absolute"},ADVCLR:{background:linb.browser.ie6?null:linb.UI.$bg("bg.png","no-repeat left top"),_filter:linb.UI.$ieBg("bg.png"),height:"101px",left:"47px",top:"47px",width:"101px"},ADVWHEEL:{background:linb.browser.ie6?null:linb.UI.$bg("clr.png","no-repeat left top"),_filter:linb.UI.$ieBg("clr.png"),height:"195px",width:"195px"},"ADVMARK1, ADVMARK2":{background:linb.browser.ie6?null:linb.UI.$bg("picker.png","no-repeat left top"),_filter:linb.UI.$ieBg("picker.png"),height:"17px",margin:"-8px 0pt 0pt -8px",overflow:"hidden",width:"17px"},"LIST span":{height:"12px",width:"10px","font-size":linb.browser.ie6?"0":null,"float":"left",display:"block",overflow:"hidden","text-indent":"100px",margin:"0",cursor:"pointer",border:"1px solid #000",margin:"0 -1px -1px 0"},SET:{position:"absolute",display:"none",top:"0",right:"38px"},TOGGLE:{position:"absolute",right:"5px",top:"0"}},Behaviors:{HoverEffected:{CLOSE:"CLOSE",SET:"SET",TOGGLE:"TOGGLE"},ClickEffected:{CLOSE:"CLOSE",SET:"SET",TOGGLE:"TOGGLE"},KEY:{onClick:function(){return false}},SC:{onMouseover:function(c,b,a){c.box._setTempUI(c,c.getSubId(a))},onClick:function(d,c,b){var a=d.getSubId(b);d.boxing()._setCtrlValue(d.$tempValue=a,false);if(!d.properties.advance){d.boxing().setUIValue(a)}d.box._vC(d);return false},onDblclick:function(d,c,b){var a=d.getSubId(b);d.boxing()._setCtrlValue(d.$tempValue=a,false);d.boxing().setUIValue(a);d.box._vC(d);return false}},LIST:{onMouseout:function(c,b,a){c.box._updateDftTip(c)}},SET:{onClick:function(b,a,c){b.boxing().setUIValue(b.$tempValue,true);b.box._vC(b)}},CANCEL:{onClick:function(b,a,c){b.getSubNode("CLOSE").onClick(true)}},TOGGLE:{onClick:function(b,a,c){b.boxing().setAdvance(!b.properties.advance)}},R:{onMousedown:function(b,a,c){b.box._dd1(b,a,c)},onDrag:function(b,a,c){b.box._dd2(b,a,c,0)},onDragstop:function(b,a,c){b.box._dd3(b,a,c,0)}},G:{onMousedown:function(b,a,c){b.box._dd1(b,a,c)},onDrag:function(b,a,c){b.box._dd2(b,a,c,1)},onDragstop:function(b,a,c){b.box._dd3(b,a,c,1)}},B:{onMousedown:function(b,a,c){b.box._dd1(b,a,c)},onDrag:function(b,a,c){b.box._dd2(b,a,c,2)},onDragstop:function(b,a,c){b.box._dd3(b,a,c,2)}},HH:{onMousedown:function(b,a,c){b.box._dd1(b,a,c,true)},onDrag:function(b,a,c){b.box._dd2(b,a,c,0,"hsv1")},onDragstop:function(b,a,c){b.box._dd3(b,a,c,0,true,"hsv1")}},S:{onMousedown:function(b,a,c){b.box._dd1(b,a,c,true)},onDrag:function(b,a,c){b.box._dd2(b,a,c,1,"hsv2")},onDragstop:function(b,a,c){b.box._dd3(b,a,c,1,true,"hsv2")}},V:{onMousedown:function(b,a,c){b.box._dd1(b,a,c,true)},onDrag:function(b,a,c){b.box._dd2(b,a,c,2,"hsv2")},onDragstop:function(b,a,c){b.box._dd3(b,a,c,2,true,"hsv2")}},H:{onMousedown:function(b,a,c){b.box._dd1(b,a,c)},onDrag:function(b,a,c){b.box._dd2(b,a,c,0,"hex")},onDragstop:function(b,a,c){b.box._dd3(b,a,c,0)}},E:{onMousedown:function(b,a,c){b.box._dd1(b,a,c)},onDrag:function(b,a,c){b.box._dd2(b,a,c,1,"hex")},onDragstop:function(b,a,c){b.box._dd3(b,a,c,1)}},X:{onMousedown:function(b,a,c){b.box._dd1(b,a,c)},onDrag:function(b,a,c){b.box._dd2(b,a,c,2,"hex")},onDragstop:function(b,a,c){b.box._dd3(b,a,c,2)}},CLOSE:{onClick:function(c,d,f){var b=c.properties,a=c.boxing();if(b.disabled||b.readonly){return}if(false===a.beforeClose(c)){return}a.destroy();return false}},ADVWHEEL:{onMousedown:function(c,b,d){var a=c.box;a._prepareAdv(c,b);a._updateClrByPos(c,b,true);c.getSubNode("ADVMARK1").startDrag(b,{dragType:"none"})}},ADVMARK1:{onMousedown:function(c,b,d){var a=c.box;a._prepareAdv(c,b);a._updateClrByPos(c,b,true);c.getSubNode("ADVMARK1").startDrag(b,{dragType:"none"})},onDrag:function(c,b,d){var a=c.box;a._updateClrByPos(c,b,true)},onDragstop:function(b,a,c){b.box._updateValueByPos(b,a)},onDblclick:function(b,a,c){b.box._updateValueByPos(b,a);b.boxing().setUIValue(b.$tempValue);b.box._vC(b)}},ADVCLR:{onMousedown:function(c,b,d){var a=c.box;a._prepareAdv(c,b);a._updateClrByPos(c,b);c.getSubNode("ADVMARK2").startDrag(b,{dragType:"none"});return false}},ADVMARK2:{onMousedown:function(c,b,d){var a=c.box;a._prepareAdv(c,b);a._updateClrByPos(c,b);c.getSubNode("ADVMARK2").startDrag(b,{dragType:"none"});return false},onDrag:function(c,b,d){var a=c.box;a._updateClrByPos(c,b)},onDragstop:function(b,a,c){b.box._updateValueByPos(b,a)},onDblclick:function(b,a,c){b.box._updateValueByPos(b,a);b.boxing().setUIValue(b.$tempValue);b.box._vC(b)}}},_vC:function(b){var e=b.properties,a=e.$UIvalue,c=a==b.$tempValue;b.getSubNode("SET").css("display",c?"none":"block");b.getSubNode("CAPTION").css("color",c?"#000":"#ff0000")},_prepareData:function(b){var c=arguments.callee.upper.call(this,b);var a="display:none";c.classBar=c.barDisplay?"uibar-top":"uibar-top-s";c.closeDisplay=c.closeBtn?"":a;c._width=c.advance?"410":"210";c.advDispay=c.advance?"":"display:none;";return c},EventHandlers:{beforeClose:function(a,b){}},RenderTrigger:function(){this.$onValueSet=this.$onValueUpdated=function(a){this.box._setClrName(this,a)}},_setClrName:function(c,b){var e=c,a="color.LIST.",d=linb.getRes(a+b);if(d==b){e.$clrN2=e.$clrN="#"+b}else{e.$clrN=d;e.$clrN2=linb.wrapRes(a+b)}},_slist:"FFFFFF,FFFFF0,FFFFE0,FFFF00,FFFAFA,FFFAF0,FFFACD,FFF8DC,FFF5EE,FFF0F5,FFEFD5,FFEBCD,FFE4E1,FFE4C4,FFE4B5,FFDEAD,FFDAB9,FFD700,FFC0CB,FFB6C1,FFA500,FFA07A,FF8C00,FF7F50,FF69B4,FF6347,FF4500,FF1493,FF00FF,FF00FF,FF0000,FDF5E6,FAFAD2,FAF0E6,FAEBD7,FA8072,F8F8FF,F5FFFA,F5F5F5,F5DEB3,F4A460,F0FFFF,F0FFF0,F0F8FF,F0E68C,F08080,EEE8AA,EE82EE,E9967A,E6E6FA,E1FFFF,DEB887,DDA0DD,DCDCDC,DC143C,DB7093,DAA520,DA70D6,D8BFD8,D3D3D3,D2B48C,D2691E,CD853F,CD5C5C,C71585,C0C0C0,BDB76B,BC8F8F,BA55D3,B22222,B0E0E6,B0C4DE,AFEEEE,ADFF2F,ADD8E6,A9A9A9,A52A2A,A0522D,9932CC,98FB98,9400D3,9370DB,90EE90,8FBC8F,8B4513,8B008B,8B0000,8A2BE2,87CEFA,87CEEB,808080,808000,800080,800000,7FFFAA,7FFF00,7CFC00,7B68EE,778899,708090,6B8E23,6A5ACD,696969,6495ED,5F9EA0,556B2F,4B0082,48D1CC,483D8B,4682B4,4169E1,40E0D0,3CB371,32CD32,2F4F4F,2E8B57,228B22,20B2AA,1E90FF,191970,00FFFF,00FFFF,00FF7F,00FF00,00FA9A,00CED1,00BFFF,008B8B,008080,008000,006400,0000FF,0000CD,00008B,000080,000000".split(","),_C16:"0123456789ABCDEF",_dd1:function(c,h,i,b){var g=c.properties,a=c.box,d=function(){var e=a.hex2rgb(c.$tempValue||g.$UIvalue);return b?a.rgb2hsv(e):e};linb.use(i).css("backgroundColor","red").startDrag(h,{dragType:"blank",targetReposition:false,widthIncrement:2,dragCursor:true});c.$temp=0;c.$start=d();c.$temp2=d()},_dd2:function(f,k,a,g,l){var h,d=linb.DragDrop.getProfile().offset,b=f.properties,c=f.$temp2,n=f.box,j=l=="hsv1"?361:l=="hsv2"?101:256,m;h=(l=="hsv2"?parseInt(f.$start[g]*100):parseInt(f.$start[g]))+parseInt(d.x/2);h=(h%j+j)%j;if(f.$temp!=h){c[g]=f.$temp=l=="hsv2"?h/100:h;m=(l=="hsv1"||l=="hsv2")?n.hsv2rgb(c):c;m=n.rgb2hex(m);n._setTempUI(f,m);linb.use(a).text(l=="hex"?n._toFF(h):h)}},_dd3:function(d,h,a,f,g){if(d.$start[f]!==d.$temp){var b=d.properties,k=d.box,c=d.$start,j;c[f]=d.$temp;j=g?k.hsv2rgb(c):c;j=k.rgb2hex(j);if(g){d.$hexinhsv=j}d.boxing()._setCtrlValue(d.$tempValue=j,false);delete d.$hexinhsv;d.box._vC(d)}linb.use(a).css("backgroundColor","");d.$temp=d.$start=0},_setTempUI:function(i,d){var c=this,f=c.hex2rgb(d),a=i.boxing(),g=a.getSubNode("EXAMI"),e=c.rgb2hsv(f),h=linb.getRes("color.LIST."+d);g.css({backgroundColor:"#"+d,color:e[2]>0.6?"#000":"#FFF"});g.text(i.show_color=h==d?"#"+d:h)},_updateDftTip:function(c){var a=c.box,b=c.boxing().getSubNode("EXAMI");b.css({backgroundColor:"#"+c.$hex.join(""),color:c.$hsv[2]>0.6?"#000":"#FFF"});b.html(c.$clrN2||"",false)},_to3:function(a){if(!a){a="FFFFFF"}return[a.substr(0,2),a.substr(2,2),a.substr(4,2)]},_toFF:function(b){var a=this._C16;b=parseInt(b)||0;b=(b>255||b<0)?0:b;return a.charAt((b-b%16)/16)+a.charAt(b%16)},_to255:function(c){var b=this._C16,a=c.split("");return b.indexOf(a[0].toUpperCase())*16+b.indexOf(a[1].toUpperCase())},_webSafe:function(e,d,a){var c=arguments.callee,h=c.f||(c.f=function(b){return parseInt(b/51)*51});if(typeof e=="object"){d=e[1];a=e[2];e=e[0]}return[h(e),h(d),h(a)]},_updateMarks:function(b,a,g,f){var j=this,e=j.hex2rgb(a),d=j.rgb2hsv(e),c=(d[0]/360)*6.28,k=b.getSubNode("ADVCLR");if(g){var i=b.getSubNode("ADVMARK1"),h=b.getSubNode("ADVMARK2");i.cssPos({left:Math.round(Math.sin(c)*j._radius+j._bigRadius),top:Math.round(-Math.cos(c)*j._radius+j._bigRadius)});h.cssPos({left:Math.round(j._square*(d[1]-0.5)+j._bigRadius),top:Math.round(j._square*(0.5-d[2])+j._bigRadius)})}if(f!==undefined){k.css("backgroundColor","#"+j.rgb2hex(j.hsv2rgb([f,1,1])))}j._setTempUI(b,a)},_updateClrByPos:function(c,j,k){var r=this,f=linb.Event.getPos(j),m=c.$tpos,b=f.left-m.left,n=f.top-m.top,d,q,p,i,u,o,g,l,a;if(k){q=c.getSubNode("ADVMARK1");d=Math.atan2(b,-n);q.cssPos({left:Math.round(Math.sin(d)*r._radius+r._bigRadius),top:Math.round(-Math.cos(d)*r._radius+r._bigRadius)});i=Math.floor((d/6.28)*360);if(i<0){i+=360}g=[i,c.$hsv[1],c.$hsv[2]];l=r.hsv2rgb(g);a=r.rgb2hex(l);r._updateMarks(c,c.$t_hex=a,false,i)}else{p=c.getSubNode("ADVMARK2");u=Math.max(0,Math.min(1,(b/r._square)+0.5));o=Math.max(0,Math.min(1,0.5-(n/r._square)));p.cssPos({left:Math.round(r._square*(u-0.5)+r._bigRadius),top:Math.round(r._square*(0.5-o)+r._bigRadius)});g=[c.$hsv[0],u,o];l=r.hsv2rgb(g);a=r.rgb2hex(l);r._updateMarks(c,c.$t_hex=a)}},_updateValueByPos:function(a,b){a.$hexinadv=a.$t_hex;a.boxing()._setCtrlValue(a.$tempValue=a.$t_hex,false);delete a.$hexinadv;a.box._vC(a)},_prepareAdv:function(b,c){var a=this,d=b.getSubNode("ADVWHEEL").offset();b.$tpos={left:d.left+a._bigRadius,top:d.top+a._bigRadius}},_ensureValue:function(d,l){var h=this,g=arguments.callee,b=g.map||(g.map=(function(){var a={};_.arr.each(h._C16.split(""),function(m,k){a[m]=1});return a}())),c=g._r||(g._r=/rgb\(([^)]*)\)/);if(!l||typeof l!="string"){return"FFFFFF"}if(c.test(l)){l=l.replace(c,"$1");l=l.split(",");l[0]=parseInt(l[0])||0;l[1]=parseInt(l[1])||0;l[2]=parseInt(l[2])||0;l=h.rgb2hex(l)}if(l.charAt(0)=="#"){l=l.substr(1,l.length)}var j="",e;for(var f=0;f<6;f++){e=l.charAt(f).toUpperCase();j+=(b[e]?e:"F")}return j},hsv2rgb:function(l,y,w){if(l instanceof Array){y=l[1];w=l[2];l=l[0]}var o=arguments.callee,n=o.f||(o.f=function(b){return Math.min(255,Math.round(b*256))}),a,m,u,j,e,d,c,x;if(y==0){return[w=n(w),w,w]}else{j=Math.floor((l/60)%6);e=(l/60)-j;d=w*(1-y);c=w*(1-e*y);x=w*(1-(1-e)*y);switch(j){case 0:a=w;m=x;u=d;break;case 1:a=c;m=w;u=d;break;case 2:a=d;m=w;u=x;break;case 3:a=d;m=c;u=w;break;case 4:a=x;m=d;u=w;break;case 5:a=w;m=d;u=c;break}return y==0?[w=n(w),w,w]:[n(a),n(m),n(u)]}},rgb2hsv:function(a,e,f){if(a instanceof Array){e=a[1];f=a[2];a=a[0]}a=a/255;e=e/255;f=f/255;var c=Math.min(a,e,f),i=Math.max(a,e,f),j=i-c,l=(i===0)?0:1-(c/i),k=i,d;switch(i){case c:d=0;break;case a:d=60*(e-f)/j;if(e<f){d+=360}break;case e:d=(60*(f-a)/j)+120;break;case f:d=(60*(a-e)/j)+240;break}return[Math.round(d),l,k]},rgb2hex:function(e,d,a){var c=this;if(e instanceof Array){d=e[1];a=e[2];e=e[0]}return c._toFF(e)+c._toFF(d)+c._toFF(a)},hex2rgb:function(b){var a=this;if(!b){b="FFFFFF"}if(b.charAt(0)=="#"){b=b.slice(1)}return[a._to255(b.substr(0,2)),a._to255(b.substr(2,2)),a._to255(b.substr(4,2))]},getTextColor:function(b){var a=this;b=a._ensureValue(0,b);b=a.hex2rgb(b);b=a.rgb2hsv(b);return(b&&b[2])>0.6?"#000000":"#FFFFFF"},_onresize:function(){}}});Class("linb.UI.List",["linb.UI","linb.absList","linb.absValue"],{Instance:{_setCtrlValue:function(a){return this.each(function(d){if(!d.renderId){return}var i=d.box,q=d.boxing().getUIValue(),b=d.properties,u=i._ITEMKEY||"ITEM",f=i._DIRTYKEY||"ITEM",g=function(o,p){return d.getSubNode(o,p)},j=function(k){return d.getSubIdByItemId(k)};if(b.selMode=="single"){var n=j(q);if(q!==null&&n){g(f,n).tagClass("-mouseover",false).tagClass("-checked",false)}n=j(a);if(n){g(f,n).tagClass("-mouseover",false).tagClass("-checked")}if(n){var c=g(u,n);if(c){var m=c.offsetTop(),r=c.offsetHeight(),l=g("ITEMS"),h=l.scrollHeight(),s=l.scrollTop(),e=l.height();if(h>e){if(m<s||(m+r)>(s+e)){l.scrollTop(m)}}}}}else{if(b.selMode=="multi"){q=q?q.split(";"):[];a=a?a.split(";"):[];_.arr.each(q,function(k){if(_.arr.indexOf(a,k)==-1){g(f,j(k)).tagClass("-mouseover",false).tagClass("-checked",false)}});_.arr.each(a,function(k){if(_.arr.indexOf(q,k)==-1){g(f,j(k)).tagClass("-mouseover",false).tagClass("-checked")}})}}})},adjustSize:function(){return this.each(function(d){var b=d.getSubNode("ITEMS"),a=d.properties;b.height("auto");var c=Math.min(a.maxHeight,b.offsetHeight());a.height=c;b.height(c);d.getRoot().height(c)})},activate:function(){return linb.absList.prototype.activate.call(this)},getShowValue:function(d){var c=this.get(0),e=c.properties,a,b;if(!_.isDefined(d)){d=e.$UIvalue}if((a=_.arr.subIndexOf(e.items,"id",d))!=-1){a=e.items[a].caption;a=a.charAt(0)=="$"?linb.getRes(a.slice(1)):a}else{a=""}return a},_setDirtyMark:function(){return arguments.callee.upper.apply(this,["ITEMS"])}},Static:{_DIRTYKEY:"ITEM",Templates:{tagName:"div",style:"{_style}",className:"uibg-base",ITEMS:{$order:10,tagName:"div",className:"{_bordertype}",text:"{items}"},$submap:{items:{ITEM:{className:"{itemClass} {disabled} {readonly}",style:"{itemStyle}{itemDisplay}",tabindex:"{_tabindex}",ICON:{$order:10,className:"ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat} {imageDisplay}"},CAPTION:{tagName:"text",text:"{caption}&nbsp;",$order:20}}}}},Appearances:{KEY:{"font-size":"12px"},ITEMS:{position:"relative",overflow:"auto","overflow-x":(linb.browser.ie||linb.browser.gek)?"hidden":""},ITEM:{display:"block",zoom:linb.browser.ie?1:null,"font-family":'"Verdana", "Helvetica", "sans-serif"',border:0,cursor:"pointer","font-size":"12px",padding:"4px 2px",position:"relative"},"ITEM-mouseover, ITEM-mousedown, ITEM-checked":{background:linb.UI.$bg("item.gif","repeat-x")},"ITEM-mouseover":{$order:1,"background-color":"#FAD200","background-position":"left -51px"},"ITEM-mousedown":{$order:2,"background-color":"#F5D22D","background-position":"left -101px"},"ITEM-checked":{$order:2,"background-color":"#AAD2FA","background-position":"left top"}},Behaviors:{HoverEffected:{ITEM:"ITEM"},ClickEffected:{ITEM:"ITEM"},DragableKeys:["ITEM"],DropableKeys:["ITEM","ITEMS"],onSize:linb.UI.$onSize,ITEM:{onDblclick:function(b,d,f){var a=b.properties,c=b.getItemByDom(f);b.boxing().onDblclick(b,c,f)},onClick:function(b,r,c){var d=b.properties,s=b.getItemByDom(c),h=b.getSubId(c),g=b.boxing(),u=linb.Event.getKey(r),f,j;if(d.disabled||s.disabled){return false}linb.use(c).focus();switch(d.selMode){case"none":f=g.onItemSelected(b,s,c);break;case"multi":if(d.readonly||s.readonly){return false}var l=g.getUIValue(),a=l?l.split(";"):[];if(a.length&&(u[1]||u[2]||d.noCtrlKey||d.$checkbox)){j=false;if(u[2]){var k=d.items,o=_.arr.subIndexOf(k,"id",b.$firstV.id),m=_.arr.subIndexOf(k,"id",s.id),q;a.length=0;for(q=Math.min(o,m);q<=Math.max(o,m);q++){a.push(k[q].id)}}else{if(_.arr.indexOf(a,s.id)!=-1){_.arr.removeValue(a,s.id)}else{a.push(s.id)}}a.sort();l=a.join(";");if(g.getUIValue()==l){f=false}else{g.setUIValue(l);if(g.get(0)&&g.getUIValue()==l){f=g.onItemSelected(b,s,c)||j}}break}case"single":if(d.readonly||s.readonly){return false}if(g.getUIValue()==s.id){f=false}else{b.$firstV=s;g.setUIValue(s.id);if(g.get(0)&&g.getUIValue()==s.id){f=g.onItemSelected(b,s,c)}}break}var n=linb.use(c).get(0),p=n&&n.href;n=null;return(!p||p.indexOf("javascript:")==0)?false:f},onKeydown:function(c,g,a){var k=linb.Event.getKey(g),j=k[0],b=k[2],i=linb(a),f=c.getRoot().nextFocus(true,true,false),h=c.getRoot().nextFocus(false,true,false);switch(linb.Event.getKey(g)[0]){case"tab":if(b){if(i.get(0)!=f.get(0)){f.focus();return false}}else{if(i.get(0)!=h.get(0)){h.focus();return false}}break;case"left":case"up":var d=i.nextFocus(false,true,false);if(i.get(0)==f.get(0)){h.focus()}else{i.nextFocus(false)}return false;break;case"right":case"down":var d=i.nextFocus(true,false,false);if(i.get(0)==h.get(0)){f.focus()}else{i.nextFocus()}return false;break;case"enter":i.onClick();break}}}},DataModel:{selMode:{ini:"single",listbox:["single","none","multi"]},borderType:{ini:"flat",listbox:["none","flat","inset","outset"],action:function(b){var d=this,g=d.properties,e=d.getSubNode("ITEMS"),c=/^uiborder-/,f="uiborder-",a=d.getRoot();e.removeClass(c);e.addClass(f+b);linb.UI.$tryResize(d,a.get(0).style.width,a.get(0).style.height,true)}},noCtrlKey:true,width:120,height:150,maxHeight:300},EventHandlers:{onDblclick:function(a,b,c){},onItemSelected:function(a,b,c){}},_ensureValue:function(b,c){if(b.properties.selMode=="multi"){var a=(c||"").split(";");a.sort();return a.join(";")}else{return c}},_onStartDrag:function(a,b,c,d){var d=linb.Event.getPos(b);linb.use(c).startDrag(b,{dragType:"icon",shadowFrom:c,targetLeft:d.left+12,targetTop:d.top+12,dragCursor:"pointer",dragDefer:1,dragKey:a.box.getDragKey(a,c),dragData:a.box.getDragData(a,b,c)});return false},_onDropTest:function(b,g,i,a,d,c){var h=d&&d.domId,f=linb.use(i).id();if(h){if(h==f){return false}if(_.get(linb.use(i).get(0),["previousSibling","id"])==h){return false}}},_onDrop:function(d,i,b,j,h,m){linb.DragDrop.setDragIcon("none");var g=d.getKey(linb.use(b).id()),c=h.profile,a=h.domId,f,l=linb.absObj.$specialChars;f=_.clone(c.getItemByDom(a),function(k,e){return !l[(e+"").charAt(0)]});c.boxing().removeItems([f.id]);if(g==d.keys.ITEM){d.boxing().insertItems([f],m.id,true)}else{d.boxing().insertItems([f])}return false},_prepareData:function(a){var b=arguments.callee.upper.call(this,a);b._bordertype="uiborder-"+b.borderType;return b},_onresize:function(d,c,a){if(a){var b=0;if(d.properties.borderType!="none"){b=2}d.getSubNode("ITEMS").height(a=="auto"?a:(a-b))}}}});Class("linb.UI.Tabs",["linb.UI","linb.absList","linb.absValue"],{Instance:{_setCtrlValue:function(a){this.each(function(c){var b=c.domId,f=c.boxing(),k=f.getUIValue(),g=c.properties,h=c.getSubIdByItemId(k),o,m,n;if(k&&c.getSubIdByItemId(k)){c.getSubNodes(["ITEM","BOX"],h).tagClass("-checked",false);if(!g.noPanel){f.getPanel(k).css("display","none")}}h=c.getSubIdByItemId(a);o=c.getItemByItemId(a);if(h){_.tryF(c.box._adjustScroll,[c,a],c.box);c.getSubNodes(["ITEM","BOX"],h).tagClass("-checked");if(!g.noPanel){f.getPanel(a).css("display","block");n=c.getRootNode().style;linb.UI.$tryResize(c,n.width,n.height,true,a);n=null;if(g.lazyAppend){var e=c.children,j=[];_.arr.each(e,function(i){if(i[1]==a&&!i[0]["parent:"+c.$linbid]){j.push(i[0]);i[0]["parent:"+c.$linbid]=1}});if(j.length){f.append(linb.UI.pack(j),a)}if(c.$attached){for(var d=0,l;l=c.$attached[d++];){if(l._render){l._render(true)}}delete c.$attached}e=c.exchildren;if(e&&e.length){j=[];_.arr.filter(e,function(i){if(i[1]==a){j.push(i[0]);return false}});if(j.length){_.arr.each(j,function(i){f.append(linb(i),a)})}}e=c.excoms;if(e&&e.length){j=[];_.arr.filter(e,function(i){if(i[1]==a){j.push(i[0]);return false}});if(j.length){_.arr.each(j,function(i){i.show(null,f,a,false)})}}}if(!o._$ini){if(f.onIniPanelView){if(f.onIniPanelView(c,o)!==false){o._$ini=true}}}}}})},append:function(c,a){var b=this.get(0).properties;if(a=a||b.$UIvalue||b.value){arguments.callee.upper.call(this,c,a)}return this},getCurPanel:function(){var a=this.get(0);return this.getPanel(a.properties.$UIvalue)},getPanel:function(a){var b=this.get(0);return b.getSubNodeByItemId("PANEL",a)},addPanel:function(b,f,g){var e={},h=g&&g.id,c=this.getItems(),d=b.id||b.tag;if(c.length){if(-1!=_.arr.subIndexOf(c,"id",d)){return false}if(!h){h=c[c.length-1].id}}_.merge(e,{caption:b.caption,image:b.image,closeBtn:b.closeBtn||false,popBtn:b.popBtn||false,optBtn:b.optBtn||false,imagePos:b.imagePos,dragKey:b.dragKey,dropKeys:b.dropKeys,id:b.id||b.tag||_.id()});this.insertItems([e],h);var a=[];_.arr.each(f,function(i){a.push(i[0])});this.append(linb.UI.pack(a,false),e.id);return this},removePanel:function(c){var a=this,b=a.getItemByDom(c);return a.removeItems([b.id])},getPanelPara:function(e){var c=this.get(0),b=c.properties,d=c.getItemByDom(e),a=_.clone(d);if(!a.dragKey){a.dragKey=b.dragKey}if(!a.dropKeys){a.dropKeys=b.dropKeys}return a},getPanelChildren:function(c){var b=this.get(0),d=b.getItemIdByDom(c),a=[];if(d){_.arr.each(b.children,function(e){if(e[1]==d){a.push(e)}})}return a},fireItemClickEvent:function(a){this.getSubNodeByItemId("ITEM",a).onMousedown();return this},_afterInsertItems:function(d,f){if(!d.renderId){return}var e=d.box,g,b,a=d.properties;if(g=d.getSubNode(d.keys.BOX||d.keys.KEY)){g.append(d._buildItems("panels",f));if(!a.hasOwnProperty("noPanel")){if(!(b=this.getUIValue())){this.fireItemClickEvent((b=a.items[0])&&(b=b.id))}var c=d.getRootNode().style;linb.UI.$tryResize(d,c.width,c.height,true,b);c=null}}},removeItems:function(a){var b=this,d,c;if(!_.isArr(a)){a=[a]}b.each(function(e){if(!e.properties.noPanel){_.arr.each(a,function(f){c=e.getSubIdByItemId(f);if(c&&!(d=e.getSubNode("PANEL",c)).isEmpty()){d.remove()}})}});arguments.callee.upper.apply(b,arguments);b.each(function(g){if(!g.boxing().getUIValue()){var f;g.boxing().fireItemClickEvent((f=g.properties.items[0])&&f.id)}if(!g.properties.noPanel){var e=g.getRootNode().style;linb.UI.$tryResize(g,e.width,e.height,true,g.boxing().getUIValue());e=null}});return b},clearItems:function(){var a=this;a.each(function(b){if(!b.properties.noPanel){b.getSubNode("PANEL",true).remove()}});a.setValue(null,true);arguments.callee.upper.apply(a,arguments);return a},markItemCaption:function(b,f,d){var c=this.get(0);b=c.getItemByItemId(b);if((b._dirty!=f)||d){var e=b.id,a=c.getItemByItemId(e).caption;c.getSubNodeByItemId("CAPTION",e).html(c.getItemByItemId(e).caption=f?("*"+a):a.replace(/^\*/,"")).css("fontStyle",f?"italic":"normal");b._dirty=f}return this},_scrollToBottom:function(){return this.each(function(f){var i=f.getSubNode("ITEMS"),d=f.getSubNode("LIST"),j=i.left(),g,e=i.width(),a=false,c=d.width();if(c<e+j){if(!f.$scrollStep){f.$scrollStep=1}if(f.$scrollStep<5){f.$scrollStep=f.$scrollStep*1.01}j-=f.$scrollStep;if(c>e+j){j=c-e;a=true}i.left(j);if(a){f.getSubNode("RIGHT").css("display","none");f.$scrollTobottom=false;f.$scrollStep=null}else{f.getSubNode("LEFT").css("display","block");if(f.$scrollTobottom){_.asyRun(arguments.callee,0,[f],this)}}}})},_scrollToTop:function(){return this.each(function(c){var d=c.getSubNode("ITEMS"),e=d.left(),a=false;if(e<0){if(!c.$scrollStep){c.$scrollStep=1}if(c.$scrollStep<5){c.$scrollStep=c.$scrollStep*1.01}e+=c.$scrollStep;if(e>=-1){e=0;a=true}d.left(e);if(a){c.getSubNode("LEFT").css("display","none");c.$scrollToTop=false;c.$scrollStep=null}else{c.getSubNode("RIGHT").css("display","block");if(c.$scrollToTop){_.asyRun(arguments.callee,0,[c],this)}}}})}},Static:{Templates:{tagName:"div",style:"{_style};",LIST:{$order:0,tagName:"div",ITEMS:{tagName:"div",text:"{items}",style:"{HAlign}"},LEFT:{},RIGHT:{}},PNAELS:{$order:1,tagName:"text",text:"{panels}"},$submap:{items:{ITEM:{className:"{itemClass} {disabled} {readonly}",style:"{itemDisplay} {itemStyle}",ITEMI:{ITEMC:{HANDLE:{tabindex:"{_tabindex}",IBWRAP:{tagName:"div",style:"white-space:nowrap;",RULER:{},ICON:{$order:0,className:"ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat} {imageDisplay}"},CAPTION:{text:"{caption}",$order:1},CMDS:{$order:2,OPT:{$order:1,className:"uicmd-opt",style:"{_opt}"},POP:{className:"uicmd-pop",style:"{popDisplay}",$order:1},CLOSE:{className:"uicmd-close ",style:"{closeDisplay}",$order:2}}}}}}}},panels:{PANEL:{tagName:"div",className:"uibg-base",text:linb.UI.$childTag}}}},Appearances:{KEY:{position:"absolute",overflow:"hidden"},LIST:{position:"relative",overflow:"hidden",left:0,width:"100%",background:linb.UI.$bg("line.gif","repeat-x center bottom")},LEFT:{cursor:"pointer",display:"none",position:"absolute",top:0,left:0,height:"16px",width:"16px","z-index":"10",background:linb.UI.$bg("icons.gif","no-repeat -152px -244px",true)},RIGHT:{cursor:"pointer",display:"none",position:"absolute",top:0,right:0,height:"16px",width:"16px","z-index":"10",background:linb.UI.$bg("icons.gif","no-repeat -170px -244px",true)},ITEMS:{padding:"0 4px 2px 0",position:"relative",left:0,top:0,"white-space":"nowrap"},ITEM:{$order:0,"font-family":'"Verdana", "Helvetica", "sans-serif"',cursor:"pointer","padding-right":"6px","vertical-align":"top",background:linb.UI.$bg("button.gif","no-repeat right -540px",true)},"ITEM-mouseover":{$order:1,"background-position":"right -690px"},"ITEM-mousedown, ITEM-checked":{$order:2,"background-position":"right -840px","border-bottom":"solid 1px #FAD600;"},ITEMI:{$order:0,"padding-left":"6px","vertical-align":"top",background:linb.UI.$bg("button.gif","no-repeat left -640px",true)},"ITEM-mouseover ITEMI":{$order:1,"background-position":"left -790px"},"ITEM-mousedown ITEMI, ITEM-checked ITEMI":{$order:2,"background-position":"left -940px"},ITEMC:{$order:0,padding:"5px 0 3px 0","vertical-align":"top","text-align":"center",background:linb.UI.$bg("button.gif","repeat-x left -590px",true)},"ITEM-mouseover ITEMC":{$order:1,"background-position":"left -740px"},"ITEM-mousedown ITEMC, ITEM-checked ITEMC":{$order:2,"background-position":"left -890px"},HANDLE:{display:linb.$inlineBlock,zoom:linb.browser.ie6?1:null,cursor:"pointer","vertical-align":"middle","font-size":"12px"},RULER:{height:"18px",width:"1px","vertical-align":"middle"},PANEL:{position:"relative",display:"none",width:"100%",overflow:"auto"},CAPTION:{"vertical-align":linb.browser.ie6?"baseline":"middle"},CMDS:{"vertical-align":"middle","margin-left":"4px"}},Behaviors:{DropableKeys:["PANEL","KEY","ITEM"],DragableKeys:["ITEM"],HoverEffected:{ITEM:"ITEM",OPT:"OPT",CLOSE:"CLOSE",POP:"POP"},ClickEffected:{ITEM:"ITEM",OPT:"OPT",CLOSE:"CLOSE",POP:"POP"},onSize:linb.UI.$onSize,OPT:{onMousedown:function(){return false},onClick:function(a,b,c){a.boxing().onShowOptions(a,a.getItemByDom(c),b,c);return false}},CAPTION:{onMousedown:function(b,f,g){if(linb.Event.getBtn(f)!="left"){return}var a=b.properties,d=b.getItemByDom(g),c=b.boxing();if(a.disabled||d.disabled){return false}if(a.readonly||d.readonly){return false}if(c.getUIValue()==d.id){if(b.onCaptionActive){b.boxing().onCaptionActive(b,b.getItemByDom(g),g)}}}},ITEM:{onClick:function(a,b,c){return false},onMousedown:function(b,f,h){if(linb.Event.getBtn(f)!="left"){return false}if(b.getKey(linb.Event.getSrc(f).parentNode.id)==b.keys.CMDS){return false}var a=b.properties,g=b.getSubId(h),d=b.getItemByDom(h),c=b.boxing();if(a.disabled||d.disabled){return false}if(a.readonly||d.readonly){return false}if(c.getUIValue()==d.id){return}b.getSubNode("HANDLE",g).focus();c.setUIValue(d.id);if(c.getUIValue()==d.id){c.onItemSelected(b,d,h);return false}}},HANDLE:{onClick:function(a,b,c){return !!linb.Event.getKey(b)[2]},onKeydown:function(c,g,a){var l=linb.Event.getKey(g),k=l[0],b=l[2];if(k==" "||k=="enter"){c.getSubNode("ITEM",c.getSubId(a)).onMousedown();return false}var j=linb(a),h=c.getSubNode("ITEMS"),f=h.nextFocus(true,true,false),i=h.nextFocus(false,true,false);switch(k){case"tab":if(b){if(j.get(0)!=f.get(0)){f.focus();return false}}else{if(j.get(0)!=i.get(0)){i.focus();return false}}break;case"left":case"up":var d=j.nextFocus(false,true,false);if(j.get(0)==f.get(0)){i.focus()}else{j.nextFocus(false)}return false;break;case"right":case"down":var d=j.nextFocus(true,false,false);if(j.get(0)==i.get(0)){f.focus()}else{j.nextFocus()}return false;break}}},CLOSE:{onMousedown:function(){return false},onClick:function(c,f,a){var h=c.properties,m=c.getItemByDom(a),i=h.$UIvalue,k;if(h.disabled||m.disabled){return}if(h.readonly||m.readonly){return false}var j=c.boxing();if(false===j.beforePageClose(c,m,a)){return}k=_.copy(m);if(i&&i==m.id){var g=h.items,d=_.arr.subIndexOf(g,"id",m.id),l,b=(l=g[d+1])?l.id:(l=g[d-1])?l.id:(l=g[0])?l.id:null;if(b&&b!=i){c.boxing().fireItemClickEvent(b)}}j.removeItems(m.id);j.afterPageClose(c,k);var l=c.getRootNode().style;linb.UI.$tryResize(c,l.width,l.height,true);l=null;return false}},POP:{onMousedown:function(){return false},onClick:function(d,g,a){var i=d.properties,l=d.getItemByDom(a),c=l.id;if(i.disabled||l.disabled){return}if(i.readonly||l.readonly){return false}if(d.beforePagePop&&false==d.boxing().beforePagePop(d,l)){return false}var b=d.boxing().getPanel(c),j=d.getRoot().offset(),m=d.getRoot().cssSize(),k=_.copy(linb.UI.Dialog.$DataStruct);_.merge(k,l,"with");_.merge(k,{dragKey:l.dragkey||i.dragKey,dock:"none",tag:l.tag||l.id,width:Math.max(m.width,200),height:Math.max(m.height,100),left:j.left,top:j.top},"all");var h=new linb.UI.Dialog(k);linb("body").append(h);var f=[];_.arr.each(d.children,function(e){if(e[1]==c){f.push(e[0])}},null,true);if(f.length){h.append(linb.UI.pack(f,false))}d.boxing().removeItems(c);return false}},ITEMS:{onMousedown:function(b,c,d){var a=linb.Event.getPos(c);if(!b._$scroll_l&&!b._$scroll_r){return}linb.use(d).startDrag(c,{horizontalOnly:true,dragType:"blank",dragDefer:2,targetLeft:a.left,targetTop:a.top,targetReposition:false,maxLeftOffset:b._$scroll_l,maxRightOffset:b._$scroll_r})},onDrag:function(b,c,d){var a=linb.DragDrop.getProfile();linb.use(d).left(-b._$scroll_r+a.offset.x)},onDragstop:function(a,b,c){a.box._adjustScroll(a)}},LEFT:{onMouseover:function(a,b,c){a.$scrollToTop=true;a.boxing()._scrollToTop()},onMouseout:function(a,b,c){a.$scrollToTop=false;a.$scrollStep=null},onClick:function(a,b,c){a.$scrollStep*=2}},RIGHT:{onMouseover:function(a,b,c){a.$scrollTobottom=true;a.boxing()._scrollToBottom()},onMouseout:function(a,b,c){a.$scrollTobottom=false;a.$scrollStep=null},onClick:function(a,b,c){a.$scrollStep*=2}}},DataModel:{dirtyMark:false,dataBinder:null,dataField:null,lazyAppend:true,dock:"fill",noPanel:false,width:200,height:200,position:"absolute",HAlign:{ini:"left",listbox:["left","center","right"],action:function(a){this.getSubNode("ITEMS").css("textAlign",a)}},dropKeysPanel:"",value:{ini:""},items:{set:function(f){var h=this;if(h.renderId){var e=h.boxing(),g,b=linb.$getGhostDiv(),d=_.copy(h.children);h.children.length=0;_.arr.each(d,function(i){delete i[0].$dockParent;b.appendChild(i[0].getRootNode())});var a=h.properties.value;e.clearItems();e.insertItems(f);_.arr.each(d,function(i){e.append.apply(e,i)});b.innerHTML="";e.setValue(a,true);var c=h.getRootNode().style;linb.UI.$tryResize(h,c.width,c.height,true);c=null}else{h.properties.items=_.copy(f)}}}},EventHandlers:{onIniPanelView:function(a,b){},beforePagePop:function(a,b){},beforePageClose:function(a,b,c){},afterPageClose:function(a,b){},onShowOptions:function(a,b,c,d){},onItemSelected:function(a,b,c){},onCaptionActive:function(a,b,c){}},RenderTrigger:function(){var b=this,a,d,c;if(a=b.properties.value){(c=b.boxing()).setUIValue(a);if(d=b.getItemByItemId(a)){c.onItemSelected(b,d)}}},_prepareData:function(a){var b=arguments.callee.upper.call(this,a);b.panels=b.items;b.HAlign="text-align:"+b.HAlign+";";return b},_prepareItem:function(a,b){var c="display:none";b.closeDisplay=b.closeBtn?"":c;b.popDisplay=b.popBtn?"":c;b._opt=b.optBtn?"":c;b.itemDisplay=b.hidden?c:""},getDropKeys:function(a,b){return a.properties[a.getKey(linb.use(b).id())==a.keys.PANEL?"dropKeys":"dropKeysPanel"]},_showTips:function(b,d,g){if(b.properties.disableTips){return}if(b.onShowTips){return b.boxing().onShowTips(b,d,g)}if(!linb.Tips){return}var f=d.id,e=b.properties,c=b.keys,a=b.getKey(f);if(!f){return false}return arguments.callee.upper.apply(this,arguments)},_onresize:function(d,b,j,a,i){var m=d.properties,k=d.getItemByItemId(i);if(!k){i=m.$UIvalue}k=d.getItemByItemId(i);var c=d.boxing().getPanel(i),f=d.getSubNode("LIST"),h;if(!c||c.isEmpty()){return}var g=null,e=null;if(a){k._w=k._h=null}if(j&&k._h!=j){k._h=j;if(j&&j!="auto"){h=f.get(0).offsetHeight||f.offsetHeight();j=j-h;if(j>0){g=j}}else{g=j}}if(b&&k._w!=b){f.width(k._w=b);this._adjustScroll(d);e=b}if(g||e){c.height(g).onSize()}},_adjustScroll:function(c,f){var g=c.getSubNode("LIST"),j=g.offsetWidth(),h=c.getSubNode("ITEMS"),e=h.left(),b=c.getSubNode("LEFT"),k=c.getSubNode("RIGHT"),a=0,d=0,i=0;h.children().each(function(l){if(f&&c.getItemIdByDom(l.id)==f){d=a;i=l.offsetWidth}a+=l.offsetWidth});h.width(Math.max(a,j));if(a<=j){h.left(0);c._$scroll_r=c._$scroll_l=0;h.css("cursor","")}else{if(i){if((d+e<0)||(d+i-e>j)){e=-d}}if(a+e<j){h.left(j-a);c._$scroll_r=a-j;c._$scroll_l=0}else{h.left(e);c._$scroll_r=-e;c._$scroll_l=a-j+e}h.css("cursor","move")}b.css("display",c._$scroll_r?"block":"none");k.css("display",c._$scroll_l?"block":"none")}}});Class("linb.UI.Stacks","linb.UI.Tabs",{Initialize:function(){var a=this.getTemplate();a.BOX={tagName:"div",LIST:a.LIST,PNAELS:a.PNAELS};delete a.LIST;delete a.PNAELS;delete a.LEFT;delete a.TOP;this.setTemplate(a)},Static:{Appearances:{BOX:{border:"solid 1px #648CB4",position:"absolute",left:0,top:0},LIST:{position:"static"},ITEMS:{position:"static"},ITEM:{$order:0,display:"block",position:"absolute",cursor:"pointer",background:linb.UI.$bg("bar_vertical.gif","repeat-x left -380px",true),width:"100%",left:0},ITEMC:{display:"block"},ITEMI:{display:"block"},"ITEM-mouseover":{$order:1,"background-position":"right -410px"},"ITEM-mousedown, ITEM-checked":{$order:2,"background-position":"right -440px"},HANDLE:{cursor:"pointer",display:"block","font-size":"12px",height:"100%",height:"18px",padding:"5px 0 5px 8px","white-space":"nowrap"},PANEL:{position:"absolute",display:"none",overflow:"auto"},CMDS:{position:"absolute",top:"6px",right:"8px","text-align":"right","vertical-align":"middle"}},DataModel:{$border:1,NoPanel:null},_onresize:function(d,b,p,a,m){var r=d.properties,q=d.getItemByItemId(m),l=r.$border*2;if(!q){m=r.$UIvalue}var n,i,g,f,k,e=null,h=null,j=d.getSubNode("BOX"),c=d.boxing().getPanel(m);if(!c||c.isEmpty()){return}if(p){p-=l;g=i=0;_.arr.each(r.items,function(s){f=d.getSubNodeByItemId("ITEM",s.id);f.cssRegion({bottom:"auto",top:i});i+=f.height();if(s.id==m){return false}});_.arr.each(r.items,function(s){if(s.id==m){return false}f=d.getSubNodeByItemId("ITEM",s.id);f.cssRegion({top:"auto",bottom:g});g+=f.height()},null,true);n=p-i-g;if(n>0){k=i;h=n}j.height(p)}if(b){b-=l;e=b;j.width(b)}c.cssRegion({width:e?e:null,height:h?h:null,top:k,left:0},true);if(e){d.getSubNode("LIST").width(e)}},_adjustScroll:null}});Class("linb.UI.Panel","linb.UI.Div",{Instance:{activate:function(b){var c,a=this.constructor;if(c=linb.UI._cache["$"+a.activeWndId]){c.getSubNode("TBAR").tagClass("-focus",false)}delete a.activeWndId;if(b!==false){c=this.get(0);c.getSubNode("TBAR").tagClass("-focus");c.getSubNode("CAPTION").focus();a.activeWndId=c.$linbid}},resetPanelView:function(b){if(!_.isSet(b)){b=true}var a;return this.each(function(c){if(c.renderId){delete c.$ini;a=c.boxing();a.removeChildren(true,b);if(c.properties.toggle){a.setToggle(false)}}})}},Static:{Templates:{tagName:"div",style:"{_style}",BORDER:{tagName:"div",TBAR:{tagName:"div",className:"uibar-top",BART:{cellpadding:"0",cellspacing:"0",width:"100%",height:"100%",border:"0",tagName:"table",className:"uibar-t",BARTR:{tagName:"tr",BARTDL:{tagName:"td",className:"uibar-tdl"},BARTDM:{$order:1,width:"100%",tagName:"td",className:"uibar-tdm"},BARTDR:{$order:2,tagName:"td",className:"uibar-tdr"}}},BARCMDL:{tagName:"div",className:"uibar-cmdl",TOGGLE:{className:"uicmd-toggle {toggleCls}",style:"{toggleDisplay}",$order:0},ICON:{$order:0,className:"ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat} {imageDisplay}"},CAPTION:{tabindex:"{tabindex}",text:"{caption}",$order:1}},BARCMDR:{tagName:"div",className:"uibar-cmdr",OPT:{className:"uicmd-opt",style:"{optDisplay}",$order:1},POP:{className:"uicmd-pop",style:"{popDisplay}",$order:2},REFRESH:{className:"uicmd-refresh",style:"{refreshDisplay}",$order:3},CLOSE:{className:"uicmd-close ",style:"{closeDisplay}",$order:4}}},MAIN:{$order:2,tagName:"div",className:"uicon-main",MAINI:{tagName:"div",className:"uicon-maini",PANEL:{tagName:"div",className:"{_bordertype}",style:"{panelDisplay}",text:"{html}"+linb.UI.$childTag}}},BBAR:{$order:3,tagName:"div",className:"uibar-bottom-s",BBART:{cellpadding:"0",cellspacing:"0",width:"100%",border:"0",tagName:"table",className:"uibar-t",BBARTR:{tagName:"tr",BBARTDL:{tagName:"td",className:"uibar-tdl"},BBARTDM:{$order:1,width:"100%",tagName:"td",className:"uibar-tdm"},BBARTDR:{$order:2,tagName:"td",className:"uibar-tdr"}}}}}},Appearances:{KEY:{overflow:"hidden",background:"transparent"},"KEY BORDER":{zoom:linb.browser.ie6?1:null},PANEL:{position:"relative",left:0,top:0,overflow:"hidden",zoom:linb.browser.ie6?1:null},CAPTION:{"font-size":"12px",cursor:"pointer",display:"inline","vertical-align":linb.browser.ie6?"baseline":"middle"}},Behaviors:{DropableKeys:["PANEL"],DragableKeys:["TBAR"],NoDragableKeys:["OPT","CLOSE","POP","REFRESH","TOGGLE","CAPTION"],HoverEffected:{OPT:"OPT",CLOSE:"CLOSE",POP:"POP",REFRESH:"REFRESH",TOGGLE:"TOGGLE"},ClickEffected:{CLOSE:"CLOSE",OPT:"OPT",POP:"POP",REFRESH:"REFRESH",TOGGLE:"TOGGLE"},onSize:linb.UI.$onSize,OPT:{onClick:function(a,b,c){a.boxing().onShowOptions(a,b,c)}},REFRESH:{onClick:function(a,b,c){a.boxing().onRefresh(a)}},TOGGLE:{onClick:function(a,b,c){a.box._toggle(a,!a.properties.toggle);return false}},CAPTION:{onClick:function(a,b,c){if(!a.onClickBar||false===a.boxing().onClickBar(a,c)){return !!linb.Event.getKey(b)[2]}}},CLOSE:{onClick:function(c,d,f){var b=c.properties;if(b.disabled){return}var a=c.boxing();if(false===a.beforeClose(c)){return}a.destroy();return false}},POP:{onClick:function(b,d,a){var f=b.properties;if(f.disabled){return}var h=b.getRoot().offset(),j=b.getRoot().cssSize();if(b.beforePop&&false==b.boxing().beforePop(b)){return false}var i=_.copy(linb.UI.Dialog.$DataStruct);_.merge(i,f,"with");_.merge(i,{dock:"none",width:Math.max(j.width,200),height:Math.max(j.height,100),left:h.left,top:h.top},"all");var g=new linb.UI.Dialog(i),c=[];linb("body").append(g);_.arr.each(b.children,function(e){c.push(e[0])});g.append(linb.UI.pack(c,false));b.boxing().destroy();return false}}},DataModel:{position:"absolute",zIndex:0,dock:"fill",caption:{ini:undefined,action:function(a){this.getSubNode("CAPTION").get(0).innerHTML=a}},image:{action:function(a){this.getSubNode("ICON").css("display",a?"":"none").css("backgroundImage","url("+(a||"")+")")}},imagePos:{action:function(a){this.getSubNode("ICON").css("backgroundPosition",a)}},html:{action:function(a){this.getSubNode("PANEL").html(a)}},toggle:{ini:true,action:function(a){this.box._toggle(this,a)}},optBtn:{ini:false,action:function(a){this.getSubNode("OPT").css("display",a?"":"none")}},toggleBtn:{ini:false,action:function(a){this.getSubNode("TOGGLE").css("display",a?"":"none")}},closeBtn:{ini:false,action:function(a){this.getSubNode("CLOSE").css("display",a?"":"none")}},refreshBtn:{ini:false,action:function(a){this.getSubNode("REFRESH").css("display",a?"":"none")}},popBtn:{ini:false,action:function(a){this.getSubNode("POP").css("display",a?"":"none")}},borderType:{ini:"inset",listbox:["none","flat","inset","outset"],action:function(b){var d=this,g=d.properties,e=d.getSubNode("PANEL"),c=/^uiborder-/,f="uiborder-",a=d.getRoot();e.removeClass(c);e.addClass(f+b);linb.UI.$tryResize(d,a.get(0).style.width,a.get(0).style.height,true)}}},EventHandlers:{onRefresh:function(a){},beforePop:function(a){},beforeClose:function(a){},onIniPanelView:function(a){},beforeFold:function(a){},beforeExpend:function(a){},afterFold:function(a){},afterExpend:function(a){},onShowOptions:function(a,b,c){},onClickBar:function(a,b){}},LayoutTrigger:function(){var c=this,d=c.properties,a=c.box;if(d.toggle){a._toggle(c,d.toggle)}},_prepareData:function(b){var c=arguments.callee.upper.call(this,b);var a="display:none";c.panelDisplay=c.toggle?"":a;c.toggleCls=c.toggle?"uicmd-toggle-checked":"";c.toggleDisplay=c.toggleBtn?"":a;c.optDisplay=c.optBtn?"":a;c.closeDisplay=c.closeBtn?"":a;c.popDisplay=c.popBtn?"":a;c.refreshDisplay=c.refreshBtn?"":a;c._bordertype="uiborder-"+c.borderType;b._toggle=!!c.toggle;return c},_onresize:function(b,a,k){var j={},i=b.getSubNode("TBAR"),h=b.getSubNode("PANEL"),g=b.getSubNode("BBAR"),e=b.getSubNode("MAIN"),d=b.getSubNode("MAINI"),m=b.properties.borderType=="none"?0:2,f,c,l;if(k){if(k=="auto"){j.height=k}else{f=i.height(),c=g.height();if((l=k-f-c)>0){j.height=l-m}}}if(a){j.width=a-(parseInt(d.css("paddingRight"))||0)-(parseInt(e.css("paddingLeft"))||0)-h._borderW()}h.cssSize(j,true)},_toggle:function(c,d){var e=c.properties,a=c.boxing();if(d&&!c.$ini){if(a.onIniPanelView){if(a.onIniPanelView(c)!==false){c.$ini=true}}}if(c._toggle!==!!d){c._toggle=e.toggle=!!d;if(d){if(a.beforeExpend&&false===a.beforeExpend(c)){return}}else{if(a.beforeFold&&false===a.beforeFold(c)){return}}c.getSubNode("PANEL").css("display",d?"":"none");if(e.toggleBtn){c.getSubNode("TOGGLE").tagClass("-checked",!!d)}if(d){if(a.afterExpend){a.afterExpend(c)}}else{if(a.afterFold){a.afterFold(c)}}}}}});Class("linb.UI.Image","linb.UI",{Instance:{getRate:function(){return parseFloat(this.get(0)._rate)||1}},Static:{Templates:{tagName:"image",style:"{_style}",border:"0",width:"{width}",height:"{height}",alt:"{alt}"},Behaviors:{HoverEffected:{KEY:"KEY"},ClickEffected:{KEY:"KEY"},DragableKeys:["KEY"],onError:function(a,b,c){a.boxing().onError(a)},onLoad:function(c,f,g){var b=new Image(),d=b.src=linb.use(g).get(0).src,a=c.box._adjust(c,b.width,b.height);c.boxing().afterLoad(c,d,a[0],a[1])},onClick:function(a,c,d){var b=a.properties;if(b.disabled){return false}if(a.onClick){a.boxing().onClick(a,c,d)}},onDblclick:function(a,c,d){var b=a.properties;if(b.disabled){return false}if(a.onDblclick){a.boxing().onDblclick(a,c,d)}}},RenderTrigger:function(){var b=this,c=b.properties,a=c.src;if(a){c.value=c.$UIvalue="";b.boxing().setSrc(a,true)}},EventHandlers:{onClick:function(a,b,c){},onDblclick:function(a,b,c){},onError:function(a){},beforeLoad:function(a){},afterLoad:function(c,d,b,a){}},_adjust:function(e,d,a){var h=e.properties,g=e.getRootNode();if(d>0&&a>0){var c=h.maxWidth/d,b=h.maxHeight/a,f=c<b?c:b;if(f>=1){f=1}e._rate=f;g.width=d*f;g.height=a*f;return[d*f,a*f]}return[0,0]},DataModel:{maxWidth:{ini:800,action:function(a){var b=this.getRootNode();this.box._adjust(this,b.width,b.height)}},maxHeight:{ini:600,action:function(a){var b=this.getRootNode();this.box._adjust(this,b.width,b.height)}},width:{ini:"",action:function(a){var b=this.getRootNode();b.width=a}},height:{ini:"",action:function(a){var b=this.getRootNode();b.height=a}},src:{ini:linb.ini.file_bg,action:function(b){var a=this;if(false!==a.boxing().beforeLoad(this)){_.asyRun(function(){a.getRoot().attr({width:"0",height:"0",src:b})})}}},alt:{action:function(a){this.getRoot().attr("alt",a)}}}}});Class("linb.UI.IconList","linb.UI.List",{Instance:{getStatus:function(b){var a=this.get(0).getItemByItemId(b);return(a&&a._status)||"ini"}},Initialize:function(){var a=this.getTemplate();a.$submap={items:{ITEM:{tabindex:"{_tabindex}",className:"{itemClass} {disabled}  {readonly}",style:"padding:{itemPadding}px;margin:{itemMargin}px;{itemStyle}",IBWRAP:{tagName:"div",IMAGE:{tagName:"img",src:"{image}",width:"{itemWidth}",height:"{itemHeight}",style:"{imgStyle}"}}}}};this.setTemplate(a)},Static:{Appearances:{KEY:{overflow:"auto","overflow-x":(linb.browser.ie||linb.browser.gek)?"hidden":""},ITEMS:{overflow:"auto","overflow-x":(linb.browser.ie||linb.browser.gek)?"hidden":"",position:"relative","line-height":"14px",zoom:linb.browser.ie6?1:null},ITEM:{display:linb.$inlineBlock,zoom:linb.browser.ie6?1:null,position:"relative",cursor:"pointer",border:"solid 1px #C2E4FC","vertical-align":"top"},IBWRAP:{"font-size":0,"line-height":0},"ITEM-mouseover":{$order:1,padding:0,border:"solid 1px #a0c8f0","background-color":"#e1f0ff"},"ITEM-mousedown":{$order:2,padding:0,border:"solid 1px #dcdcdc","background-color":"#bbcef1"},"ITEM-checked":{$order:2,padding:0,border:"solid 1px #bbcef1","background-color":"#bbcef1"}},Behaviors:{IMAGE:{onLoad:function(a,c,d){var b=a.getItemByDom(d);b._status="loaded"},onError:function(a,c,d){var b=a.getItemByDom(d);b._status="error"}}},DataModel:({itemMargin:{ini:6,action:function(a){if(typeof a!="object"){this.getSubNode("ITEM",true).css("margin",(""+parseFloat(a))==(""+a)?a+"px":a)}else{this.getSubNode("ITEM",true).css(a)}}},itemPadding:{ini:2,action:function(a){if(typeof a!="object"){this.getSubNode("ITEM",true).css("padding",(""+parseFloat(a))==(""+a)?a+"px":a)}else{this.getSubNode("ITEM",true).css(a)}}},itemWidth:{ini:16,action:function(a){this.getSubNode("IMAGE",true).width(a)}},itemHeight:{ini:16,action:function(a){this.getSubNode("IMAGE",true).height(a)}},width:200,height:200}),_prepareItem:function(a,b){var c=a.properties;_.arr.each(_.toArr("itemWidth,itemHeight,itemPadding,itemMargin"),function(d){b[d]=b[d]||c[d]});b._tabindex=c.tabindex}}});Class("linb.UI.Dialog","linb.UI.Widget",{Instance:{showModal:function(a,c,b){this.show(a,true,c,b)},show:function(a,b,d,c){a=a||linb("body");return this.each(function(h){var g,i=h.properties,e=h.boxing(),f=function(){var k=h.boxing();if(d||d===0){k.setLeft(d)}if(c||c===0){k.setTop(c)}a.append(k);var m=h.box,j=h.getRoot();var l=h._$rs_args;linb.UI.$doResize(h,(l&&l[1])||i.width,(l&&l[2])||i.height);j.show(d?(parseInt(d)||0)+"px":null,c?(parseInt(c)||0)+"px":null);if(b&&!h.$inModal){m._modal(h)}k.activate();if(h.onShow){h.boxing().onShow(h)}if(h.properties.status=="normal"){m._refreshRegion(h)}delete h.inShowing};if(h.inShowing){return}h.inShowing=1;if(g=i.fromRegion){linb.Dom.animate({border:"dashed 1px #ff0000"},{left:[g.left,i.left],top:[g.top,i.top],width:[g.width,i.width],height:[g.height,i.height]},null,f,360,12,"expoIn").start()}else{f()}})},hide:function(){this.each(function(d){var f=d.properties,e=d.box,b=d.getRoot();if(d.inHiding){return}d.inHiding=1;if(d.$inModal){e._unModal(d)}if(f.status=="max"||f.status=="min"){e._restore(d)}b.hide();var c=f.fromRegion,a=function(){delete d.inHiding};if(c){linb.Dom.animate({border:"dashed 1px #ff0000"},{left:[f.left,c.left],top:[f.top,c.top],width:[f.width,c.width],height:[f.height,c.height]},null,a,360,12,"expoOut").start()}else{a()}});return this},close:function(){return this.each(function(c){if(c.beforeClose&&false===c.boxing().beforeClose(c)){return}if(c.inClosing){return}c.inClosing=1;var d=c.properties,b=d.fromRegion,a=function(){c.boxing().destroy();delete c.inClosing};if(b){linb.Dom.animate({border:"dashed 1px #ff0000"},{left:[d.left,b.left],top:[d.top,b.top],width:[d.width,b.width],height:[d.height,b.height]},null,a,360,12,"expoOut").start()}else{a()}})},activate:function(a){var b=this.get(0);b.box._active(b,a);if(a!==false){_.resetRun("dlg_focus:"+b.$linbid,function(){b.getRoot().nextFocus()})}}},Initialize:function(){var b=this,a=b.getTemplate();_.merge(a.FRAME.BORDER,{TABSTOP1:{$order:-1},TBAR:{tagName:"div",className:"uibar-top",TBART:{cellpadding:"0",cellspacing:"0",width:"100%",border:"0",tagName:"table",className:"uibar-t",TBARTR:{tagName:"tr",TBARTDL:{tagName:"td",className:"uibar-tdl"},TBARTDM:{$order:1,width:"100%",tagName:"td",className:"uibar-tdm"},TBARTDR:{$order:2,tagName:"td",className:"uibar-tdr"}}},BARCMDL:{$order:1,tagName:"div",className:"uibar-cmdl",ICON:{$order:0,className:"ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat} {imageDisplay}"},CAPTION:{$order:1,text:"{caption}"}},BARCMDR:{$order:2,tagName:"div",className:"uibar-cmdr",OPT:{className:"uicmd-opt",style:"{optDisplay}",$order:1},PIN:{$order:2,className:"uicmd-pin",style:"{pinDisplay}"},LAND:{$order:3,className:"uicmd-land",style:"{landDisplay}"},REFRESH:{className:"uicmd-refresh",style:"{refreshDisplay}",$order:4},MIN:{$order:5,className:"uicmd-min",style:"{minDisplay}"},RESTORE:{$order:6,className:"uicmd-restore",style:"display:none;"},MAX:{$order:7,className:"uicmd-max",style:"{maxDisplay}"},CLOSE:{$order:8,className:"uicmd-close ",style:"{closeDisplay}"}}},MAIN:{$order:2,tagName:"div",className:"uicon-main",MAINI:{tagName:"div",className:"uicon-maini",PANEL:{tagName:"div",text:"{html}"+linb.UI.$childTag}}},BBAR:{$order:3,tagName:"div",className:"uibar-bottom",BBART:{cellpadding:"0",cellspacing:"0",width:"100%",border:"0",tagName:"table",className:"uibar-t",BBARTR:{tagName:"tr",BBARTDL:{tagName:"td",className:"uibar-tdl"},BBARTDM:{$order:1,width:"100%",tagName:"td",className:"uibar-tdm"},BBARTDR:{$order:2,tagName:"td",className:"uibar-tdr"}}}},TABSTOP2:{$order:9}},"all");b.setTemplate(a);linb.alert=b.alert;linb.confirm=b.confirm;linb.pop=b.pop;linb.prompt=b.prompt},Static:{Appearances:{KEY:{overflow:"visible"},"TABSTOP1,TABSTOP2":{height:0,width:"16px",display:"inline",position:"absolute"},PANEL:{position:"relative",overflow:"auto","font-size":"12px","line-height":"14px"},CAPTION:{"font-size":"12px",display:"inline","vertical-align":linb.browser.ie6?"baseline":"middle"},BORDER:{position:"relative","font-size":0,"line-height":0}},Behaviors:{DropableKeys:["PANEL"],DragableKeys:["LAND"],HoverEffected:{OPT:"OPT",PIN:"PIN",MIN:"MIN",MAX:"MAX",RESTORE:"RESTORE",CLOSE:"CLOSE",REFRESH:"REFRESH",LAND:"LAND"},ClickEffected:{OPT:"OPT",PIN:"PIN",MIN:"MIN",MAX:"MAX",RESTORE:"RESTORE",CLOSE:"CLOSE",REFRESH:"REFRESH",LAND:"LAND"},onMousedown:function(a,b){a.box._active(a)},beforeKeydown:function(f,h){var g=linb.Event.getKey(h);if((h.$key||h.keyCode||h.charCode)==9){if(linb.browser.ie){var i="linb::_specialforietab";if(!linb.Dom.byId(i)){linb("body").append("<div style='display:none;position:absolute;' id="+i+"></div>")}linb.Dom.byId(i).innerHTML=_()+""}var d=f.getSubNode("TABSTOP1").get(0),c=f.getSubNode("TABSTOP2").get(0),a=linb.Event.getSrc(h),b;if(g[2]){if(a!==d){d.tabIndex=a.tabIndex}c.removeAttribute("tabIndex")}else{if(a!==c){c.tabIndex=a.tabIndex}d.removeAttribute("tabIndex")}d=c=a=null}},onDragstop:function(c){var e=c.getRoot().cssPos(),d=c.properties,a=null,b=null;if(d.left!==e.left){d.left=a=e.left}if(d.top!==e.top){d.top=b=e.top}if(c.onMove&&(a!==null||b!==null)){c.boxing().onMove(c,a,b,null,null)}},TABSTOP1:{onFocus:function(f,k,a){var h=parseInt(linb.use(a).get(0).tabIndex||1+"")-1;var c=f.getRoot().get(0).getElementsByTagName("*"),m,d;for(var j=0,g=c.length,b;b=c[j];j++){if(b.nodeType==1){if(b.tabIndex&&b.tabIndex<=h){if(!m){m=(d=b).tabIndex}if(b.tabIndex>m){m=(d=b).tabIndex}if(m===h){break}}}}if(b){linb(b).focus();linb.use(a).get(0).tabIndex=b.tabIndex}else{b=f.getRoot().nextFocus(false,true,false);linb(b).focus();linb.use(a).get(0).tabIndex=b.get(0).tabIndex}c=b=null}},TABSTOP2:{onFocus:function(f,j,a){tabindex=parseInt(linb.use(a).get(0).tabIndex||1+"")+1;var c=f.getRoot().get(0).getElementsByTagName("*"),k,d;for(var h=0,g=c.length,b;b=c[h];h++){if(b.nodeType==1){if(b.tabIndex&&b.tabIndex>=tabindex){if(!k){k=(d=b).tabIndex}if(b.tabIndex<k){k=(d=b).tabIndex}if(k===tabindex){break}}}}if(b){linb(b).focus();linb.use(a).get(0).tabIndex=b.tabIndex}else{b=f.getRoot().nextFocus(true,true,false);linb(b).focus();linb.use(a).get(0).tabIndex=b.get(0).tabIndex}c=b=null}},TBAR:{onMousedown:function(a,b,c){if(a.getKey(linb.Event.getSrc(b).parentNode.id)==a.keys.BARCMDR){return}if(a.properties.movable&&!a._locked){a.box._active(a);a.getRoot().startDrag(b,{dragDefer:1,maxTopOffset:a.getRoot().top(),maxLeftOffset:a.getRoot().left(),targetOffsetParent:a.getRoot().parent()})}},onDblclick:function(a,b,c){if(a.getKey(linb.Event.getSrc(b).parentNode.id)==a.keys.BARCMDR){return}if(!a.properties.maxBtn){return}if(a.properties.status=="max"){a.box._restore(a)}else{a.box._max(a)}}},PIN:{onClick:function(c,d,f){var b=c.keys.PIN,a=c.properties;a.pinned=!a.pinned;c.getSubNode("PIN").tagClass("-checked",a.pinned);c._locked=a.pinned;if(a.resizer){if(!a.pinned){if(a.status!="min"&&c.$resizer){c.$resizer.show()}}else{if(c.$resizer){c.$resizer.hide()}}}}},MIN:{onClick:function(a,b,c){a.box._min(a)}},MAX:{onClick:function(a,b,c){a.box._max(a)}},RESTORE:{onClick:function(a,b,c){a.box._restore(a)}},OPT:{onClick:function(a,b,c){a.boxing().onShowOptions(a,b,c)}},REFRESH:{onClick:function(a,b,c){a.boxing().onRefresh(a)}},CLOSE:{onClick:function(a,b,c){a.boxing().close()}}},DataModel:{tips:null,border:null,disabled:null,dock:{hidden:true},html:{action:function(a){this.getSubNode("PANEL").html(a)}},caption:{ini:undefined,action:function(a){this.getSubNode("CAPTION").get(0).innerHTML=a}},image:{action:function(a){this.getSubNode("ICON").css("display",a?"":"none").css("backgroundImage","url("+(a||"")+")")}},imagePos:{action:function(a){this.getSubNode("ICON").css("backgroundPosition",a)}},shadow:true,resizer:true,movable:true,minBtn:{ini:true,action:function(a){var b=this.getSubNode("MIN");if(a){b.setInlineBlock()}else{b.css("display","none")}}},maxBtn:{ini:true,action:function(a){var b=this.getSubNode("MAX");if(a){b.setInlineBlock()}else{b.css("display","none")}}},optBtn:{ini:false,action:function(a){this.getSubNode("OPT").css("display",a?"":"none")}},closeBtn:{ini:true,action:function(a){var b=this.getSubNode("CLOSE");if(a){b.setInlineBlock()}else{b.css("display","none")}}},refreshBtn:{ini:false,action:function(a){this.getSubNode("REFRESH").css("display",a?"":"none")}},pinBtn:{ini:false,action:function(a){var b=this.getSubNode("PIN");if(a){b.setInlineBlock()}else{b.css("display","none")}}},landBtn:{ini:false,action:function(a){var b=this.getSubNode("LAND");if(a){b.setInlineBlock()}else{b.css("display","none")}}},width:300,height:300,minWidth:200,minHeight:100,position:"absolute",fromRegion:{hidden:true,ini:null},status:{ini:"normal",listbox:["normal","min","max"],action:function(d,e){var c=this,a=c.box;if(d=="min"){a._min(c,e)}else{if(d=="max"){a._max(c,e)}else{a._restore(c,e)}}}}},EventHandlers:{onRefresh:function(a){},onShow:function(a){},beforeClose:function(a){},onShowOptions:function(a,b,c){}},RenderTrigger:function(){this.destroyTrigger=function(){var a=this;if(a.$inModal){a.box._unModal(a)}}},LayoutTrigger:function(){var c=this,d=c.properties,a=c.box;if(d.status=="min"){a._min(c)}else{if(d.status=="max"){a._max(c)}else{linb.UI.$tryResize(c,d.width,d.height)}}},_prepareData:function(c){var d=arguments.callee.upper.call(this,c),b="display:none";d.minDisplay=d.minBtn?"":b;d.maxDisplay=d.maxBtn?"":b;d.optDisplay=d.optBtn?"":b;d.closeDisplay=d.closeBtn?"":b;d.pinDisplay=d.pinBtn?"":b;d.landDisplay=d.landBtn?"":b;d.refreshDisplay=d.refreshBtn?"":b;d.statusDisplay=d.statusDisplay?"":b;d.statusHeight="height:"+d.statusHeight+"px";var a=c.properties.status;if(a=="min"||a=="max"){c.$noR=c.$noS=1}return d},_min:function(c,d){var b=c.getRoot(),f=c.box,a=b.parent(),j=c.properties;if(!d){d=j.status}if(d=="max"){f._unMax(c)}else{f._refreshRegion(c)}c.getSubNodes(["PANEL","STATUS"]).css("display","none");if(j.minBtn){c.getSubNode("RESTORE").setInlineBlock();c.getSubNode("MIN").css("display","none")}if(j.resizer&&c.$resizer){c.$resizer.hide()}if(j.shadow){c.boxing()._unShadow(false)}j.status="min";var i=b.height(),g=c.getSubNode("BORDER").height(),e=c.getSubNode("TBAR").height();b.cssSize({width:j.minWidth,height:e+i-g},true)},_max:function(d,a){var g=d.getRoot(),e=d.box,b=d.boxing(),f=g.parent(),c=d.properties;if(!a){a=c.status}if(a=="min"){e._unMin(d)}else{e._refreshRegion(d)}if(c.pinBtn){d.getSubNode("PIN").css("display","none")}if(c.maxBtn){d.getSubNode("MAX").css("display","none");d.getSubNode("RESTORE").setInlineBlock()}d.old_m=c.movable;c.movable=false;if(c.resizer&&d.$resizer){d.$resizer.hide()}if(c.shadow){b._unShadow(false)}c.status="max";b.setDock("fill")},_restore:function(c,a){var e=c.getRoot(),d=c.box,b=c.properties;if(!a){a=b.status}b.status="normal";if(a=="max"){d._unMax(c)}if(a=="min"){d._unMin(c)}c.getSubNode("RESTORE").css("display","none")},_unMax:function(c){var b=c.properties,a=c.boxing();c.getSubNode("MAX").setInlineBlock();if(b.pinBtn){c.getSubNode("PIN").setInlineBlock()}b.movable=c.old_m;if(b.shadow){a._shadow()}if(b.resizer&&!b.pinned){if(c.$resizer){c.$resizer.show()}else{a._resizer()}}a.setDock("none");linb.UI.$tryResize(c,b.width,b.height,true)},_unMin:function(c){var b=c.properties,a=c.boxing();c.getSubNodes(["PANEL","STATUS"]).css("display","block");c.getSubNode("MIN").setInlineBlock();if(b.shadow){a._shadow()}if(b.resizer&&!b.pinned){if(c.$resizer){c.$resizer.show()}else{a._resizer()}}c.getRoot().cssSize({width:b.width,height:b.height});linb.UI.$tryResize(c,b.width,b.height,true)},_active:function(d,a){var b=this;if(a!==false&&b.activeWndId==d.$linbid){return}b._deActive();if(a!==false){var f=linb(d.domId),e=f.topZindex(),c=f.css("zIndex");f.css("zIndex",e>c?e:c);d.getSubNode("TBAR").tagClass("-focus");b.activeWndId=d.$linbid}},_deActive:function(){var a;if(a=linb.UI._cache["$"+this.activeWndId]){a.getSubNode("TBAR").tagClass("-focus",false)}delete this.activeWndId},_modal:function(c){var b=c.getRoot(),a,e=b.parent(),d;if(!e.isEmpty()){if(!c.$inModal){d=c.$modalDiv;if(!d||!d.get(0)||!d.get(0).parentNode){d=c.$modalDiv=linb.create("<div style='left:0;top:0;position:absolute;overflow:hidden;display:block;z-index:0;cursor:wait;background-image:url("+linb.ini.file_bg+")'></div>")}e.append(d);if(e.get(0)===document.body||e.get(0)===document||e.get(0)===window){e=linb.win}d.css({display:"block",width:Math.max(e.width(),e.scrollWidth())+"px",height:Math.max(e.height(),e.scrollHeight())+"px"}).onMousedown(function(){return false}).topZindex(true);e.onSize(function(f){f=linb(f);d.width(f.width()).height(f.height());_.asyRun(function(){d.width(Math.max(f.width(),f.scrollWidth()));d.height(Math.max(f.height(),f.scrollHeight()))})},"dialog:"+c.serialId);b.css("zIndex",(parseInt(d.css("zIndex"))||0)+1);c.$inModal=true}}},_unModal:function(a){if(a.$inModal){var b=a.$modalDiv.parent();if(b.get(0)===document.body||b.get(0)===document||b.get(0)===window){b=linb.win}b.onSize(null,"dialog:"+a.serialId);a.getRoot().css("zIndex",0);a.getSubNode("BORDER").append(a.$modalDiv.css("display","none"));a.$inModal=false}},_refreshRegion:function(a){if(!a.renderId){return}var b=a.properties;return _.merge(b,a.getRoot().cssRegion(),function(d,c){return b[c]!="auto"})},_adjust:function(f,l,e,a,j){l=l||"";if(!e){e=l;l=""}var b=f.$div.reBoxing(),g="linb:temp:dialog",i=arguments.callee,k,c;if(!linb.Dom.byId(g)){d=i._cache=b.clone(false);linb("body").append(d);d.css({width:"auto",height:"auto",overflow:"visible",position:"absolute",visibility:"visible",left:linb.Dom.HIDE_VALUE,top:linb.Dom.HIDE_VALUE}).id(g,true)}var d=i._cache;d.html(e,false);var m=d.cssSize();b.html(e);if(m.width>500){m.width=500;d.width(500);m.height=d.offsetHeight()+10;d.width("auto")}d.html("",false);if(m.height>400){m.height=400}if(m.width<150){m.width=150}if(m.height<30){m.height=30}b.cssSize(m).css("overflow","auto").show();k=m.width+30;c=m.height+90;f.setCaption(l).setWidth(k).setHeight(c);f.$cmd.reBoxing().left((m.width+30-f.$cmd.reBoxing().width())/2)},alert:function(k,f,j,e,d,i){var h=arguments.callee,g;if(!(g=h.dialog)||(!g.get(0).renderId)){g=h.dialog=new linb.UI.Dialog({minBtn:false,maxBtn:false,pinBtn:false,resizer:false,left:200,top:200},{beforeClose:function(){g.hide();_.tryF(h.onClose);h.onClose=null;return false}});var c=g.$cmd=new linb.UI.Div({bottom:10,width:60,height:24}),b=g.$btn=new linb.UI.SButton({width:60,tabindex:1},{onClick:function(){g.hide();_.tryF(h.onClose);h.onClose=null}});c.append(b);var a=g.$div=new linb.UI.Div({left:10,top:10});g.append(c).append(a).render()}h.onClose=j;g.$btn.setCaption(e||linb.wrapRes("$inline.ok"));linb.UI.Dialog._adjust(g,k,f);g.show(linb("body"),true,d,i);_.resetRun("dlg_focus:"+g.get(0).$linbid,function(){g.$btn.activate()});return g},confirm:function(j,l,k,m,f,c,e,i){var h=arguments.callee,g;if(!(g=h.dialog)||(!g.get(0).renderId)){g=h.dialog=new linb.UI.Dialog({minBtn:false,maxBtn:false,pinBtn:false,resizer:false,left:200,top:200},{beforeClose:function(){g.hide();_.tryF(h.onNo,["close"]);h.onYest=h.onNo=null;return false}});var d=g.$cmd=new linb.UI.Div({bottom:10,width:140,height:24}),b=g.$btn1=new linb.UI.SButton({width:60,tabindex:1,left:0},{onClick:function(){g.hide();_.tryF(h.onYes);h.onYest=h.onNo=null}});d.append(b);b=g.$btn2=new linb.UI.SButton({tabindex:1,width:60,left:80},{onClick:function(){g.hide();_.tryF(h.onNo,["no"]);h.onYest=h.onNo=null}});d.append(b);var a=g.$div=new linb.UI.Div({left:10,top:10});g.append(d).append(a).render()}h.onYes=k;h.onNo=m;g.$btn1.setCaption(f||linb.wrapRes("$inline.yes"));g.$btn2.setCaption(c||linb.wrapRes("$inline.no"));linb.UI.Dialog._adjust(g,j,l);g.show(linb("body"),true,e,i);_.resetRun("dlg_focus:"+g.get(0).$linbid,function(){g.$btn2.activate()});return g},pop:function(g,c,b,f,e){var a=new linb.UI.Dialog({minBtn:false,maxBtn:false,pinBtn:false,resizer:false,left:200||f,top:200||e}),d=a.$cmd=new linb.UI.Div({bottom:10,width:"auto",height:24,CS:"text-align:center;"}).append(a.$btn=new linb.UI.SButton({caption:b||"$inline.ok",tabindex:1,position:"relative"},{onClick:function(){a.destroy()}})),h=a.$div=new linb.UI.Div({left:10,top:10,width:80}).setCustomStyle({KEY:"overflow:visible"});a.append(d).append(h).render();linb.UI.Dialog._adjust(a,g,c);a.show(linb("body"),false,f,e);_.resetRun("dlg_focus:"+a.get(0).$linbid,function(){a.$btn.activate()});return a},prompt:function(k,n,f,l,o,e,b,d,j){var g,i=arguments.callee;if(!(g=i.dialog)||(!g.get(0).renderId)){var m=function(){i.$inp.setValue("");i.onYes=i.onNo=null;i.dialog.hide();return false};g=i.dialog=new linb.UI.Dialog({minBtn:false,maxBtn:false,pinBtn:false,resizer:false,left:200,top:200,width:300,height:130},{beforeClose:function(){_.tryF(i.onNo);return m()}});var a=i.$con=new linb.UI.Div({top:4,left:10,width:270,height:18}),c=new linb.UI.Div({top:65,width:270,height:24}).setCustomStyle("KEY","text-align:center;").append(g.$btn1=new linb.UI.SButton({width:60,left:70,tabindex:1},{onClick:function(){if(false!==_.tryF(i.onYes,[i.$inp.getUIValue()])){return m()}}}));c.append(g.$btn2=new linb.UI.SButton({tabindex:1,left:140,width:60},{onClick:function(){_.tryF(i.onNo);return m()}}));var h=i.$inp=new linb.UI.Input({left:10,top:22,width:270,height:36,multiLines:true});g.append(a).append(c).append(h).render()}g.setCaption(k||"Prompt");i.$con.setHtml(n||"");i.$inp.setValue(f||"",true);i.onYes=l;i.onNo=o;g.$btn1.setCaption(e||linb.wrapRes("$inline.ok"));g.$btn2.setCaption(b||linb.wrapRes("$inline.cancel"));g.show(linb("body"),true,d,j);_.resetRun("dlg_focus:"+g.get(0).$linbid,function(){i.$inp.activate()});return g},_onresize:function(c,b,l,a){if(b&&c.properties.status=="min"){b=c.properties.minWidth}var n=arguments.callee.upper.apply(this,arguments),k={},j=c.getSubNode("TBAR"),i=c.getSubNode("PANEL"),h=c.getSubNode("BBAR"),f=c.getSubNode("MAIN"),e=c.getSubNode("MAINI"),g,d,m;if(l){if(l=="auto"){k.height=l}else{g=j.height(),d=h.height();if((m=n.height-g-d)>0){k.height=m}}}if(b){k.width=n.width-(parseInt(e.css("paddingRight"))||0)-(parseInt(f.css("paddingLeft"))||0)}i.cssSize(k,true)}}});Class("linb.UI.Range",["linb.UI","linb.absValue"],{Instance:{_setCtrlValue:function(a){return this.each(function(f){var d=f.properties,k=d.captionTpl,l=function(b){return f.getSubNode(b)},h=function(b,p){b.cssPos({left:f[p],top:j._x2y(f[p])})},g=function(p,b){p.get(0).style.width=b+"px"},n=l("CAPTION"),o=l("IND1"),m=l("IND2"),e=l("RULER1"),c=l("RULER3"),j=f.box,i=j._v2a(a);f._rate=300/(d.max-d.min);f._v1=Math.round((i[0]-d.min)/(d.max-d.min)*300);f._v2=Math.round((1-(d.max-i[1])/(d.max-d.min))*300);n.html(j._buildTpl(d.singleValue,k,i,d.unit),false);h(o,"_v1");h(m,"_v2");g(e,f._v1+8);g(c,f._v2+8)})},_setDirtyMark:function(){return arguments.callee.upper.apply(this,["BOX"])}},Static:{Templates:{style:"{_style}",BOX:{tagName:"div",RULER:{tagName:"div",IND1:{tabindex:"{tabindex}",style:"{_single}"},IND2:{tabindex:"{tabindex}"},RULER1:{$order:2,style:"{_single}"},RULER3:{}},TAIL:{tagName:"div",CAPTION:{tagName:"div"},MIN:{text:"{min}"},MAX:{text:"{max}"}}}},Appearances:{"KEY, RULER, IND1, IND1":{"font-size":0,"line-height":0,position:"relative"},BOX:{position:"absolute",left:0,top:0,width:"316px"},"CAPTION, IND1, TAIL, MIN":{"font-size":"12px","line-height":"14px"},RULER:{$order:1,position:"relative",height:"30px",overflow:"visible","margin-bottom":"3px",background:linb.UI.$bg("bg.png"),_background:"none",_filter:linb.UI.$ieBg("bg.png")},"RULER1, RULER3":{position:"absolute",left:0,top:0,height:"30px",width:"300px"},RULER1:{background:linb.UI.$bg("bg.png"),_background:"none",_filter:linb.UI.$ieBg("bg.png")},RULER3:{background:linb.UI.$bg("front.png"),_background:"none",_filter:linb.UI.$ieBg("front.png")},"IND1,IND2":{display:linb.$inlineBlock,zoom:linb.browser.ie6?1:null,"z-index":"2",width:"15px",height:"14px",position:"absolute"},IND1:{background:linb.UI.$bg("icons.gif","no-repeat left -225px",true),left:"0px",top:"11px"},IND2:{background:linb.UI.$bg("icons.gif","no-repeat -15px -225px",true),left:"300px",top:"1px"},TAIL:{$order:2,width:"300px",position:"relative"},CAPTION:{position:"relative","text-align":"center"},MIN:{position:"absolute",left:0,top:0},MAX:{position:"absolute",right:0,top:0}},Behaviors:{IND1:{onKeydown:function(a,b,c){a.box._keydown.apply(a.box,[a,b,c,0])},onMousedown:function(b,f,g){var d=b.properties,c=b.box,a=c._v2a(d.$UIvalue);linb.use(g).startDrag(f,{widthIncrement:d.steps?d.width/d.steps:null,dragType:"move",targetReposition:true,horizontalOnly:true,maxLeftOffset:Math.floor(b._v1),maxRightOffset:Math.floor(b._v2-b._v1),dragCursor:"default"});linb.use(g).css("zIndex",10).focus();b.getSubNode("IND2").css("zIndex",5)},onDrag:function(a,b,f){var c=linb.DragDrop.getProfile();a.box._ondrag.apply(a.box,[a,c.curPos.left,f,0])},onDragstop:function(c,j,a){var b=c.properties,h=c.boxing(),k=c._rate,l=linb.DragDrop.getProfile(),i,g=b.$UIvalue.split(":");c._v1=l.curPos.left;g[0]=Math.floor((c._v1)/k+b.min);h.setUIValue(g.join(":"));if(c._v1==c._v2){linb.use(a).css("zIndex",10);c.getSubNode("IND2").css("zIndex",5)}}},IND2:{onKeydown:function(a,b,c){a.box._keydown.apply(a.box,[a,b,c,1])},onMousedown:function(b,f,g){var d=b.properties,c=b.box,a=c._v2a(d.$UIvalue);linb.use(g).startDrag(f,{widthIncrement:d.steps?d.width/d.steps:null,dragType:"move",targetReposition:true,horizontalOnly:true,maxLeftOffset:Math.floor(b._v2-b._v1),maxRightOffset:Math.floor(300-b._v2),dragCursor:"default"});linb.use(g).css("zIndex",10).focus();b.getSubNode("IND1").css("zIndex",5)},onDrag:function(a,b,f){var c=linb.DragDrop.getProfile();a.box._ondrag.apply(a.box,[a,c.curPos.left,f,1])},onDragstop:function(c,j,a){var b=c.properties,h=c.boxing(),k=c._rate,l=linb.DragDrop.getProfile(),i,g=b.$UIvalue.split(":");c._v2=l.curPos.left;g[1]=Math.floor((c._v2)/k+b.min);h.setUIValue(g.join(":"))}}},DataModel:{position:"absolute",width:{ini:300,readonly:true},height:{ini:46,readonly:true},min:{ini:0,action:function(){var c=this,d,e=c.properties,a=c.boxing();a.refresh();if(e.$UIvalue!=(d=this.box._ensureValue(c,e.$UIvalue))){a.setValue(d)}}},max:{ini:100,action:function(){var c=this,d,e=c.properties,a=c.boxing();a.refresh();if(e.$UIvalue!=(d=this.box._ensureValue(c,e.$UIvalue))){a.setValue(d)}}},unit:{ini:"",action:function(){this.boxing()._setCtrlValue(this.properties.$UIvalue)}},steps:0,captionTpl:{ini:"{fromvalue}{unit} - {tovalue}{unit}",action:function(){this.boxing()._setCtrlValue(this.properties.$UIvalue)}},value:"0:100",singleValue:{ini:false,action:function(a){this.boxing().refresh()}}},_prepareData:function(b){var e=arguments.callee.upper.call(this,b);var c=b.properties,a=b.box._v2a(c.value);e._single=c.singleValue?"display:none":"";c.min=parseFloat(c.min);c.max=parseFloat(c.max);e.min=e.min+c.unit;e.max=e.max+c.unit;return e},_ensureValue:function(d,k){if(!k){k=""}var c=d.properties,j=k.split(":"),f=c.min,h=c.max,i=[],g=function(b){return parseFloat(b)},e=function(b){return Math.min(h,Math.max(f,b))};i[0]=g(j[0]);i[1]=g(j[1]);i[0]=Math.min(i[0],i[1]);if(!f){f=i[0]}if(!h){h=i[1]}i[0]=e(i[0]);i[1]=e(i[1]);return i.join(":")},_v2a:function(a){return typeof a=="string"?a.split(":"):a},_buildTpl:function(d,b,a,c){return d?a[1]+c:b.replace(/\{fromvalue\}/g,a[0]).replace(/\{tovalue\}/g,a[1]).replace(/\{unit\}/g,c)},_x2y:function(a){return Math.floor(15+1-(a)*(15/300))},_keydown:function(c,i,a,j){var o=linb.Event.getKey(i);if(o[0]=="left"||o[0]=="right"){var p=linb.use(a).get(0).style,b=parseInt(p.left),n=c.properties,k=n.steps,l=300/k,m,g=function(e){return parseInt(c.getSubNode(e).get(0).style.left)};b+=o[0]=="left"?-1:1;if(k){b=b-b%l;if(o[0]=="right"){b+=l}}if(!n.singleValue){if(j===0){m=g("IND2");if(b>m){b=m}}else{m=g("IND1");if(b<m){b=m}}}if(b<0){b=0}if(b>300){b=300}p.left=b+"px";c.box._ondrag.apply(c.box,[c,b,a,j]);var h=c._rate,d=n.$UIvalue.split(":");if(j===0){c._v1=b;d[0]=Math.floor((c._v1)/h+n.min)}else{c._v2=b;d[1]=Math.floor((c._v2)/h+n.min)}c.boxing().setUIValue(d.join(":"))}},_ondrag:function(h,g,a,r){var c=h.properties,m=linb.DragDrop.getProfile(),k=h.box,n=function(d){return h.getSubNode(d)},i=function(f,d){f.get(0).style.width=d+"px"},o=n("CAPTION"),e=n("RULER1"),b=n("RULER3"),q,l,j=this._v2a(c.$UIvalue);linb.use(a).get(0).style.top=this._x2y(g)+"px";q=Math.floor((g)/h._rate+c.min);if(r){j[1]=q;i(b,g+8)}else{j[0]=q;i(e,g+8)}o.html(k._buildTpl(c.singleValue,c.captionTpl,j,c.unit),false)},_onresize:function(){}}});CONF={basePath:"imglib/",service:"request.php",workingPath:"working/",ComFactoryProfile:{uploader:{cls:"App.Upload"}}};Class("App","linb.Com",{Instance:{events:{onReady:"_onready",onRender:"_onRender"},paras:{sessionname:"",filename:"",tag:"",fileext:"jpg"},getPath:function(a){return CONF.basePath+CONF.workingPath+(a.origin=="demos"?"demos":a.origin=="upload"?("upload/"+a.sessionname):(a.logindate+"/"+a.sessionname))+"/"+a.filename+(a.origin?"":("/"+a.tag))+"."+a.fileext},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a((new linb.UI.Pane).setHost(c,"paneTop").setDomId("paneTop").setWidth("auto").setHeight(36).setPosition("relative"));c.paneTop.append((new linb.UI.Pane).setHost(c,"paneTopRight").setDomId("paneTopRight").setTop(6).setWidth("auto").setHeight(20).setRight(10));c.paneTopRight.append((new linb.UI.Link).setHost(c,"linkLangEn").setLeft(15).setTop(0).setWidth(66).setPosition("relative").setCaption("English").onClick("_linklangen_onclick").setCustomClass({KEY:"btn-lang"}));c.paneTopRight.append((new linb.UI.Link).setHost(c,"linkLangCn").setLeft(10).setTop(0).setPosition("relative").setCaption("\u4e2d\u6587").onClick("_linklangcn_onclick").setCustomClass({KEY:"btn-lang"}));c.paneTop.append((new linb.UI.Div).setHost(c,"vLogo").setDomId("vLogo").setLeft(8).setTop(4).setWidth(32).setHeight(32));c.paneTop.append((new linb.UI.Pane).setHost(c,"panelTopLeft").setDomId("panelTopLeft").setLeft(50).setTop(10).setWidth(300).setHeight(20).setHtml("$app.caption.logo"));a((new linb.UI.Pane).setHost(c,"paneMain").setDomId("paneMain").setWidth("auto").setHeight("auto").setPosition("relative").setCustomStyle({KEY:"margin-left:100px;"}));c.paneMain.append((new linb.UI.Tabs).setHost(c,"tabsCmds").setDomId("tabsCmds").setItems([{id:"basic",caption:"$app.tasks.basic",tips:"$app.tasks.basicTips"},{id:"crop",caption:"$app.tasks.crop",tips:"$app.tasks.cropTips"},{id:"frm",caption:"$app.tasks.frm",tips:"$app.tasks.frmTips"},{id:"frm2",caption:"$app.tasks.frm2",tips:"$app.tasks.frm2Tips"},{id:"text",caption:"$app.tasks.text",tips:"$app.tasks.textTips"},{id:"resize",caption:"$app.tasks.resize",tips:"$app.tasks.resizeTips"}]).setDock("none").setWidth("auto").setHeight(95).setPosition("relative").setHAlign("center").onItemSelected("_tb_onitemseltected").setCustomStyle({PANEL:"border-left:solid 1px #C87800;border-right:solid 1px #C87800;",KEY:"border-bottom:solid 1px #C87800;"}));c.tabsCmds.append((new linb.UI.Button).setHost(c,"btnRot").setLeft(661).setTop(6).setWidth(110).setCaption("$app.basic.rot").beforeHoverEffect("_btnrot_beforehovereffect"),"basic");c.tabsCmds.append((new linb.UI.Button).setHost(c,"btnMir").setLeft(781).setTop(6).setWidth(110).setCaption("$app.basic.mir").beforeHoverEffect("_btnmir_beforehovereffect"),"basic");c.tabsCmds.append((new linb.UI.Button).setHost(c,"btnOne").setLeft(661).setTop(36).setWidth(110).setCaption("$app.basic.one").beforeHoverEffect("_btnone_beforehovereffect"),"basic");c.tabsCmds.append((new linb.UI.Button).setHost(c,"btnFilter").setLeft(781).setTop(36).setWidth(110).setCaption("$app.basic.filter").beforeHoverEffect("_btnfilter_beforehovereffect"),"basic");c.tabsCmds.append((new linb.UI.Button).setHost(c,"btnApply").setLeft(11).setTop(36).setCaption("$app.caption.applyCrop").onClick("_crop_onclick"),"crop");c.tabsCmds.append((new linb.UI.Button).setHost(c,"btnResizeApply").setLeft(10).setTop(36).setCaption("$app.caption.applyResize").onClick("_resize_onclick"),"resize");c.tabsCmds.append((new linb.UI.Div).setHost(c,"vFont").setLeft(351).setTop(21).setHeight(20).setHtml("$app.addtext.font").setCustomClass({KEY:"app-label"}),"text");c.tabsCmds.append((new linb.UI.Div).setHost(c,"vFontSize").setLeft(141).setTop(8).setWidth(80).setHeight(20).setHtml("$app.addtext.fontsize").setCustomClass({KEY:"app-label"}),"text");c.tabsCmds.append((new linb.UI.Div).setHost(c,"vFontColor").setLeft(121).setTop(41).setHeight(20).setHtml("$app.addtext.fontcolor").setCustomClass({KEY:"app-label"}),"text");c.tabsCmds.append((new linb.UI.Button).setHost(c,"btnAddText").setLeft(11).setTop(34).setWidth(100).setCaption("$app.caption.addtext").onClick("_btnaddtext_onclick"),"text");c.tabsCmds.append((new linb.UI.ComboInput).setHost(c,"ciFontSize").setLeft(231).setTop(7).setWidth(101).setValueFormat("^\\d\\d*$").setType("helpinput").setValue("32").afterUIValueSet("_fontsize_us"),"text");c.tabsCmds.append((new linb.UI.ComboInput).setHost(c,"ciFontColor").setLeft(231).setTop(40).setWidth(101).setInputReadonly(true).setType("colorpicker").setValue("#000000").beforeUIValueSet("_cifontcolor_beforeuivalueset"),"text");c.tabsCmds.append((new linb.UI.Range).setHost(c,"rangeCon").setLeft(10).setTop(11).setZIndex("10").setMin(-100).setSingleValue(true).setValue("-100:0").afterUIValueSet("_rangecon_afteruivalueset"),"basic");c.tabsCmds.append((new linb.UI.Range).setHost(c,"rangeBri").setLeft(331).setTop(11).setZIndex("10").setMin(-100).setSingleValue(true).setValue("-100:0").afterUIValueSet("_rangebri_afteruivalueset"),"basic");c.tabsCmds.append((new linb.UI.Div).setHost(c,"div39").setLeft(21).setTop(3).setWidth(180).setHeight(30).setHtml("$app.basic.con"),"basic");c.tabsCmds.append((new linb.UI.Div).setHost(c,"div40").setLeft(347).setTop(3).setWidth(180).setHeight(30).setHtml("$app.basic.bri"),"basic");c.tabsCmds.append((new linb.UI.Button).setHost(c,"button12").setLeft(21).setTop(36).setZIndex("10").setCaption("$app.caption.applyIcon").onClick("_button12_onclick"),"frm2");c.tabsCmds.append((new linb.UI.Button).setHost(c,"button25").setLeft(171).setTop(38).setZIndex("10").setCaption("$app.caption.applyFrm").onClick("_button13_onclick"),"frm");c.tabsCmds.append((new linb.UI.Div).setHost(c,"div46").setLeft(11).setTop(43).setWidth(80).setHeight(20).setZIndex("10").setHtml("$app.caption.frmbg").setCustomClass({KEY:"app-label"}),"frm");c.tabsCmds.append((new linb.UI.ComboInput).setHost(c,"iBGFrm").setDomId("iBGFrm").setLeft(97).setTop(43).setWidth(70).setZIndex("10").setType("colorpicker").setValue("#FFFFFF").afterUIValueSet("_btnbgfrm_onclick"),"frm");c.tabsCmds.append((new linb.UI.Div).setHost(c,"divFont").setLeft(455).setTop(10).setWidth("auto").setHeight("40").setCustomStyle("KEY","overflow:visible;"),"text");c.paneMain.append((new linb.UI.Pane).setHost(c,"paneInfo").setDomId("paneInfo").setWidth("auto").setHeight("40").setPosition("relative"));c.paneInfo.append((new linb.UI.Div).setHost(c,"vInfo").setDomId("vInfo").setLeft(12).setWidth("auto").setHeight("auto").setPosition("relative"));c.paneInfo.append((new linb.UI.Div).setHost(c,"vInfo2").setDomId("vInfo2").setLeft(12).setWidth("auto").setHeight("auto").setPosition("relative"));c.paneMain.append((new linb.UI.Pane).setHost(c,"panePic").setDomId("panePic").setWidth("auto").setHeight("auto").setPosition("relative"));c.panePic.append((new linb.UI.Pane).setHost(c,"paneImageBorder").setDomId("paneImageBorder").setWidth("auto").setHeight("auto").setPosition("relative"));c.paneImageBorder.append((new linb.UI.Image).setHost(c,"imgBig").setDomId("imgBig").setPosition("relative").onError("_imgbig_onerror").beforeLoad("_imgbig_beforeload").afterLoad("_imgbig_afterload"));c.paneMain.append((new linb.UI.Pane).setHost(c,"paneBottom").setDomId("paneBottom").setWidth("auto").setHeight("auto").setPosition("relative"));a((new linb.UI.Dialog).setHost(c,"dlgHistory").setDomId("dlgHistory").setTop(132).setWidth(200).setRight(0).setShadow(false).setCaption("$app.caption.history").setMaxBtn(false).setCloseBtn(false).setPinBtn(false));c.dlgHistory.append((new linb.UI.IconList).setHost(c,"ilHistory").setDomId("ilHistory").setDock("fill").setItemWidth(32).setItemHeight(32).onItemSelected("_il_onitemseletcted"));a((new linb.UI.Pane).setHost(c,"paneDemo").setDomId("paneDemo").setLeft(4).setTop(155).setWidth(91).setHeight(385));c.paneDemo.append((new linb.UI.Stacks).setHost(c,"stack").setItems([{id:"files",caption:"$app.caption.upload_short"},{id:"demos",caption:"$app.caption.demos_short"}]).setValue("demos"));c.stack.append((new linb.UI.IconList).setHost(c,"ilDemo").setDock("fill").setSelMode("none").setItemWidth(50).setItemHeight(38).onItemSelected("_ildemo_onitemselected"),"demos");c.stack.append((new linb.UI.IconList).setHost(c,"ilPhoto").setDock("fill").setSelMode("none").setItemWidth(50).setItemHeight(38).onItemSelected("_ilphoto_onitemselected"),"files");a((new linb.UI.Button).setHost(c,"btnUpload").setLeft(7).setTop(70).setWidth(85).setHeight(28).setCaption("$app.caption.upload").setVAlign("middle").onClick("_btnupload_click"));a((new linb.UI.Button).setHost(c,"btnSave").setDomId("btnSave").setLeft(7).setTop(116).setWidth(85).setHeight(28).setCaption("$app.caption.save").setVAlign("middle").onClick("_btnsave_click"));a((new linb.UI.ComboInput).setHost(c,"iBGC").setDomId("iBGC").setLeft(4).setTop(40).setWidth(91).setType("colorpicker").afterUIValueSet("_btnbgc_onclick"));return b},_onRender:function(){linb.CSS.includeLink(linb.getPath("css","main.css","default/"));linb("imgBig").setSelectable(false);SPA.tabsCmds.fireItemClickEvent("basic");var a=SPA.ilDemo.getItems()[parseInt(Math.random()*6)];SPA.ilDemo.fireItemClickEvent(a.id);SPA.iBGC.setValue(linb("body").css("backgroundColor"))},_tb_onitemseltected:function(a,b){linb("imgBig").onClick(null).attr({width:null,height:null});SPA.hideResizer();SPA.hideFrm();SPA.hideCrop();SPA.hideIcon();SPA.hideText();switch(SPA.curView=b.id){case"resize":SPA.showResizer();break;case"crop":SPA.showCrop();break;case"text":SPA.showText();var c=_.copy(SPA.paras);c.action="get_font_list";SPA.request1(c,function(e){var d=[],g=function(f){return"<img src="+f.path+" alt="+f.caption+">"};_.each(e.data,function(j,f){var h=CONF.basePath+"font/"+j.preview;d.push({id:f,_obj:j,caption:f,path:h,renderer:g})});SPA.divFont.getRoot().onMouseover(SPA._divfont_mover).onMouseout(SPA._divfont_mout);SPA.$fontFamilies=d;SPA.$fontFamily=d[0].caption;SPA.AddText.getSubNode("INPUT").css("fontFamily",SPA.$fontFamily);SPA.divFont.setHtml('<img style="border:solid 1px #ccc;cursor:pointer;" src='+d[0].path+" alt="+d[0].caption+"/>")});break;case"frm":if(!SPA.ilFrm){SPA.ilFrm=new linb.UI.IconList({selMode:"none",position:"relative",width:"auto",height:"auto",itemWidth:16,itemHeight:16});SPA.ilFrm.onItemSelected(function(d,e){if(d.boxing().getStatus(e.id)=="loaded"){SPA.showFrm(e.image);SPA.$frmId=e.id}else{delete SPA.$frmId}});a.boxing().append(SPA.ilFrm,"frm");var c=_.copy(SPA.paras);c.action="get_modern_list";SPA.request1(c,function(e){var d=[];_.each(e.data,function(h,f){var g=CONF.basePath+"template/modern/"+h.filename;d.push({id:f,_obj:h,image:g,transTips:true,tips:"<img border=0 height=300 src="+g+">"})});SPA.ilFrm.setItems(d)})}break;case"frm2":if(!SPA.ilFrm2){SPA.ilFrm2=new linb.UI.IconList({selMode:"none",position:"relative",width:"auto",height:"auto",itemWidth:16,itemHeight:16});SPA.ilFrm2.onItemSelected(function(d,e){if(d.boxing().getStatus(e.id)=="loaded"){SPA.showIcon(e.image);SPA.$iconId=e.id}else{delete SPA.$iconId}});a.boxing().append(SPA.ilFrm2,"frm2");var c=_.copy(SPA.paras);c.action="get_avatar_list";SPA.request1(c,function(e){var d=[];_.each(e.data,function(h,f){var g=CONF.basePath+"template/avatar/"+h.filename;d.push({id:f,_obj:h,image:g,transTips:true,tips:"<img border=0 height=100 src="+g+">"})});SPA.ilFrm2.setItems(d)})}break}},_linklangen_onclick:function(a,b){linb.setLang("en");linb.Cookies.set("lang","en")},_linklangcn_onclick:function(a,b){linb.setLang("cn");linb.Cookies.set("lang","cn")},_onready:function(){SPA=this;var e=function(f){SPA.request1({action:"listphotos",sessionname:f},function(g){if(g.data.length>0){SPA.stack.setValue("files",true)}SPA.ilPhoto.setItems(g.data)})};var a=linb.Cookies.get("csession");if(!a){SPA.request1({action:"getsession"},function(f){linb.Cookies.set("csession",SPA.paras.sessionname=f.data);e(SPA.paras.sessionname)})}else{e(SPA.paras.sessionname=a)}linb.ComFactory.setProfile(CONF.ComFactoryProfile).prepareComs(_.toArr(CONF.ComFactoryProfile,true));var d=CONF.basePath+CONF.workingPath+"demos/";var b=[{id:"1",big:d+"1.jpg",image:d+"1s.jpg"},{id:"2",big:d+"2.jpg",image:d+"2s.jpg"},{id:"3",big:d+"3.jpg",image:d+"3s.jpg"},{id:"4",big:d+"4.jpg",image:d+"4s.jpg"},{id:"5",big:d+"/5.jpg",image:d+"5s.jpg"},{id:"6",big:d+"6.jpg",image:d+"6s.jpg"},{id:"7",big:d+"7.jpg",image:d+"7s.jpg"}];SPA.ilDemo.setItems(b);SPA.paneBottom.setHtml(linb.wrapRes("app.info"));var c=[];_.arr.each([6,8,10,12,14,16,18,24,32,48],function(f){c.push({id:""+f,caption:'<div style="font-size:'+f+'px">'+f+"px</div>"})});SPA.ciFontSize.setItems(c)},_iniSome:function(){SPA.hideFrm()},_il_onitemseletcted:function(b,c,d){var a=b.boxing();SPA.paras=_.copy(c._obj);SPA.imgBig.setSrc(SPA.getPath(SPA.paras));SPA._iniSome()},_ildemo_onitemselected:function(a,b,c){if(SPA.$curID!=b.id){SPA.$curID=b.id;SPA.vInfo.setHtml(linb.wrapRes("$app.caption.demos")+" : "+b.id+".jpg");SPA.imgBig.setSrc(b.big);_.merge(SPA.paras,{origin:"demos",tag:"",filename:b.id,fileext:"jpg"},"all");SPA._iniSome()}},_ilphoto_onitemselected:function(a,b,c){if(SPA.$curID!=b.id){SPA.$curID=b.id;SPA.vInfo.setHtml(linb.wrapRes("$app.caption.upload")+" : "+b.id+"."+b.ext);SPA.imgBig.setSrc(b.big);_.merge(SPA.paras,{origin:"upload",tag:"",filename:b.id,fileext:b.ext},"all");SPA._iniSome()}},_imgbig_beforeload:function(a){_.resetRun("$changCon",function(){SPA.vInfo2.setHtml('<image src="img/loading.gif"/>');_.resetRun("$imgvisible",function(){SPA.imgBig.setDisplay("none")})})},_imgbig_afterload:function(c,d,b,a){_.resetRun("$changCon",function(){SPA.vInfo2.setHtml(linb.wrapRes("app.caption.width")+' <span class="val-size">'+b+'</span><span style="width:10px;"></span>'+linb.wrapRes("app.caption.height")+' <span class="val-size">'+a+"</span>")});_.resetRun("$imgvisible",function(){SPA.imgBig.setDisplay("")});SPA.$width=b;SPA.$height=a},_imgbig_onerror:function(a){SPA.vInfo2.setHtml('<image src="img/error.gif"/>'+linb.wrapRes("app.imageErr"))},_btnbgc_onclick:function(a,c,b){linb.doc.query("html").css("backgroundColor",b)},_btnbgfrm_onclick:function(a,c,b){if(SPA.frm&&SPA.$frmId){SPA.frm.css("background",b);SPA.$frmBg=b.slice(1)}},showResizer:function(){var a;if(!(a=SPA.resizer)){a=SPA.resizer=linb.create("div").css({zIndex:1001,position:"absolute"});a.addResizer({forceVisible:true,minHeight:50,minWidth:50,maxWidth:800,maxHeight:800,handlerSize:8},function(c,d){var b=c.proxy.cssSize();d.cssSize(b);linb("imgBig").attr("width",b.width).attr("height",b.height)});linb("panePic").append(a)}a.cssPos(linb("imgBig").offset(null,linb("panePic"))).cssSize(linb("imgBig").cssSize())},hideResizer:function(){if(SPA.resizer){SPA.resizer.hide()}},showIcon:function(a){var b;if(!(b=SPA.icon)){b=SPA.icon=linb.create("div").css({zIndex:1001,left:0,top:0,width:"100px",height:"100px",position:"absolute",border:"solid 1px #00ff00"});b.append(linb.create("img"));b.addResizer({forceVisible:true,forceMovable:true,minHeight:10,minWidth:10,maxWidth:800,maxHeight:800,handlerSize:6},function(d,e,c,f){d.box.onUpdate(d,e,c,f);b.first().cssSize(e.cssSize())});linb("panePic").append(b)}b.first().css({width:"auto",height:"auto"}).attr("src",a);b.cssRegion({left:0,top:0,width:b.first().attr("width"),height:b.first().attr("height")});if(linb.browser.ie6){b.first().fixPng("scale")}},hideIcon:function(){delete SPA.$iconId;if(SPA.icon){SPA.icon.hide()}},showFrm:function(a){var d;if(!(d=SPA.frm)){var f,e;d=SPA.frm=linb.create("div").css({cursor:"move",zIndex:1001,left:0,top:0,position:"relative",overflow:"hidden"});d.append(f=linb.create("img"));d.append(e=linb.create("img"));linb("panePic").append(d);f.css({position:"absolute",left:0,top:0,zIndex:1});e.css({position:"absolute",left:0,top:0,zIndex:2});d._left=d._top=0;d.onMousedown(function(i,h,g){linb([this]).startDrag(h,{dragType:"none"})}).onDrag(function(i,h,g){var j=linb.DragDrop.getProfile();f.left(d.$left+j.offset.x).top(d.$top+j.offset.y)}).onDragstop(function(i,h,g){d.$left=f.left();d.$top=f.top()});SPA.imgBig.setDisplay("none")}d.$left=d.$top=0;d.first().cssPos({left:0,top:0});d.last().cssSize({width:"auto",height:"auto"}).attr("src",a);var b={width:d.last().attr("width"),height:d.last().attr("height")};if(linb.browser.ie6){d.last().fixPng("scale")}d.first().attr("src",linb("imgBig").attr("src"));var c=SPA.iBGFrm.getUIValue();SPA.frm.css("background",c);SPA.$frmBg=c.slice(1);d.cssSize(b).cssPos({left:0,top:0});_.resetRun("$imgvisible",function(){SPA.imgBig.setDisplay("none")})},hideFrm:function(){delete SPA.$frmBg;delete SPA.$frmId;SPA.iBGFrm.setValue("#FFFFFF",true);_.resetRun("$imgvisible",function(){SPA.imgBig.setDisplay("")});if(SPA.frm){SPA.frm.hide()}},showCrop:function(){var a;if(!(a=SPA.crop)){a=SPA.crop=linb.create("div").css({zIndex:1001,left:0,top:0,width:"100px",height:"100px",position:"absolute",border:"solid 1px #00ff00"});a.addResizer({forceVisible:true,forceMovable:true,minHeight:10,minWidth:10,maxWidth:800,maxHeight:800,handlerSize:6},function(c,d,b,e){c.box.onUpdate(c,d,b,e)});linb("panePic").append(a)}a.cssRegion({left:0,top:0,width:100,height:100})},hideCrop:function(){if(SPA.crop){SPA.crop.hide()}},showText:function(){var a;if(!(a=SPA.AddText)){a=SPA.AddText=new linb.UI.Input({multiLines:true,resizer:true}).setCustomStyle({BOX:"background:transparent",INPUT:"background:transparent"});linb("panePic").append(a);_.asyRun(function(){var b=a.getSubNode("BORDER").$getResizer();_.merge(b.get(0).properties,{forceVisible:true,forceMovable:true,minHeight:10,singleDir:true,minWidth:10,maxWidth:800,maxHeight:800,handlerSize:8},"all");b.refresh()},100);SPA.AddText.getSubNode("INPUT").css({fontSize:"32px",color:"#000000",fontFamily:SPA.$fontFamily||""})}a.setLeft(0).setTop(0).setWidth(300).setHeight(100).setValue("Freedom")},hideText:function(){if(SPA.AddText){SPA.AddText.hide()}},_btnsave_click:function(){var b="ifr_for_download";if(!linb.Dom.byId(b)){linb("body").append(linb.create('<iframe id="'+b+'" name="'+b+'" style="display:none;"/>'))}var a=_.copy(SPA.paras);a.action="download";linb.Dom.submit(CONF.service,{key:"ImgProcess",para:a},"get",b)},_btnupload_click:function(a,b,c){linb.ComFactory.getCom("uploader",function(){if(!SPA.com_uploader){var g=SPA.com_uploader=this.getUIComponents();linb("body").append(g)}var h=function(i){SPA.stack.setValue("files",true);SPA.ilPhoto.insertItems([i.data],null,false);SPA.ilPhoto.fireItemClickEvent(i.data.id);SPA.ilHistory.clearItems().setTag(i.data.filename);SPA.popMsg(linb.getRes("app.message.uploadOK"))};this.onUpload=function(i){var j={action:"upload",sessionname:SPA.paras.sessionname};SPA.request1(j,h,i);SPA.com_uploader.hide()};this.onOpenWeb=function(i){var j={action:"openweb",sessionname:SPA.paras.sessionname,url:i};SPA.request1(j,h);SPA.com_uploader.hide()};var d=SPA.com_uploader.getRoot(),f=d.cssSize(),e=linb(c).cssSize();d.popToTop(c,4).setBlurTrigger(_(),function(){SPA.com_uploader.hide()})})},base:[],required:["linb.UI.Pane","linb.UI.Link","linb.UI.Div","linb.UI.ComboInput","linb.UI.Tabs","linb.UI.Button","linb.UI.Image","linb.UI.Dialog","linb.UI.IconList","linb.UI.Panel","linb.UI.Range","linb.UI.Stacks"],_showpopmenu:function(f,d,h){var a="__"+h,c="com_"+h;if(d=="mouseover"){_.resetRun(a,null);if(!SPA[c]){var b=[],g=linb.getRes("app."+h);_.each(g,function(k,j){b.push({id:j,caption:"$app."+h+"."+j})});var e=SPA[c]=new linb.UI.PopMenu({autoHide:true,items:b}).render(true);e.getRoot().onMouseover(function(){_.resetRun(a,null)}).onMouseout(function(){_.resetRun(a,function(){SPA[c].hide()})});e.onMenuSelected(function(i,j,l){var k=_.copy(SPA.paras);k.action=j.id;SPA.request2(k)})}SPA[c].pop(f)}else{if(SPA[c]){_.resetRun(a,function(){SPA[c].hide()})}}},_btnrot_beforehovereffect:function(b,c,d,f,a){this._showpopmenu(f,a,"rotation")},_btnmir_beforehovereffect:function(b,c,d,f,a){this._showpopmenu(f,a,"mirror")},_btnfilter_beforehovereffect:function(b,c,d,f,a){this._showpopmenu(f,a,"filter")},_btnone_beforehovereffect:function(b,c,d,f,a){this._showpopmenu(f,a,"onecolor")},_showFontFamily:function(e,c,f){var a="__"+f,b="com_"+f;if(c=="mouseover"){_.resetRun(a,null);if(!SPA[b]){var d=SPA[b]=new linb.UI.List({items:SPA.$fontFamilies,width:"480"}).render(true);d.getRoot().onMouseover(function(){_.resetRun(a,null)}).onMouseout(function(){_.resetRun(a,function(){SPA[b].hide()})});d.onItemSelected(function(g,h,i){SPA[b].hide();SPA.$fontFamily=h.caption;SPA.AddText.getSubNode("INPUT").css("fontFamily",SPA.$fontFamily);SPA.divFont.setHtml('<img style="border:solid 1px #ccc;cursor:pointer;" src='+h.path+" alt="+h.caption+"/>")})}SPA[b].getRoot().popToTop(e)}else{if(SPA[b]){_.resetRun(a,function(){SPA[b].hide()})}}},_divfont_mover:function(a,b,c){SPA._showFontFamily(c,"mouseover","fontfamily")},_divfont_mout:function(a,b,c){SPA._showFontFamily(c,"mouseout","fontfamily")},_fontsize_us:function(b,c,a){if(SPA.AddText){SPA.AddText.getSubNode("INPUT").css("fontSize",a+"px")}},_cifontcolor_beforeuivalueset:function(b,a,c){if(SPA.AddText){SPA.AddText.getSubNode("INPUT").css("color",c)}},_btnaddtext_onclick:function(a){var b=_.copy(SPA.paras);b.action="writetext";b.text=SPA.AddText.getUIValue();b.fontcolor=linb.UI.ColorPicker.hex2rgb(SPA.ciFontColor.getUIValue()).join(",");b.x=SPA.AddText.getLeft();b.fontsize=SPA.ciFontSize.getUIValue();b.fontfile=SPA.$fontFamily;b.y=SPA.AddText.getTop()+Number(b.fontsize);SPA.hideText();SPA.request2(b,function(){SPA.AddText.getSubNode("INPUT").css({fontSize:"32px",color:"#000000"});SPA.AddText.setLeft(0).setTop(0).setWidth(300).setHeight(100);SPA.ciFontSize.setValue("32",true);SPA.ciFontColor.setValue("#000000",true);SPA.showText()})},_crop_onclick:function(b){var a=SPA.imgBig.getRoot(),c=_.copy(SPA.paras);c.action="cut";var d=SPA.crop;reg=d.cssRegion();_.merge(c,reg);SPA.hideCrop();SPA.request2(c,function(){SPA.showCrop()})},_resize_onclick:function(d){var b=SPA.imgBig.getRoot(),a=b.attr("width"),c=b.attr("height"),e=_.copy(SPA.paras);if(a!==SPA.$width||c!=SPA.$height){e.action="resize";e.width=a;e.height=c;SPA.request2(e)}},popMsg:function(b){var a=linb.UI.Dialog.pop(b);_.asyRun(function(){if(a.getRoot()){a.destroy()}a=null},3000)},request1:function(b,c,a){linb.Thread.observableRun(function(f){var e={key:"ImgProcess",para:b},d;if(a){e.file=a;d={method:"post"}}linb.request(CONF.service,e,function(g){var h;if(typeof g=="string"){h=_.unserialize(g)}else{h=g}if(h){if(!h.error){_.tryF(c,[h])}else{SPA.popMsg(_.serialize(h.error))}}else{SPA.popMsg(_.serialize(g))}},function(g){SPA.popMsg(_.serialize(g))},f,d)})},request2:function(a,b){linb.Thread.observableRun(function(c){linb.request(CONF.service,{key:"ImgProcess",para:a},function(i){if(typeof i=="string"){i=_.unserialize(i)}if(i.error){SPA.popMsg(_.serialize(i.error))}else{var f=SPA.ilHistory.getTag();if(SPA.paras.filename!=f){SPA.ilHistory.clearItems().setTag(SPA.paras.filename)}var h=SPA.ilHistory,g=h.getItems(),e=false,d=[];_.each(g,function(l,k){if(e){d.push(l.id)}if(l.id==SPA.paras.tag){e=true}});h.removeItems(d);if(SPA.paras.origin){var j=_.copy(SPA.paras);j.origin=j.tag=SPA.paras.origin;if(SPA.ilHistory.getItems().length===0){SPA.ilHistory.setItems([{id:j.tag,image:SPA.imgBig.getSrc(),_obj:j}])}delete SPA.paras.origin}SPA.paras.logindate=i.data.logindate;SPA.paras.tag=i.data.tag;SPA.imgBig.setSrc(i.data.url);h.insertItems([{id:SPA.paras.tag,image:i.data.url,_obj:_.copy(SPA.paras)}],null,false);h.setValue(null,true);_.tryF(b,[i])}},function(d){linb.message(d)},c)})},_rangecon_afteruivalueset:function(b,a,d){var c=_.copy(SPA.paras);c.action="filter_contrast";c.value=Number(d.split(":")[1]);SPA.request2(c,function(){b.boxing().setValue("-100:0",true)})},_rangebri_afteruivalueset:function(b,a,d){var c=_.copy(SPA.paras);c.action="filter_brightness";c.value=Number(d.split(":")[1]);SPA.request2(c,function(){b.boxing().setValue("-100:0",true)})},_button12_onclick:function(b,f,g,c){if(!SPA.$iconId){return}var d=_.copy(SPA.paras);d.action="avatar";d.value=SPA.$iconId;var a=SPA.icon.cssRegion();d.x=a.left;d.y=a.top;d.width=a.width;d.height=a.height;SPA.request2(d,function(){SPA.hideIcon()})},_button13_onclick:function(a,d,f,b){if(!SPA.$frmId){return}var c=_.copy(SPA.paras);c.action="modern_frame";c.value=SPA.$frmId;c.background=SPA.$frmBg;c.x=SPA.frm.$left;c.y=SPA.frm.$top;c.width=linb("imgBig").width();c.height=linb("imgBig").height();SPA.request2(c,function(){SPA.hideFrm()})}}});(linb.Locale.en||(linb.Locale.en={})).app={info:"<br />Web application created by 'Visual JS', goto <a href='http://www.linb.net'>http://www.linb.net</a>",imageErr:"This image doesn't exist!",message:{uploadOK:"You just uploaded a photo successfule!"},caption:{logo:"LINB online photo editor",upload:"Upload Photo",upload_short:"Upload",openweb:"Open Web Photo",save:"Save",applyIcon:"Apply Icon",applyFrm:"Apply Frame",applyCrop:"Apply Crop",applyResize:"Apply Resizing",addtext:"Apply Text",history:"History",demos:"Demos Photo",demos_short:"Demos",width:"Width : ",height:"Height : ",frmbg:"background"},tasks:{basic:"Basic Tasks",basicTips:"Basic Tasks Tips",crop:"Crop",cropTips:"Crop Tips",frm:"PhotoFrame",frmTips:"PhotoFrame Tips",frm2:"Add Icon",frm2Tips:"Add Icon Tips",text:"Add Text",textTips:"Add Text Tips",resize:"Resizing",resizeTips:"Resizing Tips",mag:"Make Magazine",magTips:"Make Magazine Tips"},basic:{bri:"Brightness",con:"Contrast",rot:"Rotation",mir:"Mirror",one:"One Color",filter:"Filters"},upload:{txtUp:"Upload Photo",txtWeb:"Open From Web"},addtext:{font:"Select Font:",fontsize:"Font Size:",fontcolor:"Font Color"},filter:{filter_grayscale:"grayscale",filter_negate:"negate",filter_edgedetect:"edge detect",filter_embosses:"embosses",filter_gaussian_blur:"gaussian blur",filter_selective_blur:"blur",filter_mean_removal:"mean removal",filter_smooth:"smooth"},onecolor:{onecolor_red:"red",onecolor_green:"green",onecolor_blue:"blue"},rotation:{rotate_90:"90",rotate_180:"180",rotate_270:"270"},mirror:{mirror_v:"vertical",mirror_h:"horizontal"}};Class("App.Upload","linb.Com",{Instance:{base:["linb.UI"],required:["linb.UI.Div","linb.UI.ComboInput","linb.UI.Input","linb.UI.Block","linb.UI.Button"],events:{},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a((new linb.UI.Block).setHost(c,"block1").setWidth(520).setHeight(80).setShadow(true));c.block1.append((new linb.UI.Div).setHost(c,"vUpload").setLeft(10).setTop(10).setWidth(100).setHeight(20).setHtml("$app.upload.txtUp").setCustomClass({KEY:"app-label"}));c.block1.append((new linb.UI.Div).setHost(c,"vFromWeb").setLeft(10).setTop(40).setWidth(100).setHeight(20).setHtml("$app.upload.txtWeb").setCustomClass({KEY:"app-label"}));c.block1.append((new linb.UI.ComboInput).setHost(c,"iUploader").setLeft(120).setTop(9).setWidth(230).setType("upload"));c.block1.append((new linb.UI.Input).setHost(c,"iWeb").setLeft(120).setTop(40).setWidth(230).setValueFormat("^(http|https|ftp)\\:\\/\\/[\\w\\-\\_\\.]+[\\w\\-\\_](:[\\w]*)?\\/?([\\w\\-\\._\\?\\,\\'\\/\\\\\\+&amp;%\\$#\\=~])*$"));c.block1.append((new linb.UI.Button).setHost(c,"btnUp").setLeft(358).setTop(8).setWidth(142).setCaption("$app.caption.upload").setVAlign("middle").onClick("_up_click"));c.block1.append((new linb.UI.Button).setHost(c,"btnWeb").setLeft(358).setTop(39).setWidth(142).setCaption("$app.caption.openweb").setVAlign("middle").onClick("_btnweb_onclick"));return b},_up_click:function(b){if(this.iUploader.getUIValue()){var a=this.iUploader.getUploadObj();_.tryF(this.onUpload,[a]);this.iUploader.resetValue()}},_btnweb_onclick:function(a){var b=this.iWeb;if(b.checkValid()){_.tryF(this.onOpenWeb,[b.getUIValue()]);b.resetValue()}}}});