new function(){Class("linb.Profile","linb.iProfile",{Instance:{setEvents:function(A){_.merge(this,A,"all");return this},getEvents:function(){var A=this,B,C={};_.each(A.box.$EventHandlers,function(E,D){if(A[D]){C[D]=A[D]}});return C},_applySetAction:function(A,B){return A.call(this,B)},$gc:function(){this.antiAllLinks().resetCache();_.breakO(this)},resetCache:_.fun(),destroy:_.fun(),boxing:function(){return this},beforeSerialized:function(){var B,A=this,G=(B=A.box.beforeSerialized)?B(A):A,C={alias:G.alias,key:G.key};if(G.host){C.host="$this$"}if(G.$domId!=G.domId){C.domId=G.domId}if(G.appearance&&G.appearance!="default"){C.appearance=G.appearance}if(G.behavior&&G.behavior._id!="default"){C.behavior=G.behavior._id}if(G.template&&G.template._id!="default"){C.template=G.template._id}var H={},E=G.box.$DataStruct,D=linb.Base.$specialChars;_.merge(H,G.properties,function(J,I){return(I in E)&&E[I]!==J&&!D[I.charAt(0)]});if(!_.isEmpty(H)){C.properties=H}if(!_.isEmpty(B=this.getEvents())){C.events=B}var F=G.box.$EventHandlers;_.filter(C.events,function(J,I){return J!=F[I]});if(_.isEmpty(C.events)){delete C.events}if(!_.isEmpty(G.CA)){C.CA=_.copy(G.CA)}if(!_.isEmpty(G.CB)){C.CB=_.copy(G.CB)}if(!_.isEmpty(G.CC)){C.CC=_.copy(G.CC)}if(!_.isEmpty(G.CF)){C.CF=_.copy(G.CF)}if(G.children&&G.children.length){C.children=G.children;C.children.sort(function(I,J){I=parseInt(I[0].properties.tabindex);J=parseInt(J[0].properties.tabindex);return I>J?1:I==J?0:-1})}return C},copy:function(){var A=new this.constructor;_.merge(A,this,"all");return A},clone:function(A){var C=_.unserialize(_.serialize(this));if(!A){var B=function(F,E){var D=arguments.callee;delete F.alias;if(E){F.host=E}if(F.children){F.children.each(function(G){D(G[0],E)})}};B(C,this.host)}return C}}});Class("linb.Base","linb.iBox",{Constructor:function(D,C,B){var A=this,F=A.constructor,E;if(typeof D=="object"){B=D.events;C=D.properties;D=D.alias}E=new linb.Profile;_.merge(E,{properties:C||{},alias:D||F.pickAlias(),$id:_.id(),_links:[],box:F,key:F.KEY,object:A},"all");F._namePool[E.alias]=1;E.setEvents(B);E.links(F._cache,"self").links(linb.Base._cache,"base").links(linb._object,"linb");E.boxing=function(){return A};A._nodes=[E]},Instance:{ini:function(B,A,D){var C=this.get(0);_.merge(C.properties,B,"all");C.setEvents(A||C.events||{});delete C.events;C.host=D;return this},$gc:function(){delete this.box._namePool[this.alias]},alias:function(B){var A=this;if(B){delete A.constructor._namePool[A.get(0).alias];A.get(0).alias=B;A.constructor._namePool[B]}else{return A.get(0).alias}return A},host:function(C,B){var A=this;if(C){A.get(0).host=C;if(B){A.alias(B);C[B]=A}return A}else{return A.get(0).host}}},After:function(){var J=this,E=arguments.callee,H,I,B,G,A,D,C,F;J._nameId=0;J._namePool={};J._nameTag=(I=J.KEY.split("."))[I.length-1].toLowerCase();J._cache=[];if(J===linb.Base){return }A=E.a1||(E.a1="$Keys,$DataModel,$DataStruct,$EventHandlers".toArr());for(C=0;F=A[C++];){if(I=J.$parent){B={};for(D=0;G=I[D++];){_.merge(B,G[F])}J[F]=_.clone(B)}else{J[F]={}}}G=J.$Keys;for(D in G){if((I=G[D].split("-")).length){G[D]=J.KEY+"-"+I[I.length-1]}}G.KEY=G.$key=J.KEY;J.setDataModel(J.DataModel);delete J.DataModel;J.setEventHandlers(J.EventHandlers);delete J.EventHandlers;A=E.a5||(E.a5="createdTrigger,renderedTrigger".toArr());for(C=0;F=A[C++];){H=[];if(I=J.$parent){for(D=0;G=I[D];D++){if(G=G["$"+F]){H.push.apply(H,G)}}}if(J[F]){H.push(J[F])}J["$"+F]=H;delete J[F]}},Static:{$i:true,$specialChars:{_:1,$:1},$gc:function(){var B=this,A=B.$key;_.breakO([B.$DataModel,B.$DataStruct,B.$EventHandlers,B],2);Class.$gc(A)},getDefaultProp:function(){return _.copy(this.$DataStruct)},setDataModel:function(G){var K=this,J,B,D,E,A,I=linb.Base.$specialChars;var C=K.$DataStruct,H=K.$DataModel;for(var F in G){if(!H[F]){H[F]={}}if(_.isHash(B=G[F])){J=H[F];_.merge(J,B,"all");C[F]=B.ini!==undefined?B.ini:C[F]!==undefined?C[F]:undefined}else{if(null===B){A=F.initial();delete C[F];delete H[F];delete K.prototype["get"+A];delete K.prototype["set"+A]}else{C[F]=B;if(typeof B!="function"){H[F].ini=B}}}}_.each(G,function(M,L){if(M===null||I[L.charAt(0)]||typeof M=="function"){return }A=L.initial();if(!(M&&M.readonly)){J=M.set;D="set"+A;E=K.prototype[D];K.prototype[D]=typeof J=="function"?Class._fun(J,D,K.KEY):typeof E=="function"?E:Class._fun(function(O,N){return this.each(function(Q){if(Q.properties[L]===O&&!N){return }var R=Q.properties[L],P=_.get(Q.box.$DataModel,[L,"action"]);Q.properties[L]=O;if(typeof P=="function"&&Q._applySetAction(P,O,R)===false){Q.properties[L]=R}})},D,K.KEY)}J=M.get;D="get"+A;E=K.prototype[D];K.prototype[D]=typeof J=="function"?Class._fun(J,D,K.KEY):typeof E=="function"?E:Class._fun(function(){return this.get(0).properties[L]},D,K.KEY)});return K},getDataModel:function(A){var B=this.$DataModel;return A?B[A]:B},setEventHandlers:function(A){_.each(A,function(D,B){if(null===D){delete this.$EventHandlers[B];delete this.prototype[B]}else{this.$EventHandlers[B]=D;var C=function(E){var H=arguments,J=typeof E;if(H.length==1&&(J=="function"||J=="string")){return this.each(function(K){if(K.domNode){K.resetCache()}K[B]=E})}else{if(H.length==1&&null===E){return this.each(function(K){K.resetCache();delete K[B]})}else{var G=this.get(0),I=G[B],F=G.host||G;if(typeof I=="string"){I=F[I]}if(typeof I=="function"){return _.tryF(I,H,F)}}}};C.$event$=1;return this.plugIn(B,C)}},this)},getEventHandlers:function(){return this.$EventHandlers},getByCacheId:function(B){var A;if(A=this._cache[B]){return A.object}},pickAlias:function(){var B,C=this._namePool,A=this._nameTag;while(C[B=(A+(++this._nameId))]){}return B},unserialize:function(B){var A=_.unserialize(B);return new this(A)}}});Class("linb.iDataBinder","linb.Base",{Constructor:function(){this._nodes=[]},Instance:{getDataBinder:function(){var A=this.get(0);return linb.iDataBinder.getDataBinder(A.properties.dataBinder)},resetValue:function(A){this.each(function(B){B.boxing().resetValue((A&&A[B.properties.dataField])||B.value)});return this},checkValid:function(){return linb.UI.iWidget.pack(this._nodes).checkUIValueValid()},getValue:function(){if(this.checkValid()){var A={};this.each(function(D){var E=D.properties,B=D.boxing(),C;if(D.domNode){B.updateValue()}C=B.getValue();A[E.dataField]=C});return A}else{return null}}},Static:{$i:true,_pool:{},clear:function(){this._pool={}},link:function(A,C){var B=this._pool[A];if(!B){B=this._pool[A]=new linb.iDataBinder()}if(C&&!B._nodes.exists(C)){B._nodes.push(C)}},unlink:function(A,C){var B=this._pool[A];if(B){B._nodes.removeValue(C)}},getDataBinder:function(A){return this._pool[A]},DataModel:{dataBinder:{ini:"",set:function(A){var C,B;return this.each(function(F,E){var G=F.properties,D=G.dataBinder;if(D==A&&!E){return }if(D){linb.iDataBinder.unlink(D,F)}G.dataBinder=A;linb.iDataBinder.link(A,F)})}},dataField:""},createdTrigger:function(){var B=this,A=B.boxing(),C;if(C=B.dataBinder){A.setDataBinder(C)}if(C=B.dataField){A.setDataField(C)}}}})};new function(){Class("linb.UIProfile","linb.Profile",{Instance:{$gc:function(){var A=this,C;if(!A.serialId){return }A.resetCache();if(A.addition&&(C=A.domNode)){for(var B in A.addition){C[B]=null}}if(!A.$exID){C=linb.cache.domId;(C[A.key]||(C[A.key]=[])).push(A.serialId)}else{delete A.$exID}delete linb.cache.dom[A.domId];delete linb.cache.dom[A.$domId];delete A.box._namePool[A.alias];A.antiAllLinks();_.breakO(A)},_linkParent:function(C,B){var A=this;A.parent=B;A.childrenId=C;A.antiLinks("$parent");A.links(B.children,"$parent",[A,C])},_reg:/^[\w]*$/,setDomId:function(D){var A=this,C=linb.cache.dom,B=A._reg;if(typeof D!="string"||!B.test(D)){D=A.$domId}if(A.domId!=A.$domId){delete C[A.domId]}if(A.domNode){A.domNode.id=D}C[A.domId=D]=A;return A},getDomId:function(){return this.domId},destroy:function(){var A=this;if(A.root){A.root.remove()}else{A.$gc()}},resetCache:function(A){_.breakO(this.$cache_egetter,2);_.breakO(this.$cache_domid)},getEV:function(B,A){var K=this,H=B+"+"+A,F=K.$cache_egetter||(K.$cache_egetter={});if(F[H]){return F[H]}var D=linb.cache.dom,G=[],J,I;if((J=D[B])&&(J=J.events)&&(J=J[A])){for(var E=0,C=J.length;E<C;E++){if(typeof J[J[E]]=="function"){G[G.length]=J[J[E]]}}}I=B.split(":")[0].split("-")[1];if(typeof (((J=K._CB)&&(I?(J=J[I]):1))&&(J=J[A]))=="function"){G[G.length]=J}else{if(typeof (((J=K.CB)&&(I?(J=J[I]):1))&&(J=J[A]))=="function"){G[G.length]=J}else{if(typeof (((J=K.behavior)&&(I?(J=J[I]):1))&&(J=J[A]))=="function"){G[G.length]=J}}}return F[H]=G},toString:function(H){var L=this,F,C,E,K,J,L,D,G={},A,I=arguments.callee,B=I.reg||(I.reg=/<!--([^>^\s]*)-->/g);if(!L.string||H){J=L.box;_.merge(L.properties,J.$DataStruct);L.data={};J.prepareData(L,true);if(J.dynamicTemplate){J.dynamicTemplate(L)}L.string=J.build(L);delete L.data;if(E=L.children){for(F=0;C=E[F++];){if(!C[0]["linb.UIProfile"]){K=new (linb.SC(C[0].key));K.ini.call(K,C[0]);C[0]=K.get(0)}}}}if(E=L.children){for(F=0;C=E[F++];){A=C[1]||"";K=G[A]||(G[A]=[]);K[K.length]=C[0].toString()}}return L.string.replace(B,function(N,M){return G[M]?G[M].join(""):""})},boxing:function(){var A=this,B;if(!((B=A.object)&&B._nodes[0]==A&&B._nodes.length==1)){B=A.object=A.box.pack([A],false)}return B},_applySetAction:function(A,B,C){if(this.domNode){return A.call(this,B,C)}},makeRootId:function(A){return(A||this.key)+":"+this.serialId+":"},getKey:function(A){return A.split(":")[0]},getSubSerialId:function(A){return A.split(":")[2]},getSerialId:function(A){return A.split(":")[1]},getNodeId:function(B,C,A){return B+":"+C+":"+A},pickSubId:function(B){var A=this,C,D=A.cache_subid||(A.cache_subid={});if((D[B]||(D[B]=[]))[0]){return D[B].shift()}D=A.subId||(A.subId={});C=(D[B]||(D[B]=new _.id)).next();return C},cacheSubId:function(C,A){var B=this.cache_subid||(this.cache_subid={});(B[A]||(B[A]=[])).push(C)},getClass:function(G,I,D){var H=this;G=H.keys[G]||G;var F=arguments.callee,A=F.map||(F.map={}),B=F.reg||(F.reg=/\./g),C=H.appearance+":"+G+":"+I+":"+D;if(A[C]){return A[C]}if(H.classKey){G=G.replace(H.key,H.classKey)}var E=(((!D&&H.appearance!="default")?H.appearance+"--":"")+G).replace(B,"-").toLowerCase();E=E+(I||"");return A[C]=E},addTagClass:function(H,K,A,F){var I=this;H=I.keys[H]||H;if(!A){A=I.getSubNode(H)}var G=I.box.$clscache||(I.box.$clscache={}),E=H+":"+K,J="[^\\s]*[-\\w]+",D=G[E]||(G[E]=new RegExp(J+"[-\\w]*"+K+"[-\\w]*")),C=G[J+"*2"]||(G[J+"*2"]=new RegExp("("+J+"[-\\w]*)","g")),B=G[J+"*3"]||(G[J+"*3"]=new RegExp("("+J+")"));A.removeClass(D);if(!F){A.reClass(C,"$1 $1"+K)}else{A.reClass(B,"$1 $1"+K)}return I},removeTagClass:function(E,A,D){var C=this;E=C.keys[E]||E;if(!D){D=C.getSubNode(E)}var G=C.box.$clscache||(C.box.$clscache={}),B=E+":"+A,F=G[B]||(G[B]=new RegExp("[-\\w]*"+A+"[-\\w]*"));D.removeClass(F);return C},getSubNodeId:function(B,C){var A=this.$domId.split(":");A[0]=B;A[2]=C||"";return A.join(":")},getSubNode:function(D,H,A){var B=this;D=B.keys[D]||D;var G,C,F,E=B._domNode||(B._domNode={});if(H===true){G=linb([B.domNode]).dig("*","id",new RegExp("^"+D+":"+B.serialId))}else{if(A){delete E[D]}if(!H&&E[D]&&E[D]._nodes.length==1){return E[D]}G=(C=linb.dom.byId(F=B.getSubNodeId(D,H)))?linb([C]):linb([B.domNode]).dig("*","id",F);if(!H&&!A){E[D]=G}}return G},getSubNodes:function(A,E){var C=0,B=[],D;for(;D=A[C++];){B.push(this.getSubNode(D,E).get(0))}return linb(B)},getSubNodeByItemId:function(A,B){return(B=this.getSubSerialIdByItemId(B))?this.getSubNode(A,B):linb([])},getItemByItemId:function(B){var A;if((A=this.ItemIdMapSubSerialId)&&(A=A[B])){return this.SubSerialIdMapItem[A]}},getItemByDom:function(A){return this.SubSerialIdMapItem&&this.SubSerialIdMapItem[this.getSubSerialId(A.id||A)]},getItemIdByDom:function(B){var A;return(A=this.getItemByDom(B))&&A.id},getSubSerialIdByItemId:function(B){var A;return(A=this.ItemIdMapSubSerialId)&&A[B]},itemsSearch:function(C,B,A,F){A=A||false;F=F||false;var D=[];var E=arguments.callee.f||(arguments.callee.f=function(I,H,G,L,K){var J=arguments.callee;I.each(function(M){if(H===true||H.call(null,M)){K.push(M);if(L){return false}}if(G&&M.sub&&M.sub.length){J(M.sub,H,G,L,K)}})});E(C,B,A,F,D);return D}}});Class("linb.UI","linb.Base",{Constructor:function(){if(arguments[0]!==false){return this.ini.apply(this,arguments)}},Before:function(B,A,C){linb.iBox.$type[B.replace("linb.UI.","").replace("linb.","")]=linb.iBox.$type[B]=B;return true},After:function(){linb.Base.After.apply(this,arguments);var N=this,G=arguments.callee,L,M,B,K,H,F,A,D,C,E,I,J;N._ctrlId=new _.id();N._idCache=[];A=G.a2||(G.a2="$Templates,$Behaviors,$Appearances".toArr());for(C=0;J=A[C++];){B={};if(M=N.$parent){for(E=0;H=M[E++];){for(D in H[J]){M=H[J][D];K=B[D]||(B[D]={});for(F in M){I=M[F];K[F]=K[F]||{};_.merge(K[F],I)}}}N[J]=_.clone(B)}else{N[J]={}}}A=G.a3||(G.a3="Templates,Behaviors,Appearances".toArr());I=G.a4||(G.a4="setTemplate,setBehavior,setAppearance".toArr());for(C=0;J=A[C];C++){K=N[J];for(D in K){N[I[C]](D,K[D])}delete N[J]}if(N.PublicAppearance){linb.css.add(N.buildCSSText(N.PublicAppearance,linb.getPath(N.KEY,"/css.css","appearance")));delete N.PublicAppearance}if(N.Dropable&&N.Dropable.length){N.Dropable.each(function(O){N.dropable(O)});delete N.Dropable}if(N.Dragable&&N.Dragable.length){N.Dragable.each(function(O){N.dragable(O)});delete N.Dragable}},Instance:{getSubNode:function(){var A=this.get(0);return A.getSubNode.apply(A,arguments)},toString:function(){return this._nodes.join("")},toDomNodes:function(){var B,A=[];this._nodes.each(function(C){if(B=C.domNode){A.push(B)}});return A},setDomId:function(A){this.get(0).setDomId(A);return this},getDomId:function(){return this.get(0).getDomId()},ini:function(G,Q,P,L,A,E,B,M,J,I,F){var O=this,C,H=O.constructor,N="default";if(G&&G["linb.UIProfile"]){O._nodes=[C=G]}else{O._nodes=[C=new linb.UIProfile]}C.box=H;C.key=O.$key;C.$id=_.id();C.keys=H.$Keys;if(G&&G.key&&linb.iBox.$type[G.key]){_.merge(C,G);G=null}C.properties=G||C.properties||{};C.host=P||C.host||null;C.appearance=E||C.appearance||N;C.behavior=H.getBehavior(A||C.behavior||N);C.CA=M||C.CA||{};C.CB=J||C.CB||{};C.CC=I||C.CC||{};C.CF=F||C.CF||{};if(H.iniProfile){H.iniProfile.call(C)}C.template=H.getTemplate(L||C.template||N);C.setEvents(Q||C.events||{});delete C.events;if(!C.serialId){C.serialId=H.pickSerialId()}C.$domId=C.makeRootId();C.domId=C.domId||C.$domId;C.alias=C.alias||H.pickAlias();H._namePool[C.alias]=1;C.createdTrigger=H.$createdTrigger.copy();C.renderedTrigger=H.$renderedTrigger.copy();C.addition=C.behavior?C.behavior.$eventhandler:null;C._links={};C.links(linb.UI._cache,"UI").links(H._cache,"self").links(linb._object,"linb");B=B||C.children||[];C.children=[];for(var D=0,K;K=B[D++];){if(!K[0]["linb.UIProfile"]){K[0]=new (linb.SC(K[0].key))(K[0]).get(0)}K[0]._linkParent(K[1],C)}return O},_set:function(G,B){var D=arguments.callee,F;G.root=linb([G.domNode=linb.dom.byId(G.domId)]);linb.cache.dom[G.domId]=linb.cache.dom[G.$domId]=G;if(F=G.createdTrigger){for(var E=0,A=F.length;E<A;E++){F[E].call(G)}delete G.createdTrigger}if(B&&(F=G.renderedTrigger)){for(var E=0,A=F.length;E<A;E++){F[E].call(G)}}if(G.children){for(var E=0,C;C=G.children[E++];){D(C[0],true)}}},create:function(B){var A=[],C,E,G=this._nodes,D=arguments.callee,F=this._set;for(C=0;E=G[C++];){if(!E.domNode){A[A.length]=E}}if(A.length){linb.dom.getMatix().html(A.join(""),false);for(C=0;E=A[C++];){F(E,B)}}return this},render:function(){var B,E,G=this._nodes,D,C=arguments.callee,F=this._set,A=C.para||(C.para=function(I){var H=I.getRegion();H.tabindex=I.tabIndex();H.zIndex=I.zIndex();H.position=I.position();return H});for(B=0;E=G[B++];){if(!(D=linb(E.alias)).isEmpty()){_.merge(E.properties,A(D));D.outerHTML(E.toString());window[E.alias]=E.boxing();F(E,true)}}return this},hide:function(){return this.each(function(A){if(A.domNode){A.root.hide();A.properties.exDock=true}})},show:function(A,B){return this.each(function(C){if(C.domNode){C.properties.exDock=false;C.root.show(A,B)}})},display:function(A){return this.each(function(B){if(B.domNode){B.root.display(A?"":"none")}})},destroy:function(){this.each(function(A){if(A.beforeDestroy&&A.boxing().beforeDestroy(A)===false){return }if(A.destroyTrigger){A.destroyTrigger()}if(A.root){A.root.remove()}else{A.$gc()}})},clean:function(){return this},activate:function(){return this},clone:function(B){var A=[];this.each(function(C){A.insertAny(linb.create(C.clone(B)).get())});return this.constructor.pack(A,false)},refresh:function(){var I,F,A,H,B,E,G,D,C;return this.each(function(K){if(!K.domNode){return }if(F=!!K.parent){A=K.parent.boxing();I=K.childrenId}else{A=K.root.parent()}var J=linb.create("span");K.root.replace(J,true);C=K.children.copy();K.children.length=0;C.each(function(L){delete L[0].$dockParent;J.addLast(L[0].root)});D=K.box;G=K.host;H=K.beforeSerialized();E=K.$addOns;K.$exID=1;K.boxing().destroy();linb.dom.$gc();H.host=G;_.merge(K,H,"all");K=new D(K).create();if(E){E.call(E.target,K.get(0))}J.empty(false);J.replace(K.get(0).root);if(F){A.attach(K,I)}else{A.attach(K)}C.each(function(L){K.attach.apply(K,L)});J.remove()})},template:function(D){var A=this,C,B;if(typeof D=="string"){A.each(function(E){if(E.domNode){if(!E.template||E.template._id!=_.str(D)){B=E.box.getTemplate(_.str(D));if(!B){return }E.template=B;return A.refresh()}}else{E.template=D}});return A}else{return A.get(0).template}},behavior:function(D){var B,C,A;if(typeof D=="string"){this.each(function(G){if(G.behavior._id!=_.str(D)){if(G.domNode){C=G.behavior;if(B=C.$eventhandler){for(var E in B){G.root.removeEventHandler(E.slice(2))}}for(var F in G.keys){if(C[F]&&(B=C[F].$eventhandler)){for(var E in B){G.getSubNode(F,true).removeEventHandler(E.slice(2))}}}}C=G.box.getBehavior(_.str(D));if(!C){return }G.behavior=C;if(G.domNode){if(B=C.$eventhandler){for(var E in B){G.root.addEventHandler(E.slice(2))}}for(var F in G.keys){if(C[F]&&(B=C[F].$eventhandler)){for(var E in B){G.getSubNode(F,true).addEventHandler(E.slice(2))}}}}}});return this}else{return this.get(0).behavior}},appearance:function(C){var A,B;if(typeof C=="string"){return this.each(function(D){if(D.appearance!=C){B=D.getClass("KEY");D.appearance=C;if(!D.box.cssNone){D.box.setCSSFile(D.box.cssPathKey||D.key,D.appearance)}if(D.domNode){D.root.dig("*","id",new RegExp("^"+D.key+"(-[w]+)?:"+D.serialId)).reClass(new RegExp("([\\w]+\\-\\-)?"+B,"g"),D.getClass("KEY"))}}})}else{return this.get(0).appearance}},attach:function(A,C){if(C!==false){this.appendChild(A,C)}var B=this.get(0);if(B.domNode){(B.keys.PANEL?B.getSubNode(B.keys.PANEL):B.root).attach(A)}return this},appendChild:function(A,B){if(A["linb.UIProfile"]){A=A.boxing()}if(_.isArr(A)){A=linb.UI.pack(A,false)}if(!A["linb.UI"]){A=A.reBoxing("UI")}return this.each(function(C){A.each(function(D){D._linkParent(B,C)})})},detach:function(){return this.each(function(A){A.antiLinks("$parent");delete A.parent;delete A.childrenId})},addPanel:function(A,C,D){var E=linb.UI.PanelBar.getDefaultProp();_.merge(E,A,"with");_.merge(E,{left:0,top:0,dock:"fill",tag:A.tag||A.id},"all");var B=new linb.UI.PanelBar(E);this.attach(B,D&&D.id);C.each(function(F){B.attach(F[0])})},dragable:function(A,C,B){return this.each(function(D){D.getSubNode(D.keys[B]||"KEY",true).beforeMousedown(function(G,E,F){linb([F]).startDrag(E,{drop2:true,key:A,data:typeof C=="function"?C():C,icon:linb.ini.path+"ondrag.gif",dragMode:"move",cursor:"pointer",move:false,defer:1})},"",-1).beforeDragbegin(function(E,F,G){linb([G]).onMouseout(true,{$force:true}).onMouseup(true)},"",-1)})},unDragable:function(A){return this.each(function(B){B.getSubNode(B.keys[A]||"KEY",true).beforeMousedown(null,"").beforeDragbegin(null,"");B.resetCache()})},setCustomFunction:function(A,B){return this.each(function(C){if(typeof A=="string"){if(typeof B=="function"){C.CF[A]=B}else{delete C.CF[A]}}else{C.CF=A||{}}})},setCustomClass:function(B,D){var C=arguments.callee;var A=(C.fun||(C.fun=function(J,G,H,F){var I=J.getSubNode(G,true),E;if(!I.isEmpty()){H[G].split(/\s+/).each(function(K){if(!F){I.addClass(K)}else{I.removeClass(K)}})}}));return this.each(function(G){var E=_.copy(G.CC);if(typeof B=="string"){if(G.domNode){if(B in E){A(G,B,E,true)}}if(!D){delete G.CC[B]}else{G.CC[B]=D;if(G.domNode){A(G,B,E)}}}else{if(!!B&&typeof B=="object"){if(G.domNode){for(var F in E){A(G,F,E,true)}for(var F in B){A(G,F,B)}}G.CC=B}else{if(G.domNode){for(var F in E){A(G,F,E,true)}}G.CC={}}}})},setCustomAppearance:function(B,D){var C=arguments.callee;var A=(C.fun||(C.fun=function(J,G,H,F){var I=J.getSubNode(G,true),E;if(H[G]&&!I.isEmpty()){H[G].split(";").each(function(M,K){if((E=M.split(":")).length==2){E[0]=E[0].replace(/\-(\w)/g,function(O,N){return N.toUpperCase()});try{I.setStyle(E[0],F?"":E[1])}catch(L){}}})}}));return this.each(function(G){var E=_.copy(G.CA);if(typeof B=="string"){if(G.domNode){if(B in E){A(G,B,E,true)}}if(!D){delete G.CA[B]}else{G.CA[B]=D;if(G.domNode){A(G,B,E)}}}else{if(!!B&&typeof B=="object"){if(G.domNode){for(var F in E){A(G,F,E,true)}for(var F in B){A(G,F,B)}}G.CA=B}else{if(G.domNode){for(var F in E){A(G,F,E,true)}}G.CA={}}}})},setCustomBehavior:function(A,B){return this.each(function(C){if(typeof A=="string"){if(C.keys[A]){C.CB[A]=B||{}}}else{C.CB=A||{}}C.resetCache()})}},Initialize:function(){linb.css.add(linb.UI.buildCSSText({body:{$order:0,font:["13px arial,helvetica,clean,sans-serif",linb.browser.ie?"x-small":""],"font-size":linb.browser.ie6?"100.01%":linb.browser.ie?"small":"",margin:0,padding:0,cursor:"default"},"div,span,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,form,fieldset,input,button,p,blockquote,th,td":{$order:1,margin:0,padding:0},table:{$order:2,"font-size":"inherit",font:linb.browser.ie?"100%":"","border-collapse":"collapse","border-spacing":0,"empty-cells":"show"},"div,span,fieldset,img,abbr,acronym":{$order:3,border:0},"address,caption,cite,dfn,em,strong,th,var":{$order:4,"font-style":"normal","font-weight":"normal"},"pre, code ":{$order:5,"font-size":linb.browser.ie?"100%":"","font-style":"normal","font-weight":"normal",margin:0,padding:0},"ol,ul ":{$order:6,"list-style":"none"},"caption,th":{$order:7,"text-align":"left"},"h1,h2,h3,h4,h5,h6":{$order:8,"font-size":"100%"},a:{$order:10,"text-decoration":"none",cursor:"pointer","-moz-user-select":linb.browser.gek?"none":""},"a:hover":{$order:11,color:"red"},"a:focus":{$order:11,"-moz-outline-offset":linb.browser.gek?"-1px ! important":""},button:{$order:11,cursor:"pointer","border-width":"1px"},"select, input, textarea":{$order:12,font:"99% arial,helvetica,clean,sans-serif"},strong:{$order:14,"font-weight":"bold"},em:{$order:15,"font-style":"italic"},div:{$order:15,"vertical-align":linb.browser.ie?"auto":null,"font-size":"12px"},span:{$order:16,display:linb.browser.gek?["-moz-inline-block","-moz-inline-box","inline-block"]:linb.browser.ie6?"inline":"inline-block",zoom:linb.browser.ie6?1:null,"vertical-align":"middle"},"body *":{$order:17,"line-height":"1.22em"},".ui-dirty, .ui-dirty *":{$order:18,color:"#f00"},".ui-invalid, .ui-invalid *":{$order:19,"background-color":"Aqua"},"#linb_lang":{$order:20,"vertical-align":"text-top"}}),"linb.UI");linb.cache.$dropPool={}},Static:{$i:true,$cache_csspath:{},$css_tag_dirty:"ui-dirty",$css_tag_invalid:"ui-invalid",$tag_left:"{",$tag_right:"}",$tag_special:"#",$ID:"#id#",$DOMID:"#domid#",$CLS:"#cls#",subSerialIdTag:"_serialId",$childTag:"<!--{id}-->",hasDomRoot:true,unserialize:function(D,B){var A=_.unserialize(D),C=function(E){delete E.serialId;E.children.each(C)};A.each(function(E){if(!B){C(E)}});return linb.create(A)},clean:function(B){if(B&&B._nodes&&B._nodes[0]&&B._nodes[0]["linb.UIProfile"]){return B._nodes}else{var A=this._dom2ui(linb.dom.pack(B)._nodes);A.filter(function(C){return C.box["linb.UI"]});return A}},_dom2ui:function(A){var E=0,B=[],D,C=this.KEY;A.each(function(F){if((D=linb.cache.dom[F.id])&&D.key){B[E++]=D}});return B},$gc:function(){var A=this.$key;_.breakO([linb.cache.template[A],linb.cache.domId[A]],2);_.breakO([this._cache,this._idCache,this.$DataModel,this.$Templates,this.$Behaviors,this],2);delete linb.iBox.$type[A.replace("linb.UI.","")];this.$gc=null;Class.$gc(A)},getAll:function(){return this.pack(this._cache)},getByCacheId:function(C){var A=[],B,D=this._cache;C=C instanceof Array?C:[C];C.each(function(E){if(B=D[E]){A[A.length]=B}});return linb.UI.pack(A,false)},pickSerialId:function(){var A=linb.cache.domId[this.$key];if(A&&A[0]){return A.pop()}return this._ctrlId.next()},getCSSImgPara:function(D,A,B,C){return function(E){var F=linb.getPath(C||E,null,"appearance")+(B?B:"default")+"/"+D;return"url("+F+") "+(A||"")}},getImgPath2:function(C,A,B){return function(D){var E=linb.getPath(D,"/"+(B?B:"default")+"/"+C,"appearance");return A.replace("{*}",E)}},$doTemplate:function(E,I,H,O,P){var L=arguments.callee,N,K,D,M=H.constructor==Array;var J=I[O||""],A=!P;var P=P||[];if(M){if(typeof J!="function"){J=L}for(var G=0;K=H[G++];){J(E,I,K,O,P)}}else{if(typeof J=="function"){J(E,I,H,O,P)}else{O=O?O+".":"";var C=J[0],B=J[1];for(var G=0,F=C.length;G<F;G++){if(D=B[G]){if(D in H){K=H[D];if(I[N=O+D]&&K){L(E,I,K,N,P)}else{P[P.length]=K}}}else{P[P.length]=C[G]}}}}if(A){return P.join("")}},$buildTemplate:function(E,V,c,H,B){if(V&&String(V.tagName).toLowerCase()=="text"){B[B.length]=V.text;return }var L=arguments.callee,J,N,U,K=E.behavior?c?E.behavior[c]:E.behavior:null,Y=L.map1||(L.map1={tagName:1,text:1}),W=L.map2||(L.map2={image:1,input:1}),Q=L.r2||(L.r2=/[a-z]/),P=L.r3||(L.r3=/^(on|before|after)/),M=L.r7||(L.r7=/([^{}]*)\{([\w]+)\}([^{}]*)/g);var C,F=false,G=linb.UI;if(!V){V=E.template}C=c?E.keys[c]:E.key;if(!V.tagName){V.tagName="span"}if(V.id!==null){V.id=c?C+":"+G.$ID+":"+G.$tag_left+G.subSerialIdTag+G.$tag_right:G.$DOMID}else{delete V.id}if(V.className!==null){J=G.$CLS+(c?"-"+c.toLowerCase():"");U=V.className||"";V["class"]=J+" "+U+" "+G.$tag_special+(c||"KEY")+"_CC"+G.$tag_special}delete V.className;V.style=(V.style||"")+";"+G.$tag_special+(c||"KEY")+"_CA"+G.$tag_special;var T=[],S={},D=V.tagName,I=V.text,A=linb.Base.$specialChars;for(var R in V){if(!A[R.charAt(0)]&&!Y[R]){N=V[R];if(!Q.test(R)){if(typeof N=="object"){if(!N.$order){N.$order=0}N.$key=R;T[T.length]=N}}else{S[R]=N}}}T.sort(function(b,d){b=b.$order;d=d.$order;return b>d?1:b==d?0:-1});if(!B){F=true;B=[]}B[B.length]="<"+D+" ";for(var R in S){B[B.length]=R+'="'+S[R]+'" '}if(V.className!==null){V.className=U}delete V["class"];if(K&&(J=K.$eventhandler)){for(var R in J){if(J[R]){B[B.length]=R+'="'+J[R]+'" '}}}B[B.length]="{attributes}>";if(!W[D]&&I){B[B.length]=I}for(var R=0,O=T.length;R<O;){N=T[R++];L(E,N,N.$key,H,B)}if(!W[D]){B[B.length]="</"+D+">"}if(F){var Z=H[0],X=H[1];B.join("").replace(M,function(f,e,h,g){if(e){Z[Z.length]=e}X[Z.length]=Z[Z.length]=h;if(g){Z[Z.length]=g}return""})}},_rpt:function(F,J){var I=linb.UI,G=arguments.callee,H=this.KEY,L=I.$tag_special,E=G.r1||(G.r1=new RegExp(I.$ID,"img")),C=G.r2||(G.r2=new RegExp(L+"([A-Z0-9]+)_CA"+L,"g")),B=G.r3||(G.r3=new RegExp(L+"([A-Z0-9]+)_CC"+L,"g")),A=G.r4||(G.r4=new RegExp(I.$CLS,"img")),D,K;J=J.replace(E,F.serialId).replace(A,F.getClass("KEY")).replace(I.$DOMID,F.domId);if(D=F.CA){J=J.replace(C,function(N,M){return(K=D[M])?K:""})}else{J=J.replace(C,"")}if(D=F.CC){J=J.replace(B,function(N,M){return(K=D[M])?K:""})}else{J=J.replace(B,"")}return J},build:function(B,G){var I,L,C,J=linb.UI,K=[[],[]],M=this,H=M.KEY,A=linb.cache.template,F=B._hash="a:"+(B.template._id||"")+";b:"+(B.template._did||"")+";c:"+(B.behavior._id||"")+";d:"+(B.behavior._did||"")+";!"+(B._exhash||"");if(!(I=_.get(A,[H,F]))){if(!M.cssNone){M.setCSSFile(M.cssPathKey||H,B.appearance)}J.$buildTemplate(B,null,null,K);_.set(A,[H,F,""],K);if(L=B.template.$dynamic){for(var E in L){if(typeof (C=L[E])!="function"){var K=[[],[]];for(var D in C){if(typeof C[D]=="object"){J.$buildTemplate(B,C[D],D,K)}}C=K}_.set(A,[H,F,E],C)}}I=_.get(A,[H,F])}if(!I||G){return""}return M._rpt(B,J.$doTemplate(B,I,B.data))},subBuild:function(C,B,A){return this._rpt(C,linb.UI.$doTemplate(C,_.get(linb.cache.template,[this.KEY,C._hash]),A,B))},_setDefaultBehavior:function(C){var B=function(D,F,G){var E=function(M,R,H){var U,K=H.id,T,S=M.getSubSerialId(K),J=M.properties,I,Q,P;if(J.disabled){return }T=M.SubSerialIdMapItem&&M.SubSerialIdMapItem[S];if(T&&T.disabled){return }switch(typeof D){case"string":I=M.getSubNode(D,S).get();break;case"function":Q=[D];break;case"object":I=[];Q=[];for(var L,O=0,N=D.length;O<N;O++){L=D[O];if(typeof L=="string"){I.insertAny(M.getSubNode(L,S).get())}else{Q.push(L)}}}if(I&&I.length){I=linb(I);P=M.boxing();if(arguments.callee.mode==1){if(F=="mouseover"&&M.beforeHoverEffect){if(false==P.beforeHoverEffect(M,T,H,"mouseover")){return }}if(F=="mousedown"&&M.beforeClickEffect){if(false==P.beforeClickEffect(M,T,H,"mousedown")){return }}M.addTagClass("KEY","-"+F,I)}else{if(F=="mouseup"){if(M.beforeClickEffect&&false==P.beforeClickEffect(M,T,H,"mouseup")){return }M.removeTagClass("KEY","-mousedown",I)}else{if(M.beforeHoverEffect&&false==P.beforeHoverEffect(M,T,H,"mouseout")){return }M.removeTagClass("KEY","(-mouseover|-mousedown)",I)}}I.length=0}if(Q&&Q.length){Q.each(function(V){_.tryF(V,[M],M)});Q.length=0}};E.mode=G;return E},A;if(C._hoverEffect){_.each(C._hoverEffect,function(E,D){A=["","KEY","$key"].exists(D)?C:(C[D]||(C[D]={}));if(!E){A.afterMouseover=A.afterMouseout=null}else{A.afterMouseover=B(E,"mouseover",1);A.afterMouseout=B(E,"mouseout",2)}})}if(C._clickEffect){_.each(C._clickEffect,function(E,D){A=["","KEY","$key"].exists(D)?C:(C[D]||(C[D]={}));if(!E){A.afterMousedown=A.afterMouseup=null}else{A.afterMousedown=B(E,"mousedown",1);A.afterMouseup=B(E,"mouseup",2)}})}if(C._keyHook){_.merge(C,{afterKeydown:function(E,F,G){if(E.onHotKeydown){var D=linb.event.getKey(F);return false!==E.boxing().onHotKeydown(E,D[0],!!D[1],!!D[2],!!D[3],F,G)}},afterKeypress:function(E,F,G){if(E.onHotKeypress){var D=linb.event.getKey(F);return false!==E.boxing().onHotKeypress(E,D[0],!!D[1],!!D[2],!!D[3],F,G)}},afterKeyup:function(E,F,G){if(E.onHotKeyup){var D=linb.event.getKey(F);return false!==E.boxing().onHotKeyup(E,D[0],!!D[1],!!D[2],!!D[3],F,G)}}},"all")}if(C._focusHook){_.each(C._focusHook,function(E,G){var D=arguments.callee,F,L=D.m1||(D.m1={KEY:1,$key:1});if(L[G]){return }var J=D.m2||(D.m2={input:1,textarea:1}),I=D.m3||(D.m3={tab:1,enter:1,up:1,down:1,left:1,right:1}),H=D.m4||(D.m4={tab:1,up:1,down:1,left:1,right:1}),K=C[G]||(C[G]={});if(null===E){K.afterKeydown=null}else{K.afterKeydown=function(P,S,M){var Q=linb.event.getKey(S),U=Q[0],O=Q[2],T=false;if(J[Q=M.tagName.toLowerCase()]){if(I[U]){var N=linb.UI.getCaretPos(M),R=M.value;switch(U){case"up":if(!/[\n\r]/.test(R.substr(0,N[0]))){T=true}break;case"left":if(N[0]===0&&(N[1]!==R.length||N[1]===0)){T=true}break;case"down":if(!/[\n\r]/.test(R.substr(N[1],R.length))){T=true}break;case"right":if(N[1]===R.length&&(N[0]!==0||N[1]===0)){T=true}break;default:if(Q=="input"){T=true}}}}else{if(H[U]){T=true}}if(T){if(P.beforeNextFocus&&false===P.boxing().beforeNextFocus(P,U,!!O,S)){return false}if(U!="tab"){linb(M).nextFocus(("up"==U||"left"==U)?false:true)}}}}})}},mapKeys:function(B){var A=this;B.each(function(C){A.$Keys[C]=A.KEY+"-"+C})},setAppearance:function(B,C){var A;if(A=this.$Appearances[B]){_.merge(A,C,"all")}else{this.$Appearances[B]=C}return this},getAppearance:function(A){if(typeof A=="string"){return this.$Appearances[A]}else{return this.$Appearances}},setTemplate:function(G,B,F){var I=this,D=arguments.callee,H;var E=D.build||(D.build=function(M){var N,L=arguments.callee,J=L.r2||(L.r2=/[a-z]/);for(var K in M){if(!linb.Base.$specialChars[K.charAt(0)]){if(!J.test(K)){this.$Keys[K]=this.$key+"-"+K;N=M[K];if(typeof N=="object"){L.call(this,N)}}}}});E.call(I,B);H=I.$Templates;H[G]=_.hash(H[G]);B._id=G;if(typeof F=="string"){B._did=F;H[G][F]=B}else{H[G]["$"]=B}if(H=B.$dynamic){for(var C in H){for(var A in H[C]){D.call(I,G,H[C],A)}}}return this},getTemplate:function(B,D){var A=this;if(typeof B=="string"){var C=A.$Templates[B];if(!C){linb.request(linb.getPath(A.KEY,"/"+B+".js","template"),"",function(E){A.setTemplate(B,_.unserialize(E),D)},null,null,{asy:false});C=this.$Templates[B]}return C?typeof D=="string"?C[D]:C.$:null}else{return A.$Templates}},setBehavior:function(N,H,M){this._setDefaultBehavior(H);var B=linb.Base.$specialChars,P=linb.event.eventhandler,F,E,I,G,D,L,K,O=this.$Behaviors;var A=linb.event._getEventType,J=arguments.callee,C=J.r2||(J.r2=/[a-z]/);O[N]=O[N]||{};if(typeof M=="string"){O[N][M]=O[N][M]||{};E=O[N][M];E._did=M}else{O[N].$=O[N].$||{};E=O[N].$}E._id=N;if(H.KEY){_.merge(H,H.KEY,"all");delete H.KEY}for(I in H){D=H[I];if(!B[I.charAt(0)]){if(!C.test(I)){F=E[I]=_.hash(O[I]);for(G in D){L=D[G];if(!B[G.charAt(0)]){K=A(G);if(L){F[G]=L;(F.$eventhandler||(F.$eventhandler={}))["on"+K]=P}else{delete F[G];if(E.$eventhandler){delete E.$eventhandler["on"+K]}}}}}else{K=A(I);if(D){E[I]=D;(E.$eventhandler||(E.$eventhandler={}))["on"+K]=P}else{delete E[I];if(E.$eventhandler){delete E.$eventhandler["on"+K]}}}}}return this},getBehavior:function(B,D){var A=this;if(typeof B=="string"){var C=A.$Behaviors[B];if(!C&&B!="default"){linb.request(linb.getPath(A.KEY,"/"+B+".js","behavior"),"",function(E){A.setBehavior(B,_.unserialize(E),D)},null,null,{asy:false});C=A.$Behaviors[B]}return C?typeof D=="string"?C[D]:C.$:null}else{return A.$Behaviors}},cancelLink:function(A){if(!linb.event.getKey(A)[2]){return false}},getCaretPos:function(J){J.focus();if(linb.browser.ie){if(J.tagName=="INPUT"){var F,A=document.selection.createRange().duplicate(),C=J.createTextRange();A.move("character",0);C.move("character",0);try{C.setEndPoint("EndToEnd",A);F=String(C.text).replace(/\r/g,"").length}catch(H){F=0}return[F,F]}else{var I="\x01",B=document.selection.createRange(),G=B.text,D=G.length,E=B.duplicate();try{E.moveToElementText(J)}catch(H){}B.text=G+I;len=(E.text.indexOf(I));B.moveStart("character",-1);B.text="";if(len==-1){len=J.value.length}return[len,len]}}else{return[J.selectionStart,J.selectionEnd]}},setCSSFile:function(E,B,A){var C=this,F=linb.getPath(C.KEY,"/"+B+"/css.css","appearance"),D;if(!linb.UI.$cache_csspath[F]){if(D=C.$Appearances[B]){linb.css.add(C.buildCSSText(D,B=="default"?"":B),F)}else{if(!A){linb.css.include(F)}}linb.UI.$cache_csspath[F]=true}return C},buildCSSText:function(B,F){var J=this,G,E,L,C,T,W;var K=linb.debug,S=K?"\n":"",V=arguments.callee,Q=V.r1||(V.r1=/(^|\s|,)([0-9A-Z_]+)/g),O=V.r2||(V.r2=/\./g),R=[],H=[],U=linb.browser,D=U.ie6,I=U.ie,A=U.gek;if(!J.$cssKeys){L=J.$cssKeys={};G=J.$Keys;for(var P in G){L[P]=G[P].replace(O,"-")}}W=J.$cssKeys;if(F){G=W.KEY.toLowerCase();C=new RegExp("([\\w]+\\-\\-)?"+G,"g");T=F+"--"+G}for(var P in B){L=B[P];G=P.replace(Q,function(Y,X,Z){return X+"."+(W[Z]||Z)}).toLowerCase();if(F){G=G.replace(C,T)}L.$order=parseInt(L.$order)||0;L.$=G;R[R.length]=L}R.sort(function(X,Y){X=X.$order;Y=Y.$order;return X>Y?1:X==Y?0:-1});for(var P=0,M=R.length;P<M;){L=R[P++];H[H.length]=L.$+"{"+S;if(G=L.$before){H[H.length]=S+G+S}if(G=L.$text){H[H.length]=S+G+S}for(var N in L){switch(N.charAt(0)){case"$":continue;break;case"_":if(!D){continue}break;case"*":if(!I){continue}break;case"-":if(!A){continue}break}if((E=L[N])||L[N]===0){if(K){N="    "+N}switch(typeof E){case"string":case"number":H[H.length]=N+":"+E+";"+S;break;case"function":H[H.length]=N+":"+E(J.KEY)+";"+S;break;default:E.each(function(X){if(X){H[H.length]=N+":"+X+";"+S}})}}}if(E=L.$after){H[H.length]=S+E+S}H[H.length]="}"+S}return H.join("")},pickObj:function(A){return _.clone(A,function(B){return B.charAt(0)!="_"})},dropable:function(D,E){var B=this,C=linb.event.eventhandler2;if(!E){E=B.getDropKeys}(linb.cache.$dropPool[B.KEY]=linb.cache.$dropPool[B.KEY]||[]).push(D);B.$dropKey=B.$Keys[D];var A={beforeMouseover:function(G,J,F){var P=this,M=linb.dragDrop,L=M.dragKey,H=M.data,O,I,N,K;if(!L||!H||!(new RegExp("\\b"+L+"\\b")).test(E(G,P))){return }I=G.boxing();if(I.getItemByDom){O=I.getItemByDom(F)}K=[G,J,P,L,H,O];if(G.onDropTest&&(false===I.onDropTest.apply(I,K))){return }if((N=G.$onDropTest)&&(false===N.apply(G,K))){return }M._current=F;if(G.onDropMarkShow&&(false===I.onDropMarkShow.apply(I,K))){}else{if((N=G.$onDropMarkShow)&&(false===N.apply(G,K))){}else{_.resetRun("showDDMark",M.showDDMark,0,[P],M)}}if(N=G.$onDragEnter){N.apply(G,K)}if(G.onDragEnter){I.onDragEnter.apply(I,K)}return false},beforeMouseout:function(G,J,F){var O=this,M=linb.dragDrop,L=M.dragKey,H=M.data,N,I,K;if(M._current==F){I=G.boxing();K=[G,J,O,L,H,N];if(I.getItemByDom){N=I.getItemByDom(F)}if(G.onDropMarkClear&&(false===I.onDropMarkClear.apply(I,K))){}else{if((t=G.$onDropMarkClear)&&(false===t.apply(G,K))){}else{_.resetRun("showDDMark",M.showDDMark,0,[null],linb.dragDrop)}}if(t=G.$onDragLeave){t.apply(G,K)}if(G.onDragLeave){I.onDragLeave.apply(I,K)}M._current=null}return false},beforeDrop:function(G,J,F){var O=this,M=linb.dragDrop,L=M.dragKey,H=M.data,N,I=G.boxing(),K;if(I.getItemByDom){N=I.getItemByDom(F)}K=[G,J,O,L,H,N];if(G.onDropMarkClear&&(false===I.onDropMarkClear.apply(I,K))){}else{if((t=G.$onDropMarkClear)&&(false===t.apply(G,K))){}}if(t=G.$onDrop){t.apply(G,K)}if(G.onDrop){I.onDrop.apply(I,K)}}};_.each(B.$Behaviors,function(H,G){var F;if(D=="KEY"){F=H.$}else{if(!H.$[D]){H.$[D]={}}F=H.$[D]}_.merge(F,A,"all");if(!F.$eventhandler){F.$eventhandler={}}_.merge(F.$eventhandler,{onmouseover:C,onmouseout:C,ondrop:C})});if(!B.prototype.empty){B.prototype.empty=function(){return this.each(function(F){F.getSubNode(D).empty()})}}B.setEventHandlers({onDragEnter:function(G,K,I,F,J,H){},onDragLeave:function(G,K,I,F,J,H){},onDrop:function(G,K,I,F,J,H){},onDropTest:function(G,K,I,F,J,H){},onDropMarkShow:function(G,K,I,F,J,H){},onDropMarkClear:function(G,K,I,F,J,H){}});if(!B.$DataModel.dropKeys){B.setDataModel({dropKeys:""})}return B},dragable:function(D,E,C){var A=this,B=linb.event.eventhandler2;if(!E){E=A.getDragKey}if(!C){C=A.getDragData}_.each(A.$Behaviors,function(H,G){var F;if(D=="KEY"){F=H.$}else{if(!H.$[D]){H.$[D]={}}F=H.$[D]}_.merge(F,{beforeMousedown:function(I,J,K){if(!I.properties.dragKey){return }var L=linb.event.getPos(J);linb([K]).startDrag(J,{drop2:true,icon:linb.ini.path+"ondrag.gif",dragMode:"move",target_left:L.left+12,target_top:L.top+12,cursor:"pointer",defer:1,move:false,key:E(I,this),data:C(I,this)})},beforeDragbegin:function(I,J,K){linb(K).onMouseout(true,{$force:true}).onMouseup(true)}},"all");if(!F.$eventhandler){F.$eventhandler={}}_.merge(F.$eventhandler,{onmousedown:B,ondragbegin:B})});return A},copyItem:function(E,F){if(!F){F={}}var B,G,A=linb.wrapRes,D=arguments.callee,C=C||(C=D._r=/(\$)([\w\.]+)/g);for(B in E){if(B.charAt(0)=="$"){continue}if(!(B in F)){F[B]=(typeof (G=E[B])=="string"&&G.indexOf("$")!=-1)?G.replace(C,function(I,H,J){return A(J)}):G}}F.iconDisplay=E.icon?"":"display:none";return F},setCacheList:function(A,B){_.set(linb.cache,["list","List",A],B);return this},getCacheListType:function(A){return typeof _.get(linb.cache,["list","List",A])},getCacheList:function(B){var A=_.get(linb.cache,["list","List",B]);if(typeof A=="function"){A=A()}return _.clone(A)}}})};new function(){var A="linb.UI.";Class(A+"iWidget",["linb.UI","linb.iDataBinder"],{Instance:{getValue:function(){return this.get(0).properties.value},getUIValue:function(){return this.get(0).properties.$UIvalue},getCtrlValue:function(){return this.get(0).properties.$UIvalue},setUIValue:function(B){this.get(0).properties.$UIvalue=B;return this},setCtrlValue:function(B){return this},setDirtyMark:function(){return this},resetValue:function(C){var B=this;B.setCtrlValue(C||"");B.each(function(D){var E;if(typeof (E=D.box.ensureV)=="function"){C=E.call(D.box,D,C)}D.properties.$UIvalue=D.properties.value=C||"";if(typeof (E=D.$onValueSet)=="function"){E.call(D,C)}D.inValid=1});B.setDirtyMark();return B},updateUIValue:function(D,C){var B=this;this.each(function(E){var I=E.properties,G,H=I.$UIvalue,F=E.boxing();if(H!==D||C){if(false===E.box.checkValid(E,D)||(E.beforeValueUpdated&&false===(G=F.beforeValueUpdated(E,H,D)))){return }if(G!==undefined){D=G}if(typeof (G=E.box.ensureV)=="function"){D=G.call(E.box,E,D)}if(typeof (G=E.$onValueUpdated)=="function"){G.call(E,D)}if(E.domNode){F.setCtrlValue(D)}I.$UIvalue=D;if(E.domNode){F.setDirtyMark()}if(E.afterValueUpdated){F.afterValueUpdated(E,H,D)}}});return this},updateValue:function(){this.each(function(B){var C=B.properties;C.value=C.$UIvalue});return this.setDirtyMark()},isDirtied:function(){var B=this.get(0).properties;return B.value!==B.$UIvalue},checkUIValueValid:function(){var B=true;this.each(function(C){var D=C.properties;B=C.box.checkValid(C,D.$UIvalue)&&B;if(C.domNode){C.boxing().setDirtyMark()}});return B},disabled:function(B){return this.each(function(C){C.root.opacity(B?0.5:1)})}},Static:{$i:true,DataModel:{$UIvalue:"",tag:"",tagVar:{ini:{}},dragKey:"",value:{ini:null,set:function(C,B){this.each(function(D){var H=D.properties,F,G=H.value,E=D.boxing();if(G!==C||B){if(D.box.checkValid(D,C)===false){return }if(D.beforeValueSet&&false===(F=E.beforeValueSet(D,G,C))){return }if(F!==undefined){C=F}if(typeof (F=D.box.ensureV)=="function"){C=F.call(D.box,D,C)}if(typeof (F=D.$onValueSet)=="function"){F.call(D,C)}if(D.domNode){E.setCtrlValue(C)}H.value=H.$UIvalue=C;D.inValid=1;if(D.domNode){E.setDirtyMark()}if(D.afterValueSet){E.afterValueSet(D,G,C)}}});return this}},disabled:{ini:false,action:function(B){this.boxing().disabled(B)}},dock:{ini:"none",listbox:["none","top","bottom","left","right","center","middle","origin","width","height","fill","cover"],action:function(C){var B=this;if(B.domNode){B.box.dock(B,true)}}},exDock:{ini:false,action:function(C){var B=this;if(!C&&B.domNode&&B.properties.dock!="none"){B.box.dock(B,true,true)}}},dockOrder:{ini:1,action:function(C){var B=this;if(B.domNode&&B.properties.dock!="none"){B.box.dock(B,true,true)}}},dockMargin:{ini:{left:0,top:0,right:0,bottom:0},action:function(C){var B=this;if(B.domNode&&B.properties.dock!="none"){B.box.dock(B,true,true)}}},dockFloat:{ini:false,action:function(C){var B=this;if(B.domNode&&B.properties.dock!="none"){B.box.dock(B,true,true)}}},dockMinW:0,dockMinH:0,tips:""},Behaviors:{"default":{}},EventHandlers:{beforeValueSet:function(D,B,E,C){},afterValueSet:function(D,B,E,C){},beforeValueUpdated:function(D,B,E,C){},afterValueUpdated:function(D,B,E,C){},beforeHoverEffect:function(C,D,E,B){},beforeClickEffect:function(C,D,E,B){},beforeNextFocus:function(C,D,B,E){},afterCreated:function(B){},afterRendered:function(B){},beforeDestroy:function(B){},onHotKeydown:function(D,C,G,B,F,E,H){},onHotKeypress:function(D,C,G,B,F,E,H){},onHotKeyup:function(D,C,G,B,F,E,H){},onShowTips:function(B,C,D){}},createdTrigger:function(){var C=this,B=C.boxing(),D=C.properties;D.$UIvalue=D.value;if(D.value!==undefined){B.setCtrlValue(D.value)}if(D.disabled){B.disabled(true)}C.inValid=1;C.created=true;if(C.afterCreated){B.afterCreated(C)}},renderedTrigger:function(){var F=arguments.callee,C=this,B=C.boxing(),G=C.properties,D=C.box;if(D.resize){var E=F.wc||(F.wc={top:1,bottom:1,width:1,fill:1,cover:1}),H=F.hc||(F.hc={left:1,right:1,height:1,fill:1,cover:1});E=E[G.dock]?null:G.width;H=H[G.dock]?null:G.height;if(E!==null||H!==null){D.resize(C,E,H)}}if(G.dock&&G.dock!="none"){D.dock(this,true)}C.rendered=true;if(C.afterRendered){B.afterRendered(C)}},dock:function(H,N,E){var C=H.properties,J=C.dockMargin,G=H.root,P=C.dock||"none",D=G.parent(),R="auto",K=D.id(),F=function(S,T){S=parseInt(S.properties.dockOrder)||0;T=parseInt(T.properties.dockOrder)||0;return S>T?1:S==T?0:-1},M=false,O,B="$inMatix",L,Q,I=function(S){return linb.browser.ie6?S-S%2:S};if(linb.dom.isMatix(K)){return }if(H.$dockParent!=K||H.$dockType!=P||E){H.$dockParent=K;H.$dockType=P;H.antiLinks("$dock");H.antiLinks("$dock1");H.antiLinks("$dock2");switch(P){case"middle":O={right:R,bottom:R,left:C.left||"",width:C.width||"",height:C.height||""};break;case"center":O={right:R,bottom:R,top:C.top||"",width:C.width||"",height:C.height||""};break;case"origin":O={right:R,bottom:R,width:C.width||"",height:C.height||""};break;case"top":O={left:J.left,right:J.right,bottom:R,height:C.height||""};break;case"bottom":O={left:J.left,right:J.right,top:R,height:C.height||""};break;case"left":O={right:R,width:C.width||""};break;case"right":O={left:R,width:C.width||""};break;case"width":O={bottom:R,height:C.height||"",top:C.top||""};break;case"height":O={right:R,width:C.width||"",left:C.left||""};break;case"fill":case"cover":O={right:R,bottom:R};break;case"none":O={left:C.left,top:C.top,width:C.width||"",height:C.height||""};break}G.setRegion(O,true);if(D.get(0)===document.body){D=linb([window]);M=true;if(M&&!linb.cache._resizeTime){linb.cache._resizeTime=1}}if(P!="none"){L=D.getEvent("onRewh","dock");if(!L){L=function(U,h){var f=arguments.callee,S=f.map||(f.map={middle:1,center:1}),b=f.arr,c=f.rePos,W=f.node,T=W.get(0).style,d=f.win,Z,Y,X,V,g,e;if(h.$dockid||!d||(_()-linb.cache._resizeTime>100)){Z={left:0,top:0,right:0,bottom:0,width:parseInt(T&&T.width)||W.width(),height:parseInt(T&&T.height)||W.height()};for(X=0;g=b[X++];){e=f[g];if(e.length){if(!S[g]){h.width=h.height=1}for(Y=0;V=e[Y++];){if(!V.properties.exDock){c(V,Z,g,h.$dockid,d||h.width,d||h.height)}}}}if(Z.later){_.each(Z.later,function(j){try{j.node.setRegion(j,true,true)}catch(i){_.asyRun(function(){j.width+=1;j.height+=1;j.node.setRegion(j,true,true)})}})}if(d){linb.cache._resizeTime=_()}}};L.node=D;L.arr=["top","bottom","left","right","center","middle","width","height"];L.arr.each(function(S){L[S]=[]});L.win=M;L.rePos=function(T,c,g,f,b,l){var k=false;if(f&&T.$id!=f){k=true}var S=T.properties,j=S.dockFloat,e=S.dockMargin,i=T.root,m=T.domNode.style,V,d,o,X,n,W,Z=parseInt(S._dockBorderWidth)||0,Y=parseInt(S._dockBorderHeight)||0,U={};switch(g){case"middle":i.top((c.height-i.height())/2);break;case"center":i.left((c.width-i.width())/2);break;case"top":if(!k){V=e.left;o=e.right;d=(j?0:c.top)+e.top;if(parseFloat(m.top)!=d){U.top=d}n=c.width-V-o-Z;if(parseFloat(m.width)!=n){U.width=I(n)}if(!_.isEmpty(U)){i.setRegion(U,true)}}if(!j){c.top+=(i.offsetHeight()+e.top+e.bottom)}break;case"bottom":if(!k){V=e.left;o=e.right;X=(j?0:c.bottom)+e.bottom;if(parseFloat(m.bottom)!=X){U.bottom=X}n=c.width-V-o-Z;if(parseFloat(m.width)!=n){U.width=I(n)}if(!_.isEmpty(U)){i.setRegion(U,true)}}if(!j){c.bottom+=(i.offsetHeight()+e.top+e.bottom)}break;case"left":if(!k){V=(j?0:c.left)+e.left;d=(j?0:c.top)+e.top;X=(j?0:c.bottom)+e.bottom;if(parseFloat(m.left)!=V){U.left=V}if(parseFloat(m.top)!=d){U.top=d}n=c.height-d-X-Y;if(parseFloat(m.height)!=n){U.height=I(n)}if(!_.isEmpty(U)){i.setRegion(U,true)}}if(!j){c.left+=(i.offsetWidth()+e.left+e.right)}break;case"right":if(!k){o=(j?0:c.right)+e.right;d=(j?0:c.top)+e.top;X=(j?0:c.bottom)+e.bottom;if(parseFloat(m.right)!=o){U.right=o}if(parseFloat(m.top)!=d){U.top=d}n=c.height-d-X-Y;if(parseFloat(m.height)!=n){U.height=I(n)}if(!_.isEmpty(U)){i.setRegion(U,true)}}if(!j){c.right+=(i.offsetWidth()+e.left+e.right)}break;case"width":if(!b){return }V=(S.dock=="cover"?0:(j?0:c.left))+e.left;o=(S.dock=="cover"?0:(j?0:c.right))+e.right;d=S.dock=="width"?(parseInt(S.top)||0):((S.dock=="cover"?0:(j?0:c.top))+e.top);n=c.width-V-o-Z;c.later=c.later||{};c.later[T.$id]=c.later[T.$id]||{};_.merge(c.later[T.$id],{node:i,width:I(S.dockMinW?Math.max(S.dockMinW,n):n),left:V,top:d},"all");break;case"height":if(!l){return }d=(S.dock=="cover"?0:(j?0:c.top))+e.top;X=(S.dock=="cover"?0:(j?0:c.bottom))+e.bottom;V=S.dock=="height"?(parseInt(S.left)||0):((S.dock=="cover"?0:(j?0:c.left))+e.left);n=c.height-d-X-Y;c.later=c.later||{};c.later[T.$id]=c.later[T.$id]||{};_.merge(c.later[T.$id],{node:i,height:I(S.dockMinH?Math.max(S.dockMinH,n):n),left:V,top:d},"all");break}};D.onRewh(L,"dock")}if(P=="fill"||P=="cover"){H.links(L.height,"$dock1");H.links(L.width,"$dock2");L.height.sort(F);L.width.sort(F)}else{if(P=="origin"){H.links(L.center,"$dock1");H.links(L.middle,"$dock2")}else{H.links(L[P],"$dock");L[P].sort(F)}}linb.cache._resizeTime=1;H.$dock=L}}if(P!="none"&&N){H.$dock(H,{width:1,height:1,$dockid:["width","height","fill","cover"].exists(P)?H.$id:null,$type:P})}},checkValid:function(B,C){return true},beforeSerialized:function(C){var D=C.boxing(),B,F=C.copy(),E=F.properties=_.copy(C.properties);switch(E.dock){case"top":case"bottom":delete E.width;delete E.left;delete E.top;delete E.right;delete E.bottom;break;case"left":case"right":delete E.height;delete E.left;delete E.top;delete E.right;delete E.bottom;break;case"width":delete E.width;break;case"height":delete E.height;break;case"fill":case"cover":delete E.width;delete E.height;break}if(E.items&&E.items.length){t=linb.Base.$specialChars;E.items=_.clone(E.items,function(G){return !t[G.charAt(0)]})}if(E.listKey&&!E.$first){E.items.length=0}return F},getDropKeys:function(B,C){return B.properties.dropKeys},getDragKey:function(B,C){return B.properties.dragKey},getDragData:function(B,C){return{profile:B,domId:C.id}},prepareData:function(D,I){var B=D.properties,G=D.data,H=this.getDataModel(),J=arguments.callee,C=J.map||(J.map="left,top,bottom,right,width,height".toArr()),K=[""],L;if(B.id){delete B.id}if("caption" in H&&B.caption!==null){B.caption=B.caption===undefined?D.alias:B.caption}if("$border" in H){G.bWidth=B.width-(L=(B.$border||0)*2);G.bHeight=B.height-L}for(var E=0,F;F=C[E];E++){if(B[F]||B[F]===0){if(String(parseFloat(B[F]))==String(B[F])){K[K.length]=F+":"+(parseInt(B[F])||0)+"px"}else{if(B[F]!="auto"&&B[F]){K[K.length]=F+":"+B[F]}}}}if(B.position){K[K.length]="position:"+B.position}if(B.visibility){K[K.length]="visibility:"+B.visibility}if(B.zIndex){K[K.length]="z-index:"+B.zIndex}if(B.display){K[K.length]="display:"+(B.display=="inline-block"?linb.browser.gek?"-moz-inline-block;display:-moz-inline-box;display:inline-block;":"inline-block":B.display)}K[K.length]="";G._style=K.join(";");if("href" in H){G.href=B.href||"javascript:;"}if("tabindex" in H){G.tabindex=B.tabindex||"-1"}if("items" in H){D.ItemIdMapSubSerialId={};D.SubSerialIdMapItem={};if((L=B.items)&&L.constructor==Array&&L.length===0){L=B.items=[]}if(!L||L.constructor!=Array){L=B.items=linb.UI.getCacheList(B.listKey||(this.$recursive?"test1":"test2"))}if(!L||L.constructor!=Array){L=B.items=[]}G.items=this.prepareItems(D,L)}G=linb.UI.copyItem(B,G);D.prepared=true;return G},prepareItems:function(E,J,I){var L=[],K,B,D=linb.UI.subSerialIdTag,C,G=E.properties.tabindex;for(var H=0,F=J.length;H<F;H++){K=J[H];B={id:K.id,_tabindex:G};if(I){B._parent=I}C=E.pickSubId("items");B[D]=E.ItemIdMapSubSerialId[K.id]=C;E.SubSerialIdMapItem[C]=K;linb.UI.copyItem(K,B);if(this.prepareItem){this.prepareItem(E,B,K,I)}L.push(B)}return L},showTips:function(B,C,D){if(B.onShowTips){return B.boxing().onShowTips(B,C,D)}}},Initialize:function(){var B=this,C={};"left,top,width,height,right,bottom".toArr().each(function(D){C[D]={ini:"auto",action:function(H){var F=this,I=F.properties,E=false,G={$type:I.dock};if(F.domNode){switch(I.dock){case"top":if(D!="height"&&D!="top"){return }G.width=G.height=1;break;case"bottom":if(D!="height"&&D!="bottom"){return }G.width=G.height=1;break;case"left":if(D!="width"&&D!="left"){return }G.width=G.height=1;break;case"right":if(D!="width"&&D!="right"){return }G.width=G.height=1;break;case"width":if("width"==D){return }G.width=1;break;case"height":if("height"==D){return }G.height=1;break;case"fill":case"cover":if(D=="width"&&D=="height"){return }G.width=G.height=1;break}F.root[D](H);if(I.dock!="none"){_.tryF(F.$dock,[F,G],F)}}}}});_.merge(C,{zIndex:{ini:1,action:function(D){if(this.domNode){this.root.zIndex(D)}}},tabindex:{ini:1},position:{ini:"absolute",listbox:["relative","absolute"],action:function(D){if(this.domNode){this.root.position(D)}}},visibility:{ini:"",combobox:["","visible","hidden"],action:function(D){if(this.domNode){this.root.visibility(D)}}},display:{ini:"",combobox:["","none","block","inline","inline-block"],action:function(D){if(this.domNode){if(D=="inline-block"){this.root.inlineBlock(true)}else{this.root.display(D)}}}}});B.setDataModel(C);"left,top,width,height,right,bottom,zIndex,position,visibility".toArr().each(function(D){var E="refresh"+D.initial();B.prototype[E]=Class._fun(function(){var F=this;F.each(function(H){var G=(H.domNode)?H.root[D]():H.properties[D];F["set"+D.initial()](G)});return F["get"+D.initial()]()},E,B.KEY)})}});Class(A+"Widget",A+"iWidget",{Static:{$i:true,cssNone:false,Templates:{"default":{className:"linb-uishell ",style:"{_style}",FRAME:{className:"linb-uiframe ",BORDER:{style:"width:{bWidth}px;height:{bHeight}px;",className:"linb-uiborder "}}}},PublicAppearance:{".linb-uishell":{display:linb.browser.gek?["-moz-inline-block","-moz-inline-box","inline-block"]:"inline-block",overflow:"hidden",border:0,padding:0,margin:0},".linb-uiframe":{$order:1,display:"block",position:"relative",overflow:"hidden",border:0,padding:0,margin:0,width:"100%",height:"100%","-moz-box-flex":"1"},".linb-uiborder":{$order:2,display:"block",position:"absolute",border:0,padding:0,margin:0,left:0,top:0,width:"100%",height:"100%"}},Behaviors:{"default":{_keyHook:true,onRewh:function(E,F,G){var D=E.domNode.style,B=null,C=null;if(F.width){B=parseInt(D.width)||0}if(F.height){C=parseInt(D.height)||0}E.box.resize(E,B,C)}}},DataModel:{caption:{action:function(B){this.getSubNode("CAPTION").get(0).innerHTML=B}},icon:{ini:"",action:function(B){this.getSubNode("ICON").display(B?"":"none").setStyle("backgroundImage","url("+(B||"")+")")}},iconPos:{ini:"",action:function(B){this.getSubNode("ICON").setStyle("backgroundPosition",B)}},$paddingTop:0,$paddingLeft:0,$paddingBottom:0,$paddingRight:0,$border:0},createdTrigger:function(){var B=this,C=B.properties,D=B.boxing();_.asyRun(function(){if((!B.$noB)&&C.border&&D._border){D._border(C.border)}if((!B.$noR)&&C.resizable&&D.setResizable){D.setResizable(C.resizable,true)}if((!B.$noS)&&C.shadow&&D._shadow){D._shadow(C.shadow)}})},resize:function(E,H,F){var C=E.getSubNode("BORDER"),J=E.properties,D=null,G=null,B=null,I=null;if(null!==H){H-=(J.$border*2+J.$paddingLeft+J.$paddingRight);if(linb.browser.ie6){H=(parseInt(H/2))*2}D=J.$paddingLeft;B=H}if(null!==F){F-=(J.$border*2+J.$paddingTop+J.$paddingBottom);if(linb.browser.ie6){F=(parseInt(F/2))*2}G=J.$paddingTop;I=F;if(linb.browser.ie6&&null===H){C.ieTrigger()}}C.setRegion({left:D,top:G,width:B,height:I});return{width:B,height:I}}}});Class(A+"iList","linb.UI",{Instance:{activate:function(){var C=this.get(0),B=C.getSubNode("ITEM",true);if(!B.isEmpty()){B.focus()}return this},insertItems:function(G,C,K){if(!G||!G.length){return }var L=this.constructor,D,I,H,B,E,F,J=this.afterInsertItems;return this.each(function(N){F=N.box;I=N.properties.items;H=I.subIndexOf("id",C);if(H==-1){I.insertAny(G)}else{I.insertAny(G,K?H:H+1)}E=F.prepareItems(N,G,C);if(N.domNode){var M=L.subBuild(N,"items",E);if(H==-1){D=N.getSubNode(F.ITEMSKEY||N.keys.ITEMS||N.keys.KEY);if(typeof K=="boolean"){B=M.toDom();if(K||I.length==1){D.addFirst(B)}else{D.addLast(B)}}else{D.html(M)}}else{B=M.toDom();D=N.getSubNodeByItemId(F.ITEMKEY||"ITEM",C);if(K===true){D.addPre(B)}else{D.addNext(B)}}}if(J){N.boxing().afterInsertItems(N,E,C,K)}})},removeItems:function(C){if(!(C instanceof Array)){C=[C]}var E,D,B=this.beforeRemoveItems;remove=function(I,F,K,H,J){var G=arguments.callee;if(!H){H=linb([])}F.filter(function(O){var N,L;if(J||(L=K.exists(O.id))){if(N=I.ItemIdMapSubSerialId[O.id]){delete I.SubSerialIdMapItem[N];delete I.ItemIdMapSubSerialId[O.id];I.cacheSubId(N,"items");if(!J){if(!(E=I.getSubNode("ITEM",N)).isEmpty()){H.add(E)}}}}if(O.sub){G(I,O.sub,K,H,J||L)}if(L){for(var M in O){O[M]=null}return false}},null,true);H.remove()};if(B){profile.boxing().beforeRemoveItems(profile,C)}return this.each(function(F){remove(F,F.properties.items,C);if(D=F.properties.value){if((D=D.split(";")).length>1){D.filter(function(G){return !C.exists(G)});F.properties.value=D.join(";")}else{if(C.exists(F.properties.value)){F.properties.value=null}}}})},clearItems:function(B){return this.each(function(C){if(!C.SubSerialIdMapItem){return }C.getSubNode(C.keys[B]||C.keys.ITEMS||"KEY",true).empty();_.each(C.SubSerialIdMapItem,function(E,D){C.cacheSubId(D,"items")});if(C.properties.items){C.properties.items.length=0}C.SubSerialIdMapItem={};C.ItemIdMapSubSerialId={};C.properties.value=null})}},Initialize:function(){var C={id:"a",caption:"itema",tips:"item a"},B={id:"b",caption:"itemb",tips:"item b"},E={id:"c",caption:"itemc",tips:"item c"},D={id:"a",caption:"itema",tips:"item a",sub:[{id:"aa",caption:"suba"},{id:"ab",caption:"subb"}]};this.setCacheList("test1",[D,B,E]).setCacheList("test2",[C,B,E]);"getItemByItemId,getItemByDom,getIdBySubId,getSubSerialIdByItemId".toArr().each(function(F){this[F]=function(){var G=this.get(0);return G[F].apply(G,arguments)}},this.prototype)},Static:{$i:true,cssNone:true,DataModel:{listKey:{ini:"",set:function(C,B){return this.each(function(E){if(E.properties.listKey!=C||B){var D=linb.UI.getCacheList(C);if(D){E.boxing().setItems(D)}else{E.boxing().setItems(E.properties.items)}E.properties.listKey=C}})}},items:{ini:{},set:function(B){return this.each(function(C){if(C.domNode){C.boxing().clearItems().insertItems(B)}C.properties.items=B})}}},showTips:function(D,F,I){var C=D.properties,H=F.id,B=D.getSubSerialId(H),G=D.SubSerialIdMapItem,E=G&&G[B];if(C.disabled){return }if(E&&E.disabled){return }if(E&&E.tips){linb.UI.Tips.show(I,E);return true}else{return false}}}});"iContainer,iForm,iMisc,iNavigator,iSchedule".toArr().each(function(B){Class(A+B,null,{Static:{$i:true}})});Class(A+"Link",A+"iWidget",{Static:{cssNone:true,Templates:{"default":{tagName:"a",style:"{_style}",href:"{href}",target:"{target}",tabindex:"{tabindex}",text:"{caption}"}},Behaviors:{"default":{onClick:function(B,D,E){var C;if(!B.properties.disabled&&B.onClick){C=B.boxing().onClick(B,D,E)}return C!==undefined?C:false}}},DataModel:{dataBinder:null,dataField:null,caption:{action:function(B){this.root.get(0).innerHTML=B}},href:{ini:"javascript:;",action:function(B){if(this.domNode){this.root.href(B)}}},target:{ini:"",action:function(B){if(this.domNode){this.root.attr("target",B)}}}},EventHandlers:{onClick:function(B,C){}}}});Class(A+"Div",A+"iWidget",{Static:{cssNone:true,Templates:{"default":{tagName:"div",style:(linb.browser.gek?"overflow:auto;outline:none;":";")+(linb.browser.ie6?"zoom:1;":";")+"{_style}",tabindex:"-1",text:"{html}"+linb.UI.$childTag}},DataModel:{dataBinder:null,dataField:null,value:null,disabled:null,width:"100",height:"100",html:{ini:"",action:function(B){this.domNode.innerHTML=B}}},prepareData:function(B){arguments.callee.upper.call(this,B)},EventHandlers:{beforeValueSet:null,afterValueSet:null,beforeValueUpdated:null,afterValueUpdated:null,beforeHoverEffect:null,beforeNextFocus:null,beforeClickEffect:null}}});Class(A+"Tag",A+"Div",{Static:{Templates:{"default":{tagName:"div",style:"overflow:auto;border:dashed blue 1px;text-align:center;background:#FAF0E6;{_style}",text:"{tagKey}"+linb.UI.$childTag}},DataModel:{html:null,tagKey:{ini:"",action:function(B){this.root.html(B)}}},_l:"left,top,bottom,right,width,height,zIndex,tabindex,position,dock,dockFloat,dockMinW,dockMinH,dockOrder,dockMargin".toArr(),replace:function(C,D){this._l.each(function(G){if(G in C.properties){D.properties[G]=C.properties[G]}});_.merge(D.CA,C.CA,"all");_.merge(D.CC,C.CC,"all");if(C.parent){var E=C.parent.children,F=E[C.$id],B=E.indexOf(F);C.parent.boxing().attach(D,F[1]);E[B]=E.pop();C.antiLinks("$parent");delete C.parent}}}});Class(A+"Panel",[A+"Div",A+"iContainer"],{Static:{Dropable:["KEY"]}})};Class("linb.coder",null,{Constructor:function(){return _.tryF(this.constructor.parse,arguments,this.constructor)},Initialize:function(){linb.css.add('.sh {font-family: "Courier New" , Courier, mono;font-size: 12px;border: 1px solid #92D1E4;}.sh .con{padding-bottom:3px;background-color: #fff;}.sh .cmd{margin-left: 45px; padding: 3px 8px 3px 10px;font: 9px Verdana, Geneva, Arial, Helvetica, sans-serif;color: silver;border-bottom: 1px solid #EBEADB;}.sh .cmd a{font-size: 12px;color: blue;text-decoration: none;margin-right: 10px;}.sh .cmd a:hover{color: red;text-decoration: underline;}.sh ol{color: #FF97A9; margin: 0px 0px 0px 45px; padding: 0; border-bottom: 1px solid #EBEADB; }.sh ol li{border-left: 3px solid #6CE26C;padding-left: 10px;line-height: 14px;list-style: decimal none;margin:0;border-bottom: 1px dashed #E2E2E2;}.sh ol li span{color: #000157;}.sh .js .comment, .sh .php .comment{ color: green; }.sh .js .string, .sh .php .string{ color: #ff1493; }.sh .js .reg, .sh .php .reg{ color: #ff1493; }.sh .js .number,.sh .php .number { color: darkred; }.sh .js .keyword, .sh .php .keyword{ color: blue; }.sh .js .keyword2, .sh .php .keyword2 { font-weight: bold; color: red; }.sh .js .special, .sh .php .special{ font-weight: bold; color: navy; }.sh .php .vars{color:#079BFA}.sh .css .comment { color: green; }.sh .css .string { color: red; }.sh .css .colors { color: darkred; }.sh .css .vars { color: #d00; }.sh .css .number { color: blue; }.sh .css .keyword {color:teal;}.sh .css .selector {font-weight: bold; color: navy;}.sh .html .comment { color: green; }.sh .html .string{ color: #ff1493; }.sh .html .script{ color: #ff1493; }.sh .html .attr { color: blue; }.sh .html .speical{color:#079BFA}.sh .html .tag { font-weight: bold; color: navy; }',linb.getPath(this.KEY,"/css.css","appearance"));this.setProfile("js",{multicomment:this.$COM_REG.BLOCK_COMMENT,comment:this.$COM_REG.LINE_COMMENT,reg1:this.$COM_REG.REG1,reg2:this.$COM_REG.REG2,string1:this.$COM_REG.DQ_STRING,string2:this.$COM_REG.SQ_STRING,number:this.$COM_REG.NUMBER,keyword:"try|throw|catch|finally|arguments|break|case|continue|default|delete|do|else|false|for|function|if|in|instanceof|new|null|return|switch|this|true|typeof|var|void|while|with|toString|valueOf|window|prototype|document|escape|unescape|parseInt|parseFloat|setTimeout|clearTimeout|setInterval|clearInterval|NaN|isNaN|Infinity|Error",keyword2:"exists|isNull|isObj|isEmpty|isArr|isBool|isDate|isFun|isHash|isNumb|isStr|_.arr|_.bool|_.cls|_.date|_.fun|_.hash|_.numb|_.str|_.id|_|alias|host|attach|toArr|breakO|tryF|each|copy|clone|filter|asyRun|resetRun|merge|each|swap|removeFrom|filter|indexOf|clean|insertAny|serialize|unserialize|Class|Instance|Initialize|Before|After|Static|Constructor|reBoxing|copy|clone|left|top|right|bottom|startWith|endWith|initial|trim|ltrim|rtrim|blen|toDom|create",special:/linb[\w\.]*|(\bon|before|after|set|get)[A-Z]\w*/}).setProfile("css",{multicomment:this.$COM_REG.BLOCK_COMMENT,string:[this.$COM_REG.DQ_STRING,this.$COM_REG.SQ_STRING],IGNORE:/\([^'")]*\)/,keyword:[/@\w[\w.\s]*/,/attr|rect|rgb|url/],selector:/[\w-:\[.#][^{};]*\{/,colors:/\#[a-zA-Z0-9]{3,6}/,number:[/(\d*\.?\d+|\d+\.?\d*)(cm|em|ex|pt|px|%|\:)?/],vars:[/(-[\w-]+)\s*[ ]*:/,/([\w-]+)\s*[ ]*:/]}).setProfile("php",{multicomment:this.$COM_REG.BLOCK_COMMENT,comment:this.$COM_REG.LINE_COMMENT,reg:this.$COM_REG.REG,string:[this.$COM_REG.DQ_STRING,this.$COM_REG.SQ_STRING],number:this.$COM_REG.NUMBER,keyword:"abs|acos|acosh|addcslashes|addslashes|array_change_key_case|array_chunk|array_combine|array_count_values|array_diff|array_diff_assoc|array_diff_key|array_diff_uassoc|array_diff_ukey|array_fill|array_filter|array_flip|array_intersect|array_intersect_assoc|array_intersect_key|array_intersect_uassoc|array_intersect_ukey|array_key_exists|array_keys|array_map|array_merge|array_merge_recursive|array_multisort|array_pad|array_pop|array_product|array_push|array_rand|array_reduce|array_reverse|array_search|array_shift|array_slice|array_splice|array_sum|array_udiff|array_udiff_assoc|array_udiff_uassoc|array_uintersect|array_uintersect_assoc|array_uintersect_uassoc|array_unique|array_unshift|array_values|array_walk|array_walk_recursive|atan|atan2|atanh|base64_decode|base64_encode|base_convert|basename|bcadd|bccomp|bcdiv|bcmod|bcmul|bindec|bindtextdomain|bzclose|bzcompress|bzdecompress|bzerrno|bzerror|bzerrstr|bzflush|bzopen|bzread|bzwrite|ceil|chdir|checkdate|checkdnsrr|chgrp|chmod|chop|chown|chr|chroot|chunk_split|class_exists|closedir|closelog|copy|cos|cosh|count|count_chars|date|decbin|dechex|decoct|deg2rad|delete|ebcdic2ascii|echo|empty|end|ereg|ereg_replace|eregi|eregi_replace|error_log|error_reporting|escapeshellarg|escapeshellcmd|eval|exec|exit|exp|explode|extension_loaded|feof|fflush|fgetc|fgetcsv|fgets|fgetss|file_exists|file_get_contents|file_put_contents|fileatime|filectime|filegroup|fileinode|filemtime|fileowner|fileperms|filesize|filetype|floatval|flock|floor|flush|fmod|fnmatch|fopen|fpassthru|fprintf|fputcsv|fputs|fread|fscanf|fseek|fsockopen|fstat|ftell|ftok|getallheaders|getcwd|getdate|getenv|gethostbyaddr|gethostbyname|gethostbynamel|getimagesize|getlastmod|getmxrr|getmygid|getmyinode|getmypid|getmyuid|getopt|getprotobyname|getprotobynumber|getrandmax|getrusage|getservbyname|getservbyport|gettext|gettimeofday|gettype|glob|gmdate|gmmktime|ini_alter|ini_get|ini_get_all|ini_restore|ini_set|interface_exists|intval|ip2long|is_a|is_array|is_bool|is_callable|is_dir|is_double|is_executable|is_file|is_finite|is_float|is_infinite|is_int|is_integer|is_link|is_long|is_nan|is_null|is_numeric|is_object|is_readable|is_real|is_resource|is_scalar|is_soap_fault|is_string|is_subclass_of|is_uploaded_file|is_writable|is_writeable|mkdir|mktime|nl2br|parse_ini_file|parse_str|parse_url|passthru|pathinfo|readlink|realpath|rewind|rewinddir|rmdir|round|str_ireplace|str_pad|str_repeat|str_replace|str_rot13|str_shuffle|str_split|str_word_count|strcasecmp|strchr|strcmp|strcoll|strcspn|strftime|strip_tags|stripcslashes|stripos|stripslashes|stristr|strlen|strnatcasecmp|strnatcmp|strncasecmp|strncmp|strpbrk|strpos|strptime|strrchr|strrev|strripos|strrpos|strspn|strstr|strtok|strtolower|strtotime|strtoupper|strtr|strval|substr|substr_compare",keyword2:"and|or|xor|__FILE__|__LINE__|array|as|break|case|cfunction|class|const|continue|declare|default|die|do|else|elseif|empty|enddeclare|endfor|endforeach|endif|endswitch|endwhile|extends|for|foreach|function|include|include_once|global|if|new|old_function|return|static|switch|use|require|require_once|var|while|__FUNCTION__|__CLASS__|__METHOD__|abstract|interface|public|implements|extends|private|protected|throw",vars:/\$\w+/}).setProfile("html",{multicomment:this.$COM_REG.HTML_COMMENT,tag:/\x02\/?\w+/,attr:/\w+=/,script:/(>([^<][^\/]*<+)*\/)(script|style)>/,special:/<!DOCTYPE[^>]+>/,string:[this.$COM_REG.DQ_STRING,this.$COM_REG.SQ_STRING]})},Static:{$COM_REG:{HTML_COMMENT:/<!\s*(--([^-]|[\r\n]|-[^-])*--\s*)>/,BLOCK_COMMENT2:/(^|\n)\s*\/\*[^*@]*\*+([^\/][^*]*\*+)*\//,LINE_COMMENT2:/(^|\n)\s*\/\/[^\n]*/,BLOCK_COMMENT:/\/\*[^*@]*\*+([^\/][^*]*\*+)*\//,LINE_COMMENT:/\/\/[^\n]*/,REG1:/\s+(\/[^\/\n\r\*][^\/\n\r]*\/m?g?i?)\s*[:,;\r\n]/,REG2:/[^\w\x24\/'"*)\]\?:]\/[^\/\n\r\*][^\/\n\r]*\/m?g?i?\s*[:,;\r\n]/,DQ_STRING:/"(\\.|[^"\\])*"/,SQ_STRING:/'(\\.|[^'\\])*'/,NUMBER:/-?(\d*\.?\d+|\d+\.?\d*)([eE][+-]?\d+|%)?\b/},replace:function(F,B,U,A){var K,M,Q,G,E,J,V=[],T=[];var S=arguments.callee,R=S.reg1||(S.reg1=/\\./g),P=S.reg2||(S.reg2=/\(/g),O=S.reg3||(S.reg3=/\$\d/),N=S.reg4||(S.reg4=/^\$\d+$/),L=S.reg5||(S.reg5=/'/),I=S.reg6||(S.reg6=/\\./g),W=S.reg11||(S.reg11=/(['"])\1\+(.*)\+\1\1$/);if(!_.isArr(B)){B=[B,U]}else{A=U}if(!_.isArr(B[0])){B=[B]}B.each(function(X){G=(_.isStr(X[0])?X[0]:_.isReg(X[0])?String(X[0]).slice(1,-1):"");E=_.isFun(X[1])?X[1]:_.str(X[1]);M=((G).replace(R,"").match(P)||"").length;if(!_.isFun(E)){if(O.test(E)){if(N.test(E)){Q=parseInt(E.slice(1));if(Q<=M){E=Q}}else{J=L.test(E.replace(I,""))?'"':"'";K=M;while(K+1){E=E.split("$"+K).join(J+"+a[o+"+K--+"]+"+J)}E=new Function("a,o","return"+J+E.replace(W,"$1")+J)}}}V.push(G||"^$");T.push([E,M,typeof E])});var K,H,D,C;return F.replace(new RegExp("("+V.join(")|(")+")",A?"ig":"g"),function(){if(!arguments[0]){return""}K=1;H=0;while(D=T[H++]){if(C=arguments[K]){switch(D[2]){case"function":return D[0](arguments,K);case"number":return arguments[D[0]+K];default:return D[0]}}else{K+=D[1]+1}}})},decode:function(O,V){var F,J,S,C=[];var Q=0,R,P=20,U=function(W){var X="";while(W--){X+=" "}return X},T=[""];for(R=1;R<P;R++){T.push(U(R*4))}if(V=="html"){C.push([/[\s]*(<[\w]+[^>]+>)[\s]*/,"$1"]);C.push([/[\s]*(<\/[\w]+>)[\s]*/,"$1"]);O=this.replace(O,C);C.length=0;C.push([this.$COM_REG.HTML_COMMENT,"$0\\n"]);C.push([/<input[^>]+>/,function(W,X){return T[Q]+W[X]+"\n"}]);C.push([/<img[^>]+>/,function(W,X){return T[Q]+W[X]+"\n"}]);C.push([/<[\w]+[^>]*\/>/,function(W,X){return T[Q]+W[X]+"\n"}]);C.push([/[^<]+/,function(W,X){return T[Q]+W[X]+"\n"}]);C.push([/<[\w]+[^>]*>/,function(W,X){return T[Q++]+W[X]+"\n"}]);C.push([/<\/[\w]+>/,function(W,X){return T[--Q]+W[X]+"\n"}]);O=this.replace(O,C,true)}else{F=this.$COM_REG;var L,I=1,H=1,N={},M={},K,B,G=function(Y,X){var W="#"+I+++";";N[W]=Y[X];return W},E=function(Y,X){var W="`"+H+++";";M[W]=Y[X];return W},D=function(W){return W.replace(/( *)(#\d+;)/g,function(Y,Z,X){Z=Z||"";return Z+N[X].replace(/^\s*/,"").replace(/\s*$/,"").replace(/(\n)( *)/g,"$1"+Z)})},A=function(W){return W.replace(/`(\d+);/g,function(X){return M[X].replace(/^\s*/,"").replace(/\s*$/,"")})};O=linb.coder.replace(O,[[F.BLOCK_COMMENT2,G],[F.LINE_COMMENT2,E]]);J=[[F.REG1,"$0"],[F.REG2,"$0"],[F.DQ_STRING,"$0"],[F.SQ_STRING,"$0"]];S=[[/(\b|\x24)\s+(\b|\x24)/,"$1 $2"],[/([+\-])\s+([+\-])/,"$1 $2"],[/\s+/,""]];if(V=="css"){S.insertAny([/\s+(\.)/," $1"],2,true);S.insertAny([/(\d*\.?\d+|\d+\.?\d*)(cm|em|ex|pt|px|%|\:)?/," $0 "],-1,true)}C.length=0;C.insertAny(J);C.insertAny(S);O=this.replace(O,C);J[0][1]=J[1][1]=function(W,X){return W[X]+T[Q]};S=[[/\{/,function(W,X){return W[X]+"\n"+T[++Q]}],[/(;?)(\}[;,\)\]]*)/,function(W,X){return W[X+1]+"\n"+T[--Q]+W[X+2]+"\n"+T[Q]}],[/;(#|`)?/,function(W,X){return";\n"+T[Q]+(W[X+1]||"")}],[/(#|`)/,function(W,X){return"\n"+T[Q]+W[X]}],[/,/,", "]];if(V!="css"){S.insertAny([/for\s*\([\w ]+\sin\s/,"$0"],2,true);S.insertAny([/for\s*\(([^;]*);([^;]*);([^)]*)\)/,"for($1; $2; $3)"],3,true);S.insertAny([/(,)(("[^"\n\r]*"|'[^'\n\r]*'|\w+)?(:|=>))/,function(W,X){return W[X+1]+"\n"+T[Q]+W[X+2]}],4,true);S.insertAny([/\b(case|default)\b[^:]+:/,function(W,X){return W[X]+"\n"+T[Q]}],-1,true)}C.length=0;C.insertAny(J);C.insertAny(S);O=this.replace(O,C);J[0][1]=J[1][1]="$0";S=[[/\n +\n/,"\n"]];if(V=="css"){S.push([/:/," : "])}else{S.push([/{\s+}/,"{}"],[/\}\n *\(\)\)/,"}())"],[/\}\n *(else|catch|finnally)/,"}$1"],[F.NUMBER,"$0"],[/(->|=>)|(\+\+|\-\-|\&\&|\|\||!!)|([=!]==)|((<<|>>>|>>)=?)|([+\-*/%&|^<>!=~]=?)|([?:])/," $0 "])}C.length=0;C.insertAny(J);C.insertAny(S);O=this.replace(O,C);O=A(D(O))}return O},parse:function(J,L,Q,O,D){D=_.str(D);if(D==""){D=_.id()}var C=this.$key;var N=J,I=this;var B=function(R){return R.replace(/\x02/g,"&lt;").replace(/\x03/,"&amp;")},G=function(R){return R.replace(/</g,"\x02").replace(/&/g,"\x03")};J=J.replace(/^\s*/,"").replace(/\s*$/,"");J=G(J);var K,M;if(!this._profiles[L]){L="js"}K=_.copy(this._profiles[L]);J=J.replace(/(\r\n|\r)/g,"\n").replace(/( +)(\n)/g,"$2").replace(/\t/g,"    ").replace(/ /g,"&nbsp;");var F=[];var H=function(T,R,S){if(typeof T=="string"){T="\\b("+T+")\\b"}F.push([T,S?S:"<span class='"+R+"'>$0</span>"])};if(M=K.multicomment){H(M,"multicomment",function(R,S){return"<span class='comment'>"+R[S].split("\n").join("</span>\n<span class='comment'>")+"</span>"});delete K.multicomment}if(M=K.comment){H(M,"comment",function(R,S){return"<span class='comment'>"+R[S].replace("\n","")+"</span>"});delete K.comment}if(M=K.IGNORE){H(M,"IGNORE","$0");delete K.IGNORE}_.each(this.custom,function(S,R){if(K[R]){H(K[R],R,S);delete K[R]}});["reg1","reg2","string1","string2","number"].each(function(R){if(K[R]){H(K[R],R);delete K[R]}});_.each(K,function(S,R){H(S,R)});J=this.replace(J,F);J=B(J);var P="";var E=J.split("\n");if(E[0]==""){E.shift()}if(E[E.length-1]==""){E.pop()}var A=[];A.push("<div id='"+C+":"+D+"'class='sh'>");if(Q&&Q[0]){A.push("<div id='"+C+"-cmd:"+D+"' class='cmd'>");Q.each(function(R){A.push("<a id='"+C+"-"+R+":"+D+"' href='javascript:;' onclick='linb.coder.action(this,\""+R+"\");return false;'>"+R+"</a>")});A.push("<span>"+L+" source code viewer, powered by <a href='http://www.linb.net' target='_blank' style='font-size:9px;color:#000157;'>LINB</a></span>");A.push("</div>")}A.push("<pre style='display:none'>");A.push(N.replace(/<(\w)/g,"&lt;$1"));A.push("</pre>");A.push("<div id='"+C+"-con:"+D+"'class='con' "+(O?"style='overflow:auto;height:"+O+"px;'":"")+"><ol id='"+C+"-ol:"+D+"' start='1' class='"+L+"'><li><span>");A.push(E.join("&nbsp;</span></li><li><span>"));A.push("</span></li></ol></div>");A.push("</div>");B=G=null;if(!linb.browser.ie){_.asyRun(function(){linb.coder.remedy(D)})}return A.join("")},format:function(){var A=_.toArr(arguments);A[0]=this.decode.apply(this,arguments);return this.parse.apply(this,A)},remedy:function(D){var C=this.$key+":"+D;if(!(C=linb(C)).isEmpty()){var B=C.parent().scrollWidth(),A=C.parent().width();C.realWidth(Math.max(B,A))}},apply:function(D){var C=0,B=this,A=function(G){if(linb.dom.byId(D)){var F,H,E;C++;F=linb(D);E=_.str(F.className()).split(" ");H=linb.coder.parse(F.text(),E[0],E[1]?E[1].split("-"):undefined,null,String(C)).toDom();F.replace(H.id(D+":"+C))}else{linb.thread(G).abort()}};linb.thread(null,[A],null,null,null,null,true).start()},_profiles:{},custom:{},setProfile:function(A,B){this._profiles[A]=B;return this},getProfile:function(A){return this._profiles[A]},$action:{run:function(o){eval(linb(o).parent().next().text())},plain:function(C){var B=linb(C).parent().next().text();var B=B.replace(/</g,"&lt;");var A=window.open("","_blank","width=750, height=400, location=0, resizable=1, menubar=0, scrollbars=1");A.document.write('<pre style="width:100%;height:100%;border:none;">'+B+"</pre>");A.document.close();A=null}},action:function(B,A){if(this.$action[A]){this.$action[A](B)}}}});Class("linb.UI.Tips",null,{Constructor:function(){return null},Initialize:function(){var B=linb.dragDrop,A=this;B.$reset=function(){A.pos={left:B.x,top:B.y}};linb.css.add(".linb-ui-tips{font-size:0;line-height:0;position:absolute;border:solid gray 1px;background-color:#FFF8DC;overflow:visible;} .linb-ui-tips-i{font-size:12px;margin:1px 2px 2px 2px;}.linb-ui-tips-i span{display:inline;}",linb.getPath(this.KEY,"/css.css","appearance"));linb([document]).afterMousedown(function(){if(A.markId){if(A.showed){A.hide()}else{A.cancel()}}},"$Tips",-1).afterMousemove(function(F,E,G){if(B.working){return }var C=linb.event,D,H;if((D=_.resetRun.cache)&&D["$Tips"]){A.pos=C.getPos(E)}if(A.from){_.resetRun("$Tips3",null);A._showF()}else{if(A.showed&&A.move){D=C.getPos(E);H=A.Node.style;H.left=(parseInt(H.left)||0)+(D.left-A._pos.left)+"px";H.top=(parseInt(H.top)||0)+(D.top-A._pos.top)+"px";A._pos=D}}},"$Tips",-1).afterMouseover(function(J,L,C){var D=linb.event,G=D.rtnFalse,F=D.getSrc(L),E,H=F._tid,K=L.fromElement||L.relatedTarget,N,M,I,O;if(F&&F.id==linb.langId){F=F.parentNode}if(!F||(!H&&!(E=F.id)||(H&&!(I=F.getAttribute("evid"))))){return G}E=H?H:E;if((N=D._getProfile(E))&&N.box){M=H?H+I:N.onShowTips?E:E.replace(D._reg,"$1$3$4");if(A.markId&&M==A.markId){return G}A.markId=M;A.pos=D.getPos(L);_.resetRun("$Tips",function(){A.from=N;A.enode=F;_.resetRun("$Tips3",function(){if(A.from){A._showF()}},100)},A.delayTime)}return G},"$Tips",-1).afterMouseout(function(H,K,C){if(A.markId){var D=linb.event,E,M,I,G=D.getSrc(K)._tid,L=A.from,J,F=K.toElement||K.relatedTarget;try{if(F&&F.id==linb.langId){F=F.parentNode}if(!F||(!G&&!(E=F.id)||(G&&F.id))){J=1}}catch(K){J=1}if(!J){M=G?G+F.getAttribute("evid"):(L&&L.onShowTips)?E:E.replace(D._reg,"$1$3$4");J=M!==A.markId}if(J){if(A.showed){A.hide()}else{A.cancel()}}return D.rtnFalse}},"$Tips",-1);this.Types={"default":new function(){this._r=/(\$)([\w\.]+)/g;this.show=function(J,G,I){if(!G){return }var K=this,E,D,L,H,F;if(!(E=K.node)){E=K.node=linb.create('<div class="linb-ui-tips"><div class="linb-ui-tips-i"></div></div>');D=K._ruler=linb.create('<div class="linb-ui-tips" style="position:absolute;visibility:hidden;left:-10000px;"><div class="linb-ui-tips-i" style="position:relative;"></div></div>');K.n=E.first();K._n=D.first();if(linb.dom.support("shadow")){E.shadow();D.shadow()}linb([document.body]).addLast(D)}D=K._ruler;if(document.body.lastChild!=E.get(0)){linb([document.body]).addLast(E)}L=typeof J=="object"?J[I||"tips"]:J;if(L=L.toString()){L=L.replace(K._r,function(N,M,O){return linb.wrapRes(O)});K._n.get(0).innerHTML=L;H=Math.min(A.maxWidth,D.get(0).offsetWidth);var C=E.get(0).style;C.visibility="hidden";K.n.get(0).innerHTML=L;if(linb.browser.ie){C.width=H+(H%2)+"px";F=K.n.get(0).offsetHeight;C.height=F+(F%2)+"px"}else{C.width=H+"px"}E.popToTop({left:G.left,top:G.top,region:{left:G.left,top:G.top-12,width:24,height:32}},null,1)}};this.hide=function(){this.node.zIndex(0).hide()}}}},Static:{maxWidth:300,move:true,delayTime:200,autoHideTime:5000,_showF:function(){var B=this,H=B.from,D=B.enode,G=B.pos,F,E,C,A=false;B.from=B.enode=null;if(!D||!H||!G||!(E=H.box)){return }B._pos=G;A=((C=H.CF)&&(C=C.showTips)&&C(H,D,G));if(!A){A=(E.showTips&&E.showTips(H,D,G))}if(!A&&(C=H.properties)&&(C.tips)){B.show(G,C);A=true}if(!A){B.hide()}else{if(!B.move){_.resetRun("$Tips2",B.hide,B.autoHideTime,null,B)}}},show:function(E,D,C){var A=this,B;if(A.item==D){return }if(typeof D=="string"||D.tips){B=A.curTemplate=A.Types[D.tipsTemplate]||A.Types["default"];B.show(D,E,C);A.Node=B.node.get(0);A.item=D;A.showed=true}},hide:function(A){var B=this;if(A||B.showed){if(B.curTemplate){B.curTemplate.hide()}B._c()}},cancel:function(){var A=this;_.resetRun("$Tips",null);_.resetRun("$Tips3",null);A._c()},_c:function(){var A=this;A.markId=A.from=A.curTemplate=A.item=A.showed=null}}});Class("linb.UI.Edge","linb.UI.iWidget",{Instance:{_attachTo:function(C,E,D){var H=this,F=H.get(0);E.attach(H);F.$edgeId=linb(C).id();if(F.properties.borderActive){var G=F.behavior.TAG,I=linb(D),B="afterMouse",A;if(I){I.addObserver(A=B+"over","tag",-1,G[A],[F]).addObserver(A=B+"out","tag",-1,G[A],[F]).addObserver(A=B+"down","tag",-1,G[A],[F]).addObserver(A=B+"up","tag",-1,G[A],[F])}}return C}},Initialize:function(){_.each({edge:function(B,C,A){return new linb.UI.Edge(B)._attachTo(C||this,this,A)},isEdged:function(){var B=this.id(),A=false;linb.UI.Edge._cache.each(function(C){if(C.$edgeId==B){A=true;return false}});return A},getEdge:function(){var B=this.id(),A=null;linb.UI.Edge._cache.each(function(C){if(C.$edgeId==B){A=C;return false}});return A&&A.boxing()},unEdge:function(){var A=this.id();linb.UI.Edge._cache.each(function(B){if(B.$edgeId==A){B.boxing().destroy()}});return this}},function(B,A){linb.dom.plugIn(A,B)});_.each({_border:function(B,A){return this.each(function(I){var G=I.getSubNode("BORDER");if(G.isEdged()){return }var D=I.boxing(),H=I.properties,J=D.reBoxing(),C=J.width(),F=J.height(),E=H._borderSize;H.$paddingLeft+=E;H.$paddingTop+=E;H.$paddingBottom+=E;H.$paddingRight+=E;A=A||{};_.merge(A,{offset:E/2,enlarge:E/2},"without");I.$border=G.edge(A,G,I.makeRootId());if(H.$fix){D.setWidth(C+E).setHeight(F+E)}else{I.box.resize(I,C,F)}I.resetCache();if(G.isShadow&&G.isShadow()){var I=G.getShadow();I.setOffset(I.getOffset()+E/2+1)}})},_unBorder:function(){return this.each(function(G){var E=G.getSubNode("BORDER");if(!E.isEdged()){return }var B=G.boxing(),F=G.properties,H=B.reBoxing(),A=H.width(),D=H.height(),C=F._borderSize;F.$paddingLeft-=C;F.$paddingTop-=C;F.$paddingBottom-=C;F.$paddingRight-=C;E.unEdge();G.box.resize(G,A,D);if(E.isShadow()){var G=E.getShadow();G.setOffset(G.getOffset()-C/2-1)}delete G.$border})}},function(B,A){linb.UI.Widget.plugIn(A,B)});linb.UI.Widget.setDataModel({border:{ini:false,action:function(B){var A=this.boxing();if(B){A._border(B)}else{A._unBorder()}}},_borderSize:4})},Static:{Templates:{"default":{tagName:"div",TAG:{},T:{style:"width:100%;left:0;top:-{edge}px;height:{hSize}px;"},RT:{style:"top:-{edge}px;right:-{edge}px;width:{hSize}px;height:{hSize}px;"},R:{style:"height:100%;top:0;right:-{edge}px;width:{hSize}px;"},RB:{style:"right:-{edge}px;bottom:-{edge}px;width:{hSize}px;height:{hSize}px;"},B:{style:"width:100%;left:0;bottom:-{edge}px;height:{hSize}px;"},LB:{style:"left:-{edge}px;bottom:-{edge}px;width:{hSize}px;height:{hSize}px;"},L:{style:"height:100%;top:0;left:-{edge}px;width:{hSize}px;"},LT:{style:"top:-{edge}px;left:-{edge}px;width:{hSize}px;height:{hSize}px;"}}},Appearances:{"default":{KEY:{position:"static",display:"inline","_font-size":0,"_line-height":0,visibility:"hidden","z-index":"50"},TAG:{"_font-size":0,"_line-height":0},"T, RT, R, RB, B, LB, L, LT":{$order:1,position:"absolute",display:"block",border:0,"z-index":30,visibility:"visible","_font-size":0,"_line-height":0},"RT, RB, LB, LT":{"z-index":40},T:{background:linb.UI.getCSSImgPara("v.gif"," repeat-x left top")},B:{background:linb.UI.getCSSImgPara("v.gif"," repeat-x left bottom")},"KEY-mouseover T, KEY-mouseover B":{$order:1,"background-image":linb.UI.getCSSImgPara("v_mouseover.gif")},"KEY-checked T, KEY-checked B, KEY-mousedown T, KEY-mousedown B":{$order:2,"background-image":linb.UI.getCSSImgPara("v_mousedown.gif")},L:{background:linb.UI.getCSSImgPara("h.gif"," repeat-y left top")},R:{background:linb.UI.getCSSImgPara("h.gif"," repeat-y right top")},"KEY-mouseover L, KEY-mouseover R":{$order:1,"background-image":linb.UI.getCSSImgPara("h_mouseover.gif")},"KEY-checked L, KEY-checked R, KEY-mousedown L, KEY-mousedown R":{$order:2,"background-image":linb.UI.getCSSImgPara("h_mousedown.gif")},LT:{background:linb.UI.getCSSImgPara("corner.gif"," no-repeat left top")},RT:{background:linb.UI.getCSSImgPara("corner.gif"," no-repeat right top")},RB:{background:linb.UI.getCSSImgPara("corner.gif"," no-repeat right bottom")},LB:{background:linb.UI.getCSSImgPara("corner.gif"," no-repeat left bottom")},"KEY-mouseover LT, KEY-mouseover RT, KEY-mouseover RB, KEY-mouseover LB":{$order:1,"background-image":linb.UI.getCSSImgPara("corner_mouseover.gif")},"KEY-checked LT, KEY-checked RT, KEY-checked RB, KEY-checked LB, KEY-mousedown LT, KEY-mousedown RT, KEY-mousedown RB, KEY-mousedown LB":{$order:2,"background-image":linb.UI.getCSSImgPara("corner_mousedown.gif")}}},Behaviors:{"default":{_hoverEffect:{TAG:"KEY"},_clickEffect:{TAG:"KEY"}}},DataModel:{offset:2,enlarge:2,borderActive:false},prepareData:function(C){var A=C.properties,B=parseInt(A.offset);A.hSize=B*2;A.edge=B+parseInt(A.enlarge);arguments.callee.upper.call(this,C)}}});Class("linb.UI.Shadow","linb.UI.iWidget",{Instance:{getTarget:function(){return this.get(0)._target},attachTo:function(B){B=B.reBoxing();var A=this;A.get(0)._target=B.get(0);B.attach(A);return B}},Initialize:function(){_.each({shadow:function(A){var B=this.get(0);return new linb.UI.Shadow(A).attachTo(linb([B],false))},isShadow:function(){var B=this.get(0),A=false;linb.UI.Shadow._cache.each(function(C){if(C._target==B){A=true;return false}});return A},getShadow:function(){var B=this.get(0),A=null;linb.UI.Shadow._cache.each(function(C){if(C._target==B){A=C;return false}});return A.boxing()},unShadow:function(){var A=this.get();linb.UI.Shadow._cache.each(function(B){if(A.exists(linb(B._target).get(0))){B.boxing().destroy()}});return this}},function(B,A){linb.dom.plugIn(A,B)});_.each({_shadow:function(A){return this.each(function(G){var E=G.getSubNode("BORDER");if(E.isShadow()){return }var C=G.boxing(),F=G.properties,H=C.reBoxing(),B=H.width(),D=H.height();G.$shadow=E.shadow({size:F._shadowSize,offset:F.$paddingBottom||F.$border});F.$paddingBottom+=F._shadowSize;F.$paddingRight+=F._shadowSize;if(F.$fix){C.setWidth(B+F._shadowSize).setHeight(D+F._shadowSize)}else{G.box.resize(G,B,D)}})},_unShadow:function(){return this.each(function(F){var D=F.getSubNode("BORDER");if(!D.isShadow()){return }D.unShadow();var B=F.boxing(),E=F.properties,G=B.reBoxing(),A=G.width(),C=G.height();E.$paddingBottom-=E._shadowSize;E.$paddingRight-=E._shadowSize;F.box.resize(F,A,C);delete F.$shadow})}},function(B,A){linb.UI.Widget.plugIn(A,B)});linb.UI.Widget.setDataModel({shadow:{ini:false,action:function(B){var A=this.boxing();if(B){A._shadow(B)}else{A._unShadow()}}},_shadowSize:8})},Static:{Templates:{"default":{tagName:"div",R:{tagName:"div",style:"top:{offset}px;width:{size}px;right:-{pos}px;"},RB:{tagName:"div",style:"height:{size}px;width:{size}px;right:-{rbpos}px;bottom:-{rbpos}px;"},B:{tagName:"div",style:"left:{offset}px;height:{size}px;bottom:-{pos}px;"}}},Appearances:{"default":{KEY:{width:0,height:0,_display:"inline"},"B, RB, R":{position:"absolute",display:"block","*font-size":0,"*line-height":0},B:{left:0,width:"100%",background:linb.browser.ie6?"":linb.UI.getCSSImgPara("B.png","repeat-x left bottom"),_filter:linb.UI.getImgPath2("B.png",'progid:DXImageTransform.Microsoft.AlphaImageLoader(src="{*}",sizingMethod="crop")')},RB:{background:linb.browser.ie6?"":linb.UI.getCSSImgPara("RB.png","left top"),_filter:linb.UI.getImgPath2("RB.png",'progid:DXImageTransform.Microsoft.AlphaImageLoader(src="{*}",sizingMethod="crop")')},R:{top:0,height:"100%",background:linb.browser.ie6?"":linb.UI.getCSSImgPara("R.png","repeat-y right top"),_filter:linb.UI.getImgPath2("R.png",'progid:DXImageTransform.Microsoft.AlphaImageLoader(src="{*}",sizingMethod="crop")')}}},DataModel:{size:{ini:8,action:function(B){var A=this,C=A.properties.offset;A.getSubNode("R").width(B).top(C).right(-B-C);A.getSubNode("RB").width(B).height(B).right(-B-C).bottom(-B-C);A.getSubNode("B").height(B).left(C).bottom(-B-C)}},offset:{ini:0,action:function(A){this.boxing().setSize(this.properties.size,true)}}},prepareData:function(B){arguments.callee.upper.call(this,B);var A=B.data;A.pos=(parseInt(A.size)||0)+(parseInt(A.offset)||0);A.rbpos=A.pos-1},renderedTrigger:function(){if(linb.browser.ie){this.root.ieTrigger()}},hide:function(A,B){linb([A.domNode]).children().display(B?"none":"block")}}});Class("linb.UI.Resizer","linb.UI.iWidget",{Instance:{getRegion:function(){var B=this.get(0),F=B._target,D,K,J,A,I,G,E,C,H=[];if(F){F._nodes.sort(function(L,M){L=parseInt(L.style.zIndex)||0;M=parseInt(M.style.zIndex)||0;return L>M?1:L==M?0:-1});F.each(function(M,L){var M=linb([M]);if(L===0){D=M.offsetLeft();K=M.offsetTop();A=D+(E=M.offsetWidth());J=K+(C=M.offsetHeight());H.push([{left:D,top:K},{width:E,height:C},M.id()])}else{D=Math.min(D,I=M.offsetLeft());K=Math.min(K,G=M.offsetTop());A=Math.max(A,I+(E=M.offsetWidth()));J=Math.max(J,G+(C=M.offsetHeight()));H.push([{left:I,top:G},{width:E,height:C},M.id()])}})}B.regionBlocks=H;H.each(function(L){L[0].left-=D;L[0].top-=K;L[1].width-=2;L[1].height-=2});return{l:D,t:K,b:J,r:A}},rePosSize:function(){var A=this;A.each(function(F){var C,E=F.root,D=F._target;if(!D||D.isEmpty()){return }if(!F.properties.child){C=F.region=F.boxing().getRegion();E.cssPos({left:C.l,top:C.t}).offsetWidth(C.r-C.l).offsetHeight(C.b-C.t)}if(!F.regPool){F.regPool=linb([])}if(C=F.regions){F.regPool.add(C);C.display("none")}F.regions=linb([]);if(F.regionBlocks){var C,B=function(K,J){var G=F.boxing(),I=G.getTarget(),H=linb.event.currentKey;if(F.onRegionClick&&false!==G.onRegionClick(F,J)){if(I.length()>1){if(H&&H[2]){I.minus(linb(this.tid));G.resetTarget(I)}else{G.focus(this.tid)}}}};F.regionBlocks.each(function(G){if(F.regPool.length()){C=F.regPool.pop();linb(C).cssPos(G[0]).cssSize(G[1])}else{C='<div style="position:absolute;border:dashed 1px blue;left:{l}px;top:{t}px;width:{w}px;height:{h}px;"></div>'.replace("{l}",G[0].left).replace("{t}",G[0].top).replace("{w}",G[1].width).replace("{h}",G[1].height).toDom();C.onClick(B);C=C.get(0)}F.regions.push(C);C.tid=G[2]});F.root.addLast(F.regions.display("block"))}});A.focus();return A},getTarget:function(){return this.get(0)._target},resetTarget:function(F,A){var B=this,D=B.get(0),E=B.reBoxing(),C;if(D.properties.child){return }delete D.$focus;if(F&&!F.isEmpty()){D._target=F;B.rePosSize();E.zIndex(linb.dom.top_zIndex).display("block")}else{D._target=linb([]);E.zIndex(0).display("none")}if(F&&!F.isEmpty()){C=[];F.reBoxing("UI").each(function(H,G){C.push(H.$id)})}else{C=null}if(A!==false){D.boxing().onItemsSelected(D,C,D.$id)}return B},attachTo:function(D,C){var B=this,A=B.get(0);A._target=linb(D);A._parent=C||linb(document.body);A._parent.attach(B);B.resetTarget(A._target);A.$resizeId=linb(D).id();return B},focus:function(D){var C=this.get(0),B=-1;if(!C.regions){return }C.regions.border("dashed 1px blue");var A=C._target.get();if(D){B=A.subIndexOf("id",D)}if(B==-1&&C.$focus!==undefined){B=C.$focus}if(B==-1&&A.length>1){B=A.length-1}if(B!=-1){C.regions.border("dashed 1px blue");linb([C.regions.get(B)]).border("solid 1px red");C.$focus=B;if(C.onFocusChange){C.boxing().onFocusChange(C,B)}}return this},getFocus:function(){return this.get(0).$focus},active:function(A){return this.each(function(B){B.getSubNode("MOVE").setStyle("backgroundPosition","-17px top");B.getSubNodes(["LT","T","RT","R","RB","B","LB","L"]).background(linb.browser.ie?"url("+linb.ini.path+"bg.gif)":"transparent");if(A!==false){B.boxing().onActive(B)}})},inActive:function(){return this.each(function(A){if(A.$onDrag){return }A.getSubNode("MOVE").setStyle("backgroundPosition","-17px -17px");A.getSubNodes(["LT","T","RT","R","RB","B","LB","L"]).background("#808080")})},show:function(){this.each(function(A){A.root.display(A.$display||"block")});if(linb.browser.ie){this.reBoxing().ieTrigger()}return this},hide:function(){this.each(function(A){A.$display=A.root.display()});this.reBoxing().display("none");return this}},Initialize:function(){this.mapKeys(["HANDLER","HIDDEN"]);_.each({resizable:function(B,D,A){B=_.hash(B);var E=this.get(0),C=new linb.UI.Resizer(B).attachTo(D,linb([E]));if(A){C.onUpdate(A)}return C},unResizable:function(){var A=this.id();linb.UI.Resizer._cache.each(function(B){if(B.$resizeId==A){B.boxing().destroy()}});return this},isResizable:function(){var B=this.id(),A=false;linb.UI.Resizer._cache.each(function(C){if(C.$resizeId==B){A=true;return false}});return A},getResizer:function(){var B=this.id(),A=null;linb.UI.Resizer._cache.each(function(C){if(C.$resizeId==B){A=C;return false}});return A.boxing()}},function(B,A){linb.dom.plugIn(A,B)});_.each({_resize:function(B,A){return this.each(function(E){var C=E.getSubNode("BORDER"),D=E.properties;if(C.isResizable()){return }A=A||{};_.merge(A,{child:true,cover:true,parent:C},"without");var F=function(N,L,P,H){var J=arguments.callee.profile,I=J.root,G=J.properties,O;if(P){var M=null,K=null;if(O=P.width){I.widthBy(O);G.width=M=I.width()}if(O=P.height){I.heightBy(O);G.height=K=I.height()}J.box.resize(J,M,K)}if(H){if(O=H.left){I.leftBy(O);G.left=I.left()}if(O=H.top){I.topBy(O);G.top=I.top()}}};F.profile=E;E.$resizer=C.resizable(A,C,F)})},_unResize:function(){return this.each(function(B){var A=B.getSubNode("BORDER");if(!A.isResizable()){return }A.unResizable();delete B.$resizer})}},function(B,A){linb.UI.Widget.plugIn(A,B)});linb.UI.Widget.setDataModel({resizable:{ini:false,action:function(C){var B=this.boxing();if(C){var D=this.properties,A={};_.merge(A,D,"all",["minHeight","minWidth","maxHeight","maxWidth"]);B._resize(C,A)}else{B._unResize()}}}})},Static:{Templates:{"default":{tagName:"div",style:"{_style}"}},Appearances:{"default":{KEY:{position:"absolute",margin:"0 -1px -1px 0",visibility:"visible","_font-size":0,"_line-height":0,"*background":"url("+linb.ini.path+"bg.gif)","z-index":60,cursor:"move"},MOVE:{position:"absolute",display:"block","z-index":100,visibility:"visible",background:linb.UI.getCSSImgPara("icon.gif"," no-repeat -17px top",null,"linb.UI.Public"),"_font-size":0,"_line-height":0},HANDLER:{$order:0,position:"absolute",display:"block",border:"solid 1px","z-index":100,visibility:"visible","_font-size":0,"_line-height":0},T:{$order:1,left:"50%",cursor:"n-resize"},RT:{$order:1,cursor:"ne-resize","z-index":110},R:{$order:1,top:"50%",cursor:"e-resize"},RB:{$order:1,cursor:"se-resize","z-index":110},B:{$order:1,left:"50%",cursor:"s-resize"},LB:{$order:1,cursor:"sw-resize","z-index":110},L:{$order:1,top:"50%",cursor:"w-resize"},LT:{$order:1,cursor:"nw-resize","z-index":110},HIDDEN:{$order:10,"border-width":0}}},Behaviors:{"default":{onClick:function(A){A.boxing().active()},onMousedown:function(A,B,C){A.box.onMousedown(A,B,C,{move:true})},onDragbegin:function(A,B,C){A.box.onDragbegin(A,B,C)},onDrag:function(A,B,C){A.box.onDrag(A,B,C,{move:true})},onDragstop:function(A,B,C){A.box.onDragstop(A,B,C,{move:true})},LT:{onMousedown:function(A,B,C){A.box.onMousedown(A,B,C,{left:true,top:true})},onDragbegin:function(A,B,C){A.box.onDragbegin(A,B,C)},onDrag:function(A,B,C){A.box.onDrag(A,B,C,{left:true,top:true})},onDragstop:function(A,B,C){A.box.onDragstop(A,B,C,{left:true,top:true})}},RT:{onMousedown:function(A,B,C){A.box.onMousedown(A,B,C,{right:true,top:true})},onDragbegin:function(A,B,C){A.box.onDragbegin(A,B,C)},onDrag:function(A,B,C){A.box.onDrag(A,B,C,{right:true,top:true})},onDragstop:function(A,B,C){A.box.onDragstop(A,B,C,{right:true,top:true})}},LB:{onMousedown:function(A,B,C){A.box.onMousedown(A,B,C,{left:true,bottom:true})},onDragbegin:function(A,B,C){A.box.onDragbegin(A,B,C)},onDrag:function(A,B,C){A.box.onDrag(A,B,C,{left:true,bottom:true})},onDragstop:function(A,B,C){A.box.onDragstop(A,B,C,{left:true,bottom:true})}},RB:{onMousedown:function(A,B,C){A.box.onMousedown(A,B,C,{right:true,bottom:true})},onDragbegin:function(A,B,C){A.box.onDragbegin(A,B,C)},onDrag:function(A,B,C){A.box.onDrag(A,B,C,{right:true,bottom:true})},onDragstop:function(A,B,C){A.box.onDragstop(A,B,C,{right:true,bottom:true})}},L:{onMousedown:function(A,B,C){A.box.onMousedown(A,B,C,{left:true})},onDragbegin:function(A,B,C){A.box.onDragbegin(A,B,C)},onDrag:function(A,B,C){A.box.onDrag(A,B,C,{left:true})},onDragstop:function(A,B,C){A.box.onDragstop(A,B,C,{left:true})}},T:{onMousedown:function(A,B,C){A.box.onMousedown(A,B,C,{top:true})},onDragbegin:function(A,B,C){A.box.onDragbegin(A,B,C)},onDrag:function(A,B,C){A.box.onDrag(A,B,C,{top:true})},onDragstop:function(A,B,C){A.box.onDragstop(A,B,C,{top:true})}},R:{onMousedown:function(A,B,C){A.box.onMousedown(A,B,C,{right:true})},onDragbegin:function(A,B,C){A.box.onDragbegin(A,B,C)},onDrag:function(A,B,C){A.box.onDrag(A,B,C,{right:true})},onDragstop:function(A,B,C){A.box.onDragstop(A,B,C,{right:true})}},B:{onMousedown:function(A,B,C){A.box.onMousedown(A,B,C,{bottom:true})},onDragbegin:function(A,B,C){A.box.onDragbegin(A,B,C)},onDrag:function(A,B,C){A.box.onDrag(A,B,C,{bottom:true})},onDragstop:function(A,B,C){A.box.onDragstop(A,B,C,{bottom:true})}}}},DataModel:{proxy:true,child:false,visible:true,cover:false,Static:false,reHeight:true,reWidth:true,changable:true,move:true,left:100,top:100,height:100,width:100,position:"absolute",display:"block",visibility:"visible",minHeight:12,minWidth:12,maxHeight:5000,maxWidth:5000,offset:2,enlarge:0,dragArgs:{}},EventHandlers:{onUpdate:function(C,D,B,A){},onActive:function(A){},onFocusChange:function(B,A){},onItemsSelected:function(B,A){},onRegionClick:function(A,B){}},dynamicTemplate:function(C){var H=C.properties,K,F,I,E=C._exhash="$child:"+H.child+";visible:"+H.visible+";cover:"+H.cover+";Static:"+H.Static+";reheight:"+H.reHeight+";rewidth:"+H.reWidth+";move:"+H.move+";";var A=arguments.callee.map||(arguments.callee.map={MOVE:{tagName:"div",style:"top:50%;left:50%;margin-left:-6px;margin-top:-6px;width:13px;height:13px;"},T:{tagName:"div",style:"top:-{edge}px;margin-left:-{edge}px;width:{hSize}px;height:{hSize}px;"},RT:{tagName:"div",style:"top:-{edge}px;right:-{edge}px;width:{hSize}px;height:{hSize}px;"},R:{tagName:"div",style:"right:-{edge}px;margin-top:-{edge}px;width:{hSize}px;height:{hSize}px;"},RB:{tagName:"div",style:"bottom:-{edge}px;right:-{edge}px;width:{hSize}px;height:{hSize}px;"},B:{tagName:"div",style:"bottom:-{edge}px;margin-left:-{edge}px;width:{hSize}px;height:{hSize}px;"},LB:{tagName:"div",style:"bottom:-{edge}px;left:-{edge}px;width:{hSize}px;height:{hSize}px;"},L:{tagName:"div",style:"left:-{edge}px;margin-top:-{edge}px;width:{hSize}px;height:{hSize}px;"},LT:{tagName:"div",style:"left:-{edge}px;top:-{edge}px;width:{hSize}px;height:{hSize}px;"},cover:{T:{tagName:"div",style:"width:100%;left:0;top:-{edge}px;height:{hSize}px;"},RT:{tagName:"div",style:"top:-{edge}px;right:-{edge}px;width:{hSize}px;height:{hSize}px;"},R:{tagName:"div",style:"height:100%;top:0;right:-{edge}px;width:{hSize}px;"},RB:{tagName:"div",style:"right:-{edge}px;bottom:-{edge}px;width:{hSize}px;height:{hSize}px;"},B:{tagName:"div",style:"width:100%;left:0;bottom:-{edge}px;height:{hSize}px;"},LB:{tagName:"div",style:"left:-{edge}px;bottom:-{edge}px;width:{hSize}px;height:{hSize}px;"},L:{tagName:"div",style:"height:100%;top:0;left:-{edge}px;width:{hSize}px;"},LT:{tagName:"div",style:"top:-{edge}px;left:-{edge}px;width:{hSize}px;height:{hSize}px;"}}});var D=C.template._id,G=C.box.getTemplate(D,E);if(!G){var J,B;G=_.clone(C.box.getTemplate(D));J=H.cover?A.cover:A;if(H.move){G.MOVE=J.MOVE}if(H.reHeight){if(!H.Static){G.T=J.T}G.B=J.B}if(H.reWidth){if(!H.Static){G.L=J.L}G.R=J.R;if(H.reHeight){if(!H.Static){G.LB=J.LB;G.RT=J.RT;G.LT=J.LT}G.RB=J.RB}}B=C.getClass("KEY","-handler")+" ";if(J=G.T){J.className=B}if(J=G.RT){J.className=B}if(J=G.R){J.className=B}if(J=G.RB){J.className=B}if(J=G.B){J.className=B}if(J=G.LB){J.className=B}if(J=G.L){J.className=B}if(J=G.LT){J.className=B}if(!H.visible){B=C.getClass("KEY","-hidden")+" ";if(J=G.T){J.className+=B}if(J=G.RT){J.className+=B}if(J=G.R){J.className+=B}if(J=G.RB){J.className+=B}if(J=G.B){J.className+=B}if(J=G.LB){J.className+=B}if(J=G.L){J.className+=B}if(J=G.LT){J.className+=B}}C.box.setTemplate(D,G,E)}C.template=G},prepareData:function(B){var A=B.properties;A.hSize=parseInt(A.offset)*2;A.edge=A.offset+A.enlarge;if(A.child){A.offset=0;A.visible=false;A.cover=true;A.position="static";A.display="inline";A.left=A.top=A.width=A.height=0}if(!A.visible){A.visibility="hidden"}arguments.callee.upper.call(this,B)},renderedTrigger:function(){this.boxing().rePosSize()},createdTrigger:function(){this.domNode.zIndexIgnore=true;if(!this.onUpdate){this.onUpdate=function(C,D,B,A){if(D){if(B){D.widthBy(B.width,true).heightBy(B.height,true)}if(A){D.leftBy(A.left).topBy(A.top)}}}}},onMousedown:function(D,I,B,K){if(!D.properties.changable){return }var L=linb.event.currentKey;if(L&&(L[1]||(linb.browser.kde&&L[0]=="space"))){D.boxing().resetTarget(null);var J=linb.event.getPos(I);var E={defer:1,drop2:true,icon:linb.ini.path+"ondrag.gif",dragMode:"move",target_left:J.left+12,target_top:J.top+12,cursor:"pointer",move:false};_.merge(E,D.properties.dragArgs,"all");E.grid_width=E.grid_height=0;E.data.pos=D.boxing().reBoxing().cssPos();linb([]).startDrag(I,E)}else{var E,C,A,J,H,M;if(D.properties.child){J=linb.event.getPos(I);linb([B]).startDrag(I,{defer:1,move:false,type:"blank",cursor:true,target_left:J.left,target_top:J.top})}else{C=D.root;var A=C.absPos();J=C.cssPos();H=_.copy(J);M=C.cssSize();if(K.move){var A=linb.event.getPos(I),H=_.copy(J)}else{var A=C.absPos();J=C.cssPos();H=_.copy(J);M=C.cssSize();if(K.left){if(K.top){}else{if(K.bottom){J.top=J.top+M.height}else{J.top=J.top+M.height/2}}}if(K.right){J.left=J.left+M.width;if(K.top){}else{if(K.bottom){J.top=J.top+M.height}else{J.top=J.top+M.height/2}}}if(K.top&&!K.left&&!K.right){J.left=J.left+M.width/2}if(K.bottom&&!K.left&&!K.right){J.left=J.left+M.width/2;J.top=J.top+M.height}}if((t=D.properties.dragArgs)&&(t=t.grid_width)){var G=linb.dragDrop._size%t;if(K.left){J.left+=G}else{if(K.right){J.left+=G}else{if(K.move){J.left+=G}}}}if((t=D.properties.dragArgs)&&(t=t.grid_height)){var F=linb.dragDrop._size%t;if(K.top){J.top+=F}else{if(K.bottom){J.top+=F}else{if(K.move){J.top+=F}}}}J.left+=parseInt((A.left-H.left)/t)*t;J.top+=parseInt((A.top-H.top)/t)*t;var E={defer:1,move:false,type:"blank",cursor:true,target_left:J.left,target_top:J.top};_.merge(E,D.properties.dragArgs,"all");E.target_parent=D._parent;E.key=null;linb([B]).startDrag(I,E)}}},onDragbegin:function(C,D){if(C.properties.child){var E=C._target,F=E.absPos(),A=E.offsetWidth(),B=E.offsetHeight();C.proxy=linb.dom.getMatix();C.proxy.html(" ",false).setStyle({border:"1px dashed",visibility:"visible"}).absPos(F).offsetWidth(A).offsetHeight(B).zIndex(linb.dom.top_zIndex+20)}else{var E=linb([C.domNode]);C.proxy=E}C.o_pos=C.proxy.cssPos();C.o_w2=C.o_w=E.width();C.o_h2=C.o_h=E.height();C.$onDrag=true},onDrag:function(D,G,B,L){var C=L;D.oos=D.oos||{};var E=linb.dragDrop.getOffset();if(E.x==D.oos.width&&E.y==D.oos.height){return }D.oos=E;var J,I,K,F,M=D.properties;if(C.left){K=D.o_w-E.x;J=D.o_pos.left+E.x;if(K<M.minWidth){K=M.minWidth;J=D.o_w+D.o_pos.left-K}else{if(K>M.maxWidth){K=M.maxWidth;J=D.o_w+D.o_pos.left-K}}D.proxy.width(K).left(J)}else{if(C.right){K=D.o_w+E.x;if(K<M.minWidth){K=M.minWidth}else{if(K>M.maxWidth){K=M.maxWidth}}D.proxy.width(K)}}if(C.left||C.right){var A=K-D.o_w2;if(D.regions&&A!==0){D.regions.widthBy(A);D.o_w2=K}}if(C.top){F=D.o_h-E.y;I=D.o_pos.top+E.y;if(F<M.minHeight){F=M.minHeight;I=D.o_h+D.o_pos.top-F}else{if(F>M.maxHeight){F=M.maxHeight;I=D.o_h+D.o_pos.top-F}}D.proxy.height(F).top(I)}else{if(C.bottom){F=D.o_h+E.y;if(F<M.minHeight){F=M.minHeight}else{if(F>M.maxHeight){F=M.maxHeight}}D.proxy.height(F)}}if(C.top||C.bottom){var H=F-D.o_h2;if(D.regions&&H!==0){D.regions.heightBy(H);D.o_h2=F}}if(C.move){J=D.o_pos.left+E.x;I=D.o_pos.top+E.y;D.proxy.top(I).left(J)}},onDragstop:function(D,E,G,B){var A,C,H;var F=D.proxy;if(!B.move){C={width:F.width()-D.o_w,height:F.height()-D.o_h}}if(B.left||B.top||B.move){A=F.cssPos();H={left:A.left-D.o_pos.left,top:A.top-D.o_pos.top}}D.boxing().onUpdate(D,D._target,C,H);if(D.properties.child){if(linb.browser.ie6){D._target.ieTrigger()}D.proxy.html("",false).setStyle({visibility:"hidden",zIndex:"0",width:"0",height:"0"})}D.boxing().active();D.$onDrag=false}}});Class("linb.UI.Block",["linb.UI.Widget","linb.UI.iContainer"],{Initialize:function(){var A=this,C="default",B=A.getTemplate(C);_.merge(B.FRAME.BORDER,{PANEL:{tagName:"div",text:"{html}"+linb.UI.$childTag}},"all");A.setTemplate(C,B);B=A.getAppearance(C)||{};_.merge(B,{PANEL:{position:"absolute",left:0,top:0,overflow:"auto","background-color":"#fff"}});A.setAppearance(C,B)},Static:{Dropable:["PANEL"],DataModel:{dataBinder:null,dataField:null,value:null,disabled:null,caption:null,icon:null,iconPos:null,tips:null,html:{ini:"",action:function(A){this.getSubNode("PANEL").html(A)}},width:100,height:100},EventHandlers:{beforeValueSet:null,afterValueSet:null,beforeValueUpdated:null,afterValueUpdated:null,beforeHoverEffect:null,beforeClickEffect:null,beforeNextFocus:null},resize:function(D,A,C){var B=arguments.callee.upper.apply(this,arguments);D.getSubNode("PANEL").cssSize(B,true)}}});Class("linb.UI.Label",["linb.UI.Widget","linb.UI.iForm"],{Instance:{_shadowText:function(A){return this.each(function(B){B.getSubNode("SHADOW").display("block")})},_unShadowText:function(A){return this.each(function(B){B.getSubNode("SHADOW").display("none")})}},Initialize:function(){var A=this.getTemplate("default");_.merge(A.FRAME.BORDER,{SHADOW:{$order:1,style:"display:none;",SICON:{style:"background:url({icon}) transparent no-repeat {iconPos};{iconDisplay}",$order:0},SCAPTION:{text:"{caption}",style:"color:#cdcdcd;",$order:1}},BOX:{$order:2,ICON:{style:"background:url({icon}) transparent no-repeat {iconPos};{iconDisplay}",$order:0},CAPTION:{text:"{caption}",$order:1}}},"all");this.setTemplate("default",A)},Static:{Appearances:{"default":{KEY:{"font-size":"12px","line-height":"12px"},BOX:{position:"absolute"},SHADOW:{position:"absolute"},ICON:{width:"16px",height:"16px",margin:"0 4px 0 0"},SICON:{width:"16px",height:"16px",margin:"0 4px 0 0"}}},DataModel:{tabindex:null,caption:{action:function(D){var C=this,E=C.properties,A=C.boxing(),B=C.keys;C.getSubNodes(["CAPTION","SCAPTION"]).html(D,false);if(E.hAlign!="left"){A.setHAlign(E.hAlign,true)}if(E.vAlign!="top"){A.setVAlign(E.vAlign,true)}}},icon:{ini:"",action:function(C){var B=this,A=B.keys;B.getSubNodes(["ICON","SICON"]).display(C?"":"none").setStyle("backgroundImage","url("+(C||"")+")")}},iconPos:{ini:"",action:function(C){var B=this,A=B.keys;B.getSubNodes(["ICON","SICON"]).setStyle(backgroundPosition,C)}},shadowText:{ini:false,action:function(B){var A=this.boxing();B=String(B).toLowerCase()!="false";if(B){A._shadowText(B)}else{A._unShadowText()}}},hAlign:{ini:"right",listbox:["left","center","right"],action:function(B){var A=this,E=A.getSubNode("BOX"),D=A.getSubNode("SHADOW"),C=A.properties;switch(B){case"left":E.setStyle({left:0,right:"auto",marginLeft:"auto"});D.setStyle({left:C._textSshadowSize+"px",right:"auto",marginLeft:"auto"});break;case"right":E.setStyle({left:"auto",right:C._textSshadowSize+"px",marginLeft:"auto"});D.setStyle({left:"auto",right:0,marginLeft:"auto"});break;case"center":E.setStyle({left:"50%",right:"auto",marginLeft:-1*E.get(0).offsetWidth/2+"px"});D.setStyle({left:"50%",right:"auto",marginLeft:-1*E.get(0).offsetWidth/2+C._textSshadowSize+"px"});break}}},vAlign:{ini:"top",listbox:["top","middle","bottom"],action:function(B){var A=this,E=A.getSubNode("BOX"),D=A.getSubNode("SHADOW"),C=A.properties;switch(B){case"top":E.setStyle({top:0,bottom:"auto",marginTop:"auto"});D.setStyle({top:C._textSshadowSize+"px",bottom:"auto",marginTop:"auto"});break;case"bottom":E.setStyle({top:"auto",bottom:C._textSshadowSize+"px",marginTop:"auto"});D.setStyle({top:"auto",bottom:0,marginTop:"auto"});break;case"middle":E.setStyle({top:"50%",bottom:"auto",marginTop:-1*E.get(0).offsetHeight/2+"px"});D.setStyle({top:"50%",bottom:"auto",marginTop:-1*E.get(0).offsetHeight/2+C._textSshadowSize+"px"});break}}},fontSize:{ini:"",action:function(B){var A=this;A.getSubNodes(["CAPTION","SCAPTION"]).setStyle("fontSize",B)}},fontWeight:{ini:"",action:function(B){var A=this;A.getSubNodes(["CAPTION","SCAPTION"]).setStyle("fontWeight",B)}},width:60,height:20,_textSshadowSize:4},createdTrigger:function(){var A=this.properties,B=this.boxing();if(A.fontSize){B.setFontSize(A.fontSize,true)}if(A.fontWeight){B.setFontWeight(A.fontWeight,true)}if(A.shadowText){B.setShadowText(true,true)}},renderedTrigger:function(){var B=this.properties,C=this.boxing(),A=B.shadowText;if(B.hAlign!="left"||A){C.setHAlign(B.hAlign,true)}if(B.vAlign!="top"||A){C.setVAlign(B.vAlign,true)}},EventHandlers:{beforeValueUpdated:null,afterValueUpdated:null,beforeValueSet:null,afterValueSet:null,beforeNextFocus:null}}});Class("linb.UI.ProgressBar",["linb.UI.Widget","linb.UI.iForm"],{Instance:{setCtrlValue:function(A){return this.each(function(B){B.getSubNode("FILL").width(A+"%");B.getSubNode("CAP").text(A+"%")})}},Initialize:function(){var A=this,C="default",B=A.getTemplate(C);_.merge(B.FRAME.BORDER,{FILL:{tagName:"div",style:"width:{value}%;background:{background};",text:"{html}"+linb.UI.$childTag},INN:{tagName:"div",CAP:{$order:2,tagName:"div",text:"{value}%"}}},"all");A.setTemplate(C,B);B=A.getAppearance(C)||{};_.merge(B,{BORDER:{border:"solid 1px"},INN:{display:"table",position:"absolute",left:0,top:0,width:"100%",height:"100%"},CAP:{display:"table-cell","text-align":"center","vertical-align":"middle"},FILL:{position:"absolute",left:0,top:0,height:"100%",width:"0%"}});A.setAppearance(C,B)},Static:{DataModel:{icon:null,iconPos:null,value:0,width:300,height:24,caption:null,background:{ini:"#336699",action:function(A){this.getSubNode("FILL").setStyle("background",A)}},$border:1},EventHandlers:{onFinish:function(A){}}}});Class("linb.UI.Button",["linb.UI.Widget","linb.UI.iForm"],{Instance:{_border:function(B,A){A=A||{};A.borderActive=true;return arguments.callee.upper.call(this,B,A)},activate:function(){var A=this.get(0);A.getSubNode("FOCUS").focus();return this},setCtrlValue:function(A){if(_.isNull(A)||!_.exists(A)){A=false}return this.each(function(C){if(!C.properties.toggleKey){return }if(A){C.addTagClass("BORDER","-checked")}else{C.removeTagClass("BORDER","-checked")}if(C.properties.border){var B=C.boxing().getBorder();if(B){B.setChecked(A)}}})}},Initialize:function(){var A=this.getTemplate("default");_.merge(A.FRAME.BORDER,{FOCUS:{tagName:"a",href:"{href}",tabindex:"{tabindex}",TB:{cellpadding:"0",cellspacing:"0",width:"100%",height:"100%",border:"0",tagName:"table",TR:{tagName:"tr",TD:{align:"{hAlign}",valign:"{vAlign}",tagName:"td",BOX:{ICON:{$order:1,style:"background:url({icon}) transparent no-repeat  {iconPos};{iconDisplay}"},CAPTION:{$order:2,text:"{caption}",className:"{disabled}"}}}}}}},"all");this.setTemplate("default",A);A=this.getAppearance("default");var B=_.copy(A);_.merge(B,{BORDER:{$order:0,"text-decoration":"underline",cursor:"pointer"},"BORDER-mouseover":{$order:1,"font-weight":"bold"},"BORDER-mousedown":{$order:1,"font-style":"italic"}},"all");this.setAppearance("link",B)},Static:{Appearances:{"default":{KEY:{"font-size":"12px","line-height":"12px"},BORDER:{border:"solid 1px #eee","background-color":"#f4f4f4"},"BORDER-mouseover":{$order:1,"border-color":"#fff #cdcdcd #cdcdcd #fff"},"BORDER-mousedown, BORDER-checked":{$order:2,"border-color":"#cdcdcd #fff #fff #cdcdcd","background-color":"#fff"},ICON:{width:"16px",height:"16px",margin:"0 4px 0 0"},TD:{height:"100%"},FOCUS:{overflow:"hidden",display:"block",position:"absolute",left:0,top:0,"z-index":"20",width:"100%",height:"100%","-moz-outline-offset":"-1px !important"},BOX:{display:linb.browser.gek?["-moz-inline-block","-moz-inline-box","inline-block"]:"inline-block","font-size":"12px","line-height":"14px",overflow:"hidden"}}},Behaviors:{"default":{_hoverEffect:{KEY:["BORDER"]},_clickEffect:{KEY:["BORDER"]},_focusHook:{FOCUS:1},onClick:function(B,D,E){var C=B.properties;if(C.disabled){return false}B.getSubNode("FOCUS").focus();var A=B.boxing();if(C.toggleKey){A.updateUIValue(!C.$UIvalue);if(B.onToggle){A.onToggle(B,D,C.$UIvalue,C.toggleKey)}}if(B.onClick){A.onClick(B,D,C.$UIvalue)}}}},DataModel:{hAlign:{ini:"center",listbox:["left","center","right"],action:function(B){var A=this,D=A.getSubNode("TD"),C=A.properties;D.attr("align",B)}},vAlign:{ini:"top",listbox:["top","middle","bottom"],action:function(B){var A=this,D=A.getSubNode("TD"),C=A.properties;D.attr("valign",B)}},tabindex:{action:function(B){var A=this;if(A.domNode){A.getSubNode("FOCUS").tabIndex(B)}}},href:"javascript:;",value:false,toggleKey:"",width:120,height:20,$border:1},createdTrigger:function(){var A=this.properties,B=this.boxing();if(A.toggleKey&&A.value){B.setValue(true,true)}},EventHandlers:{onClick:function(A,C,B){},onToggle:function(A,D,C,B){}}}});Class("linb.UI.CheckBox","linb.UI.Button",{Instance:{activate:function(){var A=this.get(0);A.getSubNode("FOCUS").focus();return this},setCtrlValue:function(A){if(_.isNull(A)||!_.exists(A)){A=false}return this.each(function(B){if(A){B.addTagClass("MARK","-checked")}else{B.removeTagClass("MARK","-checked")}})},setDirtyMark:function(){return this.each(function(C){if(!C.domNode){return }var B=C.properties,E=C.getSubNode("CAPTION"),A=B.value!==B.$UIvalue,D=linb.UI.$css_tag_dirty;if(E.beforeDirtyMark&&false===E.boxing().beforeDirtyMark(C,A)){return }if(A){E.addClass(D)}else{E.removeClass(D)}})}},Initialize:function(){var A=this.getTemplate("default");_.merge(A.FRAME.BORDER.FOCUS.TB.TR.TD.BOX,{MARK:{$order:0}},"all");this.setTemplate("default",A)},Static:{Appearances:{"default":{KEY:{"font-family":'"Verdana", "Helvetica", "sans-serif"',"font-size":"12px",border:0,cursor:"pointer","background-color":"#fff"},BORDER:{},FOCUS:{overflow:"hidden",display:"block",position:"absolute",left:0,top:0,"z-index":"200",width:"100%",height:"100%","-moz-outline-offset":"-1px !important"},BOX:{display:linb.browser.gek?["-moz-inline-block","-moz-inline-box","inline-block"]:"inline-block","font-size":"12px","line-height":"14px",overflow:"hidden",position:"absolute","white-space":"nowrap"},MARK:{cursor:"pointer",width:"16px",height:"16px",background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -112px top",null,"linb.UI.Public")},"MARK-mouseover":{$order:1,"background-position":"-112px -17px"},"MARK-mousedown":{$order:2,"background-position":"-112px -34px"},"MARK-checked":{$order:3,"background-position":"-96px top"},"MARK-checked-mouseover":{$order:4,"background-position":"-96px -17px"},"MARK-checked-mousedown":{$order:5,"background-position":"-96px -34px"},ICON:{cursor:"pointer",width:"16px",height:"16px",margin:"0 4px 0 0"},CAPTION:{"vertical-align":"top"}}},Behaviors:{"default":{_hoverEffect:{KEY:"MARK"},_clickEffect:{KEY:"MARK"},_focusHook:{FOCUS:1},onClick:function(B,D,E){var C=B.properties,A=B.boxing();if(C.disabled){return false}A.updateUIValue(!C.$UIvalue);if(B.onChecked){A.onChecked(B,C.$UIvalue)}B.getSubNode("FOCUS").focus()},FOCUS:{onKeydown:function(B,C,D){var A=linb.event.getKey(C)[0];if(A=="space"||A=="enter"){B.root.onClick(true);return false}}}}},DataModel:{value:false,hAlign:"left",toggleKey:null},EventHandlers:{beforeDirtyMark:function(B,A){},onClick:null,onToggle:null,onChecked:function(A,B){}}}});Class("linb.UI.Input",["linb.UI.Widget","linb.UI.iForm"],{Instance:{_setTB:function(C){var B=this.get(0),D=B.properties,E,A;if(!B.host||!D.tipsBinder){return }A=B.tips=B.tips||D.tips||"";E=B.host[D.tipsBinder];if(E&&E.KEY=="linb.UI.Div"){E.get(0).domNode.innerHTML=A.charAt(0)=="$"?linb.wrapRes(A):A;E.reBoxing().setStyle("color",C==1?"gray":C==2?"red":"#000")}},activate:function(){var A=this.get(0);if(A.domNode){A.getSubNode("INPUT").activate()}return this},disabled:function(A){arguments.callee.upper.call(this,A);return this.each(function(B){B.getSubNode("INPUT").readonly(A)})},setCtrlValue:function(A){if(_.isNull(A)||!_.exists(A)){A=""}return this.each(function(B){B.getSubNode("INPUT").value(A.toString())})},getCtrlValue:function(){var A=this.get(0);return A.getSubNode("INPUT").value()},setDirtyMark:function(){return this.each(function(C){var G=C.properties,B=C.getSubNode("INPUT"),E=C.boxing(),F=linb.UI.$css_tag_dirty,I=linb.UI.$css_tag_invalid,H=G.value!==G.$UIvalue;if(C.beforeDirtyMark&&false===E.beforeDirtyMark(C,H)){}else{if(H){B.addClass(F)}else{B.removeClass(F)}}if(C.beforeFormatMark&&false===E.beforeFormatMark(C)){}else{var D=C.getSubNode("ERROR"),A=C.properties;if(C.inValid==2){B.addClass(I);D.display("block");C.tips=A.tipsErr||A.tips}else{B.removeClass(I);D.display("none");if(C.inValid==1){C.tips=A.tips}else{C.tips=A.tipsOK||A.tips}}E._setTB(C.inValid)}})},readonly:function(A){return this.each(function(B){B.getSubNode("INPUT").readonly(A)})},fireChangeEvent:function(){var A=this.get(0);A.getSubNode("INPUT").onChange()}},Initialize:function(){var A=this.getTemplate("default");_.merge(A.FRAME.BORDER,{BOX:{tagName:"div",INPUT:{tagName:"input",type:"{type}",value:"{value}",tabindex:"{tabindex}",cursor:"{cursor}"}}},"all");A.FRAME.ERROR={};this.setTemplate("default",A)},Static:{Appearances:{"default":{KEY:{"font-family":'"Verdana", "Helvetica", "sans-serif"',cursor:"pointer",overflow:"hidden"},BORDER:{"line-height":"0px","font-size":"0px","background-color":"#fff",border:"1px solid #7F9DB9"},"BORDER-focus, BORDER-mouseover":{$order:1,border:"1px solid #FFD700"},BOX:{position:"absolute","z-index":"10",left:0,top:0,overflow:linb.browser.gek?"auto":""},INPUT:{border:0,padding:0,margin:0,"font-size":"12px",position:"relative",overflow:"auto","overflow-y":(linb.browser.gek||linb.browser.ie)?"auto":"","overflow-x":(linb.browser.gek||linb.browser.ie)?"hidden":""},ERROR:{width:"16px",height:"16px",position:"absolute",right:0,top:0,display:"none","font-size":0,background:linb.UI.getCSSImgPara("icon.gif"," no-repeat left top",null,"linb.UI.Public"),"z-index":"50"}}},Behaviors:{"default":{_focusEffect:{INPUT:1},_hoverEffect:{KEY:["BORDER"]},_focusHook:{INPUT:1},INPUT:{onChange:function(A,B,D){var C=A.inValid;A.boxing().updateUIValue(D.value);A.properties.$UIvalue=D.value;if(C!==A.inValid){if(A.domNode){A.boxing().setDirtyMark()}}},onKeyup:function(A,C,D){var B=A.properties;if(B.dynCheck){if(B.$UIvalue!=D.value){A.box.checkValid(A,D.value)}A.boxing().setDirtyMark()}},onFocus:function(A,C,D){var B=A.properties;if(B.disabled){return false}if(A.beforeFocus&&false===A.boxing().beforeFocus(A)){}else{A.addTagClass(A.key,"-focus",A.getSubNode("BORDER"))}A.boxing()._setTB(3)},onBlur:function(A,C,D){var B=A.properties;if(B.disabled){return false}if(A.beforeBlur&&false===A.boxing().beforeBlur(A)){}else{A.removeTagClass("KEY","-focus",A.getSubNode("BORDER"))}if(B.$UIvalue==D.value){A.box.checkValid(A,D.value)}A.boxing().setDirtyMark()}}}},DataModel:{icon:null,iconPos:null,caption:null,tipsErr:"",tipsOK:"",dynCheck:false,valueFormat:{ini:"",helpinput:[{caption:"required",id:"[^.*]"},{caption:"email",id:"^[\\w\\.=-]+@[\\w\\.-]+\\.[\\w\\.-]{2,4}$"},{caption:"charOnly",id:"^[a-zA-Z]*$"},{caption:"words",id:"^[\\w ]*$"},{caption:"integer",id:"^-?\\d\\d*$"},{caption:"positiveInteger",id:"^\\d\\d*$"},{caption:"number",id:"^-?(\\d\\d*\\.\\d*$)|(^-?\\d\\d*$)|(^-?\\.\\d\\d*$)"},{caption:"filepath",id:"([\\/]?[\\w_]+)+\\.\\w{1,9}$"},{caption:"URL",id:"^(http|https|ftp)\\:\\/\\/[\\w\\-\\.]+\\.[a-zA-Z]{2,3}(:[\\w]*)?\\/?([\\w\\-\\._\\?\\,\\'\\/\\\\\\+&amp;%\\$#\\=~])*$"},{caption:"color",id:"^\\#[0-9A-Fa-f]{6}$"},{caption:"HH:MM",id:"^(([0-1][0-9])|([2][0-3])):([0-5][0-9])$"},{caption:"HH:MM:SS",id:"^(([0-1][0-9])|([2][0-3])):([0-5][0-9])\\:([0-5][0-9])$"},{caption:"YYYY-MM-DD",id:"^([0-9]{4})\\-(([0][0-9])|([1][0-2]))\\-([0-3][0-9])$"},{caption:"DD/MM/YYYY",id:"^(([0-2][0-9])|([3][0-1]))/(([0][0-9])|([1][0-2]))/([0-9]{4})$"}]},value:"",width:120,height:20,tabindex:{action:function(A){if(this.domNode){this.getSubNode("INPUT").tabIndex(A)}}},readonly:{ini:false,action:function(A){A=String(A).toLowerCase()!="false";this.boxing().readonly(A);this.root.cursor(A?"pointer":"")}},type:{ini:"text",listbox:["text","password"],action:function(A){this.getSubNode("INPUT").attr("type",A)}},inputArea:{ini:"input",listbox:["input","textarea"],action:function(B){var C=this.getSubNode("INPUT").outerHTML();C=C.replace(/^(<)[a-zA-Z]+(\s)/i,"$1"+B+"$2");var A=this.boxing().getValue();this.getSubNode("INPUT").outerHTML(C);this.boxing().updateUIValue(A)}},tipsBinder:"",$border:1},EventHandlers:{beforeFocus:function(A){},beforeBlur:function(A){},beforeDirtyMark:function(B,A){},onFormatCheck:function(A,B){},beforeFormatMark:function(A){}},prepareData:function(A){arguments.callee.upper.call(this,A);var B=A.data;B.cursor=B.readonly?"pointer":"default";B.type=B.type||""},dynamicTemplate:function(C){var A=C.properties;var E=C._exhash="$inputArea:"+A.inputArea+";readonly:"+A.readonly+";",D=C.template._id,B=C.box.getTemplate(D,E);A.$UIvalue=A.value;if(!B){B=_.clone(C.box.getTemplate(D));if(A.inputArea!="input"){B.FRAME.BORDER.BOX.INPUT.tagName=A.inputArea;delete B.FRAME.BORDER.BOX.INPUT.type}if(A.readonly){B.FRAME.BORDER.BOX.INPUT.readonly="readonly"}C.box.setTemplate(D,B,E)}C.template=B},createdTrigger:function(){var A=this;_.asyRun(function(){A.boxing()._setTB(1)})},checkValid:function(B,C){var D=B.properties,A=D.valueFormat||B.$valueFormat;if((B.onFormatCheck&&(B.boxing().onFormatCheck(B,C)===false))||(A&&typeof A=="string"&&!(new RegExp(A)).test(C||""))){B.inValid=2;return false}B.inValid=3;return true},resize:function(E,A,D){var C=arguments.callee.upper.apply(this,arguments);var B=linb.dom.pack([],false).add(E.getSubNode("INPUT")).add(E.getSubNode("BOX"));if(!_.isNull(A)){B.width(C.width)}if(!_.isNull(D)){B.height(C.height-(linb.browser.ie6?2:linb.browser.ie?1:linb.browser.kde?1:0))}return C}}});Class("linb.UI.ComboInput","linb.UI.Input",{Instance:{setCtrlValue:function(B,A){return this.each(function(C){C.getSubNode("INPUT").value(A?B:C.boxing()._getShowValue(B))})},_compareValue:function(D,C){var B=this.get(0),A;if(A=B.$compareValue||B.CF.compareValue){return A(B,D,C)}return D===C},_getShowValue:function(D){var C=this.get(0),E=C.properties,A,B;if(C.onClickButton){A=D}else{if(B=C.$getShowValue||C.CF.getShowValue){A=B(C,D)}else{if("listbox"==E.type||"combobox"==E.type){if((A=E.items.subIndexOf("id",D))!=-1){A=E.items[A].caption;A=A.charAt(0)=="$"?linb.getRes(A.slice(1)):A}else{A=""}}else{A=C.$showValue||D}}if(typeof A=="string"){A=A.replace(/\<\/?[^>]+\>/g,"")}}return A||D||""},_getEditValue:function(C){var B=this.get(0),D=B.properties,A;if(A=B.$getEditValue||B.CF.getEditValue){return A(B,C)}return C},_fromEditValue:function(C){var B=this.get(0),D=B.properties,A;if(A=B.$fromEditValue||B.CF.fromEditValue){return A(B,C)}return C},_cache:function(){var B=this.get(0),A=B.$drop;if(A){B.getSubNode("POOL").addLast(A.root.display("none"))}delete B.$poplink},refreshCache:function(){var A=this.get(0);if(A.domNode){A.getSubNode("POOL").empty()}delete A.$drop;return this},getUploadObj:function(){var A=this.get(0);if(A.domNode){var B=A.getSubNode("UPLOAD",null,true),C=B.clone();B.addPre(C);return B.remove(false)}},resetValue:function(A){this.each(function(B){if(B.properties.type=="upload"){B.getSubNode("UPLOAD").value("")}});return arguments.callee.upper.apply(this,arguments)},_drop:function(){return this.each(function(C){var H=C.properties;if(H.disabled){return }if(H.type=="upload"){return }if(C.$poplink){return }var A,I,E=C.boxing(),D=E.reBoxing(),G=D.absPos(),K=D.cssSize();K.width+=2;G.top+=D.offsetHeight();switch(H.type){case"getter":case"cmdbox":case"popbox":E.onClickButton(C,G,C.root.get(0));return }var F;switch(H.type){case"combobox":case"listbox":case"helpinput":if(H.listKey){if(linb.UI.getCacheListType(H.listKey)=="function"){C.$drop=null}else{F=C.$drop}}else{F=C.$id}break;default:F=H.type}if(F){_.filter(C.box.$drop,function(L){return !!L.domNode});C.$drop=C.box.$drop[F]}if(!C.$drop){switch(H.type){case"combobox":case"listbox":case"helpinput":linb.SC("linb.UI.List");A=linb.create("List");A.host(C).setItems(H.items.copy()).adjustSize();A.beforeValueUpdated(function(P,O,N,M){this.$showValue=M;var L=this.boxing();L.updateUIValue(N);L._cache();L.activate();return false});break;case"timepicker":linb.SC("linb.UI.TimePicker");A=linb.create("TimePicker");A.host(C);A.beforeClose(function(){this.boxing()._cache();return false});A.beforeValueUpdated(function(M,N,L){this.boxing().updateUIValue(L)._cache()});break;case"datepicker":linb.SC("linb.UI.DatePicker");A=linb.create("DatePicker");A.host(C);A.beforeClose(function(){this.boxing()._cache();return false});A.beforeValueUpdated(function(M,N,L){this.boxing().updateUIValue(String(L.getTime()))._cache()});break;case"colorpicker":linb.SC("linb.UI.ColorPicker");A=linb.create("ColorPicker");A.host(C);A.beforeClose(function(){this.boxing()._cache();return false});A.onOK(function(M,N,L){this.boxing().updateUIValue("#"+L)._cache()});break}C.$drop=A.get(0);if(F){C.$drop.links(C.box.$drop,F,null,F)}}A=C.$drop.boxing();A.host(C);switch(H.type){case"combobox":case"listbox":case"helpinput":A.setWidth(C.root.width());case"timepicker":A.setValue(E.getUIValue(),true);break;case"datepicker":var J=C.$drop.properties;J.firstDayOfWeek=H.firstDayOfWeek;if(J=E.getUIValue()){A.setValue(new Date(parseInt(J)),true)}break;case"colorpicker":A.setValue(E.getUIValue().replace("#",""),true);break}C.$poplink=A.get(0);var B=A.reBoxing();B.popToTop(C.root);A.activate();B.setBlurTrigger(C.key+":"+C.$id,function(){E._cache()},null,C.$id);linb.event.hookKey("esc",0,0,0,function(){E._cache();E.activate();linb.event.hookKey("esc",0,0,0,null)})})}},Initialize:function(){this.mapKeys(["UPLOAD"]);var A=this.getTemplate("default");_.merge(A.FRAME.BORDER,{BTN:{$order:4,style:"{popbtnDisplay}",TOP:{},MID:{style:"{typePos}"}},SBTN:{$order:3,style:"{saveDisplay}",STOP:{},SMID:{}}},"all");A.FRAME.POOL={};this.setTemplate("default",A)},Static:{$drop:{},Appearances:{"default":{POOL:{position:"absolute",left:0,top:0,width:0,height:0,display:"none",visibility:"hidden"},UPLOAD:{opacity:0,"*filter":"alpha(opacity=0)","z-index":"3",border:0,height:"100%",position:"absolute",top:0,right:0,cursor:"pointer","font-size":"12px",overflow:"hidden"},"SBTN,BTN":{"z-index":"1",cursor:"pointer",width:"13px","font-size":0,"line-height":0,position:"relative","float":"right",background:linb.UI.getCSSImgPara("cmd.gif"," left bottom no-repeat")},"BTN-mouseover, SBTN-mouseover":{$order:1,"background-position":"-14px bottom"},"BTN-mousedown, SBTN-mousedown":{$order:2,"background-position":"-27px bottom"},"STOP, TOP":{cursor:"pointer",width:"13px","font-size":0,"line-height":0,position:"absolute",top:0,left:0,height:"4px",background:linb.UI.getCSSImgPara("cmd.gif"," left -104px no-repeat")},"BTN-mouseover TOP,SBTN-mouseover STOP":{$order:1,"background-position":"-14px -104px"},"BTN-mousedown TOP,SBTN-mousedown STOP":{$order:2,"background-position":"-27px -104px"},"SMID,MID":{cursor:"pointer",width:"13px","font-size":0,"line-height":0,position:"absolute",bottom:"3px",left:0,height:"13px",background:linb.UI.getCSSImgPara("cmd.gif"," left top no-repeat")},SMID:{"background-position":"-14px -14px"}}},Behaviors:{"default":{_hoverEffect:{KEY:"BORDER",BTN:"BTN",SBTN:"SBTN"},_clickEffect:{BTN:"BTN",SBTN:"SBTN"},_focusHook:{INPUT:1},UPLOAD:{onChange:function(A,B,C){A.getSubNode("INPUT").value(C.value).onChange()}},BTN:{onClick:function(A,B,C){A.boxing()._drop()}},SBTN:{onClick:function(A,B,C){if(A.onSave){A.boxing().onSave(A,C)}}},INPUT:{onChange:function(C,E,G){if(C.$_onedit||C.$_inner){return }var F=C.inValid,A=C.boxing(),B=A._fromEditValue(G.value),D=C.properties.$UIvalue;if(!A._compareValue(D,B)){C.$_inner=1;delete C.$_inner;if(B===null){A.setCtrlValue(D)}else{A.updateUIValue(B);if(F!==C.inValid){if(C.domNode){A.setDirtyMark()}}}}},onKeyup:function(A,C,D){var B=A.properties;if(B.dynCheck){if(B.$UIvalue!=D.value){A.box.checkValid(A,D.value)}A.boxing().setDirtyMark()}},onFocus:function(C,F,G){var E=C.properties,D=E.$UIvalue;if(E.disabled){return false}var A=C.boxing(),B=A._getEditValue(D);if(B!==D){C.$_onedit=true;G.value=B;delete C.$_onedit}if(C.beforeFocus&&false===C.boxing().beforeFocus(C)){}else{C.addTagClass(C.key,"-focus",C.getSubNode("BORDER"))}C.boxing()._setTB(3)},onBlur:function(C,F,G){var E=C.properties,A=C.boxing(),D=E.$UIvalue,B=A._fromEditValue(G.value);if(E.disabled){return false}if(C.beforeBlur&&false===A.beforeBlur(C)){}else{C.removeTagClass("KEY","-focus",C.getSubNode("BORDER"))}if(A._compareValue(E.$UIvalue,B)){C.box.checkValid(C,B);A.setCtrlValue(D)}A.setDirtyMark()},onKeydown:function(B,D,E){var C=B.properties.type;if(C=="getter"||C=="cmdbox"||C=="popbox"){return }var A=linb.event.getKey(D);if((A[0]=="down"||A[0]=="up")&&A[1]){B.boxing()._drop();return false}else{if(A=="enter"){B.getSubNode("INPUT").onBlur()}}},onClick:function(A,B,C){if(A.properties.readonly){A.boxing()._drop()}}}}},EventHandlers:{onSave:function(A,B){},onClickButton:function(A,C,B){}},posMap:{none:"",combobox:"left top",listbox:"left top",upload:"-16px top",getter:"left -27px",helpinput:"left -91px",cmdbox:"left -14px",popbox:"left -40px",timepicker:"left -53px",datepicker:"left -66px",colorpicker:"left -79px"},DataModel:{icon:null,iconPos:null,caption:null,listKey:{ini:"",set:function(A){var B=linb.UI.getCacheList(A);return this.each(function(C){C.boxing().setItems(B?B:C.properties.items);C.properties.listKey=A})}},items:{ini:{},action:function(B){var A=this;A.boxing().setValue(null,true);A.SubSerialIdMapItem={};A.ItemIdMapSubSerialId={};A.box.prepareItems(A,B);if(B.domNode){A.boxing().refreshCache()}}},readonly:{ini:false,action:function(A){this.getSubNode("INPUT").cursor(A?"pointer":"default")}},type:{ini:"combobox",listbox:"none,combobox,listbox,upload,getter,helpinput,cmdbox,popbox,timepicker,datepicker,colorpicker".toArr(),set:function(C){var B=this,E;if(C.exists(":")){var A=C.split(":");if(A[1]=="readonly"){B.setReadonly(true)}C=A[0]}if(C=="listbox"){B.setReadonly(true)}if(C!="listbox"&&C!="combobox"){B.each(function(F){E=F.properties;if(!E.items){E.items=[]}})}if(C=="timepicker"){B.each(function(F){var G=linb.SC("linb.UI.TimePicker");_.merge(F,{$compareValue:null,$getShowValue:function(H,I){return I?G.ensureV(H,I):""},$getEditValue:null,$fromEditValue:function(H,I){return G.ensureV(H,I)}},"all");E=F.properties;if(E.value){E.$UIvalue=E.value=G.ensureV(profile,E.value)}})}else{if(C=="datepicker"){var D=linb.date;B.each(function(F){E=F.properties;_.merge(F,{$compareValue:function(J,I,H){return String(I)==String(H)},$getShowValue:function(H,I){return I?D.getText(new Date(parseInt(I)),"ymd"):""},$getEditValue:function(I,J){var H=new Date(parseInt(J));return J?(D.get(H,"m")+1)+"/"+D.get(H,"d")+"/"+D.get(H,"y"):""},$fromEditValue:function(I,J){var H=linb.date.parse(J);if(H){H=linb.date.getRoundDown(H,"d",1)}return H?String(H.getTime()):""}},"all");if(E.value){var G=D.parse(parseInt(E.value))||new Date;E.$UIvalue=E.value=String(D.getRoundDown(G,"d",1).getTime())}})}else{B.each(function(F){delete F.$compareValue;delete F.$getShowValue;delete F.$getEditValue;delete F.$fromEditValue;E=F.properties;if(_.isDate(E.value)){E.$UIvalue=E.value=String(E.value)}})}}return B.each(function(F){F.properties.type=C;if(F.domNode){F.getSubNode("MID").setStyle("backgroundPosition",F.box.posMap[C]||"left top")}})}},saveBtn:{ini:false,action:function(A){this.boxing().refresh()}},firstDayOfWeek:0,$border:1},createdTrigger:function(){var B=this,A=B.boxing(),C=B.properties;A.setType(C.type,true);if(C.readonly){A.setReadonly(true,true)}},dynamicTemplate:function(D){var B=D.properties,F=D._exhash="$inputArea:"+B.inputArea+";readonly:"+B.readonly+";type:"+B.type+";",E=D.template._id,C=D.box.getTemplate(E,F);B.$UIvalue=B.value;if(!C){C=_.clone(D.box.getTemplate(E));var A=C.FRAME.BORDER;if(B.inputArea!="input"){A.BOX.INPUT.tagName=B.inputArea;delete A.BOX.INPUT.type}if(B.readonly){A.BOX.INPUT.readonly="readonly"}if(B.type=="upload"){A.UPLOAD={$order:2,tagName:"input",type:"file",size:"1"}}D.box.setTemplate(E,C,F)}D.template=C},prepareData:function(A){arguments.callee.upper.call(this,A);var B=A.data;if(B.type!="none"){B.typePos="background-position:"+A.box.posMap[A.data.type]}B.saveDisplay=B.saveBtn?"":"display:none";B.popbtnDisplay=B.type!="none"?"":"display:none"},resize:function(B,F,C){var J=linb.UI.Widget.resize.apply(this,arguments),H,G=B.getSubNode("INPUT"),E=B.getSubNode("BTN"),A=B.properties,D=A.saveBtn,I=D?B.getSubNode("SBTN"):null;if(!_.isNull(F)){G.width(J.width-(A.type=="none"?0:E.offsetWidth())-(D?I.offsetWidth():0))}if(!_.isNull(C)){G.height(J.height-(linb.browser.ie6?2:linb.browser.ie?1:linb.browser.kde?1:0));E.height(J.height);if(I){I.height(J.height)}}}}});Class("linb.UI.Group",["linb.UI.Widget","linb.UI.iForm"],{Instance:{activate:function(){var A=this.get(0);A.getSubNode("LEGEND").focus();return this}},Initialize:function(){var A=this.getTemplate("default");_.merge(A.FRAME.BORDER,{FIELDSET:{tagName:"fieldset",LEGEND:{tagName:"legend",ICON:{style:"background:url({icon}) transparent  no-repeat {iconPos};{iconDisplay}",$order:0},CAPTION:{tagName:"a",href:"javascript:;",tabindex:"{tabindex}",text:"{caption}",$order:1}}},PANEL:{$order:1,tagName:"div",text:linb.UI.$childTag}},"all");this.setTemplate("default",A)},Static:{Dropable:["PANEL"],Appearances:{"default":{FIELDSET:{border:"1px solid #CCCCCC","background-color":"#fff",position:"relative"},PANEL:{position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"auto"},LEGEND:{"margin-left":"3px"},CAPTION:{"font-family":'"Verdana", "Helvetica", "sans-serif"',"font-size":"12px","line-height":"18px"},ICON:{width:"16px",height:"16px","vertical-align":"middle",margin:"0 4px 0 0"}}},EventHandlers:{beforeValueSet:null,afterValueSet:null,beforeValueUpdated:null,afterValueUpdated:null,beforeHoverEffect:null,beforeClickEffect:null,beforeNextFocus:null},DataModel:{width:100,height:100,tabindex:{action:function(A){if(this.domNode){this.getSubNode("CAPTION").tabIndex(A)}}},$border:1},Behaviors:{"default":{_focusHook:{CAPTION:1}}},resize:function(F,A,E){var D=arguments.callee.upper.apply(this,arguments),C,B=F.getSubNode("FIELDSET"),G=F.getSubNode("PANEL");if(!_.isNull(A)){B.width(C=(D.width-2));G.width(C)}if(!_.isNull(E)){B.height(C=(D.height-2));G.top(20).height(C-20)}}}});Class("linb.UI.Fieldset",["linb.UI.Div","linb.UI.iContainer"],{Instance:{removePanel:function(){this.destroy()},getPanelPara:function(){return _.copy(this.get(0).properties)},getPanelChildren:function(){return this.get(0).children}},Static:{cssNone:false,Dropable:["PANEL"],Dragable:["HANDLE"],Templates:{"default":{tagName:"div",style:"{_style}",FIELDSET:{tagName:"fieldset",className:" {toggleCls}",LEGEND:{tagName:"legend",HANDLE:{tagName:"a",href:"javascript:;",tabindex:"{tabindex}",TOGGLE:{},CAPTION:{text:"{caption}",$order:1}}},PANEL:{$order:1,tagName:"div",style:"{panelDisplay}",text:"{html}"+linb.UI.$childTag}}}},Appearances:{"default":{KEY:{zoom:linb.browser.ie6?"1":null},FIELDSET:{border:"1px solid #CCCCCC","background-color":"#fff",position:"relative",overflow:"hidden",zoom:linb.browser.ie6?"1":null},"FIELDSET-checked":{$order:2,"padding-left":"2px","border-left":"0","border-right":"0","border-bottom":"0"},LEGEND:{"margin-left":"3px"},PANEL:{position:"relative",overflow:"auto",width:linb.browser.ie6?"100%":null,"background-color":"#fff"},"FIELDSET-checked PANEL":{$order:4,display:"none"},TOGGLE:{width:"16px",height:"16px",background:linb.UI.getCSSImgPara("icon.gif"," no-repeat left -28px",null,"linb.UI.Public")},"FIELDSET-checked TOGGLE":{$order:4,"background-position":" left -16px"}}},Behaviors:{"default":{onRewh:function(C,D,F){var E=C.root,A=null,B=null;if(D.height){B=E.height()}if(D.width){A=E.width()}C.box.resize(C,A,B)},HANDLE:{onClick:function(A,B,C){A.box._toggle(A,!A.properties.toggle);return false}}}},DataModel:{position:"absolute",zIndex:0,tabindex:{action:function(A){if(this.domNode){this.getSubNode("HANDLE").tabIndex(A)}}},dragKey:"",html:{ini:"",action:function(A){this.getSubNode("PANEL").html(A)}},caption:linb.UI.Widget.getDataModel("caption"),toggle:{ini:true,action:function(A){this.box._toggle(this,A)}}},renderedTrigger:function(){var B=this,C=B.properties,A=B.box;if(C.toggle){A._toggle(B,C.toggle)}},EventHandlers:{onIniPanelView:function(A){},onFold:function(A){},onOpen:function(A){}},prepareData:function(B){arguments.callee.upper.call(this,B);var C=B.data,A="display:none";C.panelDisplay=C.toggle?"":A;C.toggleCls=C.toggle?"":B.getClass("FIELDSET","-checked")},resize:function(C,A,B){if(B&&parseInt(C.domNode.style.height)){C.getSubNode("FIELDSET").height(B);C.getSubNode("PANEL").height(B-C.getSubNode("LEGEND").height())}if(A&&parseInt(C.domNode.style.width)){C.getSubNode("PANEL").width(A)}},_toggle:function(B,C){var D=B.properties,A=B.boxing();D.toggle=C;if(C&&!B.$ini){if(A.onIniPanelView){if(A.onIniPanelView(B)!==false){B.$ini=true}}}if(C){if(false===A.onOpen(B)){return }}else{if(false===A.onFold(B)){return }}B.getSubNode("PANEL").display(C?"":"none");if(C){B.removeTagClass("FIELDSET","-checked")}else{B.addTagClass("FIELDSET","-checked")}}}});Class("linb.UI.ColorPicker","linb.UI.iWidget",{Instance:{setCtrlValue:function(A){return this.each(function(F){if(!F.domNode){return }var J=F.box,D=F.properties,E=F.$hex=J._to3(A),C=F.$hex.join(""),I=F.$rgb=J.hex2rgb(A),G=F.$hsv=J.rgb2hsv(I),H=function(L,K){F.getSubNode(L).get(0).firstChild.nodeValue=String(K)},B=function(K){return parseInt(K*100)};H("R",I[0]);H("G",I[1]);H("B",I[2]);H("H",E[0]);H("E",E[1]);H("X",E[2]);if(F.$hexinhsv!=C){H("HH",G[0]);H("S",B(G[1]));H("V",B(G[2]));delete F.$hexinhsv}J._updateDftTip(F);if(D.advance&&F.$hexinadv!=C){J._updateMarks(F,A,true,G[0]);delete F.$hexinadv}})}},Initialize:function(){var H=this,F=linb.event.eventhandler,A=linb.UI.$ID,K=linb.UI.$CLS,I=H.KEY,G=H._slist,B=G.length,D,C,E=[],J=' unselectable="on" onmousedown="'+F+'" ondrag="'+F+'" ondragstop="'+F+'" ';H.mapKeys(["TXT","DD1","DD2","DD3","R","G","B","HH","S","V","H","E","X"]);for(D=0;D<B;D++){E.push('<a  id="'+I+"-SC:"+A+":"+G[D]+'" href="javascript:;" onmouseover="'+F+'"  onkeydown="'+F+'" onclick="'+F+'" style="background-color:#'+G[D]+'">'+G[D]+"</a>")}C='<div><span class="'+K+'-txt">R: </span><span id="'+I+"-R:"+A+':" class="'+K+'-dd2 #DD2_CC#" '+J+'>R</span><span style="width:8px;height:8px"  unselectable="on" ></span><span class="'+K+'-txt">H: </span><span id="'+I+"-HH:"+A+':" class="'+K+'-dd2 #DD2_CC#" '+J+'>H</span><span>\xB0</span></div><div><span class="'+K+'-txt">G: </span><span id="'+I+"-G:"+A+':" class="'+K+'-dd2 #DD2_CC#" '+J+'>G</span><span style="width:8px;height:8px"  unselectable="on" ></span><span class="'+K+'-txt">S: </span><span id="'+I+"-S:"+A+':" class="'+K+'-dd2 #DD2_CC#"  '+J+'>S</span><span>%</span></div><div><span class="'+K+'-txt">B: </span><span id="'+I+"-B:"+A+':" class="'+K+'-dd2 #DD2_CC#" '+J+'>B</span><span style="width:8px;height:8px"  unselectable="on" ></span><span class="'+K+'-txt">V: </span><span id="'+I+"-V:"+A+':" class="'+K+'-dd2 #DD2_CC#" '+J+'>V</span><span>%</span></div><div><span style="width:38px">HEX: #</span><span id="'+I+"-H:"+A+':" class="'+K+'-dd3 #DD3_CC#" '+J+'>H</span><span id="'+I+"-E:"+A+':" class="'+K+'-dd3 #DD3_CC#" '+J+'>E</span><span id="'+I+"-X:"+A+':" class="'+K+'-dd1 #DD1_CC#" '+J+">X</span></div>";H.setTemplate("default",{style:"{_style};width:{_width}px;",tagName:"div",onselectstart:"return false",BORDER:{tagName:"div",BAR:{$order:0,style:"height:{handleHeight}px;",tagName:"div",CMDS2:{CLOSE:{style:"{closeDisplay}"}}},CON:{$order:1,tagName:"div",SIMPLE:{tagName:"div",TOP:{$order:1,tagName:"div",DATA:{$order:0,tagName:"div",onselectstart:"return false",text:C},EXAM:{$order:1,tagName:"div"}},LIST:{$order:2,tagName:"div",text:E.join("")},SUBMIT:{$order:3,tagName:"div",OK:{tagName:"button",style:"display:{submitDispay};",text:"O K"},CANCEL:{$order:1,style:"display:{submitDispay};",tagName:"button",text:"Cancel"},TOGGLE:{$order:2,tagName:"button",text:">>"}}},ADV:{$order:2,style:"display:{advDispay};",tagName:"div",ADVWHEEL:{$order:0,tagName:"div"},ADVCLR:{$order:1,tagName:"div"},ADVMARK1:{$order:3,tagName:"div"},ADVMARK2:{$order:4,tagName:"div"}}}}})},Static:{_radius:84,_square:100,_bigRadius:97,cssNone:false,DataModel:{height:230,value:"FFFFFF",colorName:"#FFFFFF",handleHeight:22,tipsHeight:16,headHeight:20,closeBtn:{ini:true,action:function(A){this.getSubNode("CLOSE").display(A?"":"none")}},advance:{ini:false,action:function(A){var B=this;B.getSubNode("ADV").display(A?"":"none");B.getSubNode("TOGGLE").text(A?"<<":">>");B.root.width(A?400:200);if(A){B.box._updateMarks(B,B.properties.$UIvalue,true,B.$hsv[0])}}},submitBtn:{ini:true,action:function(A){var C=A?"":"none",B=this;B.getSubNode("OK").display(C);B.getSubNode("CANCEL").display(C)}},$borderW:1},Appearances:{"default":{KEY:{background:"#FFF","-moz-user-select":linb.browser.gek?"none":null},BORDER:{overflow:"visible",position:"relative"},CON:{height:"200px",border:"solid 1px #C1C1C1","border-top":0,padding:"3px"},BAR:{"white-space":"nowrap",background:linb.UI.getCSSImgPara("barvbg.gif"," repeat-x left top",null,"linb.UI.Public"),height:"22px","text-align":"center",border:"solid #C1C1C1","border-width":"1px 1px 0 1px"},CMDS2:{"float":"right",clear:"both"},CLOSE:{position:"relative",margin:"2px",width:"15px",height:"15px",cursor:"default",background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -64px 0",null,"linb.UI.Public")},"CLOSE-mouseover":{$order:1,"background-position":"-64px -16px"},"CLOSE-mousedown":{$order:2,"background-position":"-64px -32px"},DATA:{"float":"left",width:"112px",height:"86px"},"DATA span":{"float":"left"},"DATA div":{"padding-top":"3px",clear:"both"},TXT:{width:"16px"},EXAM:{"float":"left",height:"80px",width:"80px",background:"red","padding-top":"2px","white-space":"wrap","text-align":"center"},"DD1, DD2, DD3":{display:"block",height:"16px",border:"1px solid #7F9DB9","padding-right":"2px",cursor:"e-resize","text-align":"right",background:"#FFFACD"},DD1:{width:"16px",border:"1px solid #7F9DB9"},DD2:{width:"24px",border:"1px solid #7F9DB9"},DD3:{$order:2,width:"16px","border-right":"none"},TOP:{width:"192px"},LIST:{width:"192px",overflow:"hidden","padding-top":"4px","line-height":linb.browser.ie6?"0":null,clear:"both"},SIMPLE:{"float":"left"},ADV:{"float":"right",width:"195px",height:"195px",position:"relative"},"ADV div":{cursor:"crosshair",position:"absolute"},ADVCLR:{background:linb.browser.ie6?null:linb.UI.getCSSImgPara("bg.png","no-repeat left top"),_filter:linb.UI.getImgPath2("bg.png",'progid:DXImageTransform.Microsoft.AlphaImageLoader(src="{*}",sizingMethod="crop")'),height:"101px",left:"47px",top:"47px",width:"101px"},ADVWHEEL:{background:linb.browser.ie6?null:linb.UI.getCSSImgPara("clr.png"," no-repeat left top"),_filter:linb.UI.getImgPath2("clr.png",'progid:DXImageTransform.Microsoft.AlphaImageLoader(src="{*}",sizingMethod="crop")'),height:"195px",width:"195px"},"ADVMARK1, ADVMARK2":{background:linb.browser.ie6?null:linb.UI.getCSSImgPara("picker.png"," no-repeat left top"),_filter:linb.UI.getImgPath2("picker.png",'progid:DXImageTransform.Microsoft.AlphaImageLoader(src="{*}",sizingMethod="crop")'),height:"17px",margin:"-8px 0pt 0pt -8px",overflow:"hidden",width:"17px"},"LIST a":{height:"9px",width:"9px","font-size":linb.browser.ie6?"0":null,"float":"left",display:"block",overflow:"hidden","text-indent":"100px",margin:"0",cursor:"pointer",border:"1px solid #F6F7EE"},"LIST a:hover":{border:"1px solid black"},SUBMIT:{"margin-top":"3px","text-align":"right"},"OK, CANCEL":{padding:"0 3px 0 3px","margin-right":"5px"},TOGGLE:{"font-size":"8px"}}},Behaviors:{"default":{_hoverEffect:{CLOSE:"CLOSE"},_clickEffect:{CLOSE:"CLOSE"},SC:{onMouseover:function(C,B,A){C.box._setTempUI(C,C.getSubSerialId(A.id))},onClick:function(D,C,B){var A=D.getSubSerialId(B.id);D.boxing().updateUIValue(A);return false}},LIST:{onMouseout:function(C,B,A){C.box._updateDftTip(C)}},OK:{onClick:function(B,A,D){var C=B.properties;B.boxing().onOK(B,C.value,C.value=C.$UIvalue)}},CANCEL:{onClick:function(B,A,C){B.getSubNode("CLOSE").onClick(true)}},TOGGLE:{onClick:function(B,A,C){B.boxing().setAdvance(!B.properties.advance)}},R:{onMousedown:function(B,A,C){B.box._dd1(B,A,C)},onDrag:function(B,A,C){B.box._dd2(B,A,C,0)},onDragstop:function(B,A,C){B.box._dd3(B,A,C,0)}},G:{onMousedown:function(B,A,C){B.box._dd1(B,A,C)},onDrag:function(B,A,C){B.box._dd2(B,A,C,1)},onDragstop:function(B,A,C){B.box._dd3(B,A,C,1)}},B:{onMousedown:function(B,A,C){B.box._dd1(B,A,C)},onDrag:function(B,A,C){B.box._dd2(B,A,C,2)},onDragstop:function(B,A,C){B.box._dd3(B,A,C,2)}},HH:{onMousedown:function(B,A,C){B.box._dd1(B,A,C,true)},onDrag:function(B,A,C){B.box._dd2(B,A,C,0,"hsv1")},onDragstop:function(B,A,C){B.box._dd3(B,A,C,0,true,"hsv1")}},S:{onMousedown:function(B,A,C){B.box._dd1(B,A,C,true)},onDrag:function(B,A,C){B.box._dd2(B,A,C,1,"hsv2")},onDragstop:function(B,A,C){B.box._dd3(B,A,C,1,true,"hsv2")}},V:{onMousedown:function(B,A,C){B.box._dd1(B,A,C,true)},onDrag:function(B,A,C){B.box._dd2(B,A,C,2,"hsv2")},onDragstop:function(B,A,C){B.box._dd3(B,A,C,2,true,"hsv2")}},H:{onMousedown:function(B,A,C){B.box._dd1(B,A,C)},onDrag:function(B,A,C){B.box._dd2(B,A,C,0,"hex")},onDragstop:function(B,A,C){B.box._dd3(B,A,C,0)}},E:{onMousedown:function(B,A,C){B.box._dd1(B,A,C)},onDrag:function(B,A,C){B.box._dd2(B,A,C,1,"hex")},onDragstop:function(B,A,C){B.box._dd3(B,A,C,1)}},X:{onMousedown:function(B,A,C){B.box._dd1(B,A,C)},onDrag:function(B,A,C){B.box._dd2(B,A,C,2,"hex")},onDragstop:function(B,A,C){B.box._dd3(B,A,C,2)}},CLOSE:{onClick:function(C,D,E){var B=C.properties;if(B.disabled){return }var A=C.boxing();if(false===A.beforeClose(C,E)){return }A.destroy();return false}},ADVWHEEL:{onMousedown:function(C,B,D){var A=C.box;A._prepareAdv(C,B);A._updateClrByPos(C,B,true);C.getSubNode("ADVMARK1").startDrag(B,{type:"none"})}},ADVMARK1:{onMousedown:function(C,B,D){var A=C.box;A._prepareAdv(C,B);A._updateClrByPos(C,B,true);C.getSubNode("ADVMARK1").startDrag(B,{type:"none"})},onDrag:function(C,B,D){var A=C.box;A._updateClrByPos(C,B,true)},onDragstop:function(C,B,D){var A=C.box;A._updateValueByPos(C,B)}},ADVCLR:{onMousedown:function(C,B,D){var A=C.box;A._prepareAdv(C,B);A._updateClrByPos(C,B);C.getSubNode("ADVMARK2").startDrag(B,{type:"none"});return false}},ADVMARK2:{onMousedown:function(C,B,D){var A=C.box;A._prepareAdv(C,B);A._updateClrByPos(C,B);C.getSubNode("ADVMARK2").startDrag(B,{type:"none"});return false},onDrag:function(C,B,D){var A=C.box;A._updateClrByPos(C,B)},onDragstop:function(C,B,D){var A=C.box;A._updateValueByPos(C,B,true)}}}},prepareData:function(B){arguments.callee.upper.call(this,B);var C=B.data,A="display:none";C.closeDisplay=C.closeBtn?"":A;C._width=C.advance?"400":"200";C.advDispay=C.advance?"":"none";C.submitDispay=C.submitBtn?"":"none"},EventHandlers:{beforeClose:function(A,B){},onOK:function(A,B){}},createdTrigger:function(){this.$onValueSet=this.$onValueUpdated=function(A){var C=this.properties,B=linb.getRes("color.LIST."+A);C.colorName=B==A?"#"+A:B}},_slist:"FFFFFF,FFFFF0,FFFFE0,FFFF00,FFFAFA,FFFAF0,FFFACD,FFF8DC,FFF5EE,FFF0F5,FFEFD5,FFEBCD,FFE4E1,FFE4C4,FFE4B5,FFDEAD,FFDAB9,FFD700,FFC0CB,FFB6C1,FFA500,FFA07A,FF8C00,FF7F50,FF69B4,FF6347,FF4500,FF1493,FF00FF,FF00FF,FF0000,FDF5E6,FAFAD2,FAF0E6,FAEBD7,FA8072,F8F8FF,F5FFFA,F5F5F5,F5DEB3,F4A460,F0FFFF,F0FFF0,F0F8FF,F0E68C,F08080,EEE8AA,EE82EE,E9967A,E6E6FA,E1FFFF,DEB887,DDA0DD,DCDCDC,DC143C,DB7093,DAA520,DA70D6,D8BFD8,D3D3D3,D2B48C,D2691E,CD853F,CD5C5C,C71585,C0C0C0,BDB76B,BC8F8F,BA55D3,B22222,B0E0E6,B0C4DE,AFEEEE,ADFF2F,ADD8E6,A9A9A9,A52A2A,A0522D,9932CC,98FB98,9400D3,9370DB,90EE90,8FBC8F,8B4513,8B008B,8B0000,8A2BE2,87CEFA,87CEEB,808080,808000,800080,800000,7FFFAA,7FFF00,7CFC00,7B68EE,778899,708090,6B8E23,6A5ACD,696969,6495ED,5F9EA0,556B2F,4B0082,48D1CC,483D8B,4682B4,4169E1,40E0D0,3CB371,32CD32,2F4F4F,2E8B57,228B22,20B2AA,1E90FF,191970,00FFFF,00FFFF,00FF7F,00FF00,00FA9A,00CED1,00BFFF,008B8B,008080,008000,006400,0000FF,0000CD,00008B,000080,000000".split(","),C16:"0123456789ABCDEF",_dd1:function(C,F,G,B){var E=C.properties,A=C.box,D=function(){var H=A.hex2rgb(E.$UIvalue);return B?A.rgb2hsv(H):H};linb([G]).setStyle("background","red").startDrag(F,{type:"blank",move:false,grid_width:2,cursor:true});C.$temp=0;C.$start=D();C.$temp2=D()},_dd2:function(E,I,A,F,J){var G,D=linb.dragDrop.getOffset(),B=E.properties,C=E.$temp2,L=E.box,H=J=="hsv1"?361:J=="hsv2"?101:256,K;G=(J=="hsv2"?parseInt(E.$start[F]*100):parseInt(E.$start[F]))+parseInt(D.x/2);G=(G%H+H)%H;if(E.$temp!=G){C[F]=E.$temp=J=="hsv2"?G/100:G;K=(J=="hsv1"||J=="hsv2")?L.hsv2rgb(C):C;K=L.rgb2hex(K);L._setTempUI(E,K);linb([A]).text(J=="hex"?L._toFF(G):G)}},_dd3:function(D,G,A,E,F){if(D.$start[E]!==D.$temp){var B=D.properties,I=D.box,C=D.$start,H;C[E]=D.$temp;H=F?I.hsv2rgb(C):C;H=I.rgb2hex(H);if(F){D.$hexinhsv=H}D.boxing().updateUIValue(H);delete D.$hexinhsv}linb([A]).setStyle("background","");D.$temp=D.$start=0},_setTempUI:function(H,C){var B=this,E=B.hex2rgb(C),A=H.boxing(),F=A.getSubNode("EXAM"),D=B.rgb2hsv(E),G=linb.getRes("color.LIST."+C);F.setStyle({backgroundColor:"#"+C,color:D[2]>0.6?"#000":"#FFF"});F.text(G==C?"#"+C:G)},_updateDftTip:function(C){var A=C.box,B=C.boxing().getSubNode("EXAM");B.setStyle({backgroundColor:"#"+C.$hex.join(""),color:C.$hsv[2]>0.6?"#000":"#FFF"});B.text(C.properties.colorName)},_to3:function(A){if(!A){A="FFFFFF"}return[A.substr(0,2),A.substr(2,2),A.substr(4,2)]},_toFF:function(B){var A=this.C16;B=parseInt(B)||0;B=(B>255||B<0)?0:B;return A.charAt((B-B%16)/16)+A.charAt(B%16)},_to255:function(C){var B=this.C16,A=C.split("");return B.indexOf(A[0].toUpperCase())*16+B.indexOf(A[1].toUpperCase())},_webSafe:function(D,C,A){var B=arguments.callee,E=B.f||(B.f=function(F){return parseInt(F/51)*51});if(typeof D=="object"){C=D[1];A=D[2];D=D[0]}return[E(D),E(C),E(A)]},_updateMarks:function(B,A,G,F){var J=this,E=J.hex2rgb(A),D=J.rgb2hsv(E),C=(D[0]/360)*6.28,K=B.getSubNode("ADVCLR");if(G){var I=B.getSubNode("ADVMARK1"),H=B.getSubNode("ADVMARK2");I.cssPos({left:Math.round(Math.sin(C)*J._radius+J._bigRadius),top:Math.round(-Math.cos(C)*J._radius+J._bigRadius)});H.cssPos({left:Math.round(J._square*(D[1]-0.5)+J._bigRadius),top:Math.round(J._square*(0.5-D[2])+J._bigRadius)})}if(F!==undefined){K.setStyle("backgroundColor","#"+J.rgb2hex(J.hsv2rgb([F,1,1])))}J._setTempUI(B,A)},_updateClrByPos:function(C,H,I){var P=this,E=linb.event.getPos(H),K=C.$tpos,B=E.left-K.left,L=E.top-K.top,D,O,N,G,Q,M,F,J,A;if(I){O=C.getSubNode("ADVMARK1");D=Math.atan2(B,-L);O.cssPos({left:Math.round(Math.sin(D)*P._radius+P._bigRadius),top:Math.round(-Math.cos(D)*P._radius+P._bigRadius)});G=Math.floor((D/6.28)*360);if(G<0){G+=360}F=[G,C.$hsv[1],C.$hsv[2]];J=P.hsv2rgb(F);A=P.rgb2hex(J);P._updateMarks(C,C.$t_hex=A,false,G)}else{N=C.getSubNode("ADVMARK2");Q=Math.max(0,Math.min(1,(B/P._square)+0.5));M=Math.max(0,Math.min(1,0.5-(L/P._square)));N.cssPos({left:Math.round(P._square*(Q-0.5)+P._bigRadius),top:Math.round(P._square*(0.5-M)+P._bigRadius)});F=[C.$hsv[0],Q,M];J=P.hsv2rgb(F);A=P.rgb2hex(J);P._updateMarks(C,C.$t_hex=A)}},_updateValueByPos:function(B,C,A){B.$hexinadv=B.$t_hex;B.boxing().updateUIValue(B.$t_hex);delete B.$hexinadv},_prepareAdv:function(B,C){var A=this,D=B.getSubNode("ADVWHEEL").absPos();B.$tpos={left:D.left+A._bigRadius,top:D.top+A._bigRadius}},ensureV:function(F,C){var E=this,G=arguments.callee,H=G.map||(G.map=(function(){var I={};E.C16.split("").each(function(K,J){I[K]=1});return I}()));if(!C||typeof C!="string"){return"FFFFFF"}if(C.charAt(0)=="#"){C=C.substr(1,C.length)}var A="",B;for(var D=0;D<6;D++){B=C.charAt(D).toUpperCase();A+=(H[B]?B:"F")}return A},hsv2rgb:function(F,M,K){if(F instanceof Array){M=F[1];K=F[2];F=F[0]}var I=arguments.callee,H=I.f||(I.f=function(N){return Math.min(255,Math.round(N*256))}),A,G,J,E,D,C,B,L;if(M==0){return[K=H(K),K,K]}else{E=Math.floor((F/60)%6);D=(F/60)-E;C=K*(1-M);B=K*(1-D*M);L=K*(1-(1-D)*M);switch(E){case 0:A=K;G=L;J=C;break;case 1:A=B;G=K;J=C;break;case 2:A=C;G=K;J=L;break;case 3:A=C;G=B;J=K;break;case 4:A=L;G=C;J=K;break;case 5:A=K;G=C;J=B;break}return M==0?[K=H(K),K,K]:[H(A),H(G),H(J)]}},rgb2hsv:function(A,D,E){if(A instanceof Array){D=A[1];E=A[2];A=A[0]}A=A/255;D=D/255;E=E/255;var B=Math.min(A,D,E),F=Math.max(A,D,E),G=F-B,I=(F===0)?0:1-(B/F),H=F,C;switch(F){case B:C=0;break;case A:C=60*(D-E)/G;if(D<E){C+=360}break;case D:C=(60*(E-A)/G)+120;break;case E:C=(60*(A-D)/G)+240;break}return[Math.round(C),I,H]},rgb2hex:function(D,C,A){var B=this;if(D instanceof Array){C=D[1];A=D[2];D=D[0]}return B._toFF(D)+B._toFF(C)+B._toFF(A)},hex2rgb:function(B){var A=this;if(!B){B="FFFFFF"}return[A._to255(B.substr(0,2)),A._to255(B.substr(2,2)),A._to255(B.substr(4,2))]}}});Class("linb.UI.DatePicker","linb.UI.iWidget",{Dependency:["linb.date"],Instance:{setCtrlValue:function(A){return this.each(function(E){if(!E.domNode){return }var C=E.box,F=E.properties,D=linb.date,B=D.getRoundDown(A,"m");C._to(E,B,A);if(E.keys.CAPTION){E.getSubNode("CAPTION").html(D.getText(A,"ymd",F.firstDayOfWeek),false)}})}},Initialize:function(){var J=this,R=linb.event.eventhandler,K=linb.UI.$ID,A=linb.UI.$CLS,I=linb.UI.$CLS+"-td-free",W=J.KEY;J.mapKeys(["H","W","TD"]);var G='<colgroup><col width="2%"/><col width="14%"/><col width="14%"/><col width="14%"/><col width="14%"/><col width="14%"/><col width="14%"/><col width="14%"/></colgroup>',C='<thead><tr height="1%"><th id="'+W+"-H:"+K+':7" class="'+A+'-h #H_CC#"></th>',B="</tr></thead>",F='<th id="'+W+"-H:"+K+':@" class="'+A+'-h #H_CC#">@</th>',O="<tbody>",M="</tbody>",V="<tr>",T="</tr>",E='<th id="'+W+"-W:"+K+':@"  class="'+A+'-w #W_CC#">@</th>',D='<td id="'+W+"-TD:"+K+':@" class="'+A+'-td ! #TD_CC#"  unselectable="on" onmouseover="'+R+'" onmouseout="'+R+'" onclick="'+R+'" ></td>',H,Q,P,N,L,U=[],S=[];for(Q=0;Q<7;Q++){S[S.length]=F.replace(/@/g,Q)}N=L=0;for(Q=0;Q<48;Q++){P=Q%8;U[U.length]=(P==0?V:"")+(P==0?E:D).replace(/@/g,P==0?L:N).replace("!",(P==1||P==7)?I:"")+(P==7?T:"");if(P!==0){N++}else{L++}}H=G+C+S.join("")+B+O+U.join("")+M;J.setTemplate("default",{tagName:"div",style:"{_style}",onselectstart:"return false",BORDER:{tagName:"div",BAR:{$order:0,style:"height:{handleHeight}px;",tagName:"div",CMDS:{tagName:"div",PRE2:{$order:0},PRE:{$order:1},YEAR:{$order:2,unselectable:"on"},YTXT:{$order:3,style:"display:inline"},MONTH:{$order:4,unselectable:"on"},MTXT:{$order:5,style:"display:inline"},NEXT:{$order:6},NEXT2:{$order:7}},CMDS2:{CLOSE:{style:"{closeDisplay}"}}},BODY:{$order:1,tagName:"table",cellpadding:"0",cellspacing:"0",width:"100%",text:H},TIPS:{$order:2,style:"height:{tipsHeight}px;",tagName:"div",CAPTION:{text:"{caption}",$order:1}}}})},Static:{Appearances:{"default":{KEY:{overflow:"visible",background:"#FFF","-moz-user-select":linb.browser.gek?"none":null},BORDER:{overflow:"visible",position:"relative","border-top":"solid 1px #C1C1C1","border-left":"solid 1px #C1C1C1"},"BAR,BODY,TIPS":{position:"relative"},BAR:{"white-space":"nowrap",background:linb.UI.getCSSImgPara("barvbg.gif"," repeat-x left top",null,"linb.UI.Public"),"border-right":"solid 1px #C1C1C1"},TIPS:{"white-space":"nowrap","text-align":"center",border:"solid #C1C1C1","border-width":"0 1px 1px 0"},"CMDS, CMDS2":{position:"relative",height:"100%","vertical-align":"middle"},CMDS:{"float":"left","padding-left":"4px"},CMDS2:{"float":"right"},"PRE,PRE2,NEXT,NEXT2,CLOSE":{$order:0,position:"relative",margin:"2px",width:"15px",height:"15px","vertical-align":"middle",cursor:"default"},PRE:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat  0 -65px",null,"linb.UI.Public")},"PRE-mouseover":{$order:2,"background-position":"0 -80px"},"PRE-mousedown":{$order:3,"background-position":"0 -95px"},PRE2:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat  -61px -65px",null,"linb.UI.Public")},"PRE2-mouseover":{$order:2,"background-position":"-61px -80px"},"PRE2-mousedown":{$order:3,"background-position":"-61px -95px"},NEXT:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat  -16px -65px",null,"linb.UI.Public")},"NEXT-mouseover":{$order:2,"background-position":"-16px -80px"},"NEXT-mousedown":{$order:3,"background-position":"-16px -95px"},NEXT2:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat  -76px -65px",null,"linb.UI.Public")},"NEXT2-mouseover":{$order:2,"background-position":"-76px -80px"},"NEXT2-mousedown":{$order:3,"background-position":"-76px -95px"},"YEAR,MONTH":{$order:4,margin:"2px",height:"15px","font-weight":"bold",border:"1px solid #7F9DB9","background-color":"#FFFACD","padding-left":"2px",cursor:"e-resize"},YEAR:{width:"32px"},MONTH:{width:"16px"},CAPTION:{},CLOSE:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -64px 0",null,"linb.UI.Public")},"CLOSE-mouseover":{$order:1,"background-position":"-64px -16px"},"CLOSE-mousedown":{$order:2,"background-position":"-64px -32px"},BODY:{overflow:"visible"},"BODY td,BODY th":{$order:1,border:0,"border-right":"solid 1px #C1C1C1","border-bottom":"solid 1px #C1C1C1"},"TD .exday":{color:"#C1C1C1"},TD:{"text-align":"center","background-color":"#FFFACD"},"TD-free":{$order:1,"text-align":"center","background-color":"#FFF"},"TD-mouseover":{$order:3,"background-color":"#d9e8fb"},"TD-checked":{$order:4,"background-color":"#316AC5","font-weight":"bold",color:"#fff"},"W,H":{$order:3,color:"#333333","background-color":"#E8EEF7","vertical-align":"middle","text-align":"center"}}},Behaviors:{"default":{_hoverEffect:{CLOSE:"CLOSE",TD:"TD",PRE:"PRE",PRE2:"PRE2",NEXT:"NEXT",NEXT2:"NEXT2"},_clickEffect:{CLOSE:"CLOSE",TD:"TD",PRE:"PRE",PRE2:"PRE2",NEXT:"NEXT",NEXT2:"NEXT2"},TD:{onClick:function(B,E,F){var D=B.properties,G=B.getSubSerialId(F.id),C=B.$daymap,A=C[G];if(D.disabled){return false}linb([F]).onMouseout(true,{$force:true});B.boxing().updateUIValue(A)}},CLOSE:{onClick:function(C,D,E){var B=C.properties;if(B.disabled){return }var A=C.boxing();if(false===A.beforeClose(C,E)){return }A.destroy();return false}},PRE:{onClick:function(A,C,D){var B=A.properties;if(B.disabled){return }A.box._to(A,linb.date.add(A.$mfirst,"m",-1,B.firstDayOfWeek))}},NEXT:{onClick:function(A,C,D){var B=A.properties;if(B.disabled){return }A.box._to(A,linb.date.add(A.$mfirst,"m",1,B.firstDayOfWeek))}},PRE2:{onClick:function(A,C,D){var B=A.properties;if(B.disabled){return }A.box._to(A,linb.date.add(A.$mfirst,"y",-1,B.firstDayOfWeek))}},NEXT2:{onClick:function(A,C,D){var B=A.properties;if(B.disabled){return }A.box._to(A,linb.date.add(A.$mfirst,"y",1,B.firstDayOfWeek))}},YEAR:{onMousedown:function(A,B,C){linb(C).startDrag(B,{type:"blank",move:false,grid_width:20,cursor:true});A.$temp=A.$temp2=0},onDrag:function(A,C,E){var B,D=linb.dragDrop.getOffset();B=parseInt(A.$year)+(A.$temp2=parseInt(D.x/20));if(A.$temp!=B){A.$temp=B;A.getSubNode("YEAR").html(B,false)}},onDragstop:function(B,D,E){if(B.$temp2){var C=B.properties,A=linb.date.add(B.$mfirst,"y",B.$temp2,C.firstDayOfWeek);B.box._to(B,linb.date.getRoundDown(A,"m"))}B.$temp=B.$temp2=0}},MONTH:{onMousedown:function(A,B,C){linb(C).startDrag(B,{type:"blank",move:false,grid_width:20,cursor:true});A.$temp=A.$temp2=0},onDrag:function(A,C,E){var B,D=linb.dragDrop.getOffset();B=parseInt(A.$month)+(parseInt(D.x/20)%12);B=(B%12+12)%12;if(A.$temp!=B){A.$temp=B;A.$temp2=B-A.$month+1;A.getSubNode("MONTH").html(B+1,false)}},onDragstop:function(B,D,E){if(B.$temp2){var C=B.properties,A=linb.date.add(B.$mfirst,"m",B.$temp2,C.firstDayOfWeek);B.box._to(B,linb.date.getRoundDown(A,"m"))}B.$temp=B.$temp2=0}}}},DataModel:{height:152,width:200,value:new Date,handleHeight:22,tipsHeight:16,headHeight:20,closeBtn:{ini:true,action:function(A){this.getSubNode("CLOSE").display(A?"":"none")}},firstDayOfWeek:0,$borderW:1},EventHandlers:{beforeClose:function(A,B){},onSelect:function(A,B){}},prepareData:function(B){arguments.callee.upper.call(this,B);var C=B.data,A="display:none";C.closeDisplay=C.closeBtn?"":A},createdTrigger:function(){var B=this,C=B.properties,D=B.boxing(),A=B.box;A._setWeekLabel(B);B.getSubNode("YTXT").html(linb.wrapRes("date.Y"),false);B.getSubNode("MTXT").html(linb.wrapRes("date.M"),false)},_getWeekNodes:function(A){return A.$week||(A.$week=A.getSubNode("W",true))},_getTDNodes:function(A){return A.$tds||(A.$tds=A.getSubNode("TD",true))},_getDayNodes:function(A){return A.$day||(A.$day=A.getSubNode("TD",true))},_getHeaderNodes:function(A){return A.$header||(A.$header=A.getSubNode("H",true))},_setWeekLabel:function(A){var C=linb.date,B=A.getSubSerialId;A.box._getHeaderNodes(A).each(function(E,D){E.innerHTML=linb.wrapRes("date.WEEKS."+B(E.id))})},_setBGV:function(D,H,F){var E=linb.date,A=D.properties,G=D.$daymap||(D.$daymap=[]),I,C,B=A.firstDayOfWeek;D.box._getDayNodes(D).each(function(K,J){C=E.add(H,"d",J,B);G[J]=C;I=E.get(C,"m",B)==F?"#":'<p class="exday">#</p>';C=E.get(C,"d",B);K.innerHTML=I.replace("#",C)});D.box._getWeekNodes(D).each(function(K,J){K.innerHTML=E.get(E.add(H,"ww",J,B),"ww",B)})},_to:function(G,N,L){var A=G.properties,B=A.firstDayOfWeek,H=linb.date,O=G.keys,K=L||A.$UIvalue,J=H.get(K,"m",B)+"-"+H.get(K,"d",B),F=H.get(K,"y",B)+"-"+H.get(K,"m",B),C=H.get(N,"y",B)+"-"+H.get(N,"m",B),I=-1,E,M,P=H.getRoundDown(H.getRoundDown(N,"m"),"ww",1,B),D=H.get(N,"m",B);G.$mfirst=N;this._setBGV(G,P,D);if(G.$selnode){G.removeTagClass("TD","-checked",G.$selnode)}if(F==C){G.$daymap.each(function(R,Q){if(H.get(R,"m",B)+"-"+H.get(R,"d",B)==J){I=Q;return false}});E=this._getTDNodes(G).get()[I];G.addTagClass("TD","-checked",G.$selnode=linb([E]))}if(O.YEAR){M=H.get(N,"y",B);if(G.$year!=M){G.$year=M;G.getSubNode("YEAR").html(M,false)}}if(O.MONTH){M=H.get(N,"m",B)+1;if(G.$month!=M){G.$month=M;G.getSubNode("MONTH").html(M,false)}}}}});Class("linb.UI.TimePicker","linb.UI.iWidget",{Dependency:["linb.date"],Instance:{setCtrlValue:function(A){return this.each(function(D){if(!D.domNode){return }var H=D.boxing(),J=D.box,C=D.properties,G=C.$UIvalue,F=J._v2a(G),E=J._v2a(A),B=D.serialId,I=D.keys,K=linb.dom.byId;D.$hour=E[0];if(F[1]){J._uncheck(K(D.getNodeId(I.MI,B,F[1])))}J._check(K(D.getNodeId(I.MI,B,E[1])));D.getSubNode("HOUR").html(E[0],false);D.getSubNode("CAPTION").html(D.box._showV(D,D.box._v2a(E)),false)})}},Initialize:function(){this.mapKeys(["MI"]);var D=[],C=this._excls,B=this._excls2,H=linb.UI.$ID,G=linb.event.eventhandler,F='<span id="'+this.KEY+"-MI:"+H+':@" class="'+C+' !" onmouseover="'+G+'" onmouseout="'+G+'" onclick="'+G+'"   unselectable="on" >@</span>',E,A;for(E=0;E<60;E++){D[D.length]=F.replace(/@/g,E<10?"0"+E:E).replace("!",(E%5===0)?B:"")}A=D.join("");D.length=0;this.setTemplate("default",{tagName:"div",onselectstart:"return false",style:"{_style}",BORDER:{tagName:"div",BAR:{$order:0,tagName:"div",CMDS:{tagName:"div",PRE:{$order:0},HOUR:{$order:1,unselectable:"on"},HOURTXT:{$order:2,style:"display:inline"},NEXT:{$order:3}},CMDS2:{CLOSE:{style:"{closeDisplay}"}}},M:{$order:1,tagName:"div",text:A},TAIL:{$order:2,style:"height:{tipsHeight}px;",tagName:"div",CAPTION:{text:"{caption}",$order:1}}}})},Static:{_excls:"linbex-timepicker",_excls2:"linbex-timepicker2",_excls_mo:"linbex-timepicker-mouseover",_excls_c:"linbex-timepicker-checked",_mover:function(B){var A=this,C=B.className;if(C.indexOf(A._excls_mo)==-1){B.className=C+" "+A._excls_mo}},_mout:function(B){var A=this,C=B.className;if(C.indexOf(A._excls_mo)!=-1){B.className=C.replace(A._excls_mo,"")}},_check:function(B){var A=this,C=B.className;if(C.indexOf(A._excls_c)==-1){B.className=C+" "+A._excls_c}A._mout(B)},_uncheck:function(B){var A=this,C=B.className;if(C.indexOf(A._excls_c)!=-1){B.className=C.replace(A._excls_c,"")}},Appearances:{"default":{KEY:{background:"#FFF","-moz-user-select":linb.browser.gek?"none":null},"BAR,CON":{position:"relative"},BAR:{"white-space":"nowrap",background:linb.UI.getCSSImgPara("barvbg.gif"," repeat-x left top",null,"linb.UI.Public"),height:"22px","text-align":"center",border:"solid #C1C1C1","border-width":"1px 1px 0 1px"},"CMDS, CMDS2":{position:"relative",height:"100%","vertical-align":"middle"},CMDS:{"float":"left","padding-left":"4px"},CMDS2:{"float":"right"},PRE:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat  0 -65px",null,"linb.UI.Public")},"PRE-mouseover":{$order:2,"background-position":"0 -80px"},"PRE-mousedown":{$order:3,"background-position":"0 -95px"},NEXT:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat  -16px -65px",null,"linb.UI.Public")},"NEXT-mouseover":{$order:2,"background-position":"-16px -80px"},"NEXT-mousedown":{$order:3,"background-position":"-16px -95px"},HOUR:{$order:3,margin:"2px",height:"15px",width:"16px","font-weight":"bold",border:"1px solid #7F9DB9","background-color":"#FFFACD",cursor:"e-resize","padding-left":"2px"},"PRE, NEXT, CLOSE":{$order:0,position:"relative",margin:"2px",width:"15px",height:"15px","vertical-align":"middle",cursor:"default"},CLOSE:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -64px 0",null,"linb.UI.Public")},"CLOSE-mouseover":{$order:1,"background-position":"-64px -16px"},"CLOSE-mousedown":{$order:2,"background-position":"-64px -32px"},CON:{height:"103px",padding:"2px",border:"1px solid #91A7B4"},M:{position:"relative","border-left":"1px solid #91A7B4","border-top":"1px solid #91A7B4",width:"220px"},TAIL:{"white-space":"nowrap","text-align":"center",border:"solid #C1C1C1","border-width":"0 1px 1px 1px"},".linbex-timepicker2":{"background-color":"#FFFACD"},".linbex-timepicker":{"font-size":"12px","padding-left":"3px",width:"18px",height:"16px","border-right":"1px solid #91A7B4","border-bottom":"1px solid #91A7B4"},".linbex-timepicker-mouseover":{$order:1,"background-color":"#d9e8fb"},".linbex-timepicker-checked":{$order:2,"background-color":"#316AC5",color:"#fff"}}},Behaviors:{"default":{_hoverEffect:{CLOSE:"CLOSE",PRE:"PRE",NEXT:"NEXT"},_clickEffect:{CLOSE:"CLOSE",PRE:"PRE",NEXT:"NEXT"},HOUR:{onMousedown:function(A,B,C){linb(C).startDrag(B,{type:"blank",move:false,grid_width:5,cursor:true});A.$temp2=0},onDrag:function(C,E,G){var D,F=linb.dragDrop.getOffset(),B=C.properties.$UIvalue,A=B.split(":");A[0]=(parseFloat(A[0])||0)+parseInt(F.x/10);A[0]=(A[0]%24+24)%24;C.$temp2=(A[0]<=9?"0":"")+A[0];if(B[0]!=C.$temp2){C.getSubNode("HOUR").html(C.$temp2,false)}},onDragstop:function(A,B,C){if(A.$temp2){A.$hour=A.$temp2}A.$temp2=0}},MI:{onMouseover:function(A,B,C){A.box._mover(C)},onMouseout:function(A,B,C){A.box._mout(C)},onClick:function(B,C,D){var A=[];A[0]=B.$hour;A[1]=B.getSubSerialId(D.id);B.boxing().updateUIValue(A.join(":"),true)}},PRE:{onClick:function(B,D,E){var C=B.properties;if(C.disabled){return }var A=B.$hour;A=(parseFloat(A)||0)-1;A=(A%24+24)%24;B.$hour=A=(A<=9?"0":"")+A;B.getSubNode("HOUR").html(A,false)}},NEXT:{onClick:function(B,D,E){var C=B.properties;if(C.disabled){return }var A=B.$hour;A=(parseFloat(A)||0)+1;A=(A%24+24)%24;B.$hour=A=(A<=9?"0":"")+A;B.getSubNode("HOUR").html(A,false)}},CLOSE:{onClick:function(C,D,E){var B=C.properties;if(B.disabled){return }var A=C.boxing();if(false===A.beforeClose(C,E)){return }A.destroy();return false}}}},DataModel:{width:221,value:"00:00",tipsHeight:16,closeBtn:{ini:true,action:function(A){this.getSubNode("CLOSE").display(A?"":"none")}}},EventHandlers:{beforeClose:function(A,B){}},prepareData:function(B){arguments.callee.upper.call(this,B);var C=B.data,A="display:none";C.closeDisplay=C.closeBtn?"":A},createdTrigger:function(){this.getSubNode("HOURTXT").html(linb.wrapRes("date.H"),false)},ensureV:function(D,C){var B,A=[];if(C&&typeof C=="string"){B=C.split(":")}else{if(C&&typeof C=="object"&&C.constructor==Array){B=C}else{B=[]}}A[0]=parseFloat(B[0])||0;A[1]=parseFloat(B[1])||0;if(A[0]<0){A[0]=0}if(A[0]>23){A[0]=23}if(A[1]<0){A[1]=0}if(A[1]>59){A[1]=59}A[0]=(A[0]<=9?"0":"")+A[0];A[1]=(A[1]<=9?"0":"")+A[1];return A.join(":")},formatValue:function(A){return A.join(":")},_v2a:function(A){return typeof A=="string"?A.split(":"):A},_showV:function(B,A){var C=B.CF;if(typeof C.formatCaption=="function"){return C.formatCaption(A)}else{return A.join(":")}}}});Class("linb.UI.TimeLine",["linb.UI.iWidget","linb.UI.iList","linb.UI.iSchedule"],{Dependency:["linb.date"],Instance:{setCtrlValue:function(J){if(!J){return }if(J.indexOf(":")==-1){return }var D=this.get(0),B=D.properties,H=this.constructor,I=J.split(":"),A=new Date(parseInt(I[0])),F=new Date(parseInt(I[1])),G=H._getX(D,A),E=H._getX(D,F),C;if(B.items.length===0){this.insertItems([{id:"$",caption:B.dftCaption,start:A,end:F}],null,true)}else{H._resetItem(D,{left:G,width:E-G},D.getSubNodeByItemId("ITEM",B.items[0].id).get(0))}},disabled:function(A){return this.each(function(B){B.getSubNode("VIEW").opacity(A?0.5:1)})},visibleTask:function(){var C=this.get(0),D=C.properties,B=linb.date,A=D.items;if(A.length&&!D.multiTasks){target=new Date(A[0].start);if(target<D.dateStart||target>B.add(D.dateStart,"ms",D.width*D._rate)){C.box._rePosition(C,-B.diff(D.dateStart,target,"ms")/D._rate+D._band_left)}}},afterInsertItems:function(A){A.box._reArrage(A)},_cache:function(){var C=this.get(0),A=this.constructor,B=A._picker;if(B&&B.domNode){C.getSubNode("POOL").addLast(B.root.display("none"))}}},Static:{Dropable:["ITEMS"],cssNone:false,Templates:{"default":{tagName:"div",style:"{_style}",BORDER:{tagName:"div",style:"height:{_bHeight}px;width:{_bWidth}px;",FOCUS:{tagName:"button"},POOL:{tagName:"div",style:"position:absolute;left:0;top:0;width:0;height:0;display:none;"},BAR:{tagName:"div",style:"{_bardisplay};height:{barHeight}px;",CMDS:{tagName:"div",DATE:{$order:0,style:"{dateDisplay}"},PRE:{$order:2},ZOOMIN:{$order:3,style:"{zoomDisplay}"},ZOOMOUT:{$order:4,style:"{zoomDisplay}"},NEXT:{$order:5}},CMDS2:{tagName:"div",OPT:{style:"{optDisplay}",$order:0},CLOSE:{$order:4,style:"{closeDisplay}"}}},BAND:{$order:2,tagName:"div",style:"left:{_band_left}px;width:{_band_width}px;",BIGLABEL:{tagName:"div",style:"height:{bigLabelHeight}px;z-index:3;{_showBigLabel}",text:"{_bigMarks}"},SMALLLABEL:{$order:1,tagName:"div",style:"height:{smallLabelHeight}px;z-index:4;",text:"{_smallMarks}"}},VIEW:{$order:3,tagName:"div",style:"height:{_viewHeight}px;",ITEMS:{tagName:"div",style:"left:{_band_left}px;width:{_band_width}px;",text:"{items}",ACTIVE:{$order:3,tagName:"div"}},SCROLL:{tagName:"div",SCROLLI:{tagName:"div"}}},TIPS:{$order:4,style:"z-index:2;{_tipsdisplay};height:{tipsHeight}px",tagName:"div"}},$dynamic:{_bigMarks:{LABELT:{id:null,className:null,tagName:"div",style:"width:{width}px;left:{left}px;",text:"{text}"}},_smallMarks:{LABELB:{id:null,className:null,tagName:"div",style:"width:{width}px;left:{left}px;",text:"{text}"}},items:{ITEM:{tagName:"div",style:"left:{_left}px;width:{_width}px;{_top};{_height};",MIN:{$order:0,tagName:"div",style:"{_minDisplay}"},NORMAL:{$order:1,tagName:"div",style:"{_normalDisplay};{_height};{_border}",LEFT:{$order:1,tagName:"div"},HEAD:{$order:2,tagName:"div"},CON:{$order:3,tagName:"div",text:"{caption}"},RIGHT:{$order:4,tagName:"div"}}}}}}},Behaviors:{"default":{_hoverEffect:{PRE:"PRE",NEXT:"NEXT",ZOOMIN:"ZOOMIN",ZOOMOUT:"ZOOMOUT",DATE:"DATE",OPT:"OPT",CLOSE:"CLOSE",MIN:"MIN",NORMAL:"NORMAL"},_clickEffect:{PRE:"PRE",NEXT:"NEXT",ZOOMIN:"ZOOMIN",ZOOMOUT:"ZOOMOUT",DATE:"DATE",OPT:"OPT",CLOSE:"CLOSE",MIN:"MIN"},onRewh:function(C,E,G){var F=C.domNode.style,D=parseInt,H=null,A=H,B=H;if(E.height){B=D(F.height)||H}if(E.width){A=D(F.width)||H}if(B){C.box.resize(C,A,B)}},CLOSE:{onClick:function(B,C,D){if(B.properties.disabled){return }var A=B.boxing();if(false===A.beforeClose(B,D)){return }A.destroy();return false}},OPT:{onClick:function(A,B,C){if(A.properties.disabled){return }A.boxing().onTriggerOption(A,B,C)}},onClick:function(A,B){A.box._focus(A)},BAND:{onMousedown:function(C,F,A){if(C.pause){return }var H=C.properties,B=-H._band_left,D=linb.date,G=H._rate,I=linb.event.getPos(F),E=H._band_width-B-H.width;if(H._minDate&&H._smallLabelStart<H._minDate){B-=D.diff(H._smallLabelStart,H._minDate,"ms")/G}if(H._maxDate&&H._smallLabelEnd>H._maxDate){E-=D.diff(H._maxDate,H._smallLabelEnd,"ms")/G}if(B<0){B=0}if(E<0){E=0}linb([A]).startDrag(F,{move:false,type:"blank",horizontal:true,target_left:I.left,target_top:I.top,offset_left:E,offset_right:B})},onDragstop:function(A,B,C){A.box._rePosition(A);A.box._focus(A)},onDrag:function(C,D,E){var B=C.box._getMoveNodes(C),A=linb.dragDrop;B.left(C.properties._band_left+A.getOffset().x)}},SCROLL:{onMousedown:function(A,B,C){return false},onScroll:function(A,B,C){A.getSubNode("ITEMS").top(-linb([C]).scrollTop())}},ITEMS:{onMouseover:function(A,B,C){if(linb.dragDrop.working){return }A.$itemspos=linb([C]).absPos()},onMousemove:function(B,D){if(linb.dragDrop.working){if(B.$$ondrag){var E=linb.dragDrop;B.box._moveActive(B,B.$active,E.x-B.$dd_ox,B.properties.unitPixs)}}else{var I=B.properties,C=linb.date,J=I._smallLabelStart,A=I._rate,H=I.timeFormat,G=linb.event.getPos(D),F=B.$itemspos;if(F&&I.showTips){B.box._setTips(B,C.getText(C.add(J,"ms",(G.left-F.left)*A),H))}}},onMouseout:function(A,B,C){if(linb.dragDrop.working){return }if(A.properties.showTips){A.box._setTips(A,"")}},onMousedown:function(B,C,E){if(B.properties.disabled||B.properties.readonly){return }if(B.pause){return }var D=B.getSubNode("ACTIVE"),A=linb.event.getPos(C).left;D.setStyle({display:"block",width:"0"}).absPos({left:A,top:null});D.startDrag(C,{type:"none"})},onMouseup:function(A,B,C){A.box._focus(A)}},ACTIVE:{onDragbegin:function(A,B,C){A.$dd_ox=linb.dragDrop.x;A.$task_l=A.$dd_oleft=parseInt(C.style.left)||0;A.$task_w=0;linb([C,C.parentNode]).cursor("e-resize")},onDrag:function(C,D,G){var A=C.$dd_oleft,F=linb.dragDrop.x,B,E;if((E=F-C.$dd_ox)>=0){B=E}else{A=A+E;B=-E}C.box._moveActive(C,G,C.$task_l=A,C.$task_w=B)},onDragstop:function(E,H,A){E.box._deActive(E);linb([A,A.parentNode]).cursor("");var G=E.box,B=G._getTime(E,E.$task_l),F=G._getTime(E,E.$task_l+E.$task_w),C=E.properties,D,J,I=E.boxing();if(E.properties.multiTasks){D={id:_.id(),caption:C.dftCaption,start:B,end:F};if(E.beoferAddTasks&&false===I.beoferAddTasks(E,[D])){}else{I.insertItems([D],null,true)}}else{I.updateUIValue(B+":"+F)}E.$task_l=E.$task_w=E.$dd_ox=E.$dd_oleft=null}},FOCUS:{onFocus:function(A,B,C){_.resetRun(A.KEY+":focus",function(){A.addTagClass("BAR","-focus")})},onBlur:function(A,B,C){_.resetRun(A.KEY+":focus",function(){A.removeTagClass("BAR","-focus")})},onKeydown:function(E,H,B){if(E.pause){return }E.pause=true;var K=E.properties,F=linb.date,I=K._rate,G=30,C=E.box._getMoveNodes(E),J=C.left(),A=K._band_left,D=K._scroll_offset;D=K._scroll_offset=D>G?D:D*1.05;switch(linb.event.getKey(H)[0]){case"left":case"up":if(K._minDate&&F.add(K.dateStart,"ms",(A-J-D)*I)<K._minDate){D=F.diff(K._minDate,K.dateStart,"ms")/I+(A-J)}if(D<0){D=0}C.left(J+D);break;case"right":case"down":if(K._maxDate&&F.add(K.dateStart,"ms",(A-J+D+K.width)*I)>K._maxDate){D=F.diff(K.dateStart,K._maxDate,"ms")/I-(A-J+K.width)}if(D<0){D=0}C.left(J-D);break}if((J+G>0)||(J+C.width()-K.width-G<0)){E.box._rePosition(E)}E.pause=false;return false},onKeyup:function(A,C){var B=A.properties;B._scroll_offset=B.scrollRateBase;A.box._rePosition(A)}},PRE:{onClick:function(F,G){if(F.pause){return }var D=F.properties,C=linb.date,E=D._rate,H=F.box._getMoveNodes(F),B=D._band_left,A=0;if(D._minDate&&D._smallLabelStart<D._minDate){A-=C.diff(D._smallLabelStart,D._minDate,"ms")/E}F.pause=true;H.fx({left:[B,A]},null,function(){F.box._rePosition(F);F.pause=false},200,Math.max(5,(A-B)/100),"inoutsine").start()}},NEXT:{onClick:function(F,G){if(F.pause){return }var D=F.properties,C=linb.date,E=D._rate,H=F.box._getMoveNodes(F),B=D._band_left,A=D.width-D._band_width;if(D._maxDate&&D._smallLabelEnd>D._maxDate){A+=C.diff(D._maxDate,D._smallLabelEnd,"ms")/E}if(B>A){F.pause=true;H.fx({left:[B,A]},null,function(){F.box._rePosition(F);F.pause=false},200,Math.max(5,(B-A)/100),"inoutsine").start()}}},ZOOMIN:{onClick:function(B,E){if(B.pause){return }var D=B.properties,C=B.box,G=C.zoom,A=G.indexOf(D._unitParas),F;if(A>0){B.pause=true;D.timeSpanKey=G[A-1][0];F=B.getSubNodes(["VIEW","BAND"]);F.fx({opacity:[1,0.2]},null,function(){B.boxing().refresh();B.box._focus(B);B.pause=false},200,5,"insine").start()}}},ZOOMOUT:{onClick:function(B,E){if(B.pause){return }var D=B.properties,C=B.box,G=C.zoom,A=G.indexOf(D._unitParas),F;if(A<G.length-1){B.pause=true;D.timeSpanKey=G[A+1][0];F=B.getSubNodes(["VIEW","BAND"]);F.fx({opacity:[1,0.2]},null,function(){B.boxing().refresh();B.box._focus(B);B.pause=false},200,5,"insine").start()}}},DATE:{onClick:function(B,E,G){if(B.pause){return }var A=B.box,D=B.boxing(),H=B.properties.dateStart,F,C;if(A._picker&&A._picker.domNode){F=A._picker.boxing()}else{F=linb.create("DatePicker");A._picker=F.get(0);F.beforeClose(function(){this.boxing()._cache();return false}).beforeValueUpdated(function(N,J,I){var K=this,M=K.getSubNodes(["VIEW","BAND"]),L=K.boxing();K.properties.dateStart=I;L.refresh();K.box._focus(K);L._cache()})}F.setValue(H,true).host(B);C=F.reBoxing();C.popToTop(G);C.setBlurTrigger(B.key+":"+B.$id,function(){D._cache()});linb.event.hookKey("esc",0,0,0,function(){D._cache();A._focus(B);linb.event.hookKey("esc",0,0,0,null)})}},ITEM:{onMousedown:function(A,B,C){return false},onDragbegin:function(C,E,G){var A=C.getItemByDom(G),B=C.$dd_type,F=B?"e-resize":"move",D=C.$active;C.$dd_ox=linb.dragDrop.x;C.$dd_oleft=parseInt(G.style.left);C.$dd_owidth=parseInt(G.style.width);linb([D]).display("block").cssPos({left:C.$dd_oleft,top:null}).width(C.$dd_owidth-2);linb([D,D.parentNode]).cursor(F)},onDrag:function(C,E,A){var H,I,D=linb.dragDrop.x-C.$dd_ox,B=C.$dd_oleft,G=C.$dd_owidth,F=C.$dd_type;if(F=="left"){if(D<G){H=B+D;I=B+G-H}else{H=B+G;I=D-G}}else{if(F=="right"){if(-D<G){H=B;I=G+D}else{H=B+D+G;I=-D-G}}else{H=B+D;I=G}}C.box._moveActive(C,C.$active,H,I)},onDragstop:function(B,F,G){var E=B.box,D=B.box._deActive(B),C=B.$active;if(B.properties.multiTasks){E._resetItem(B,D,G)}else{var H=E._getTime(B,D.left),A=E._getTime(B,D.left+D.width);B.boxing().updateUIValue(H+":"+A)}B.$dd_type=null;linb([C,C.parentNode]).cursor("")}},HEAD:{onMousedown:function(A,B,C){if(A.properties.disabled||A.properties.readonly){return }linb([C]).parent(2).startDrag(B,{defer:1,type:"none"})}},LEFT:{onMousedown:function(A,B,C){if(A.properties.disabled||A.properties.readonly){return }A.$dd_type="left";linb([C]).parent(2).startDrag(B,{defer:1,type:"none"})}},RIGHT:{onMousedown:function(A,B,C){if(A.properties.disabled||A.properties.readonly){return }A.$dd_type="right";linb([C]).parent(2).startDrag(B,{defer:1,type:"none"})}}}},DataModel:{$borderW:1,readonly:false,width:400,height:200,leftSpanCount:0,rightSpanCount:0,dftCaption:"task",timeSpanKey:{ini:"",action:function(){this.boxing().refresh()}},unitPixs:28,smallLabelCount:2,smallLabelUnit:{ini:"h",listbox:_.toArr(linb.date.TIMEUNIT,true)},bigLabelCount:12,bigLabelUnit:{ini:"h",listbox:_.toArr(linb.date.TIMEUNIT,true)},timeFormat:{ini:"ymdhn",listbox:_.toArr(linb.date.TEXTFORMAT,true)},bigLabelFormat:{ini:"ymdh",listbox:_.toArr(linb.date.TEXTFORMAT,true)},smallLabelFormat:{ini:"h",listbox:_.toArr(linb.date.TEXTFORMAT,true)},showBar:true,barHeight:22,showTips:true,tipsHeight:16,showBigLabel:true,bigLabelHeight:16,smallLabelHeight:14,taskHeight:16,multiTasks:false,minDate:{ini:"",set:function(A){return this.each(function(D){var C=D.properties,B=C._minDate=linb.date.parse(C.minDate=A);if(B>C.dateStart){D.box._rePosition(D,-linb.date.diff(C.dateStart,B,"ms")/C._rate+C._band_left)}})}},maxDate:{ini:"",set:function(A){return this.each(function(E){var D=E.properties,B=D._maxDate=linb.date.parse(D.maxDate=A),C;if(B<(C=linb.date.add(D.dateStart,"ms",D.width*D._rate))){E.box._rePosition(E,-linb.date.diff(C,B,"ms")/D._rate+D._band_left)}})}},dateBtn:true,closeBtn:false,optBtn:false,items:{ini:[]},dateStart:new Date,scrollRateBase:5},EventHandlers:{beforeClose:function(A,B){},onTriggerOption:function(A,B,C){},onGetTasks:function(D,E,A,B,C){},beforeChangeTask:function(A,B){},beoferAddTasks:function(B,A){},beforeDelTasks:function(B,A){}},Appearances:{"default":{KEY:{"background-color":"#fff"},BORDER:{overflow:"hidden",position:"relative",top:"0",border:"solid 1px #505050"},BAR:{position:"relative","z-index":5,background:linb.UI.getCSSImgPara("barvbg.gif"," repeat-x left top",null,"linb.UI.Public")},"BAR-focus":{$order:2,"background-position":"right -22px"},"CMDS, CMDS2":{position:"relative",height:"100%","vertical-align":"middle"},CMDS:{"float":"left","padding-left":"4px"},CMDS2:{"float":"right"},"CMDS span, CMDS2 span":{$order:0,position:"relative",margin:"4px 4px 2px 0",width:"15px",height:"15px","vertical-align":"middle",cursor:"default"},TIPS:{position:"absolute",left:"0",width:"100%",bottom:"0","background-color":"#ECE9D8","border-top":"solid 1px #505050"},FOCUS:{position:"absolute","font-size":"0",width:"1px",height:"1px",left:"0",top:"0","line-height":"0",border:"0"},"BAND, VIEW, BIGLABEL, SMALLLABEL":{position:"relative"},VIEW:{width:linb.browser.ie6?"100%":null,overflow:"hidden"},SCROLL:{"z-index":500,position:"absolute","font-size":"0","line-height":"0",right:0,top:0,height:"100%",width:"18px",overflow:"auto","overflow-x":linb.browser.opr?null:"hidden"},SCROLLI:{height:"1000px",width:"1px"},"BIGLABEL, SMALLLABEL":{"background-color":"#ECE9D8",cursor:"move"},"BIGLABEL,SMALLLABEL":{"border-bottom":"solid 1px #505050"},ITEMS:{position:"relative",background:linb.UI.getCSSImgPara("bars.gif"," left top")},"BIGLABEL div, SMALLLABEL div":{"border-left":"solid 1px #505050","text-align":"center",position:"absolute",cursor:"move",top:0,height:"100%"},"BIGLABEL div":{$order:2,"text-align":"left","padding-left":"4px"},ACTIVE:{"z-index":300,position:"relative","border-left":"1px dashed","border-right":"1px dashed",left:"-100px",width:"0",background:0,height:"100%"},ZOOMIN:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat  -271px top",null,"linb.UI.Public")},"ZOOMIN-mouseover":{$order:2,"background-position":"-271px -16px"},"ZOOMIN-mousedown":{$order:3,"background-position":"-271px -31px"},ZOOMOUT:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat  -256px top",null,"linb.UI.Public")},"ZOOMOUT-mouseover":{$order:2,"background-position":"-256px -16px"},"ZOOMOUT-mousedown":{$order:3,"background-position":"-256px -31px"},DATE:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat  -46px -65px",null,"linb.UI.Public")},"DATE-mouseover":{$order:2,"background-position":" -46px -80px"},"DATE-mousedown":{$order:3,"background-position":" -46px -95px"},MIN:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat  -31px -65px",null,"linb.UI.Public")},PRE:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat  0 -65px",null,"linb.UI.Public"),top:"0"},"PRE-mouseover":{$order:2,"background-position":"0 -80px"},"PRE-mousedown":{$order:3,"background-position":"0 -95px"},NEXT:{position:"absolute",background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat  -16px -65px",null,"linb.UI.Public"),top:"0"},"NEXT-mouseover":{$order:2,"background-position":"-16px -80px"},"NEXT-mousedown":{$order:3,"background-position":"-16px -95px"},CLOSE:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat  -64px 0",null,"linb.UI.Public")},"CLOSE-mouseover":{$order:1,"background-position":"-64px -16px"},"CLOSE-mousedown":{$order:2,"background-position":"-64px -32px"},OPT:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -240px top",null,"linb.UI.Public")},"OPT-mouseover":{$order:2,"background-position":"-240px -16px"},"OPT-mousedown":{$order:3,"background-position":"-240px -32px"},ITEM:{position:"absolute",overflow:"visible"},"MIN, NORMAL":{position:"relative",height:"16px",overflow:"hidden","z-index":"1"},MIN:{width:"16px",background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -30px -80px",null,"linb.UI.Public"),cursor:"pointer"},"MIN-mouseover":{"background-position":"60px -15px"},"MIN-mousedown":{"background-position":"-60px -30px"},NORMAL:{cursor:"pointer","background-color":"#C6D6F7",border:"solid 1px #203A83"},"NORMAL-mouseover":{"border-color":"red"},"NORMAL div":{position:"absolute",top:0,height:"100%"},HEAD:{background:linb.UI.getCSSImgPara("handler.gif"," left top",null,"linb.UI.Public"),width:"6px",left:"3px",cursor:"move"},"LEFT, RIGHT":{width:"2px","z-index":10},LEFT:{cursor:"e-resize",left:0},RIGHT:{cursor:"w-resize","background-color":"#C6D6F7",right:0},CON:{"padding-left":"2px",left:"9px","z-index":1}}},createdTrigger:function(){var B=this,C=B.properties,A=B.box;A._setDropable(B);B.$active=B.getSubNode("ACTIVE").get(0);A._ajustHeight(B)},buildViewItems:function(){var D,C,A=this.zoom,F="date.VIEWS.",E=linb.wrapRes,B=[];for(D=0;D<A.length;D++){C=A[D][0];B.push({id:C,caption:E(F+C)})}return B},_setDropable:function(B){var A=linb.dragDrop,C=function(){return false};_.merge(B,{$onDropMarkShow:function(){A.setDropableIcon("add");return false},$onDropMarkClear:function(){A.setDropableIcon();return false},$onDragEnter:function(F,H,I){var E=F.properties,D=linb.event.getPos(H),G=E.unitPixs/2;linb(F.$active).display("block");F.$dd_ox=linb([I]).absPos().left+G;F.$$ondrag=true},$onDragLeave:function(D){D.$$ondrag=D.$dd_ox=null;D.box._deActive(D)},$onDrop:function(F){F.$$ondrag=F.$dd_ox=null;var H=F.box._deActive(F),E={id:_.id(),caption:F.properties.dftCaption},G=F.box,D=F.boxing();E.start=G._getTime(F,H.left);E.end=G._getTime(F,H.left+H.width);if(F.beoferAddTasks&&false===D.beoferAddTasks(F,[E])){}else{D.insertItems([E],null,true)}}},"all")},prepareData:function(D){var b=D.properties,l=D.data,j=linb.date,T=j.TIMEUNIT,B="display:none",f=D.box.zoom,e=0,W,h,X,c,E,k,A,U,F,S,Z,I,Q,L,J,G,V,R,O,C;if(b.minDate){b._minDate=j.parse(b.minDate)}if(b.maxDate){b._maxDate=j.parse(b.maxDate)}l.dateDisplay=b.dateBtn?"":B;l.closeDisplay=b.closeBtn?"":B;l.optDisplay=b.optBtn?"":B;l._showBigLabel=b.showBigLabel?"":B;b._scroll_offset=b.scrollRateBase;b._lines=[{}];l._bWidth=b.width-2*b.$borderW;l._bHeight=b.height-2*b.$borderW;b._viewHeight=l._bHeight-(b.showTips&&b.tipsHeight)-(b.showBigLabel?b.bigLabelHeight:0)-b.smallLabelHeight-(b.showBar&&b.barHeight);l._tipsdisplay=b.showTips?"":B;l._bardisplay=b.showBar?"":B;if(b.timeSpanKey){f.each(function(d){if(d[0]===b.timeSpanKey){F=b._unitParas=d;return false}});if(!F){F=b._unitParas=f[b.timeSpanKey="1 d"]}}l.zoomDisplay=F?"":B;if(F){b.unitPixs=F[1];b.smallLabelCount=F[2];b.smallLabelUnit=F[3];b.smallLabelFormat=F[4];b.bigLabelCount=F[5];b.bigLabelUnit=F[6];b.bigLabelFormat=F[7];b.timeFormat=F[8]}W=b.unitPixs;O=b.smallLabelCount;R=b.smallLabelUnit;C=b.smallLabelFormat;Z=(Math.ceil(b.width/W)||0);I=b.leftSpanCount?b.leftSpanCount:Z;Q=b.rightBarCount?b.rightBarCount:Z;L=Z+I+Q;U=b._rate=T[R]*O/W;if(b._maxDate&&j.add(b.dateStart,"ms",b.width*U)>b._maxDate){b.dateStart=j.add(b._maxDate,"ms",-b.width*U)}if(b._minDate&&b.dateStart<b._minDate){b.dateStart=b._minDate}S=j.getRoundDown(b.dateStart,R,O);G=b._smallLabelStart=j.add(S,R,-I*O);V=b._smallLabelEnd=j.add(G,R,L*O);b._band_width=Math.ceil(j.diff(G,V,"ms")/U);b._band_left_fix=b._band_left=-Math.ceil(j.diff(G,b.dateStart,"ms")/U);J=b._smallMarks=[];E=0;c=j.get(G,C);for(h=0;h<L;h++){k=j.add(G,R,O*(h+1));A=Math.ceil(j.diff(G,k,"ms")/U);J.push({left:E,width:A-E,text:c});E=A;c=j.getText(k,C)}if(b.showBigLabel){var K,Y,N,H,n,P=b.bigLabelCount,M=b.bigLabelUnit,g=b.bigLabelFormat;N=b._bigMarks=[];H=b._bigLabelStart=j.getRoundDown(G,M,P);n=b._bigLabelEnd=j.getRoundUp(V,M,P);K=j.diff(H,n,M)/P;Y=j.diff(G,H,"ms")/U;c=j.getText(H,g);E=0;for(h=0;h<K;h++){k=j.add(H,M,P*(h+1));A=j.diff(H,k,"ms")/U;N.push({left:Math.ceil(E+Y),width:Math.ceil(A-E),text:c});E=A;c=j.getText(k,g)}}arguments.callee.upper.call(this,D)},prepareItem:function(F,G,A,C){var B=this,E=F.properties,H=F.data,D;G._min=false;G._left=B._getX(F,G.start);G._width=Math.max(B._getX(F,G.end)-G._left,0);if(E.multiTasks){if(G._width<=16){G._width=16;G._min=true}}G._minDisplay=G._min?"":"display:none";G._normalDisplay=G._min?"display:none":"";D=B._getLinePos(F,G);G._top=E.multiTasks?"top:"+(E.taskHeight+3)*D+"px":"";G._height="height:"+(E.multiTasks?"16px":"100%");G._border=E.multiTasks?"":"border-top:0;border-bottom:0";E._lines=E._lines||[{}];E._lines[D][G.id]=G;G._line=D;A._left=G._left;A._width=G._width;A._min=G._min;A._line=G._line},zoom:[["10 ms",54,10,"ms","ms",100,"ms","hnsms","hnsms"],["100 ms",54,100,"ms","ms",1,"s","hns","hnsms"],["1 s",30,1,"s","s",10,"s","hns","hnsms"],["10 s",30,10,"s","s",60,"s","hns","hnsms"],["1 n",30,1,"n","n",10,"n","dhn","hns"],["5 n",30,5,"n","n",30,"n","mdhn","hns"],["10 n",30,10,"n","n",60,"n","mdhn","hns"],["30 n",30,30,"n","n",4,"h","ymdh","mdhn"],["1 h",30,1,"h","h",6,"h","ymdh","mdhn"],["2 h",30,2,"h","h",12,"h","ymdh","mdhn"],["6 h",30,6,"h","h",24,"h","ymd","mdhn"],["1 d",24,1,"d","w",1,"ww","ymd","ymdh"],["1 w",30,1,"ww","ww",4,"ww","ymd","ymd"],["15 d",30,15,"d","d",2,"m","ymd","ymd"],["1 m",30,1,"m","m",1,"q","yq","ymd"],["1 q",30,1,"q","q",1,"y","y","ymd"],["1 y",48,1,"y","y",10,"y","y","ym"],["1 de",48,1,"de","de",100,"y","y","ym"],["1 c",48,1,"c","c",1000,"y","y","y"]],_focus:function(A){A.getSubNode("FOCUS").focus(1)},_getTips:function(C){var A,B="$dd_tooltip";if(A=C[B]||(C[B]=C.getSubNode("TIPS").get(0).childNodes[0])){return A.nodeValue}else{return C.getSubNode("TIPS").get(0).innerHTML}},_rr:/\<[^>]*\>/g,_setTips:function(C,D){var A,B="$dd_tooltip";D=D.replace(this._rr,"");if(A=C[B]||(C[B]=C.getSubNode("TIPS").get(0).childNodes[0])){if(A.nodeValue!=D){A.nodeValue=D}}else{C.getSubNode("TIPS").get(0).innerHTML=D}},_getX:function(B,C){var A=B.properties,D=new Date;D.setTime(C);return(Math.ceil(linb.date.diff(A._smallLabelStart,D,"ms")||0)/A._rate)},_getTime:function(D,A,B){var C=D.properties;C=linb.date.add(C._smallLabelStart,"ms",A*C._rate);return B?C:C.getTime()},_moveActive:function(G,B,K,L){var D=Math.ceil,N=G.properties,H=linb.date,O=N._smallLabelStart,A=N._rate,M=N.timeFormat,C="ms",J=B.style,I="px",F,E;F=(D(K)||0);E=((D(L)||0)-2);if(E>0){J.left=F+I;J.width=E+I;if(N.showTips){G.box._setTips(G,H.getText(H.add(O,C,K*A),M)+" - "+H.getText(H.add(O,C,(K+L)*A),M))}}},_deActive:function(D){var C=D.$active.style,A=parseInt(C.left)||0,B=(parseInt(C.width)||0)+2;C.left="-1000px";if(D.properties.showTips){D.box._setTips(D,"")}return{left:A,width:B}},_minusLeft:function(C,B,E,D){var A=C.properties;while((D--)>0){E.first().remove();temp=B.shift()}},_minusRight:function(C,B,E,D){var A=C.properties;while((D--)>0){E.last().remove();temp=B.pop()}},_addLeft:function(A,S,K,D,B){var I=A.properties,Q=linb.date,M="_",T=M+S+"Marks",L=I[T],G=I[M+S+"LabelStart"],E=I[S+"LabelUnit"],J=I[S+"LabelCount"],C=I[S+"LabelFormat"],R=I._rate,O=[],P,F,H,N;P=0;F=Q.getText(G,C);for(N=0;N<D;N++){H=Q.add(G,E,J*(N+1));width=Q.diff(G,H,"ms")/R;O.push({left:Math.ceil(P+(B||0)-3e-13),width:Math.ceil(width-P),text:F});P=width;F=Q.getText(H,C)}O.reverse();K.addFirst(A.box.subBuild(A,T,O).toDom());L.insertAny(O.reverse(),0)},_addRight:function(A,H,S,L,D,B){var I=A.properties,Q=linb.date,N="_",T=N+S+"Marks",M=I[T],F=I[N+S+"LabelStart"],E=I[S+"LabelUnit"],K=I[S+"LabelCount"],C=I[S+"LabelFormat"],R=I._rate,P=[],J,G,O;J=H;for(O=0;O<D;O++){G=Q.add(H,E,K*(O+1));P.push({left:Math.ceil(Q.diff(F,J,"ms")/R+(B||0)-3e-13),width:Math.ceil(Q.diff(J,G,"ms")/R),text:Q.getText(J,C)});J=G}L.addLast(A.box.subBuild(A,T,P).toDom());M.insertAny(P,-1)},_getMoveNodes:function(A){return A.$moveban=A.$moveban||A.getSubNodes(["BAND","ITEMS"])},_rePosition:function(D,F){D.pause=true;var S=this,Y=linb.date,O=D.properties,c=O._rate,M,U,T,I=D.getSubNode("SMALLLABEL"),Q=S._getMoveNodes(D),N=F||Q.left(),J=N-O._band_left_fix;if(Math.abs(J)/O.unitPixs>=1||F){var L=parseInt(J/O.unitPixs),d=O._smallLabelStart,K=O._smallLabelEnd,G=-L*O.smallLabelCount,R,V,E;V=O._smallLabelStart=Y.add(O._smallLabelStart,O.smallLabelUnit,G);E=O._smallLabelEnd=Y.add(O._smallLabelEnd,O.smallLabelUnit,G);R=Math.ceil(Y.diff(V,d,"ms")/c);Q.left(N-R);O._band_width=Math.ceil(Y.diff(V,E,"ms")/c);O.items.each(function(e){e._left+=R;D.box._trimTask(D,e)});I.children().each(function(e){e.style.left=(parseFloat(e.style.left)||0)+R+"px"});O._smallMarks.each(function(e){e.left+=R});if(L>0){S._minusRight(D,O._smallMarks,I,L);S._addLeft(D,"small",I,L)}else{S._minusLeft(D,O._smallMarks,I,-L);S._addRight(D,K,"small",I,-L)}if(O.multiTasks){var A=[];O.items.each(function(e){if(e._left>=O._band_width||(e._left+e._width)<=0){delete O._lines[e._line][e.id];A.push(e.id)}});D.boxing().removeItems(A);if(D.onGetTasks){D.boxing().onGetTasks(D,L>0?V:K,L>0?d:E,O._rate,L>0?"left":"right")}S._reArrage(D)}if(O.showBigLabel){var P=D.getSubNode("BIGLABEL"),B=O.bigLabelUnit,H=O.bigLabelCount,Z,X,W,C,b;K=O._bigLabelEnd;P.children().each(function(e){e.style.left=(parseFloat(e.style.left)||0)+R+"px"});O._bigMarks.each(function(e){e.left+=R});C=Y.getRoundDown(V,B,H);X=Math.ceil(Y.diff(V,O._bigLabelStart,B)/H);W=Math.ceil(Y.diff(O._bigLabelEnd,E,B)/H);if(X){Z=Y.diff(V,C,"ms")/c;O._bigLabelStart=C;if(X>0){S._addLeft(D,"big",P,X,Z)}else{S._minusLeft(D,O._bigMarks,P,-X)}}if(W){Z=Y.diff(V,C,"ms")/c;O._bigLabelEnd=Y.add(O._bigLabelEnd,B,W*H);if(W<0){S._minusRight(D,O._bigMarks,P,-W)}else{S._addRight(D,K,"big",P,W,Z)}}}}O._band_left=Q.left();O.dateStart=S._getTime(D,-O._band_left,1);D.pause=false},_trimTask:function(D,E){var C=-12,A=E._left,B=E._width,F=D.properties._band_width;if(A<C){if(A+B<C){B=0}else{B=B+A-C}A=C}if(A>F+12){A=F+12}this._setItemNode(D,E,"left",A+"px");if(A+B>F-C){B=F-C-A}if(B>=0){this._setItemNode(D,E,"width",B+"px")}},_setItemNode:function(C,D,B,E){var A=D._node||(D._node=C.getSubNodeByItemId("ITEM",D.id).get(0));A.style[B]=E},_getLinePos:function(D,E){if(E._min){return 0}var C=D.properties,A=false,B=0;C._lines.each(function(F,G){if(G===0){return }A=true;_.each(F,function(H){if(E!==H){if(((E._left+E._width)>=H._left)&&((H._left+H._width)>=E._left)){return A=false}}});if(A){B=G;return false}});if(!A){B=C._lines.push({})-1}return B},_reArrage:function(D){var A=this,E,C,B=D.properties;B._lines.length=1;B.items.each(function(F){if(F._line===0){return }index=A._getLinePos(D,F);B._lines[index][F.id]=F;if(F._line!==index){F._line=index;if(B.multiTasks){A._setItemNode(D,F,"top",(B.taskHeight+3)*index+"px")}}});C=B._linesHeight=(B._lines.length+1)*18;A._ajustHeight(D)},_resetItem:function(D,C,A){var B=D.properties,I=D.getItemByDom(A),E=B._band_width+12,F=function(J,K){return D.getSubNodeByItemId(J,K)},H=D.box,G=Math.max;if(C.left){I._left=C.left;I.start=H._getTime(D,C.left);A.style.left=C.left+"px"}if(C.width){I._width=G(C.width,0);I.end=H._getTime(D,C.left+C.width);if(B.multiTasks){if(I._width<=16){I._width=C.width=16;if(!I._min){I._min=true;F("NORMAL",I.id).display("none");F("MIN",I.id).display("block")}}else{if(I._min){I._min=false;F("NORMAL",I.id).display("block");F("MIN",I.id).display("none")}if(C.left+C.width>E){C.width=E-C.left}}}A.style.width=C.width+"px";if(linb.browser.ie&&!B.multiTasks){linb([A.parentNode]).ieTrigger()}}H._reArrage(D)},_ajustHeight:function(C){var A=C.properties,F=function(L){return C.getSubNode(L)},I=F("VIEW"),G=F("ITEMS"),J=F("SCROLL"),B=F("SCROLLI"),E,H,K=A._linesHeight||0,D=I.height();E=Math.max(K,D);G.height(E);B.height(E);H=K>D;J.display(H?"block":"none");G.top(H?-J.scrollTop():0)},showTips:function(F,E,G){var J=F.properties,B=E.id,H=J.timeFormat,C=F.getSubSerialId(B),A=F.SubSerialIdMapItem,I=A&&A[C],D=linb.date;if(J.disabled){return }if(I&&I.disabled){return }if(I){I.tips='<p style="font-weight:bold">'+I.caption+"</p>"+D.getText(new Date(I.start),H)+":"+D.getText(new Date(I.end),H);linb.UI.Tips.show(G,I);return true}else{return false}},resize:function(D,A,C){var H=D.properties,G=function(I){return D.getSubNode(I)},F=2*H.$borderW,E=3,B;if(C&&C!=H.height&&parseInt(D.domNode.style.height)){G("BORDER").height(B=C-F);G("VIEW").height(B=B-(H.showTips&&H.tipsHeight)-E-(H.showBigLabel?H.bigLabelHeight:0)-H.smallLabelHeight-(H.showBar&&H.barHeight));this._ajustHeight(D);if(H.height!=C){H.height=C}}if(A&&A!=H.width){G("BORDER").width(A-F);if(H.width!=A){H.width=A}}}}});Class("linb.UI.List",["linb.UI.iWidget","linb.UI.iForm","linb.UI.iList"],{Instance:{setCtrlValue:function(A){return this.each(function(D){if(!D.domNode){return }var I=D.boxing(),O=I.getUIValue(),B=D.properties,F="ITEM",K=function(T,S,R){return D.removeTagClass(T,S,R)},Q=function(T,S,R){return D.addTagClass(T,S,R)},G=function(R,S){return D.getSubNode(R,S)},J=function(R){return D.getSubSerialIdByItemId(R)};if(B.selMode=="single"){var N=J(O);if(O&&N){K("ITEM","-checked",G(F,N))}N=J(A);if(N){Q("ITEM","-checked",G(F,N))}if(N){var C=G(F,N);if(C){var M=C.offsetTop(),L=G("ITEMS"),H=L.scrollHeight(),P=L.scrollTop(),E=L.height();if(H>E){if(M<P||M>P+E){L.scrollTop(M)}}}}}else{if(B.selMode=="multi"){O=O?O.split(";"):[];A=A?A.split(";"):[];O.each(function(R){if(!A.exists(R)){K("ITEM","-checked",G(F,J(R)))}});A.each(function(R){if(!O.exists(R)){Q("ITEM","-checked",G(F,J(R)))}})}}})},setValue:function(C,A){var B=arguments.callee.upper;return this.each(function(E){if(E.properties.selMode=="multi"){var D=C.split(";");D.sort();C=D.join(";")}B.apply(E.boxing(),[C,A])})},adjustSize:function(){return this.each(function(E){var A=E.root,B=E.getSubNode("ITEMS"),C=E.getSubNode("POOL");B.height("auto");var D=Math.min(E.properties.maxHeight,B.offsetHeight());E.properties.height=D;A.height(D)})},activate:function(){return linb.UI.iList.prototype.activate.call(this)},setDirtyMark:function(){return this.each(function(B){var F=B.domId,C=B.properties,A=C.value!==C.$UIvalue,E=linb.UI.$css_tag_dirty;if(B.beforeDirtyMark&&false===B.boxing().beforeDirtyMark(B,A)){}else{var D=B.getSubNode("ITEMS");if(A){D.addClass(E)}else{D.removeClass(E)}}})}},Static:{cssNone:false,Templates:{"default":{tagName:"div",style:"{_style}",ITEMS:{$order:10,tagName:"div",text:"{items}"},$dynamic:{items:{ITEM:{tagName:"a",href:"javascript:;",tabindex:"{_tabindex}",ICON:{style:"background:url({icon}) transparent  no-repeat {iconPos};{iconDisplay}",$order:0},CAPTION:{tagName:"text",text:"{caption}",$order:1}}}}}},Appearances:{"default":{KEY:{"font-size":"12px"},ITEMS:{"background-color":"#fff",position:"relative",border:"1px solid #91A7B4",overflow:"auto","overflow-x":(linb.browser.ie||linb.browser.gek)?"hidden":""},ITEM:{display:"block","font-family":'"Verdana", "Helvetica", "sans-serif"',border:0,cursor:"pointer",padding:"0 2px 0 2px",position:"relative"},"ITEM-mouseover":{$order:1,"background-color":"#d9e8fb"},"ITEM-checked":{$order:2,"background-color":"#316AC5",color:"#fff"},ICON:{cursor:"pointer",width:"16px",height:"16px",margin:"0 4px 0 0"}}},Behaviors:{"default":{_hoverEffect:{ITEM:"ITEM"},_clickEffect:{ITEM:"ITEM"},onRewh:function(C,D,F){var E=C.domNode.style,A=null,B=null;if(D.height){B=parseInt(E.height)||null}if(D.width){A=parseInt(E.width)||null}C.box.resize(C,A,B)},ITEM:{onClick:function(B,F,A){var G=B.properties,J=B.getItemByDom(A),H=B.getSubSerialId(A.id),E=B.boxing(),C;if(G.disabled||J.disabled){return false}switch(G.selMode){case"none":C=E.onItemSelected(B,J,A);break;case"multi":var I=E.getUIValue(),D=I?I.split(";"):[];if(D.exists(J.id)){D.removeValue(J.id)}else{D.push(J.id)}D.sort();I=D.join(";");if(E.getUIValue()==I){C=false}else{E.updateUIValue(I);if(E.getUIValue()==I){C=E.onItemSelected(B,J,A)}}break;case"single":if(E.getUIValue()==J.id){C=false}else{E.updateUIValue(J.id);if(E.getUIValue()==J.id){C=E.onItemSelected(B,J,A)}}break}linb(A).focus();return C},onKeydown:function(C,F,A){var J=linb.event.getKey(F),I=J[0],B=J[2],H=linb([A],false),E=C.root.nextFocus(true,true,false),G=C.root.nextFocus(false,true,false);switch(linb.event.getKey(F)[0]){case"tab":if(B){if(A!=E.get(0)){E.focus();return false}}else{if(A!=G.get(0)){G.focus();return false}}break;case"left":case"up":var D=H.nextFocus(false,true,false);if(H.get(0)==E.get(0)){G.focus()}else{H.nextFocus(false)}return false;break;case"right":case"down":var D=H.nextFocus(true,false,false);if(H.get(0)==G.get(0)){E.focus()}else{H.nextFocus()}return false;break;case"space":case"enter":linb(A.id).onClick();return false;break}}},ITEMS:{beforeKeypress:function(C,D){var B=linb.event.getKey(D)[0];if(B=="tab"||B=="enter"){return true}else{if(/^\w$/.test(B)){C._wordcache=C._wordcache||"";C._wordcache+=B.toLowerCase();clearTimeout(C._wordcachetimeout);var A=C.properties.items;A.each(function(F,E){if(F.caption.toLowerCase().startWith(C._wordcache)){C.getSubNodeByItemId("ITEM",F.id).focus();return false}});C._wordcachetimeout=_.asyRun(function(){C._wordcache=""},300)}}}}}},DataModel:({icon:null,iconPos:null,caption:null,tabindex:{action:function(A){if(this.domNode){this.getSubNode("ITEM",true).tabIndex(A)}}},selMode:{ini:"single",listbox:["single","none","multi"]},width:120,height:150,maxHeight:300}),EventHandlers:{beforeDirtyMark:function(B,A){},onItemSelected:function(A,B,C){}},resize:function(F,B,E){var D=F.properties,C,A=F.getSubNode("ITEMS");if(!parseInt(F.domNode.style.height)){return }A.height(E)}}});Class("linb.UI.LinkList",["linb.UI.List"],{Initialize:function(){var A=this.getTemplate("default");A.$dynamic={items:{ITEM:{style:"{_style};margin:{itemMargin}px",LINK:{$order:1,tagName:"a",href:"{href1}",tabindex:"{_tabindex}",text:"{caption}"}}}};this.setTemplate("default",A)},Static:{Appearances:{"default":{ITEMS:{position:"relative",overflow:"auto","overflow-x":(linb.browser.ie||linb.browser.gek)?"hidden":""},ITEM:{"vertical-align":"middle",position:"relative",background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat left -202px",null,"linb.UI.Public"),"border-right":"solid 1px #C2C1C1",height:"16px","white-space":"nowrap"},"ITEM-mouseover":{},"ITEM-checked":{},LINK:{display:linb.browser.gek?["-moz-inline-block","-moz-inline-box","inline-block"]:"inline-block","vertical-align":"middle",padding:"1pt 4px 1pt 12px"}}},DataModel:({itemMargin:0,tabindex:{action:function(D){var B=this,C=B.keys,A=function(E,F){B.getSubNode(E,true).tabIndex(F)};if(B.domNode){A("LINK",D)}}}}),Behaviors:{"default":{ITEM:{},LINK:{onClick:function(A,B){return A.box.cancelLink(B)},onMousedown:function(B,E,F){if(linb.event.getBtn(E)!="left"){return }var A=B.properties,D=B.getItemByDom(F),C=B.boxing();if(A.disabled||D.disabled){return false}C.onItemClick(B,D,F)}}}},EventHandlers:{onItemSelected:null,onItemClick:function(A,B,C){}},prepareItem:function(A,B){var C=A.properties;B._tabindex=C.tabindex;B.itemMargin=C.itemMargin}}});Class("linb.UI.Gallery","linb.UI.List",{Initialize:function(){var A=this.getTemplate("default");A.$dynamic={items:{ITEM:{style:"padding:{itemPadding}px;margin:{itemMargin}px;",ITEMFRAME:{style:"width:{itemWidth}px;height:{itemHeight}px;",CAPTION:{tagName:"div",text:"{caption}",$order:0},CONTENT:{tagName:"div",$order:1,ICON:{tagName:"a",href:"{href}",style:"background:url({icon}) transparent center  no-repeat {iconPos};width:{iconWidth}px;height:{iconHeight}px;"}},COMMENT:{tagName:"a",href:"{href}",text:"{comment}",$order:2}}}}};this.setTemplate("default",A)},Static:{Appearances:{"default":{ITEMS:{position:"relative",top:0,left:0,overflow:"auto","overflow-x":(linb.browser.ie||linb.browser.gek)?"hidden":""},ITEM:{display:linb.browser.gek?["-moz-inline-block","-moz-inline-box","inline-block"]:"inline-block",position:"relative",overflow:"hidden","vertical-align":"top",border:0,padding:0,margin:0},ITEMFRAME:{display:linb.browser.ie?"inline-block":"block",position:"relative",overflow:"hidden",border:0,padding:0,margin:0,width:"100%",height:"100%","-moz-box-flex":"1",border:"1px solid #A7A6AA"},"ITEM-mouseover":{},"ITEM-checked":{},"ITEM-mouseover CAPTION":{$order:1,"background-color":"#d9e8fb"},"ITEM-checked CAPTION":{$order:2,"background-color":"#316AC5",color:"#fff"},"CONTENT, CAPTION":{"text-align":"center",overflow:"hidden","white-space":"nowrap"},CAPTION:{"font-weight":"bold","border-bottom":"1px solid #A7A6AA"},ICON:{display:linb.browser.gek?["-moz-inline-block","-moz-inline-box","inline-block"]:"inline-block","vertical-align":"middle"},COMMENT:{display:"block",margin:"0 2px 0 2px"}}},DataModel:({itemMargin:{ini:6,action:function(A){if(typeof A!="object"){this.getSubNode("ITEM",true).setPxStyle("margin",A)}else{this.getSubNode("ITEM",true).setStyle(A)}}},itemPadding:{ini:2,action:function(A){if(typeof A!="object"){this.getSubNode("ITEM",true).setPxStyle("padding",A)}else{this.getSubNode("ITEM",true).setStyle(A)}}},itemWidth:{ini:32,action:function(A){this.getSubNode("ITEMFRAME",true).width(A)}},itemHeight:{ini:32,action:function(A){this.getSubNode("ITEMFRAME",true).height(A)}},iconWidth:{ini:16,action:function(A){this.getSubNode("ICON",true).width(A)}},iconHeight:{ini:16,action:function(A){this.getSubNode("ICON",true).height(A)}},tabindex:{action:function(A){if(this.domNode){this.getSubNode("ITEM",true).tabIndex(A)}}},width:200,height:200}),prepareItem:function(A,B){var C=A.properties;"itemWidth,itemHeight,iconWidth,iconHeight,itemPadding,itemMargin".toArr().each(function(D){B[D]=B[D]||C[D]});B.capition=B.capition||"";B.comment=B.comment||"";B._tabindex=C.tabindex}}});Class("linb.UI.IconList","linb.UI.List",{Initialize:function(){var A=this.getTemplate("default");A.$dynamic={items:{ITEM:{style:"padding:{itemPadding}px;margin:{itemMargin}px;",ICON:{style:"background:url({icon}) transparent no-repeat {iconPos};width:{itemWidth}px;height:{itemHeight}px;"}}}};this.setTemplate("default",A)},Static:{Appearances:{"default":{ITEMS:{position:"relative",top:0,left:0,overflow:"auto","overflow-x":(linb.browser.ie||linb.browser.gek)?"hidden":""},ITEM:{display:linb.browser.gek?["-moz-inline-block","-moz-inline-box","inline-block"]:"inline-block",position:"relative",overflow:"hidden","vertical-align":"top"},ICON:{border:"1px solid #CDCDCD"}}},DataModel:({itemMargin:{ini:6,action:function(A){if(typeof A!="object"){this.getSubNode("ITEM",true).setPxStyle("margin",A)}else{this.getSubNode("ITEM",true).setStyle(A)}}},itemPadding:{ini:2,action:function(A){if(typeof A!="object"){this.getSubNode("ITEM",true).setPxStyle("padding",A)}else{this.getSubNode("ITEM",true).setStyle(A)}}},itemWidth:{ini:16,action:function(A){this.getSubNode("ICON",true).width(A)}},itemHeight:{ini:16,action:function(A){this.getSubNode("ICON",true).height(A)}},tabindex:{action:function(A){if(this.domNode){this.getSubNode("ITEM",true).tabIndex(A)}}},width:200,height:200}),prepareItem:function(A,B){var C=A.properties;"itemWidth,itemHeight,itemPadding,itemMargin".toArr().each(function(D){B[D]=B[D]||C[D]});B._tabindex=C.tabindex}}});Class("linb.UI.Poll","linb.UI.List",{Instance:{fillDetail:function(B,C){var A=this.get(0);A.getSubNodeByItemId("BODY",B.id).html("",false).attach(B._obj=C)},setOptCap:function(B,A){return this.each(function(E){var C=E.properties.items,D=E.itemsSearch(E.properties.items,function(F){return F.id==B.id},false,true);if(D&&(D=D[0])){D.caption=A;if(E.domNode){E.getSubNodeByItemId("CAPTION",D.id).html(A)}}})},getBindEditor:function(){return this.get(0)._bind},insertOpt:function(D,B){if(!D.id){D.id=_.id()}var E,A=this.get(0).properties.items,C;if(!_.isNumb(B)){if(C=A.length){E=A[C-1]}}else{E=A[B]}this.insertItems([D],E&&E.id,false);return this},removeOpt:function(A){this.removeItems([A]);return this},setDirtyMark:function(){return this}},Initialize:function(){var B=this;B.mapKeys(["MARK2","MARK3","EDIT"]);var C=B.getTemplate("default");C.TITLE={$order:"0",tagName:"DIV",style:"{titleDisplay}",text:"{title}",className:"{disabled} {_cls}"};C.TAIL={$order:"20",tagName:"DIV",className:"{disabled} ",text:"{cmds}"};C.$dynamic={items:{OUTER:{tagName:"div",TOGGLE:{style:"{_togdisplay}"},ITEM:{tagName:"a",href:"javascript:;",tabindex:"{_tabindex}",OPTION:{$order:0,tagName:"DIV",MARK:{$order:1,className:"{_optclass}"}},CAPTION:{$order:1,tagName:"DIV",text:"{caption}",className:"{disabled} {_itemcls}"},CHART:{$order:2,tagName:"DIV",style:"{_display}",CAST:{$order:0,text:"{message}"},BAR:{$order:1,style:"background-position: -{_per}px -190px;",BARI:{}},DEL:{$order:2,tagName:"BUTTON",style:"{_del}",text:"{delText}"}},CLEAR:{$order:3,tagName:"DIV"}},BODY:{$order:1,tagName:"DIV",text:"{_body}"}}},cmds:{CMD:{tagName:"{tagName}",tabindex:"{_tabindex}",text:"{caption}"}}};B.setTemplate("default",C);var D=function(J,I,K,L,M){var G=J._bind,F=J.properties;if(J.onCustomEdit){J._bind=J.boxing().onCustomEdit(J,I,K,L,M)}else{if(!G){var H={type:F.editorType,saveBtn:true,left:-10000,top:-10000};if(!_.isEmpty(F.editorProps)){_.merge(H,F.editorProps,"all")}J._bind=G=linb.create(F.editor,H);G.onHotKeydown(function(O,N){if(N=="enter"){O.boxing().onSave(O);return false}else{if(N=="esc"){G.hide()}}});J.root.attach(G)}var E=I.getRegion(true,J.root);if(E.height>G.getHeight()){G.setHeight(E.height)}else{E.top-=3}if(E.top<0){E.top=0}G.setValue(L||"",true).setWidth(E.width+I.paddingW()).show(E.left+"px",E.top+"px").onSave(function(Q){var O=Q.properties.$UIvalue,P=Q.properties.value,N=J.boxing();if(O!=P){switch(K){case"1":if(J.beforeItemChanged&&N.beforeItemChanged(J,M,O)===false){}else{N.setOptCap(M,O)}break;case"2":if(J.beforeItemAdded&&N.beforeItemAdded(J,O)===false){}else{N.insertOpt({caption:O})}break;default:if(J.beforeTitleChanged&&N.beforeTitleChanged(J,O)===false){}else{N.setTitle(O)}}}_.asyRun(function(){G.hide()})}).reBoxing().setBlurTrigger(G.KEY+":"+G.$id,function(){G.hide()});_.asyRun(function(){G.activate()})}};C=B.getBehavior("default");var A=C.ITEM.onClick;C.ITEM.onClick=function(E,H,I){var G=E.properties,F=E.getItemByDom(I);if(G.disabled){return }if(G.editable){D(E,E.getSubNodeByItemId("CAPTION",F.id),F.editable?"2":"1",F.editable?"":F.caption,F)}else{if(F.editable){D(E,E.getSubNodeByItemId("CAPTION",F.id),"2")}else{A.apply(this,arguments)}}};C.TITLE={onClick:function(E,H,I){var G=E.properties,F=E.getItemByDom(I);if(G.disabled){return }if(G.editable){D(E,E.getSubNode("TITLE"),"3",G.title)}}};C.DEL={onClick:function(F,I,J){var H=F.properties,E=F.boxing(),G=F.getItemByDom(J);if(H.disabled){return }if(H.editable){if(F.beforeItemRemoved&&E.beforeItemRemoved(F,G)===false){}else{E.removeOpt(G.id)}return false}}};C.CMD={onClick:function(F,H,I){var G=F.properties,E=F.getSubSerialId(I.id);if(G.disabled){return }F.boxing().onCommand(F,E,I)}};C.TOGGLE={onClick:function(G,I,E){var J=G.properties,K=J.items,M=G.getItemByDom(E),L=G.getSubSerialId(E.id),F=linb([E]),H=G.getSubNode("BODY",L);if(M._show){G.removeTagClass("TOGGLE","-checked",F);H.display("none")}else{G.addTagClass("TOGGLE","-checked",F);H.display("block");if(!M._fill){M._fill=true;M._body=G.onBuildBody?G.boxing().onBuildBody(G,M):G.box.buildBody(G,M);if(M._body){G.getSubNode("BODY",L).html(M._body,false)}}}M._show=!M._show}};B.setBehavior("default",C)},Static:{ITEMKEY:"OUTER",Appearances:{"default":{KEY:{"font-size":"12px",zoom:linb.browser.ie?1:null,background:"#fff"},"TITLE, ITEMS, TAIL":{position:"relative",overflow:"auto","line-height":"12px",background:"#fff"},TAIL:{zoom:linb.browser.ie?1:null,padding:"5px 0 5px 40px"},CMD:{margin:"3px","white-space":"nowrap","vertical-align":"middle"},TITLE:{"font-weight":"bold",padding:"4px","border-bottom":"1px solid #CDCDCD"},ITEMS:{"overflow-x":(linb.browser.ie||linb.browser.gek)?"hidden":"",zoom:linb.browser.ie?1:null,margin:"4px 4px 4px 5px"},OUTER:{position:"relative",zoom:linb.browser.ie?1:null,"padding-left":"15px","border-bottom":"1px dashed #CDCDCD"},TOGGLE:{cursor:"pointer",position:"absolute",left:0,top:"4px",width:"15px",height:"15px",background:linb.UI.getCSSImgPara("icon.gif"," no-repeat left -16px",null,"linb.UI.Public")},"TOGGLE-checked":{$order:1,"background-position":"left -28px"},BODY:{display:"none","padding-left":"27px"},ITEM:{display:"block",position:"relative",zoom:linb.browser.ie?1:null,padding:"4px 2px 4px 2px"},"ITEM-checked":{},OPTION:{position:"absolute",left:"2px",top:"4px"},CAPTION:{"float":"left",zoom:linb.browser.ie?1:null,"margin-left":"24px",display:linb.browser.ie6?"inline":null},EDIT:{$order:2,"float":"none","background-color":"#f4f4f4",cursor:"pointer",display:linb.browser.ie6?"block":null},CHART:{"float":"right"},CLEAR:{clear:"both","text-align":"right"},"BAR, BARI":{width:"150px",height:"12px",border:0,"line-height":0,"font-size":0},BAR:{"margin-left":"2px",background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -130px -190px",null,"linb.UI.Public")},BARI:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -150px -225px ",null,"linb.UI.Public")},"MARK, MARK2, MARK3":{cursor:"pointer",width:"16px",height:"16px","margin-right":"6px"},MARK:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -144px top",null,"linb.UI.Public")},"ITEM-mouseover MARK":{$order:1,"background-position":" -144px -17px"},"ITEM-mousedown MARK":{$order:2,"background-position":" -144px -34px"},"ITEM-checked MARK":{$order:3,"background-position":" -128px top"},"ITEM-checked-mouseover MARK":{$order:4,"background-position":" -128px -17px"},"ITEM-checked-mousedown MARK":{$order:5,"background-position":" -128px -34px"},MARK2:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -112px top",null,"linb.UI.Public")},"ITEM-mouseover MARK2":{$order:1,"background-position":" -112px -17px"},"ITEM-mousedown MARK2":{$order:2,"background-position":" -112px -34px"},"ITEM-checked MARK2":{$order:3,"background-position":" -96px top"},"ITEM-checked-mouseover MARK2":{$order:4,"background-position":" -96px -17px"},"ITEM-checked-mousedown MARK2":{$order:5,"background-position":" -96px -34px"},MARK3:{$order:11,background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -56px -222px",null,"linb.UI.Public")},"ITEM-mouseover MARK3":{$order:11,"background-position":" -56px -222px"},"ITEM-mousedown MARK3":{$order:11,"background-position":" -56px -222px"},DEL:{margin:"0 0 0 4px"}}},DataModel:{title:{ini:"",action:function(A){this.getSubNode("TITLE").html(A)}},selMode:{ini:"single",listbox:["single","multi"],action:function(){this.boxing().refresh()}},cmds:{ini:null},noTitle:{ini:false,action:function(A){this.getSubNode("TITLE").display(A?"none":"")}},toggle:false,delText:"remove",editable:false,newOption:"",editor:"ComboInput",editorType:"none",editorProps:{ini:{}}},EventHandlers:{beforeDirtyMark:function(B,A){},onItemSelected:function(A,B,C){},beforeTitleChanged:function(B,A){},onCustomEdit:function(B,D,A,E,C){},beforeItemAdded:function(B,A){},beforeItemRemoved:function(A,B){},beforeItemChanged:function(B,C,A){},onCommand:function(B,A,C){},onBuildBody:function(A,B){}},dynamicTemplate:function(C){var A=C.properties;var E=C._exhash="$selMode:"+A.selMode+";",D=C.template._id,B=C.box.getTemplate(D,E);A.$UIvalue=A.value;if(!B){B=_.clone(C.box.getTemplate(D));if(A.selMode=="multi"){B.$dynamic.items.OUTER.ITEM.OPTION.MARK2={$order:1,className:"{_optclass}"};delete B.$dynamic.items.OUTER.ITEM.OPTION.MARK}C.box.setTemplate(D,B,E)}C.template=B},prepareData:function(E){arguments.callee.upper.call(this,E);var B=E.properties,G=E.data;if(B.editable){G._cls=E.getClass("EDIT")}G.titleDisplay=B.noTitle?"display:none":"";var A=B.cmds,D;if(A&&A.length){var C=linb.UI.subSerialIdTag,I;I=G.cmds=[];for(var H=0,J=A,F=J.length;H<F;H++){D=linb.UI.copyItem(J[H]);D.tagName=D.tagName||"button";I.push(D);D._tabindex=B.tabindex;D[C]=D.id}}},prepareItems:function(E,B,D){var C=B,A=E.properties.newOption;if(!E.prepared){if(E.properties.editable||A){C=B.copy();C.push({id:"$custom",editable:true,caption:A||"new"})}}return arguments.callee.upper.apply(this,[E,C,D])},prepareItem:function(A,B){var D=A.properties,C=A.CF;B._tabindex=D.tabindex;if(typeof C.formatCaption=="function"){B.caption=C.formatCaption(B.caption)}B._body=B._body||"Loading...";if(B.id!="$custom"){B._togdisplay=((D.toggle&&B.toggle!==false)||B.toggle)?"":"display:none;";B._display="";B.percent=parseFloat(B.percent)||0;if(B.percent<0){B.percent=0}if(B.percent>1){B.percent=1}B._per=150*(1-B.percent)}else{B._optclass=A.getClass("MARK3");B._togdisplay=B._display="display:none;";B._per=0}if(D.editable||B.editable){B._itemcls=A.getClass("EDIT")}if(D.editable){B.delText=D.delText}B._del=(D.editable&&!B.editable)?"":"display:none;"},buildBody:function(A,B){return B.text?"<pre>"+B.text.replace(/</g,"&lt;")+"</pre>":""}}});Class("linb.UI.PanelBar",["linb.UI.Div","linb.UI.iContainer"],{Instance:{removePanel:function(){this.destroy()},getPanelPara:function(){return _.copy(this.get(0).properties)},getPanelChildren:function(){return this.get(0).children}},Static:{cssNone:false,Dropable:["PANEL"],Dragable:["HANDLE"],Templates:{"default":{tagName:"div",style:"{_style}",BORDER:{tagName:"div",HANDLE:{tagName:"div",style:"{handleDisplay};height:{handleHeight}px",TOGGLE:{className:" {toggleCls}",style:"{toggleDisplay}",$order:0},ICON:{style:"background:url({icon}) transparent  no-repeat {iconPos}; {iconDisplay}",$order:0},CAPTION:{tagName:"a",href:"{href}",tabindex:"{tabindex}",text:"{caption}",className:"{disabled}",$order:1},CMDS:{OPT:{style:"{optDisplay}",$order:1},LAND:{style:"{landDisplay}",$order:1},CLOSE:{style:"{closeDisplay}",$order:2}}},PANEL:{$order:1,tagName:"div",style:"{panelDisplay}",text:"{html}"+linb.UI.$childTag}}}},Appearances:{"default":{"KEY BORDER":{zoom:linb.browser.ie6?1:null},PANEL:{position:"relative",left:0,top:0,overflow:"auto",zoom:linb.browser.ie6?1:null,"background-color":"#fff"},HANDLE:{overflow:"hidden",background:linb.UI.getCSSImgPara("barvbg.gif"," repeat-x left top",null,"linb.UI.Public"),position:"relative",width:linb.browser.ie6?"100%":null,"white-space":"nowrap"},"HANDLE-mouseover":{$order:1,"background-position":"right -22px"},"TOGGLE, ICON":{width:"16px",height:"16px",margin:"2px"},CMDS:{position:"absolute",top:0,right:0,"text-align":"right","vertical-align":"middle",height:"100%",cursor:"default"},"CMDS   span":{position:"relative",margin:"5px 4px 2px 0",width:"15px",height:"15px","vertical-align":"middle",cursor:"default"},TOGGLE:{cursor:"default",background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -16px 0",null,"linb.UI.Public")},"TOGGLE-mouseover":{$order:2,"background-position":"-16px -16px"},"TOGGLE-mousedown":{$order:3,"background-position":"-16px -32px"},"TOGGLE-checked":{$order:4,"background-position":" -48px 0"},"TOGGLE-checked-mouseover":{$order:5,"background-position":" -48px -16px"},"TOGGLE-checked-mousedown":{$order:6,"background-position":" -48px -32px"},OPT:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -240px top",null,"linb.UI.Public")},"OPT-mouseover":{$order:2,"background-position":"-240px -16px"},"OPT-mousedown":{$order:3,"background-position":"-240px -32px"},CLOSE:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -64px 0",null,"linb.UI.Public")},"CLOSE-mouseover":{$order:1,"background-position":"-64px -16px"},"CLOSE-mousedown":{$order:2,"background-position":"-64px -32px"},LAND:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -220px 0",null,"linb.UI.Public")},"LAND-mouseover":{$order:1,"background-position":"-220px -16px"},"LAND-mousedown":{$order:2,"background-position":"-220px -32px"},CAPTION:{"font-size":"12px",padding:"0 16px 0 6px",display:"inline","line-height":"20px",zoom:linb.browser.ie6?1:null}}},Behaviors:{"default":{_hoverEffect:{HANDLE:"HANDLE",OPT:"OPT",CLOSE:"CLOSE",LAND:"LAND",TOGGLE:"TOGGLE"},_clickEffect:{CLOSE:"CLOSE",OPT:"OPT",LAND:"LAND",TOGGLE:"TOGGLE"},onRewh:function(C,D,F){var E=C.root,A=null,B=null;if(D.height){B=E.height()}if(D.width){A=E.width()}C.box.resize(C,A,B)},OPT:{onClick:function(A,B,C){A.boxing().onTriggerOption(A,B,C)}},TOGGLE:{onClick:function(A,B,C){A.box._toggle(A,!A.properties.toggle);return false}},CAPTION:{onClick:function(A,B,C){if(!A.onClickHandle||false===A.boxing().onClickHandle(A,C)){return A.box.cancelLink(B)}}},CLOSE:{onClick:function(C,D,E){var B=C.properties;if(B.disabled){return }var A=C.boxing();if(false===A.beforeClose(C,E)){return }A.destroy();return false}},LAND:{onClick:function(D,E,G){var C=D.properties;if(C.disabled){return }var H=D.root.absPos(),B=D.root.cssSize();var F=linb.UI.Dialog.getDefaultProp();_.merge(F,C,"with");_.merge(F,{dock:"none",width:B.width,height:B.height,left:H.left,top:H.top},"all");var A=new linb.UI.Dialog(F);linb(document.body).attach(A);D.children.each(function(I){A.attach(I[0])});D.boxing().destroy();return false}}}},DataModel:{position:"absolute",zIndex:0,dock:"fill",tabindex:{action:function(A){if(this.domNode){this.getSubNode("HANDLE").tabIndex(A)}}},dragKey:"",href:{ini:"javascript:;",action:function(A){if(this.domNode){this.root.href(A)}}},html:{ini:"",action:function(A){this.getSubNode("PANEL").html(A)}},handleHeight:{ini:20,action:function(A){this.getSubNode("HANDLE").display(A?"":"none")}},caption:linb.UI.Widget.getDataModel("caption"),icon:linb.UI.Widget.getDataModel("icon"),iconPos:linb.UI.Widget.getDataModel("iconPos"),toggle:{ini:true,action:function(A){this.box._toggle(this,A)}},optBtn:{ini:false,action:function(A){this.getSubNode("OPT").display(A?"":"none")}},toggleBtn:{ini:false,action:function(A){this.getSubNode("TOGGLE").display(A?"":"none")}},closeBtn:{ini:false,action:function(A){this.getSubNode("CLOSE").display(A?"":"none")}},landBtn:{ini:false,action:function(A){this.getSubNode("LAND").display(A?"":"none")}}},EventHandlers:{beforeClose:function(A,B){},onIniPanelView:function(A){},onFold:function(A){},onOpen:function(A){},onTriggerOption:function(A,B,C){},onClickHandle:function(A,B){}},renderedTrigger:function(){var B=this,C=B.properties,A=B.box;if(C.toggle){A._toggle(B,C.toggle)}},prepareData:function(B){arguments.callee.upper.call(this,B);var C=B.data,A="display:none";C.panelDisplay=C.toggle?"":A;C.toggleCls=C.toggle?"":B.getClass("TOGGLE","-checked");C.toggleDisplay=C.toggleBtn?"":A;C.optDisplay=C.optBtn?"":A;C.closeDisplay=C.closeBtn?"":A;C.landDisplay=C.landBtn?"":A;C.handleDisplay=C.handleHeight?"":A},resize:function(C,A,B){if(B&&parseInt(C.domNode.style.height)){C.getSubNode("BORDER").height(B);C.getSubNode("PANEL").height(B-C.properties.handleHeight)}if(A&&parseInt(C.domNode.style.width)){C.getSubNode("PANEL").width(A)}},_toggle:function(B,C){var D=B.properties,A=B.boxing();D.toggle=C;if(C&&!B.$ini){if(A.onIniPanelView){if(A.onIniPanelView(B)!==false){B.$ini=true}}}if(C){if(false===A.onOpen(B)){return }}else{if(false===A.onFold(B)){return }}B.getSubNode("PANEL").display(C?"":"none");if(D.toggleBtn){if(C){B.removeTagClass("TOGGLE","-checked")}else{B.addTagClass("TOGGLE","-checked")}}}}});Class("linb.UI.PageBar",["linb.UI.iWidget","linb.UI.iNavigator"],{Instance:{setCtrlValue:function(A){return this.each(function(E){if(!E.domNode){return }var I,C=E.properties,B=E.box._v2a(A),O=B[0],D=B[1],R=B[2],J=E.keys,S=function(U,T){return U.getSubNode(T)},F=S(E,"FIRST"),L=S(E,"PRE"),K=S(E,"PREM"),N=S(E,"CUR"),M=S(E,"NEXT"),P=S(E,"NEXTM"),G=S(E,"LAST"),H=function(V,U,T){if(U){V.href(C.uriTpl.replace("*",U))}if(T){V.text(C.textTpl.replace("*",T))}},Q=function(U,T){U.display(T?"":"none")};H(F,O,O);H(K,"",".."+".".repeat(String(D-1-O).length));H(L,D-1);H(N,D,D);H(M,D+1);H(P,"",".."+".".repeat(String(R-D-1).length));H(G,R,R);if((I=D-O)<=0){Q(F,0);Q(K,0);Q(L,0)}else{if(I==1){Q(F,1);Q(K,0);Q(L,0)}else{if(I==2){Q(F,1);Q(K,0);Q(L,1)}else{Q(F,1);Q(K,1);Q(L,1)}}}if((I=R-D)<=0){Q(G,0);Q(P,0);Q(M,0)}else{if(I==1){Q(G,1);Q(P,0);Q(M,0)}else{if(I==2){Q(G,1);Q(P,0);Q(M,1)}else{Q(G,1);Q(P,1);Q(M,1)}}}})}},Static:{cssNone:false,Templates:{"default":{style:"{_style}",POOL:{style:"position:absolute;display:none;",POP:{tagName:"div"}},LABEL:{text:"{caption}"},FIRST:{tagName:"a",tabindex:"{tabindex}",$order:1},PREM:{tagName:"a",tabindex:"{tabindex}",href:"#",$order:2},PRE:{tagName:"a",tabindex:"{tabindex}",text:"{pre}",$order:3},CUR:{tagName:"a",tabindex:"{tabindex}",$order:4},NEXT:{tagName:"a",tabindex:"{tabindex}",text:"{next}",$order:5},NEXTM:{tagName:"a",tabindex:"{tabindex}",href:"#",$order:6},LAST:{tagName:"a",tabindex:"{tabindex}",$order:7}}},Appearances:{"default":{LABEL:{display:"inline","white-space":"nowrap"},KEY:{padding:linb.browser.ie?"3px":"",display:"inline"},"KEY a, POP a":{$order:1,"font-size":"12px",border:"solid 1px gray",padding:"0 3px 0 3px","vertical-align":"middle",margin:"3px"},"PRE,CUR,NEXT":{"font-weight":"bold"},CUR:{$order:1,background:"#316AC5",color:"#fff"},POP:{border:"dotted 1px gray",background:"#fff",position:"absolute",padding:"3px","line-height":"22px"}}},Behaviors:{"default":{POP:{onClick:function(A,B){return A.box.cancelLink(B)},onMousedown:function(A,B,D){var C=linb(D);r=linb.event.getSrc(B);C.setBlurTrigger(A.key+":"+A.$id,null);A.getSubNode("POOL").addLast(C);if(r.tagName.toLowerCase()=="a"){A.box._click(A,r)}}},FIRST:{onClick:function(A,B){return A.box.cancelLink(B)},onMousedown:function(A,B,C){A.box._click(A,C);return false}},PREM:{onClick:function(A,B){return A.box.cancelLink(B)},onMousedown:function(A,B,C){A.box._show(A,B,C,0);return false}},PRE:{onClick:function(A,B){return A.box.cancelLink(B)},onMousedown:function(A,B,C){A.box._click(A,C);return false}},CUR:{onClick:function(A,B){return A.box.cancelLink(B)},onMousedown:function(A,B,C){A.box._click(A,C);return false}},NEXT:{onClick:function(A,B){return A.box.cancelLink(B)},onMousedown:function(A,B,C){A.box._click(A,C);return false}},NEXTM:{onClick:function(A,B){return A.box.cancelLink(B)},onMousedown:function(A,B,C){A.box._show(A,B,C,1);return false}},LAST:{onClick:function(A,B){return A.box.cancelLink(B)},onMousedown:function(A,B,C){A.box._click(A,C);return false}}}},DataModel:{dataField:null,dataBinder:null,caption:" Page: ",value:"1:1:1",uriTpl:"#*",textTpl:"*",pre:"&lt;",next:"&gt;",moreStep:100,tabindex:{action:function(A){if(this.domNode){this.root.dig("a").tabIndex(A)}}}},EventHandlers:{onClick:function(A,B){}},ensureV:function(D,E){var C=E.split(":"),A=[],B=function(F){return parseInt(F)||1};A[0]=B(C[0]);A[1]=B(C[1]);A[2]=B(C[2]);A[0]=Math.max(A[0],1);A[0]=Math.min(A[0],A[1]);A[2]=Math.max(A[1],A[2]);return A.join(":")},_v2a:function(A){A=typeof A=="string"?A.split(":"):A;A[0]=parseInt(A[0]);A[1]=parseInt(A[1]);A[2]=parseInt(A[2]);return A},_click:function(A,B){A.boxing().onClick(A,B)},_show:function(E,R,F,Q){var C=E.properties,A=E.box._v2a(C.value),N=A[0],D=A[1],P=A[2],I=E.keys,S=function(V,U){return V.getSubNode(U)},J=S(E,"POOL"),G=S(E,"POP"),B=function(U){return Math.ceil((U+1)/10)*10},T=[],H,L,K,O,M;if(Q){if((H=P-1-D)<=0){return }K=D+1;M=P}else{if((H=D-1-N)<=0){return }K=1;M=D-1}L=Math.ceil(H/C.moreStep);if(L>10){K=B(K);M=B(M)-1;L=B(L)}else{K=K+L}while(K<M){T.push('<a href="'+C.uriTpl.replace("*",K)+'" onclick="return false">'+C.textTpl.replace("*",K)+"</a>");K=K+L}G.width("auto");G.html(T.join(" "));linb(document.body).addLast(G);if(G.width()>300){G.width(300)}G.popToTop(F);G.setBlurTrigger(E.key+":"+E.$id,function(){J.addLast(G)})}}});Class("linb.UI.Tabs",["linb.UI.iList","linb.UI.iWidget","linb.UI.iContainer"],{Instance:{setCtrlValue:function(A){this.each(function(E){var I=E.domId,F=E.boxing(),G=F.getUIValue(),D=E.properties,H=E.getSubSerialIdByItemId(G),B,C;if(G&&E.getSubSerialIdByItemId(G)){E.removeTagClass("ITEM","-checked",E.getSubNode("ITEM",H));E.removeTagClass("BOX","-checked",E.getSubNode("BOX",H));if(D.hasPanel){F.getPanel(G).hide()}}H=E.getSubSerialIdByItemId(A);if(H){E.addTagClass("ITEM","-checked",E.getSubNode("ITEM",H));E.addTagClass("BOX","-checked",E.getSubNode("BOX",H));if(D.hasPanel){F.getPanel(A).position("relative").show("auto","auto");C=E.domNode.style;E.box.resize(E,A,parseInt(C.width)||null,parseInt(C.height)||null)}}})},attach:function(D,F){var A=this,B=A.get(0),E=B.properties,C;if(!F){F=E.$UIvalue||E.value}if(F){A.appendChild(D,F);if(B.domNode){C=A.getPanel(F);if(!C.isEmpty()){C.attach(D)}}}return A},getCurPanel:function(){var A=this.get(0);return this.getPanel(A.properties.$UIvalue)},getPanel:function(B){var A=this.get(0);return A.getSubNodeByItemId("PANEL",B)},addPanel:function(A,D,E){var C={},F=E&&E.id;if(!F){var B=this.getItems();if(B.length){F=B[B.length-1].id}}_.merge(C,{caption:A.caption,icon:A.icon,closeBtn:A.closeBtn||false,landBtn:A.landBtn||false,iconPos:A.iconPos,dragKey:A.dragKey,dropKeys:A.dropKeys,id:A.id||A.tag||_.id()});this.insertItems([C],F);D.each(function(G){this.attach(G[0],C.id)},this)},removePanel:function(D){var A=this,B=A.get(0),C=B.getItemByDom(D);A.removeItems(C.id);return A},getPanelPara:function(D){var B=this.get(0),C=B.getItemByDom(D),A=_.clone(C);if(!A.dragKey){A.dragKey=B.properties.dragKey}if(!A.dropKeys){A.dropKeys=B.properties.dropKeys}return A},getPanelChildren:function(C){var B=this.get(0),D=B.getItemIdByDom(C),A=[];if(D){B.children.each(function(E){if(E[1]==D){A.push(E)}})}return A},fireItemClickEvent:function(C){var A=this.get(0),B=A.getSubNodeByItemId("ITEM",C);if(B.isEmpty()){A.boxing().updateUIValue(null)}else{B.onMousedown()}return this},afterInsertItems:function(C,G,F,E){var D=C.box,H,A;if(C.properties.hasPanel&&(H=C.root)){H.addLast(D.subBuild(C,"panels",G).toDom());if(!(A=this.getUIValue())){this.fireItemClickEvent((A=C.properties.items[0])&&(A=A.id))}var B=C.domNode.style;D.resize(C,A,parseInt(B.width)||null,parseInt(B.height)||null)}},removeItems:function(A){var B=this,D,C;if(!_.isArr(A)){A=[A]}B.each(function(E){if(E.properties.hasPanel){A.each(function(F){C=E.getSubSerialIdByItemId(F);if(C&&!(D=E.getSubNode("PANEL",C)).isEmpty()){D.remove()}})}});arguments.callee.upper.apply(B,arguments);B.each(function(F){if(F.properties.hasPanel){if(A.exists(F.boxing().getUIValue())){var E;F.boxing().fireItemClickEvent((E=F.properties.items[0])&&E.id)}F.box.resize(F,F.boxing().getUIValue(),F.root.width(),F.root.height())}});return B},clearItems:function(){var A=this;A.each(function(B){if(B.properties.hasPanel){B.getSubNode("PANEL",true).remove()}});A.setValue(null,true);arguments.callee.upper.apply(A,arguments);return A},markDirty:function(E,A,B){var D=this.get(0);if(typeof E=="string"){E=D.getItemByItemId(E)}if((E._dirty!=A)||B){var F=E.id,C=D.getItemByItemId(F).caption;D.getSubNodeByItemId("CAPTION",F).html(D.getItemByItemId(F).caption=A?("*"+C):C.replace(/^\*/,"")).setStyle("fontStyle",A?"italic":"normal");E._dirty=A}return this}},Static:{cssNone:false,Dropable:["PANEL","KEY","ITEM"],Dragable:["ITEM"],Templates:{"default":{tagName:"div",style:"{_style}",LIST:{$order:0,tagName:"div",style:"{HAlign}",ITEMS:{tagName:"div",text:"{items}"}},PNAELS:{$order:1,tagName:"text",text:"{panels}"},$dynamic:{items:{ITEM:{BOX:{HANDLE:{tagName:"a",href:"{href}",tabindex:"{_tabindex}",RULER:{},ICON:{style:"background:url({icon}) transparent  no-repeat {iconPos};{iconDisplay}",$order:0},CAPTION:{text:"{caption}",className:"{disabled}",$order:1},CMDS:{$order:2,LAND:{style:"{landDisplay}",$order:1},CLOSE:{style:"{closeDisplay}",$order:2}}}}}},panels:{PANEL:{tagName:"div",text:linb.UI.$childTag}}}}},Appearances:{"default":{KEY:{position:"absolute",overflow:"hidden"},LIST:{position:"relative"},ITEMS:{"padding-left":"4px","padding-right":"4px",position:"relative",background:linb.UI.getCSSImgPara("dot.gif"," repeat-x center bottom",null,"linb.UI.Public")},ITEM:{$order:0,"font-family":'"Verdana", "Helvetica", "sans-serif"',cursor:"pointer","padding-right":"6px","vertical-align":"top","border-bottom":"1px solid #91A7B4",background:linb.UI.getCSSImgPara("top.gif"," no-repeat right top")},"ITEM-mouseover":{$order:1,"background-position":"right -100px"},"ITEM-mousedown":{$order:2,"background-position":"right -200px","border-bottom":"1px solid #fff"},"ITEM-checked":{$order:3,"background-position":"right -200px","border-bottom":"1px solid #fff"},BOX:{$order:0,padding:"6px 0 2px 6px",border:0,"vertical-align":"top","text-align":"center",background:linb.UI.getCSSImgPara("top.gif"," no-repeat left -50px")},"BOX-mouseover":{$order:1,"background-position":"left -150px"},"BOX-mousedown":{$order:2,"background-position":"left -250px"},"BOX-checked":{$order:3,"background-position":"left -250px"},HANDLE:{cursor:"pointer","vertical-align":"middle",display:linb.browser.gek?["-moz-inline-block","-moz-inline-box","inline-block"]:"inline-block","font-size":"12px"},RULER:{height:"16px",width:"1px"},ICON:{cursor:"pointer",width:"16px",height:"16px","vertical-align":"middle",margin:"0 4px 0 0"},"CLOSE, LAND":{cursor:"pointer",width:"15px",height:"15px","vertical-align":"middle"},CLOSE:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -64px 0",null,"linb.UI.Public")},"CLOSE-mouseover":{$order:1,"background-position":"-64px -16px"},"CLOSE-mousedown":{$order:2,"background-position":"-64px -32px"},LAND:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -220px 0",null,"linb.UI.Public")},"LAND-mouseover":{$order:1,"background-position":"-220px -16px"},"LAND-mousedown":{$order:2,"background-position":"-220px -32px"},PANEL:{position:"absolute",visibility:"hidden",top:"-10000px",left:"-10000px",overflow:"auto","background-color":"#fff"}}},Behaviors:{"default":{_hoverEffect:{ITEM:["ITEM","BOX"],CLOSE:"CLOSE",LAND:"LAND"},_clickEffect:{ITEM:["ITEM","BOX"],CLOSE:"CLOSE",LAND:"LAND"},onRewh:function(C,D,F){var E=C.domNode.style,A=null,B=null;if(D.height){B=parseInt(E.height)||null}if(D.width){A=parseInt(E.width)||null}C.box.resize(C,C.properties.$UIvalue,A,B)},CAPTION:{onMousedown:function(B,E,F){if(linb.event.getBtn(E)!="left"){return }var A=B.properties,D=B.getItemByDom(F),C=B.boxing();if(A.disabled){return false}if(C.getUIValue()==D.id){B.boxing().onItemActive(B,B.getItemByDom(F),F)}}},ITEM:{onClick:function(A,B,C){return false},onMousedown:function(B,E,G){if(linb.event.getBtn(E)!="left"){return }var A=B.properties,F=B.getSubSerialId(G.id),D=B.getItemByDom(G),C=B.boxing();if(A.disabled){return false}if(C.getUIValue()==D.id){return }B.getSubNode("HANDLE",F).focus();C.updateUIValue(D.id);if(C.getUIValue()==D.id){C.onItemSelected(B,D,G);return false}}},HANDLE:{onClick:function(A,B,C){return A.box.cancelLink(B)},onKeydown:function(C,F,A){var K=linb.event.getKey(F),J=K[0],B=K[2];if(J=="space"||J=="enter"){C.getSubNode("ITEM",C.getSubSerialId(A.id)).onMousedown();return false}var I=linb([A]),G=C.getSubNode("ITEMS"),E=G.nextFocus(true,true,false),H=G.nextFocus(false,true,false);switch(J){case"tab":if(B){if(A!=E.get(0)){E.focus();return false}}else{if(A!=H.get(0)){H.focus();return false}}break;case"left":case"up":var D=I.nextFocus(false,true,false);if(I.get(0)==E.get(0)){H.focus()}else{I.nextFocus(false)}return false;break;case"right":case"down":var D=I.nextFocus(true,false,false);if(I.get(0)==H.get(0)){E.focus()}else{I.nextFocus()}return false;break}}},CLOSE:{onClick:function(D,F,G){var C=D.properties,E=D.getItemByDom(G),B;if(C.disabled){return }var A=D.boxing();if(false===A.beforePageClose(D,E,G)){return }B=_.copy(E);A.removeItems(E.id);A.afterPageClose(D,B);D.box.resize(D,D.properties.$UIvalue,D.root.width(),D.root.height());return false}},LAND:{onClick:function(D,E,A){var G=D.properties,J=D.getItemByDom(A),C=J.id;if(G.disabled){return }var B=D.boxing().getPanel(C),H=D.root.absPos(),K=D.root.cssSize(),I=linb.UI.Dialog.getDefaultProp();_.merge(I,J,"with");_.merge(I,{dragKey:J.dragkey||G.dragKey,dock:"none",tag:J.tag||J.id,width:K.width,height:K.height,left:H.left,top:H.top},"all");var F=new linb.UI.Dialog(I);linb(document.body).attach(F);D.children.each(function(L){if(L[1]==C){F.attach(L[0])}},null,true);D.boxing().removeItems(C);return false}}}},DataModel:{dataBinder:null,dataField:null,dock:"fill",hasPanel:true,width:200,height:200,position:"absolute",HAlign:{ini:"left",listbox:["left","right"],action:function(A){if(this.domNode){this.getSubNode("LIST").setStyle("textAlign",A)}}},tabindex:{action:function(A){if(this.domNode){this.getSubNode("HANDLE",true).tabIndex(A)}}},dragKey:"",dropKeysPanel:"",value:{ini:"a"},items:{set:function(A){return this.each(function(H){if(H.domNode){var E=H.boxing(),G,B=linb.dom.getMatix(),D=H.children.copy();H.children.length=0;D.each(function(I){delete I[0].$dockParent;B.addLast(I[0].root)});var F=H.properties.value;E.clearItems();linb.dom.$gc();E.insertItems(A);D.each(function(I){E.attach.apply(E,I)});B.empty();E.setValue(F,true);var C=H.root.cssSize();H.box.resize(H,H.properties.$UIvalue,C.width,C.height)}else{H.properties.items=A}})}}},EventHandlers:{beforeNextFocus:null,beforePageClose:function(A,B,C){},afterPageClose:function(A,B,C){},onItemSelected:function(A,B,C){},onItemActive:function(A,B,C){}},createdTrigger:function(){if(this.properties.value){this.boxing().updateUIValue(this.properties.value)}},prepareData:function(A){arguments.callee.upper.call(this,A);var B=A.data;B.panels=B.items;B.HAlign=B.HAlign=="right"?"text-align:right;":""},prepareItem:function(A,B){B.closeDisplay=B.closeBtn?"":"display:none";B.landDisplay=B.landBtn?"":"display:none";B.href=B.href||"javascript:;"},getDropKeys:function(B,C){var A=B.getKey(C.id);if(A==B.keys.PANEL){return B.properties.dropKeys}else{return B.properties.dropKeysPanel}},showTips:function(B,D,G){var F=D.id,E=B.properties,C=B.keys,A=B.getKey(F);if(!F){return false}if(A==C.PANEL){return true}if(B.onShowTips){return B.boxing().onShowTips(B,D,G)}else{return arguments.callee.upper.apply(this,arguments)}},resize:function(C,I,H,F){var L=C.properties,J,B=C.boxing().getPanel(I),K=C.getItemByItemId(I),E=C.getSubNode("LIST"),A=false;if(!B||B.isEmpty()){return }if(!parseInt(C.domNode.style.height)){F=null}var D=null,G=null;if(H&&K._w!=H){D=K._w=H;A=true}if(A){L._listH=E.get(0).offsetHeight||E.offsetHeight()}J=L._listH;if((F&&K._h!=F)||A){K._h=F;F=F-J+(linb.browser.ie6?2:1);if(F>0){G=F}}if(D||G){B.setRegion({width:D?D-2:null,height:G?G-2:null},true)}}}});Class("linb.UI.Stacks","linb.UI.Tabs",{Static:{Dropable:["PANEL","KEY","ITEM"],Appearances:{"default":{LIST:{position:"static"},ITEMS:{position:"static"},ITEM:{$order:0,display:"block",position:"absolute",cursor:"pointer",background:linb.UI.getCSSImgPara("barvbg.gif"," repeat-x left top",null,"linb.UI.Public"),height:"22px",width:"100%",left:0},BOX:{display:"block"},"ITEM-mouseover":{$order:1,"background-position":"right -22px"},"ITEM-mousedown":{$order:1,"background-position":"right -44px"},"ITEM-checked":{$order:1,"background-position":"right -44px"},HANDLE:{cursor:"pointer",display:"block","font-size":"12px",height:"100%","padding-left":"6px"},ICON:{cursor:"pointer",width:"16px",height:"16px",margin:"3px 4px 0 0"},CAPTION:{margin:"2px"},PANEL:{position:"absolute",visibility:"hidden",top:"-10000px",left:"-10000px",overflow:"auto","background-color":"#fff"},CMDS:{position:"absolute",top:0,right:0,"text-align":"right","vertical-align":"middle",height:"100%",cursor:"default"},"CMDS  span":{position:"relative",margin:"5px 4px 2px 0",width:"15px",height:"15px","vertical-align":"middle",cursor:"default"},CLOSE:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -64px 0",null,"linb.UI.Public")},"CLOSE-mouseover":{$order:1,"background-position":"-64px -16px"},"CLOSE-mousedown":{$order:2,"background-position":"-64px -32px"},LAND:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -220px 0",null,"linb.UI.Public")},"LAND-mouseover":{$order:1,"background-position":"-220px -16px"},"LAND-mousedown":{$order:2,"background-position":"-220px -32px"}}},resize:function(B,K,J,E){var M=B.properties,L,H,F,D,I,C=null,G=null,A=B.boxing().getPanel(K);if(!A||A.isEmpty()){return }if(E){F=H=0;M.items.each(function(N){D=B.getSubNodeByItemId("ITEM",N.id);D.bottom("auto").top(H);H+=D.height();if(N.id==K){return false}});M.items.each(function(N){if(N.id==K){return false}D=B.getSubNodeByItemId("ITEM",N.id);D.top("auto").bottom(F);F+=D.height()},null,true);L=E-H-F;if(L>0){I=H;G=L}}if(J){C=J}A.setRegion({width:C?C:null,height:G?G:null,top:I,left:0},true);if(C){B.getSubNode("LIST").width(C)}}}});Class("linb.UI.ButtonViews","linb.UI.Tabs",{Instance:{setCtrlValue:function(A){this.each(function(E){var I=E.domId,F=E.boxing(),G=F.getUIValue(),D=E.properties,H=E.getSubSerialIdByItemId(G),B,C;if(G&&E.getSubSerialIdByItemId(G)){E.removeTagClass("ITEM","-checked",E.getSubNode("ITEM",H));E.removeTagClass("BOX","-checked",E.getSubNode("BOX",H));F.getPanel(G).hide()}H=E.getSubSerialIdByItemId(A);if(H){E.addTagClass("ITEMS","-checked",E.getSubNode("ITEM",H));E.addTagClass("BOX","-checked",E.getSubNode("BOX",H));F.getPanel(A).show();C=E.domNode.style;E.box.resize(E,A,parseInt(C.width)||null,parseInt(C.height)||null)}})}},Initialize:function(){this.mapKeys(["LEFT","TOP","RIGHT","BOTTOM"])},Static:{Dropable:["PANEL","KEY","ITEM"],Appearances:{"default":{LIST:{"z-index":"2",position:"absolute","background-color":"#F3F3F3"},ITEMS:{"z-index":"2",position:"absolute",left:0,top:0},ITEM:{margin:"2px",position:"relative"},"ITEM-checked":{},LEFT:{"border-right":"1px solid #A7A6AA"},RIGHT:{"border-left":"1px solid #A7A6AA"},TOP:{"border-bottom":"1px solid #A7A6AA"},BOTTOM:{"border-top":"1px solid #A7A6AA"},BOX:{$order:0,border:"solid 1px #F3F3F3","vertical-align":"top"},"BOX-mouseover":{$order:1,border:"solid 1px #A7A6AA","background-color":"#FFFFE0"},"BOX-mousedown, BOX-checked":{$order:1,border:"solid 1px #A7A6AA","background-color":"#fff"},HANDLE:{cursor:"pointer",display:linb.browser.gek?["-moz-inline-block","-moz-inline-box","inline-block"]:"inline-block","vertical-align":"middle","font-size":"12px",margin:"1px"},ICON:{cursor:"pointer",width:"16px",height:"16px",margin:"1px"}}},DataModel:{dock:"fill",handleDock:{ini:"top",listbox:["top","bottom","left","right"],action:function(C){var B=this,D=B.getSubNode("LIST"),E=B.getSubNode("ITEM",true),A=B.getSubNode("BOX",true);switch(C){case"left":case"top":D.setRegion({left:0,top:0,right:"auto",bottom:"auto"});break;case"right":case"bottom":D.setRegion({left:"auto",top:"auto",right:0,bottom:0});break}switch(C){case"left":case"right":E.display("block");A.display("block");break;case"top":case"bottom":E.inlineBlock();A.inlineBlock();D.height("auto");break}B.boxing().setHandleSize(B.properties.handleSize,true)}},handleHAlign:{ini:"left",listbox:["left","right"],action:function(B){var A=this.getSubNode("ITEMS");A.setStyle("textAlign",B)}},handleVAlign:{ini:"top",listbox:["top","bottom"],action:function(B){var A=this.getSubNode("ITEMS");if(B=="top"){A.top(0).bottom("auto")}else{A.bottom(0).top("auto")}}},handleSize:{ini:50,action:function(C){var B=this,E=B.properties,D=B.getSubNode("LIST"),A=B.getSubNode("ITEMS");if(["left","right"].exists(E.handleDock)){D.add(A).width(C)}else{D.height(C)}B.box.resize(B,B.properties.$UIvalue,B.root.width(),B.root.height())}}},renderedTrigger:function(){var A=this.properties;this.boxing().setHandleDock(A.handleDock,true).setHandleHAlign(A.handleHAlign,true).setHandleVAlign(A.handleVAlign,true)},resize:function(D,K,J,F){var B=D.boxing().getPanel(K),L=D.properties,H,C,I=D.getSubNode("LIST"),A=D.getSubNode("ITEMS"),E=null,G=null;if(["top","bottom"].exists(L.handleDock)){if(J){I.width(J);A.width(J);C=0;E=J}if(F-L.handleSize>0){G=F-L.handleSize}H=L.handleDock=="top"?L.handleSize:0}else{if(F){I.height(F);H=0;G=F}if(J){C=L.handleDock=="left"?L.handleSize:0;E=J-L.handleSize}}if(B&&!B.isEmpty()){B.setRegion({width:E?E:null,height:G?G:null,left:C,top:H},true)}}}});Class("linb.UI.RadioBox","linb.UI.List",{Initialize:function(){var A=this.getTemplate("default");A.$dynamic={items:{ITEM:{tagName:"a",href:"javascript:;",tabindex:"{_tabindex}",MARK:{$order:0},ICON:{style:"background:url({icon}) transparent  no-repeat {iconPos};{iconDisplay}",$order:1},CAPTION:{text:"{caption}",className:"{disabled}",$order:2}}}};this.setTemplate("default",A)},Static:{Appearances:{"default":{ITEM:{"font-family":' "Verdana", "Helvetica", "sans-serif"',border:0,margin:"2px",padding:"0 0 0 4px",cursor:"pointer","vertical-align":"middle",display:linb.browser.gek?["-moz-inline-block","-moz-inline-box","inline-block"]:"inline-block","vertical-align":"middle","font-size":"12px"},"ITEM-checked":{},MARK:{cursor:"pointer",width:"16px",height:"16px",background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -144px top",null,"linb.UI.Public")},"ITEM-mouseover MARK":{$order:1,"background-position":" -144px -17px"},"ITEM-mousedown MARK":{$order:2,"background-position":" -144px -34px"},"ITEM-checked MARK":{$order:3,"background-position":" -128px top"},"ITEM-checked-mouseover MARK":{$order:4,"background-position":" -128px -17px"},"ITEM-checked-mousedown MARK":{$order:5,"background-position":" -128px -34px"},ICON:{cursor:"pointer",width:"16px",height:"16px",margin:"0 4px 0 0"},ITEMS:{overflow:"auto","line-height":"12px",background:"#fff"}}}}});Class("linb.UI.FoldingList",["linb.UI.List"],{Instance:{fillDetail:function(B,C){var A=this.get(0);A.getSubNodeByItemId("BODYI",B.id).html("",false).attach(B._obj=C)},toggle:function(C,A){var E=this.get(0),F=E.properties,G=F.items,I=E.getItemByItemId(C),B=E.getSubSerialIdByItemId(C),D=E.getSubNode("ITEM",B),H=D.next();if(I._show){if(F.activeLast&&G.length){if(G[G.length-1].id==I.id){return false}}E.removeTagClass("ITEM","-checked",D);if(H){E.removeTagClass("ITEM","-prechecked",H)}}else{E.addTagClass("ITEM","-checked",D);if(H){E.addTagClass("ITEM","-prechecked",H)}if(!I._fill){I._fill=true;I._body=E.onBuildBody?E.boxing().onBuildBody(E,I,A):E.box.buildBody(E,I,A);if(I._body){E.getSubNode("BODYI",B).html(I._body,false)}}}I._show=!I._show},flod:function(A){}},Initialize:function(){var A=this.getTemplate("default");A.$dynamic={items:{ITEM:{tagName:"div",className:"{_checked} {_precheked}",HEAD:{tagName:"div",HL:{tagName:"div"},HR:{tagName:"div"},TITLE:{tagName:"a",href:"javascript:;",TLEFT:{$order:0,tagName:"div",MARK:{$order:0},CAP1:{$order:1,text:"{title}"}},TRIGHT:{$order:1,tagName:"div",style:"{_capDisplay}",CAP2:{$order:0,text:"{caption}"},OPT:{$order:1,style:"{_opt}"}}}},BODY:{$order:1,tagName:"div",BODYI:{$order:0,tagName:"div",text:"{_body}"},CMDS:{$order:1,tagName:"div",text:"{cmds}"}},TAIL:{$order:4,tagName:"div",TL:{tagName:"div"},TR:{tagName:"div"}}}},"items.cmds":{$order:2,CMD:{tagName:"a",href:"javascript:;",text:"{caption}"}}};this.setTemplate("default",A)},Static:{Appearances:{"default":{KEY:{padding:"2px"},ITEMS:{border:0,position:"relative",zoom:linb.browser.ie?1:null,"padding-top":"8px"},ITEM:{border:0,zoom:linb.browser.ie?1:null,"margin-top":"-9px",padding:0,background:"#FFF","font-family":'"Verdana", "Helvetica", "sans-serif"',position:"relative",overflow:"hidden"},"ITEM-mouseover":{},"HEAD, BODY, BODYI, TAIL":{position:"relative"},MARK:{position:"relative",margin:"0 2px 3px 0",width:"15px",height:"15px","vertical-align":"middle",cursor:"default",background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -48px 0",null,"linb.UI.Public")},"ITEM-mouseover MARK":{$order:2,"background-position":"-48px -16px"},"ITEM-mousedown MARK":{$order:3,"background-position":"-48px -32px"},"ITEM-checked MARK":{$order:4,"background-position":" -16px 0"},"ITEM-checked-mouseover MARK":{$order:5,"background-position":" -16px -16px"},"ITEM-checked-mousedown MARK":{$order:6,"background-position":" -16px -32px"},CMDS:{padding:"2px 8px 4px 14px","font-weight":"bold",position:"relative",background:linb.UI.getCSSImgPara("l.gif","repeat-y left top #EEE")},CMD:{margin:"2px 4px 2px 4px"},BODY:{display:"none","border-right":"solid 1px #CCC",zoom:linb.browser.ie?1:null,position:"relative",overflow:"auto",background:linb.UI.getCSSImgPara("l.gif","repeat-y left top")},BODYI:{padding:"2px 8px 0 8px",background:linb.UI.getCSSImgPara("l.gif","repeat-y left top"),position:"relative"},"ITEM-checked":{$order:2,"margin-bottom":"12px"},"ITEM-checked BODY":{$order:2,display:"block"},"HL, HR, TL, TR":{position:"absolute","_font-size":0,"_line-height":0,width:"8px"},"HL, HR":{height:"30px"},"ITEM-prechecked HL":{"background-position":"left top"},"ITEM-prechecked HR":{"background-position":"right top"},"TL, TR":{height:"20px"},HL:{top:0,left:0,background:linb.UI.getCSSImgPara("corner.gif"," no-repeat left -37px")},HR:{top:0,right:0,background:linb.UI.getCSSImgPara("corner.gif"," no-repeat right -37px")},TL:{bottom:0,left:0,background:linb.UI.getCSSImgPara("corner.gif"," no-repeat left bottom")},TR:{bottom:0,right:0,background:linb.UI.getCSSImgPara("corner.gif"," no-repeat right bottom")},HEAD:{position:"relative",zoom:linb.browser.ie?1:null,background:linb.UI.getCSSImgPara("t.gif","repeat-x left top"),overflow:"hidden"},TITLE:{$order:1,height:"24px",display:"block",position:"relative","white-space":"nowrap",overflow:"hidden"},TAIL:{"_font-size":0,"_line-height":0,position:"relative",height:"5px",background:linb.UI.getCSSImgPara("b.gif"," repeat-x left bottom #EEE")},"CAP1, CAP2":{padding:"3px"},CAP1:{color:"#666","white-space":"nowrap",font:"bold 12px arial,sans-serif;",color:"#00681C"},"ITEM-checked CAP1":{$order:2,"font-weight":"normal"},TLEFT:{position:"absolute",left:"4px",top:"2px","white-space":"nowrap",overflow:"hidden"},TRIGHT:{position:"absolute",right:"4px",top:"2px","white-space":"nowrap",overflow:"hidden"},OPT:{margin:"0 3px 3px 2px",width:"15px",height:"15px","vertical-align":"middle",cursor:"default",background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -240px top",null,"linb.UI.Public")},"OPT-mouseover":{$order:2,"background-position":"-240px -16px"},"OPT-mousedown":{$order:3,"background-position":"-240px -32px"}}},Behaviors:{"default":{_hoverEffect:{ITEM:"ITEM",OPT:"OPT"},ITEMS:{},ITEM:{},HEAD:{onClick:function(A,B,C){return A.box.cancelLink(B)},onMousedown:function(A,B,C){A.boxing().toggle(A.getItemIdByDom(C))}},CMD:{onClick:function(A,B,C){if(A.onCommand){A.boxing().onCommand(A,A.getItemByDom(C),C.id.split("_")[1],C)}return false}},OPT:{onMousedown:function(A,B,C){if(A.onOptions){A.boxing().onOptions(A,A.getItemByDom(C),C)}return false}}}},DataModel:({tabindex:{action:function(A){if(this.domNode){this.getSubNode("HEAD",true).tabIndex(A)}}},cmds:{ini:[]},optBtn:{ini:false,action:function(A){this.getSubNode("OPT").display(A?"":"none")}},activeLast:false}),EventHandlers:{onBuildBody:function(B,C,A){},onCommand:function(A,B,C,D){},onOptions:function(A,B,C){}},prepareData:function(A){arguments.callee.upper.call(this,A)},prepareItems:function(C,A,B){if(A.length){A[0]._precheked=C.getClass("ITEM","-prechecked");if(C.properties.activeLast){var D=A[A.length-1];D._show=true;D._fill=true;D._body=C.onBuildBody?C.boxing().onBuildBody(C,D):C.box.buildBody(C,D)}}return arguments.callee.upper.apply(this,arguments)},prepareItem:function(E,J){var B=E.properties,D,K="display:none";J._tabindex=B.tabindex;if(!J.caption){J._capDisplay=K}else{J.caption=J.caption.replace(/</g,"&lt;")}J._opt=B.optBt?"":K;J._body=J._body||"Loading...";if(J._show){J._checked=E.getClass("ITEM","-checked")}var A=J.cmds||B.cmds;if(A&&A.length){var C=linb.UI.subSerialIdTag,H;H=J.cmds=[];for(var G=0,I=A,F=I.length;G<F;G++){D=linb.UI.copyItem(I[G]);H.push(D);D[C]=J[C]+"_"+D.id}}},buildBody:function(A,B){return B.text?"<pre>"+B.text.replace(/</g,"&lt;")+"</pre>":""}}});Class("linb.UI.TreeBar",["linb.UI.iList","linb.UI.iWidget","linb.UI.iNavigator"],{Instance:{setCtrlValue:function(B,A){return this.each(function(D){if(!D.domNode){return }var E=D.boxing(),F=E.getUIValue(),C=D.properties;if(C.selMode=="single"){var G=D.getSubSerialIdByItemId(F);if(F&&G){D.removeTagClass("BAR","-checked",D.getSubNode("BAR",G));D.removeTagClass("MARK2","-checked",D.getSubNode("MARK2",G))}G=D.getSubSerialIdByItemId(B);if(G){D.addTagClass("BAR","-checked",D.getSubNode("BAR",G));D.addTagClass("MARK2","-checked",D.getSubNode("MARK2",G))}}else{if(C.selMode=="multi"){F=F?F.split(";"):[];B=B?B.split(";"):[];if(A){B.each(function(H){D.addTagClass("BAR","-checked",D.getSubNodeByItemId("BAR",H));D.addTagClass("MARK2","-checked",D.getSubNodeByItemId("MARK2",H))})}else{F.each(function(H){if(!B.exists(H)){D.removeTagClass("BAR","-checked",D.getSubNodeByItemId("BAR",H));D.removeTagClass("MARK2","-checked",D.getSubNodeByItemId("MARK2",H))}});B.each(function(H){if(!F.exists(H)){D.addTagClass("BAR","-checked",D.getSubNodeByItemId("BAR",H));D.addTagClass("MARK2","-checked",D.getSubNodeByItemId("MARK2",H))}})}}}})},setValue:function(C,A){var B=arguments.callee.upper;return this.each(function(E){if(E.properties.selMode=="multi"){var D=C.split(";");D.sort();C=D.join(";")}B.apply(E.boxing(),[C,A])})},insertItems:function(A,C,F,E){var D,B=this.constructor;return this.each(function(J){var G,K,H;if(!C){H=J.properties;G=H.items||(H.items=[])}else{H=J.getItemByItemId(C);G=H.sub||(H.sub=[])}if(!F){G.insertAny(A,E?0:-1)}else{var I=G.subIndexOf(id,F);G.insertAny(A,E?I:(I+1))}if(J.domNode){if(!F){if(!C){D=J.getSubNode("ITEMS")}else{H=J.getItemByItemId(C);if(H._created){D=J.getSubNodeByItemId("SUB",C)}}if(D){K=B.subBuild(J,"items",J.box.prepareItems(J,A,C)).toDom();if(E){D.addFirst(K)}else{D.addLast(K)}}}else{H=J.getItemByItemId(C);if(H._created){K=B.subBuild(J,"items",J.box.prepareItems(J,A,C)).toDom();D=J.getSubNodeByItemId("ITEM",F);if(E){D.addPre(K)}else{D.addNext(K)}}}}var L;if(C){if((L=J.getSubNodeByItemId("MARK1",C)).display()=="none"){L.inlineBlock()}}if(!J.properties.iniFold){if(!C||J.getItemByItemId(C)._created){J.boxing().toggleNodes(A,true)}}})},updateItem:function(E,A,D){var B=this.get(0),C=B.getItemByItemId(E);if(!C){return }C[A]=D;switch(A){case"caption":B.getSubNodeByItemId("CAPTION",E).html(D,false);break}},moveItems:function(E,H){var D=this.get(0),C;if(H){var F=D.getSubSerialIdByItemId(H),B=D.getItemByItemId(H),A=B.sub||(B.sub=[]),G=D.getSubNode("SUB",F);if((C=D.getSubNode("MARK1",F)).visibility()=="none"){C.inlineBlock()}}else{var A=D.properties.items,G=D.root}E.each(function(M){var L=D.getSubSerialIdByItemId(M),K=D.getItemByItemId(M);var J;if(K._pid){J=D.getItemByItemId(K._pid).sub}else{J=D.properties.items}var I=J.subIndexOf("id",M);J[I]._pid=H;A.insertAny(J[I]);J.remove(I);G.addLast(D.getSubNode("ITEM",L))})},toggleNodes:function(B,A,C){if(B&&B.length){B.each(function(D){if(D.sub&&D.sub.length&&((A&&!D._checked)||(!A&&D._checked))){this.toggleNode(D.id,A)}},this)}},toggleNode:function(E,A,B){var C=this.get(0),D=C.getItemByItemId(E);if(D&&((A&&!D._checked)||(!A&&D._checked))){C.box.setSub(C,D,A,B)}},openToNode:function(A){return this.each(function(E){var D=false,C=[],B=function(F,H,G){G=G||0;var I=arguments.callee;F.each(function(J){if(J.id==H){C.push(J);ref=J.sub;D=true;return false}if(J.sub){D=I.call(I,J.sub,H,++G);if(D){C.push(J);return false}}});return D};B(E.properties.items,A);if(D){C.reverse();C.pop();C.each(function(F){if(!F._checked){E.box.setSub(E,F,true)}})}})},selectItem:function(C){var A=this.get(0);var B=A.getSubNodeByItemId("BAR",C);if(!B.isEmpty()){B.onClick();return this}else{return false}}},Initialize:function(){this.mapKeys(["DISABLED"])},Static:{$recursive:true,cssNone:false,Templates:{"default":{tagName:"div",style:"{_style}",BORDER:{tagName:"div",BOX:{tagName:"div",onselectstart:"return false",ITEMS:{tagName:"div",text:"{items}"}}},$dynamic:{items:{ITEM:{tagName:"div",onselectstart:"return false",unselectable:"on",BAR:{$order:0,tagName:"div",className:"{cls_group} ",onselectstart:"return false",unselectable:"on",CMD:{tagName:"a",href:"{href}",tabindex:"{_tabindex}",MARK1:{$order:0,style:"{mark}"},MARK2:{$order:1,style:"{mark2Display}"},ITEMICON:{style:"background:url({icon}) transparent  no-repeat   {iconPos}; {iconDisplay}",$order:2},ITEMCAPTION:{text:"&nbsp;{caption}",className:"{disabled} ",$order:3}}},SUB:{$order:1,tagName:"div",text:linb.UI.$childTag}}}}}},Appearances:{"default":{KEY:{"font-family":"Verdana, Helvetica, sans-serif",border:0},BOX:{left:0,overflow:"auto","overflow-x":(linb.browser.ie||linb.browser.gek)?"hidden":""},ITEMS:{overflow:"hidden","border-bottom":"1px solid #e5e5e5","border-right":"1px solid #e5e5e5"},BORDER:{"background-color":"#fff"},ITEM:{"border-left":"1px solid #e5e5e5","white-space":"nowrap",overflow:"hidden"},BAR:{overflow:"hidden","border-top":"1px solid #e5e5e5",padding:"1px"},DISABLED:{color:"#808080"},"BAR-mouseover":{$order:1,"background-color":"#d9e8fb"},"BAR-checked":{$order:2,"background-color":"#f6f6f6"},"BAR-GROUP":{$order:2,background:linb.UI.getCSSImgPara("group.gif"," repeat-x left top"),padding:"1px"},"BAR-GROUP-mouseover":{$order:3,"background-position":"left -30px"},"BAR-GROUP-checked":{$order:4,"background-position":"left -60px"},CMD:{cursor:"pointer","vertical-align":"middle",display:"block",overflow:"hidden","font-size":"12px"},SUB:{display:"none",overflow:"hidden","margin-left":"12px"},MARK1:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -161px top",null,"linb.UI.Public"),cursor:"pointer",width:"16px",height:"16px",margin:"0 4px 0 0"},"MARK1-mouseover":{$order:2,"background-position":"-161px -15px"},"MARK1-mousedown":{$order:3,"background-position":"-161px -30px"},"MARK1-checked":{$order:4,"background-position":"-176px top"},"MARK1-checked-mouseover":{$order:5,"background-position":"-176px -15px"},"MARK1-checked-mousedown":{$order:6,"background-position":"-176px -30px"},"MARK1-BUSY":{$order:7,background:linb.UI.getCSSImgPara("busy.gif"," no-repeat center center",null,"linb.UI.Public")},MARK2:{cursor:"pointer",width:"16px",height:"16px",margin:"0 4px 0 0"},"MARK2-checked":{$order:2,background:linb.UI.getCSSImgPara("icon.gif"," no-repeat -50px 0",null,"linb.UI.Public")},"ITEMICON, ICON":{cursor:"pointer",width:"16px",height:"16px"}}},Behaviors:{"default":{_hoverEffect:{MARK1:"MARK1",BAR:"BAR"},_clickEffect:{MARK1:"MARK1",BAR:"BAR"},onRewh:function(C,D,F){var E=C.root,A=null,B=null;if(D.height){B=E.height()}if(D.width){A=E.width()}C.box.resize(C,A,B)},MARK1:{onClick:function(B,D,E){var A=B.properties,C=B.getItemByDom(E);if(A.disabled||C.disabled){return false}if(!C.sub){return false}B.box.setSub(B,C,!C._checked);return false}},BAR:{onMousedown:function(B,D,E){var A=B.properties,C=B.getItemByDom(E);if(C.dragable){linb([E],false).startDrag(D,{type:"copy",move:false,key:C.dragKey||B.properties.dragKey,data:C.id});B.removeTagClass("BAR","-mouseover",linb([E]))}},onClick:function(B,F,A){var G=B.properties,J=B.getItemByDom(A),H=B.getSubSerialId(A.id),E=B.boxing(),C;if(G.disabled||J.disabled){return false}if(J.sub&&(J.group!==undefined?J.group:G.group)){B.getSubNode("MARK1",H).onClick();return false}switch(G.selMode){case"none":C=E.onItemSelected(B,J,A);break;case"multi":var I=E.getUIValue(),D=I?I.split(";"):[];if(D.exists(J.id)){D.removeValue(J.id)}else{D.push(J.id)}D.sort();I=D.join(";");if(E.getUIValue()==I){C=false}else{E.updateUIValue(I);if(E.getUIValue()==I){C=E.onItemSelected(B,J,A)}}break;case"single":if(E.getUIValue()==J.id){C=false}else{E.updateUIValue(J.id);if(E.getUIValue()==J.id){C=E.onItemSelected(B,J,A)}}break}B.getSubNode("CMD",H).focus();return C}},BOX:{onScroll:function(A,B,C){if(linb([C]).scrollLeft()!==0){linb([C]).scrollLeft(0)}}},CMD:{onKeydown:function(C,F,A){var J=linb.event.getKey(F),I=J[0],B=J[2],H=linb([A],false),E=C.root.nextFocus(true,true,false),G=C.root.nextFocus(false,true,false);switch(linb.event.getKey(F)[0]){case"tab":if(B){if(A!=E.get(0)){E.focus();return false}}else{if(A!=G.get(0)){G.focus();return false}}break;case"up":var D=H.nextFocus(false,true,false);if(H.get(0)==E.get(0)){G.focus()}else{H.nextFocus(false)}return false;break;case"down":var D=H.nextFocus(true,false,false);if(H.get(0)==G.get(0)){E.focus()}else{H.nextFocus()}return false;break;case"right":case"left":C.getSubNode("MARK1",C.getSubSerialId(A.id)).onClick();return false;case"enter":case"space":C.getSubNode("BAR",C.getSubSerialId(A.id)).onClick();return false}},onClick:function(A){}}}},EventHandlers:{onRequestData:function(A,B,C){},onItemSelected:function(A,B,C){}},DataModel:{listKey:null,tabindex:{action:function(A){if(this.domNode){this.getSubNode("CMD",true).tabIndex(A)}}},iniFold:true,fx:false,dragKey:"treeBar",dock:"fill",group:{ini:false,action:function(F){var E=this,D=this.properties.items,G=this.itemsSearch(D,function(H){return H.sub&&H.group===undefined}),C=linb([]);G.each(function(H){C.add(E.getSubNodeByItemId("BAR",H.id))});var B=this.getClass("BAR"),A=this.getClass("BAR","-group");if(F){C.reClass(new RegExp("(\\b)"+B+"([^b]*\\b)","g"),"$1"+A+"$2")}else{C.reClass(new RegExp("(\\b)"+A+"([^b]*\\b)","g"),"$1"+B+"$2")}}},selMode:{ini:"single",listbox:["single","none","multi"],action:function(A,B){var C=this.getSubNode("MARK2",true);if(B=="none"){C.inlineBlock()}if(A=="none"){C.display("none")}}},singleOpen:false,dynBuild:false,position:"absolute"},createdTrigger:function(){if(linb.browser.ie){this.root.addEvent("ondrag",function(){return false}).addEvent("onselectstart",function(){return false})}if(!this.properties.iniFold){this.boxing().toggleNodes(this.properties.items,true)}},prepareItem:function(C,D,A,B){var E=C.properties;if(B){A._pid=B}D.mark=D.sub?"":"display:none";D.disabled=D.disabled?C.getClass("KEY","-disabled"):"";D.mark2Display=(E.selMode=="none")?"display:none":"";D._tabindex=E.tabindex;D.href=D.href||"javascript:;";if(D.sub&&(D.group!==undefined?D.group:E.group)){D.cls_group=C.getClass("BAR","-group");D.mark2Display="display:none"}},setSub:function(D,P,N,E){var B=D.domId,O=D.getSubSerialIdByItemId(P.id),M=D.properties,K=D.getSubNode("BAR",O),H=D.getSubNode("MARK1",O),L=D.getSubNode("SUB",O);if(linb.thread.exists(D.key+D.id)){return }if(P._checked){if(!N){var J=L.height();if(M.fx){L.fx({height:[J,0]},function(){L.height(J)},function(){L.display("none").height("auto")},200,8,"inexp",D.key+D.id).start()}else{L.display("none").height("auto")}D.removeTagClass("MARK1","-checked",H);if(P.group||M.group){D.removeTagClass("BAR","-checked",K)}P._checked=false;if(M.dynBuild){var Q=P.sub,I=[];for(var G=0,F=Q.length;G<F;G++){I.push(Q[G].id)}D.boxing().removeItems(I);delete P._created}}}else{if(N){var C=function(U,d,T,W,Z,Y,R,V){var c=U.boxing(),S=U.properties;if(!d._created){delete d.sub;d._created=true;Z.display("none");c.insertItems(R,d.id);c.setCtrlValue(c.getUIValue(),true)}if(S.singleOpen){c.toggleNodes(d._pid?U.getItemByItemId(d._pid).sub:S.items,false)}if(!V){var X=Z.height(true);if(S.fx){Z.fx({height:[0,X]},function(){Z.height("0").display("block")},function(){Z.height("auto")},200,8,"outexp",U.key+U.id).start()}else{Z.display("block").height("auto")}}else{Z.display("block")}U.addTagClass("MARK1","-checked",W);if(d.group||M.group){U.addTagClass("BAR","-checked",Y)}d._checked=true};var A=P.sub;if(A&&A.length){C(D,P,B,H,L,K,A,E);if(E){A.each(function(R){if(R.sub&&R.sub.length&&!R._checked){D.box.setSub(D,R,true,E)}})}}else{linb.thread(null,[function(R){if(D.onRequestData){D.boxing().onRequestData(D,P,R)}else{linb.thread(R).abort()}},function(R){A=linb.thread(R).getCache("response");if(A){C(D,P,B,H,L,K,A,E);C=null}}],null,null,function(R){D.addTagClass("MARK1","-busy",H);linb(B).busy(false)},function(){D.removeTagClass("MARK1","-busy",H);linb(B).free()}).start()}}}},resize:function(C,A,B){C.getSubNode("BORDER").cssSize({width:A?A:null,height:B?B:null});C.getSubNode("BOX").cssSize({width:A?A:null,height:B?B:null})}}});Class("linb.UI.PopMenu",["linb.UI.Widget","linb.UI.iList","linb.UI.iNavigator"],{Instance:{activate:function(){return linb.UI.iList.prototype.activate.call(this)},adjustSize:function(){return this.each(function(G){var B=G.root,C=G.getSubNode("ITEMS"),D=G.getSubNode("BORDER"),H=B.cssSize(),F=D.cssSize(),E=Math.min(G.properties.maxHeight,C.height()+H.height-F.height+2),A=Math.min(G.properties.maxWidth,C.width()+H.width-F.width+2);G.properties.width=A;G.properties.height=E;B.cssSize({width:A,height:E},true);G.boxing().setScrollButtons()})},setScrollButtons:function(){return this.each(function(E){var F=E.getSubNode("ITEMS"),C=F.offsetTop(),D=F.offsetHeight(),A=E.getSubNode("BORDER"),B=A.offsetHeight();E.getSubNode("TOP").display(C===0?"none":"block");E.getSubNode("BOTTOM").display((B>D+C)?"none":"block")})},scrollToBottom:function(){return this.each(function(E){var G=E.getSubNode("ITEMS"),C=E.getSubNode("BORDER"),H=G.offsetTop(),F,D=G.offsetHeight(),A=false,B=C.height();if(B<D+H){if(!E.$scrollStep){E.$scrollStep=1}if(E.$scrollStep<30){E.$scrollStep=E.$scrollStep*1.1}H-=E.$scrollStep;if(B>D+H){H=B-D;A=true}G.top(H);if(A){E.getSubNode("BOTTOM").display("none");E.$scrollTobottom=false;E.$scrollStep=null}else{E.getSubNode("TOP").display("block");if(E.$scrollTobottom){_.asyRun(arguments.callee,0,[E],this)}}}})},scrollToTop:function(){return this.each(function(B){var C=B.getSubNode("ITEMS"),D=C.offsetTop(),A=false;if(D<0){if(!B.$scrollStep){B.$scrollStep=1}if(B.$scrollStep<10){B.$scrollStep=B.$scrollStep*1.03}D+=B.$scrollStep;if(D>=-1){D=0;A=true}C.top(D);if(A){B.getSubNode("TOP").display("none");B.$scrollToTop=false;B.$scrollStep=null}else{B.getSubNode("BOTTOM").display("block");if(B.$scrollToTop){_.asyRun(arguments.callee,0,[B],this)}}}})},pop:function(E,C,B){var A=this.get(0);if(!A.created){A.boxing().create(true)}if(A.$highLight){A.removeTagClass("ITEM","-mouseover",linb([A.$highLight],false))}A.root.popToTop(E,C,B);var D=function(){var F=arguments.callee.profile;F.boxing().hide();F.$groupPopMenu.length=0};D.profile=A;if(!A.$groupPopMenu||!A.$groupPopMenu.length){A.$groupPopMenu=[A.root.get(0)];A.root.setBlurTrigger(A.$id,null);A.root.setBlurTrigger(A.$id,D,A.$groupPopMenu)}},hide:function(A){var B,C=this.get(0);C.root.setBlurTrigger(C.$id,null);if(C.$hideMenuPool){C.$hideMenuPool.addLast(C.root)}else{C.root.display("none")}var E=C.$childPopMenu,D;while(E){E.boxing().hide();E=(D=E).$childPopMenu;D.$childPopMenu=D.$subPopMenuShowed=null}C.$childPopMenu=C.$subPopMenuShowed=null;if(B=C.$parentPopMenu){B.$subPopMenuShowed=null}C.$groupPopMenu.removeValue(C.root.get(0));if(false!==A){C.boxing().onHide(C)}}},Initialize:function(){var A=this.getTemplate("default");_.merge(A.FRAME.BORDER,{TOP:{},BOTTOM:{},BOX:{tagName:"div",ITEMS:{tagName:"div",text:"{items}"}},POOL:{tagName:"div",style:"display:none;"}},"all");A.$dynamic={items:function(F,E,D,C,B){C=C+"."+D.type;if(E[C]){linb.UI.$doTemplate(F,E,D,C,B)}},"items.split":{ITEMSPLIT:{tagName:"div",ITEMIN:{style:"width:2px;height:2px;font-size:0;line-height:0;"}}},"items.button":{ITEM:{tagName:"a",href:"javascript:;",tabindex:0,className:"{cls}",ICON:{style:"background:url({icon}) transparent  no-repeat {iconPos};",$order:0},CAPTION:{text:"{caption}",$order:1},RULER:{style:"{displayAdd}",$order:2},ADD:{tagName:"div",style:"{displayAdd}",text:"{add}",$order:2},SUB:{style:"{tagClass}"}}}};this.setTemplate("default",A)},Static:{hasDomRoot:false,Appearances:{"default":{KEY:{"font-size":"12px",visibility:"hidden"},BORDER:{border:"1px solid","border-color":"#fff #cdcdcd #cdcdcd #fff"},BOX:{"background-color":"#F9F8F7",overflow:"hidden",position:"absolute",left:0,top:0,"z-index":"3"},ITEMS:{position:"absolute",top:0,left:0,overflow:"visible",background:linb.UI.getCSSImgPara("bg.gif"," repeat-y left top")},ITEM:{display:"block",position:"relative",overflow:"visible","white-space":"nowrap",color:"#000","font-family":'"Verdana", "Helvetica", "sans-serif"',cursor:"pointer",padding:"2px 20px 2px 2px"},ITEMSPLIT:{display:"block",position:"relative",overflow:"hidden","font-size":0,"line-height":0,margin:"2px 2px 2px 26px",background:linb.UI.getCSSImgPara("hsplit.gif"," repeat-x left top",null,"linb.UI.Public")},"ITEM-mouseover":{$order:1,"background-color":"#B6BDD2"},"ITEM-checked":{$order:2,"background-color":"#B6BDD2"},TOP:{cursor:"pointer",display:"none",position:"absolute","margin-left":"-8px",right:0,height:"16px",width:"16px","z-index":"10",top:0,background:linb.UI.getCSSImgPara("icon.gif"," no-repeat -33px 0",null,"linb.UI.Public")},BOTTOM:{cursor:"pointer",display:"none",position:"absolute","margin-left":"-8px",right:0,height:"16px",width:"16px","z-index":"10",bottom:0,background:linb.UI.getCSSImgPara("icon.gif"," no-repeat -33px -17px",null,"linb.UI.Public")},ICON:{cursor:"pointer",width:"16px",height:"16px",margin:"0 4px 0 0"},CAPTION:{"vertical-align":"bottom","padding-left":"2px"},RULER:{width:"100px","font-size":0,"line-height":0},ADD:{"font-family":'"Verdana", "Helvetica", "sans-serif"',"font-size":"11px",position:"absolute",top:"2px",right:0,width:"80px",padding:"2px 20px 2px 2px","text-align":"right","z-index":"10"},SUB:{position:"absolute",top:"4px",right:0,width:"8px",height:"16px",background:linb.UI.getCSSImgPara("icon.gif"," no-repeat left -16px",null,"linb.UI.Public")}}},Behaviors:{"default":{ITEM:{onMouseover:function(D,F,H){if(D.$highLight==H){return }var C=D.properties,E=D.getItemByDom(H),G=E.id;var B=false;if(D.$subPopMenuShowed){if(D.$subPopMenuShowed==D.$allRelatedPopMenus[G]){B=true}else{D.$subPopMenuShowed.hide();D.$subPopMenuShowed=null}}if(!B){if(D.$highLight){D.removeTagClass("ITEM","-mouseover",linb([D.$highLight],false))}D.$highLight=H;D.addTagClass("ITEM","-mouseover",linb([D.$highLight],false));H.focus()}if(!B&&E.sub){var A;D.$allRelatedPopMenus=D.$allRelatedPopMenus||{};if(!(A=D.$allRelatedPopMenus[G])){A=(new linb.UI.PopMenu({position:"absolute",items:E.sub})).create(true);A.onMenuSelected(function(K,L,I,J){D.boxing().onMenuSelected(D,L,I,J)});A.get(0).$hideMenuPool=D.$hideMenuPool||D.getSubNode("POOL");D.$allRelatedPopMenus[G]=A;D.$showpops=D.$showpops||[D];A.get(0).$showpops=D.$showpops;D.$showpops.push(A.get(0))}D.$groupPopMenu.push(A.get(0).root.get(0));A.get(0).$groupPopMenu=D.$groupPopMenu;A.get(0).$parentPopMenu=D;D.$childPopMenu=A.get(0);A.pop(H,null,2);D.$subPopMenuShowed=A}},onMouseout:function(C,F,A){var G=C.properties,J=C.getItemByDom(A),H=J.id;var D=true;if(C.$subPopMenuShowed){var B=F.toElement||F.relatedTarget;var E=C.$subPopMenuShowed.get(0).root.get(0);try{do{if(B==E){return }}while((B&&(B=B.parentNode)))}catch(I){}}else{C.removeTagClass("ITEM","-mouseover",linb([A],false));C.$highLight=null;if(C.$subPopMenuShowed){C.$subPopMenuShowed.hide();C.$subPopMenuShowed=null}}},onClick:function(B,F,H){var A=B.properties,C=B.getItemByDom(H),G=C.id;if(C.sub){}else{B.boxing().onMenuSelected(B,C.id,C,H);B.removeTagClass("ITEM","-mouseover",linb(this));var E=B,D;while(E){E.boxing().hide();E=(D=E).$parentPopMenu;D.$parentPopMenu=D.$subPopMenuShowed=null}B.$subPopMenuShowed=null;B.$groupPopMenu.length=0}return false},onFocus:function(B,E,F){var C=B.getSubNode("BOX"),D=C.scrollTop(),A=C.scrollHeight(),G=linb(F).offsetTop();if(G<D||G>D+A){linb(F).offsetTop(D)}linb(F).onMouseover()},onKeydown:function(D,F,A){var L=D.getItemByDom(A),G=D.properties.items,I=L.id,H,B,E,C;var K,J=linb.event.getKey(F)[0];switch(J){case"up":B=true;H=false;G.each(function(N,M){if(N.type=="split"){return }if(H){E=N.id;return B=false}if(N.id==I){H=true}},null,true);if(B){E=G[G.length-1].id}C=D.getSubNodeByItemId("ITEM",E).get(0);if(C){C.focus()}break;case"down":B=true;H=false;G.each(function(N,M){if(N.type=="split"){return }if(H){E=N.id;return B=false}if(N.id==I){H=true}});if(B){E=G[0].id}C=D.getSubNodeByItemId("ITEM",E).get(0);if(C){C.focus()}break;case"left":if(K=D.$parentPopMenu){if(K=D.$parentPopMenu.$highLight){C=K}}if(C){C.focus()}break;case"right":if((K=D.$subPopMenuShowed)&&K==D.$allRelatedPopMenus[I]){K.activate()}break}}},TOP:{onMouseover:function(A,B,C){A.$scrollToTop=true;A.boxing().scrollToTop()},onMouseout:function(A,B,C){A.$scrollToTop=false;A.$scrollStep=null},onClick:function(A,B,C){A.$scrollStep=1000}},BOTTOM:{onMouseover:function(A,B,C){A.$scrollTobottom=true;A.boxing().scrollToBottom()},onMouseout:function(A,B,C){A.$scrollTobottom=false;A.$scrollStep=null},onClick:function(A,B,C){A.$scrollStep=1000}},ITEMS:{beforeKeydown:function(C,D){var B=linb.event.getKey(D)[0];if(B=="tab"||B=="enter"){return true}else{if(/^\w$/.test(B)){C._wordcache=C._wordcache||"";C._wordcache+=B;clearTimeout(C._wordcachetimeout);var A=C.properties.items;A.each(function(F,E){if(F.caption.toLowerCase().startWith(C._wordcache)){C.getSubNodeByItemId("ITEM",F.id).focus();return false}});C._wordcachetimeout=_.asyRun(function(){C._wordcache=""},300)}else{if(B=="esc"){C.boxing().onCancelled(C);do{C.boxing().hide()}while(C=C.$parentPopMenu);return false}else{return false}}}}}}},DataModel:({dataField:null,dataBinder:null,dock:null,tabindex:null,tips:null,icon:null,iconPos:null,caption:null,border:null,$fix:true,shadow:true,resizable:false,maxHeight:500,maxWidth:300,height:100,left:-10000,width:300,position:"absolute",$border:1}),EventHandlers:{beforeNextFocus:null,onCancelled:function(A){},onMenuSelected:function(A,D,B,C){},onHide:function(A){}},renderedTrigger:function(){this.boxing().adjustSize()},prepareItem:function(A,B){B.add=B.add||"";B.displayAdd=B.add?"":"display:none";B.tagClass=B.sub?"":"display:none";B.type=B.type||"button"},resize:function(D,A,C){var B=arguments.callee.upper.apply(this,arguments);D.getSubNode("BOX").cssSize(B)}}});Class("linb.UI.MenuBar",["linb.UI.iList","linb.UI.iWidget","linb.UI.iNavigator"],{Instance:{pop:function(C,A,G){var D,E=this.get(0);if(E.$currentmenu){this.hide()}E.addTagClass("ITEM","-mousedown",linb([A],false));E.$allRelatedPopMenus=E.$allRelatedPopMenus||{};if(G||!(D=E.$allRelatedPopMenus[C])){var H=E.getItemByItemId(C),B=H.sub;B=B||[];D=linb.create("PopMenu",{position:"absolute",items:B});E.getSubNode("POOL").attach(D);var I=this;D.onHide(function(J){I.hide(false);I.get(0).properties.$menuPop=null}).onMenuSelected(function(L,M,J,K){E.boxing().onMenuSelected(E,M,J,K)});D.get(0).$hideMenuPool=E.getSubNode("POOL");D.get(0).$allRelatedPopMenus=E.$allRelatedPopMenus;if(!G){E.$allRelatedPopMenus[C]=D}}var F=linb([A],false);D.pop(F);E.$currentmenu=C;E.$currentNode=A},hide:function(A){var B=this.get(0),D,E=B.$currentmenu,C=B.$currentNode;if(D=B.$allRelatedPopMenus[E]){if(false!==A){D.hide(false)}B.getSubNode("POOL").addLast(D.reBoxing());D=B.$currentmenu=B.$currentNode=null;B.removeTagClass("ITEM","-mousedown",linb([C],false))}},reset:function(){var A=this.get(0);A.getSubNode("POOL").empty();A.$allRelatedPopMenus=A.$currentmenu=A.$currentNode=null}},Initialize:function(){linb.SC("linb.UI.PopMenu")},Static:{$recursive:true,cssNone:false,Templates:{"default":{tagName:"div",POOL:{tagName:"div"},BORDER:{tagName:"div",LIST:{tagName:"div",HANDLER:{style:"{handler}"},ITEMS:{$order:1,text:"{items}"}}},$dynamic:{items:{ITEM:{tagName:"a",href:"javascript:;",tabindex:"{_tabindex}",className:" {typeCls} ",ICON:{$order:1,style:"background:url({icon}) transparent no-repeat  {iconPos}; {iconDisplay}"},CAPTION:{$order:2,text:"{caption}",style:"{captionDisplay}"}}}}}},Appearances:{"default":{KEY:{"font-size":0,"line-height":0,position:"absolute",left:0,top:0},POOL:{width:0,height:0,visibility:"hidden",position:"absolute",left:"-10000px"},BORDER:{left:0,top:0,border:"solid 1px","background-color":"#f4f4f4","border-color":"#fff #A7A6AA #A7A6AA #fff","font-size":0,"line-height":0},HANDLER:{height:"22px",width:"6px",background:linb.UI.getCSSImgPara("handler.gif"," left top #f4f4f4 ",null,"linb.UI.Public"),cursor:"move"},LIST:{padding:"1px 4px 1px 2px"},"LIST-disabled":{"background-color":"#E4E4E4"},ITEM:{display:linb.browser.gek?["-moz-inline-block","-moz-inline-box","inline-block"]:"inline-block","vertical-align":"middle",padding:"1px 4px 1px 4px",border:"solid 1px #f4f4f4"},"ITEM-mouseover":{$order:2,"border-color":"#fff #cdcdcd #cdcdcd #fff"},"ITEM-mousedown":{$order:2,"border-color":"#cdcdcd #fff #fff #cdcdcd","background-color":"#fff"},ICON:{width:"16px",height:"16px","margin-right":"1px","vertical-align":"middle"},CAPTION:{height:"16px","margin-left":"1px","font-size":"12px","line-height":"12px","vertical-align":"middle"}}},Behaviors:{"default":{onMousedown:function(A,B,C){},ITEM:{onMouseover:function(A,D,F){var C=A.properties;if(C.disabled){return }var B=A.getItemByDom(F),E=B.id;if(C.$menuPop){if(C.$menuPop!=E){A.addTagClass("ITEM","-mousedown",linb([this],false));A.boxing().pop(E,this);C.$menuPop=E}}else{A.addTagClass("ITEM","-mouseover",linb([this],false))}},onMouseout:function(A,C,D){var B=A.properties;if(B.disabled){return }A.removeTagClass("ITEM","-mouseover",linb([this],false))},onMousedown:function(A,D,F){var C=A.properties;if(C.disabled){return }var B=A.getItemByDom(F),E=B.id;if(C.$menuPop){if(false===_.tryF(A.onPopMenu,[E],A)){return }C.$menuPop=null;A.boxing().hide(E)}else{if(false===_.tryF(A.onHideMenu,[E],A)){return }C.$menuPop=E;A.boxing().pop(E,this);return false}},onKeydown:function(C,F,A){var J=linb.event.getKey(F),I=J[0],B=J[2],H=linb([A],false),E=C.root.nextFocus(true,true,false),G=C.root.nextFocus(false,true,false);switch(linb.event.getKey(F)[0]){case"tab":if(B){if(A!=E.get(0)){E.focus();return false}}else{if(A!=G.get(0)){G.focus();return false}}break;case"left":case"up":var D=H.nextFocus(false,true,false);if(H.get(0)==E.get(0)){G.focus()}else{H.nextFocus(false)}return false;break;case"right":case"down":var D=H.nextFocus(true,false,false);if(H.get(0)==G.get(0)){E.focus()}else{H.nextFocus()}return false;break;case"space":case"enter":linb(A).onMousedown();return false;break}},onClick:function(){return false}}}},DataModel:{value:null,dataField:null,dataBinder:null,listKey:null,height:null,tabindex:{action:function(A){if(this.domNode){this.getSubNode("ITEM",true).tabIndex(A)}}},$menuPop:null,$border:1,left:0,top:0,handler:{ini:true,action:function(A){this.getSubNode("HANDLER").display(A?"":"none")}},position:"absolute",dock:{ini:"top",listbox:["top","bottom"]}},EventHandlers:{beforeValueUpdated:null,afterValueUpdated:null,beforeValueSet:null,afterValueSet:null,onMenuSelected:function(A,D,B,C){}},createdTrigger:function(){if(this.properties.disabled){this.boxing().setDisabled(true,true)}},prepareData:function(A){arguments.callee.upper.call(this,A);A.data.handler=A.data.handler?"":"display:none"}}});Class("linb.UI.ToolBar",["linb.UI.iList","linb.UI.iWidget","linb.UI.iNavigator"],{Instance:{updateItem:function(B,A){this.get(0).getSubNodeByItemId("CAPTION",B).html(A,false)},hideItem:function(A){this.get(0).getSubNodeByItemId("ITEM",A).display("none")},disableGroup:function(B,A){return this.each(function(C){C.getSubNodeByItemId("GROUP",B).opacity(A?0.5:1);var D=C.boxing().getItemByItemId(B);D.disabled=A})}},Static:{$recursive:true,cssNone:false,Templates:{"default":{tagName:"div",ITEMS:{tagName:"div",style:"{mode}",text:"{items}"},$dynamic:{items:{GROUP:{HANDLER:{style:"{mode2}"},LIST:{$order:1,tagName:"text",text:"{sub}"}}},"items.sub":function(E,D,C,B,A){B=B+"."+C.type;if(D[B]){linb.UI.$doTemplate(E,D,C,B,A)}},"items.sub.split":{ITEMSPLIT:{}},"items.sub.button":{ITEM:{$order:1,tagName:"a",href:"javascript:;",tabindex:"{_tabindex}",className:" {typeCls} ",ICON:{$order:1,style:"background:url({icon}) transparent no-repeat  {iconPos}; {iconDisplay}"},CAPTION:{$order:2,text:"{caption}",className:" {disabled}",style:"{captionDisplay}"}}}}}},Appearances:{"default":{KEY:{"font-size":0,"line-height":0,position:"absolute",left:0,top:0},ITEMS:{display:"block",border:"solid 1px","background-color":"#f4f4f4","border-color":"#fff #A7A6AA #A7A6AA #fff","font-size":0,"line-height":0},HANDLER:{height:"22px",width:"6px",background:linb.UI.getCSSImgPara("handler.gif"," left top #f4f4f4 ",null,"linb.UI.Public"),cursor:"move"},GROUP:{"font-size":0,"line-height":0,padding:"1px 4px 1px 2px"},ITEM:{display:linb.browser.gek?["-moz-inline-block","-moz-inline-box","inline-block"]:"inline-block","vertical-align":"top",margin:"1px",padding:"1px"},ICON:{width:"16px",height:"16px","margin-right":"1px"},"ITEM-BUTTON":{$order:1,border:"solid 1px #f4f4f4"},"ITEM-BUTTON-mouseover":{$order:2,border:"solid 1px #A7A6AA"},"ITEM-BUTTON-mousedown":{$order:2,border:"solid 1px #A7A6AA","background-color":"#FFFFE0"},ITEMSPLIT:{$order:1,width:"6px",height:"16px",background:linb.UI.getCSSImgPara("vsplit.gif"," repeat-y left top",null,"linb.UI.Public")},CAPTION:{height:"16px","margin-left":"1px","margin-right":"3px","font-size":"12px","line-height":"12px"}}},Behaviors:{"default":{_hoverEffect:{ITEM:["ITEM"]},_clickEffect:{ITEM:["ITEM"]},onMousedown:function(A,B,C){},ITEM:{onClick:function(C,E,F){if(C.properties.disabled){return }var B=F.parentNode.id,A=C.getItemByDom(B);if(A.disabled){return }var G=F.id,D=C.getItemByDom(G);if(D.disabled){return }linb(F).focus();C.boxing().onClick(C,D.id,A.id,F);return false},onKeydown:function(C,F,A){var J=linb.event.getKey(F),I=J[0],B=J[2],H=linb([A],false),E=C.root.nextFocus(true,true,false),G=C.root.nextFocus(false,true,false);switch(linb.event.getKey(F)[0]){case"tab":if(B){if(A!=E.get(0)){E.focus();return false}}else{if(A!=G.get(0)){G.focus();return false}}break;case"left":case"up":var D=H.nextFocus(false,true,false);if(H.get(0)==E.get(0)){G.focus()}else{H.nextFocus(false)}return false;break;case"right":case"down":var D=H.nextFocus(true,false,false);if(H.get(0)==G.get(0)){E.focus()}else{H.nextFocus()}return false;break;case"space":case"enter":linb(A).onClick();return false;break}}}}},DataModel:{value:null,dataField:null,dataBinder:null,listKey:null,tabindex:{action:function(A){if(this.domNode){this.getSubNode("ITEM",false).tabIndex(A)}}},height:null,left:0,top:0,handler:{ini:true,action:function(A){this.getSubNode("HANDLER",true).display(A?"":"none")}},position:"absolute",align:{ini:"left",listbox:["left","right"],action:function(A){this.getSubNode("ITEMS",true).setStyle("textAlign",A)}},dock:{ini:"top",listbox:["top","bottom"]}},EventHandlers:{onClick:function(B,D,A,C){},onValueChanged:function(C,D,B,A){}},createdTrigger:function(){if(this.properties.disabled){this.boxing().setDisabled(true,true)}},prepareData:function(A){arguments.callee.upper.call(this,A);var C=A.data,B=A.properties;C.mode=B.align=="right"?"text-align:right;":"";C.items.filter(function(D){return !D.$del})},prepareItem:function(E,F,C){F.mode2=E.properties.handler?"":"display:none;";var A=[],D,G;var B=C.sub||[];B.each(function(H){D={id:H.id};G=E.pickSubId("items");D[linb.UI.subSerialIdTag]=E.ItemIdMapSubSerialId[H.id]=G;E.SubSerialIdMapItem[G]=H;linb.UI.copyItem(H,D);D.type=D.type||"button";if(D.type.exists(".")){D.$del=true;return }D.captionDisplay=D.caption?"":"display:none";D.typeCls=E.getClass("ITEM","-"+D.type);A.push(D)});F.sub=A}}});Class("linb.UI.Range",["linb.UI.iWidget"],{Instance:{setCtrlValue:function(A){return this.each(function(E){var C=E.properties,J=C.titleTpl,K=function(O){return E.getSubNode(O)},G=function(O,P){O.cssPos({left:E[P],top:I.x2y(E[P])})},F=function(P,O){P.get(0).style.width=O+"px"},M=K("CAPTION"),N=K("IND1"),L=K("IND2"),D=K("RULER1"),B=K("RULER3"),I=E.box,H=I._v2a(A);E._rate=300/(C.max-C.min);E._v1=Math.round((H[0]-C.min)/(C.max-C.min)*300)-8;E._v2=Math.round((1-(C.max-H[1])/(C.max-C.min))*300)-8;M.html(I._buildTpl(C.single,J,H,C.unit),false);G(N,"_v1");G(L,"_v2");F(D,E._v1+8);F(B,300-E._v2-8)})},setDirtyMark:function(){return this.each(function(D){if(!D.domNode){return }var C=D.properties,E=D.getSubNode("CAPTION"),B=C.value!==C.$UIvalue,A=linb.UI.$css_tag_dirty;if(E.beforeDirtyMark&&false===E.boxing().beforeDirtyMark(D,B)){return }if(B){E.addClass(A)}else{E.removeClass(A)}})}},Static:{Templates:{"default":{style:"{_style}",BOX:{tagName:"div",RULER:{tagName:"div",IND1:{style:"{_single}"},IND2:{},RULER1:{style:"{_single}"},RULER3:{}},TAIL:{tagName:"div",CAPTION:{tagName:"div"},MIN:{text:"{min}"},MAX:{text:"{max}"}}}}},Appearances:{"default":{KEY:{background:"#fff"},"KEY, RULER, IND1, IND1":{"font-size":0,"line-height":0,position:"relative"},BOX:{position:"absolute",left:0,top:0,width:"300px"},"CAPTION, IND1, TAIL, MIN":{"font-size":"12px","line-height":"12px"},RULER:{$order:1,position:"relative",height:"30px",overflow:"visible","margin-bottom":"3px",background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat left -241px",null,"linb.UI.Public")},"RULER1, RULER3":{position:"absolute",top:0,height:"30px",width:"300px"},RULER1:{left:0,background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat left -271px",null,"linb.UI.Public")},RULER3:{right:0,background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat right -271px",null,"linb.UI.Public")},"IND1,IND2":{"z-index":"2",width:"15px",height:"14px",position:"absolute"},IND1:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat left -226px",null,"linb.UI.Public"),left:"-8px",top:"11px"},IND2:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -15px -226px",null,"linb.UI.Public"),left:"268px",top:"1px"},TAIL:{$order:2,width:"300px",position:"relative"},CAPTION:{position:"relative","text-align":"center"},MIN:{position:"absolute",left:0,top:0},MAX:{position:"absolute",right:0,top:0}}},Behaviors:{"default":{IND1:{onMousedown:function(B,E,F){var D=B.properties,C=B.box,A=C._v2a(D.$UIvalue);linb([F]).startDrag(E,{type:"move",move:true,horizontal:true,offset_left:Math.floor(B._v1+8),offset_right:Math.floor(B._v2-B._v1),cursor:"default"});linb([F]).zIndex(10);B.getSubNode("IND2").zIndex(5)},onDrag:function(A,B,C){A.box._ondrag.apply(A.box,[A,B,C,0])},onDragstop:function(C,G,A){var B=C.properties,E=C.boxing(),H=C._rate,I=linb.dragDrop,F,D=B.$UIvalue.split(":");C._v1=I.proxyPos.left;D[0]=(C._v1+8)/H+B.min;if(F=C.onValueFormat){D[0]=F.call(C.host,C,D[0])}else{D[0]=Math.floor(D[0])}E.updateUIValue(D.join(":"));if(C._v1==C._v2){linb([A]).zIndex(10);C.getSubNode("IND2").zIndex(5)}}},IND2:{onMousedown:function(B,E,F){var D=B.properties,C=B.box,A=C._v2a(D.$UIvalue);linb([F]).startDrag(E,{type:"move",move:true,horizontal:true,offset_left:Math.floor(B._v2-B._v1),offset_right:Math.floor(300-B._v2-8),cursor:"default"});linb([F]).zIndex(10);B.getSubNode("IND1").zIndex(5)},onDrag:function(A,B,C){A.box._ondrag.apply(A.box,[A,B,C,1])},onDragstop:function(C,G,A){var B=C.properties,E=C.boxing(),H=C._rate,I=linb.dragDrop,F,D=B.$UIvalue.split(":");C._v2=I.proxyPos.left;D[1]=(C._v2+8)/H+B.min;if(F=C.onValueFormat){D[1]=F.call(C.host,C,D[1])}else{D[1]=Math.floor(D[1])}E.updateUIValue(D.join(":"))}}}},DataModel:{position:"absolute",width:300,height:56,min:{ini:0,action:function(){this.boxing().refresh()}},max:{ini:100,action:function(){this.boxing().refresh()}},unit:"",titleTpl:"{1}{u} - {2}{u}",value:"0:100",single:{ini:false,action:function(A){this.boxing().refresh()}}},EventHandlers:{onValueFormat:function(A,B){return Math.floor(B)}},prepareData:function(B){arguments.callee.upper.call(this,B);var D=B.data,C=B.properties,A=B.box._v2a(C.value);D._single=C.single?"display:none":"";C.min=parseFloat(C.min);C.max=parseFloat(C.max);D.min=D.min+C.unit;D.max=D.max+C.unit},ensureV:function(B,I){var A=B.properties,H=I.split(":"),D=A.min,F=A.max,G=[],E=function(J){return parseFloat(J)},C=function(J){return Math.min(F,Math.max(D,J))};G[0]=E(H[0]);G[1]=E(H[1]);G[0]=Math.min(G[0],G[1]);if(!D){D=G[0]}if(!F){F=G[1]}G[0]=C(G[0]);G[1]=C(G[1]);return G.join(":")},_v2a:function(A){return typeof A=="string"?A.split(":"):A},_buildTpl:function(D,B,A,C){return D?A[1]+C:B.replace(/\{1\}/g,A[0]).replace(/\{2\}/g,A[1]).replace(/\{u\}/g,C)},x2y:function(A){return Math.floor(15+1-(A+8)*(15/300))},_ondrag:function(E,J,A,O){var C=E.properties,K=linb.dragDrop,H=E.box,L=function(P){return E.getSubNode(P)},F=function(Q,P){Q.get(0).style.width=P+"px"},M=L("CAPTION"),D=L("RULER1"),B=L("RULER3"),N,I,G=this._v2a(C.$UIvalue);A.style.top=this.x2y(K.proxyPos.left)+"px";N=(K.proxyPos.left+8)/E._rate+C.min;if(I=E.onValueFormat){N=I.call(E.host,E,N)}else{N=Math.floor(N)}if(O){G[1]=N;F(B,300-K.proxyPos.left-8)}else{G[0]=N;F(D,K.proxyPos.left+8)}M.html(H._buildTpl(C.single,C.titleTpl,G,C.unit),false)}}});Class("linb.UI.Layout",["linb.UI.iList","linb.UI.iWidget","linb.UI.iContainer"],{Instance:{getPanel:function(A){return this.get(0).getSubNodeByItemId("PANEL",A)},attach:function(C,D){var A=this,B=A.get(0);A.appendChild(C,D||"main");if(B.domNode){if(!B.getSubSerialIdByItemId(D)){D="main"}A.getPanel(D).attach(C)}return A}},Static:{cssNone:false,Dropable:["PANEL"],Templates:{"default":{tagName:"div",style:"{_style}",text:"{items}",$dynamic:{items:{ITEM:{tagName:"div",className:"{cls1} ",style:"{size}",MOVE:{$order:0,tagName:"div",className:"{cls2} ",style:"{display}"},CMD:{$order:1,tagName:"div",style:"{cmdDisplay}",className:"{cls3} "},PANEL:{tagName:"div",style:"position:absolute;left:0;top:0;",text:linb.UI.$childTag}}}}}},Appearances:{"default":{KEY:{position:"absolute",overflow:"hidden",left:0,top:0,"font-size":linb.browser.ie?0:"","line-height":linb.browser.ie?0:""},MOVE:{$order:0,position:"absolute","background-color":"#f4f4f4","z-index":"10","font-size":linb.browser.ie?0:"","line-height":linb.browser.ie?0:""},"MOVE-mouseover":{$order:1,"background-color":"#f8f8f8"},CMD:{position:"absolute",border:"solid 1px #cdcdcd",cursor:"pointer","z-index":"20","font-size":linb.browser.ie?0:"","line-height":linb.browser.ie?0:""},ITEM:{position:"absolute",overflow:"hidden","background-color":"#fff","border-width":linb.browser.opr?"0px":"","font-size":linb.browser.ie?0:"","line-height":linb.browser.ie?0:""},PANEL:{position:"absolute",overflow:"hidden","border-width":linb.browser.opr?"0px":"","font-size":linb.browser.ie?0:"","line-height":linb.browser.ie?0:""},"ITEM-MAIN":{left:0,right:0,top:0,bottom:0},"ITEM-TOP, ITEM-BOTTOM":{left:0,right:0},"ITEM-LEFT, ITEM-RIGHT":{top:0,bottom:0},"MOVE-TOP":{"border-top":"solid 1px #cdcdcd","border-bottom":"solid 1px #cdcdcd",width:"100%",bottom:0,height:"4px",cursor:"n-resize"},"MOVE-BOTTOM":{"border-top":"solid 1px #cdcdcd","border-bottom":"solid 1px #cdcdcd",width:"100%",top:0,height:"4px",cursor:"n-resize"},"MOVE-LEFT":{"border-left":"solid 1px #cdcdcd","border-right":"solid 1px #cdcdcd",height:"100%",right:0,width:"4px",cursor:"w-resize"},"MOVE-RIGHT":{"border-left":"solid 1px #cdcdcd","border-right":"solid 1px #cdcdcd",height:"100%",left:0,width:"4px",cursor:"w-resize"},"MOVE-TOP-checked, MOVE-BOTTOM-checked, MOVE-LEFT-checked, MOVE-RIGHT-checked":{$order:1,"background-color":"#cdcdcd"},"CMD-TOP":{$order:0,left:"50%","margin-left":"-15px",bottom:0,width:"30px",height:"4px",background:linb.UI.getCSSImgPara("icon.gif"," no-repeat left -52px",null,"linb.UI.Public")},"CMD-TOP-mouseover, CMD-BOTTOM-mouseover, CMD-LEFT-mouseover, CMD-RIGHT-mouseover":{$order:1,"background-color":"#ffff00"},"CMD-TOP-mouseover, CMD-BOTTOM-mouseover, CMD-LEFT-mouseover, CMD-RIGHT-mouseover":{$order:2,"background-color":"#ffff00"},"CMD-BOTTOM":{$order:0,left:"50%","margin-left":"-15px",top:0,width:"30px",height:"4px",background:linb.UI.getCSSImgPara("icon.gif"," no-repeat left -60px",null,"linb.UI.Public")},"CMD-LEFT":{$order:0,top:"50%","margin-top":"-15px",right:0,height:"30px",width:"4px",background:linb.UI.getCSSImgPara("icon.gif"," no-repeat -84px 0px",null,"linb.UI.Public")},"CMD-RIGHT":{$order:0,top:"50%","margin-top":"-15px",left:0,height:"30px",width:"4px",background:linb.UI.getCSSImgPara("icon.gif"," no-repeat -92px -0px",null,"linb.UI.Public")},"MOVE-MAIN":{$order:5,display:"none"},"CMD-MAIN":{$order:5,display:"none"}}},Behaviors:{"default":{_hoverEffect:{MOVE:"MOVE",CMD:"CMD"},onRewh:function(A,B,D){var C=A.root;A.box.resize(A,B.width?C.width():null,B.height?C.height():null)},MOVE:{onMousedown:function(G,K,A){var C=A.id,L=G.getSubSerialId(C),Q=G.getItemByDom(A);if(Q.hide){return }var H=G.getItemByItemId("main"),E=G.getSubNode("ITEM",L),F=G.getSubNodeByItemId("ITEM","main"),O=linb([A]).cursor(),P=G.properties,I,M,J,N,D,B;G.pos=Q.pos;if(P.type=="vertical"){I=G._cur=E.height();J=F.height();if(Q.pos=="before"){D=I-Q.min;B=Q.max?Math.min(parseInt(Q.max)-I,(J-H.min)):(J-H.min)}else{D=Q.max?Math.min(parseInt(Q.max)-I,(J-H.min)):(J-H.min);B=I-Q.min}linb([A]).startDrag(K,{type:"copy",move:false,target_clone:false,vertical:true,offset_top:D,offset_bottom:B,cursor:O})}else{M=G._cur=E.width();N=F.width();if(Q.pos=="before"){D=M-Q.min;B=Q.max?Math.min(parseInt(Q.max)-M,(N-H.min)):(N-H.min)}else{D=Q.max?Math.min(parseInt(Q.max)-M,(N-H.min)):(N-H.min);B=M-Q.min}linb([A]).startDrag(K,{type:"copy",move:false,target_clone:false,horizontal:true,offset_left:D,offset_right:B,cursor:O})}G._limited=0},onDrag:function(C,D,F){var B=C.properties,E=linb.dragDrop,A=0;if(B.type=="vertical"){if((E.y<=E.limit_top)||(E.y>=E.limit_bottom)){A=true}}else{if(E.x<=E.limit_left||E.x>=E.limit_right){A=true}}if(A){if(!C._limited){C._bg=E.proxyIn.getStyle("backgroundColor");E.proxyIn.setStyle("backgroundColor","#ff6600");C._limited=true}}else{if(C._limited){E.proxyIn.setStyle("backgroundColor",C._bg);C._limited=0}}},onDragstop:function(B,E,G){var A=B.properties,F=linb([G]).parent(),D=B.root,C=B.getItemByDom(G);if(A.type=="vertical"){F.height(C.size=B._cur+(B.pos=="before"?1:-1)*linb.dragDrop.getOffset().y);B.box.resize(B,null,D.height())}else{F.width(C.size=B._cur+(B.pos=="before"?1:-1)*linb.dragDrop.getOffset().x);B.box.resize(B,D.width(),null)}B._limited=0}},CMD:{onMousedown:function(H,J,C){var M=H.properties,D=C.id,N=linb([C]),K=H.getSubSerialId(D),L=H.getItemByDom(C),B=H.root,I=H.getItemByItemId("main"),G=H.getSubNodeByItemId("ITEM","main"),E=H.getSubNode("ITEM",K),A=H.getSubNode("PANEL",K),F=H.getSubNode("MOVE",K);if(M.type=="vertical"){if(L.hide){if(L.size<=G.height()-I.min+M._handlerSize){E.height(L.size);A.show();L.hide=false;if(L.pos=="before"){N.reClass(/bottom/g,"top")}else{N.reClass(/top/g,"bottom")}if(!L.locked){F.cursor("n-resize")}H.removeTagClass("MOVE","-checked")}else{linb.message("no enough space!")}}else{E.height(M._handlerSize);A.hide();L.hide=true;if(L.pos=="before"){N.reClass(/top/g,"bottom")}else{N.reClass(/bottom/g,"top")}if(!L.locked){F.cursor("default")}H.addTagClass("MOVE","-checked")}H.box.resize(H,null,B.height())}else{if(L.hide){if(L.size<=G.width()-I.min+M._handlerSize){E.width(L.size);A.show();L.hide=false;if(L.pos=="before"){N.reClass(/right/g,"left")}else{N.reClass(/left/g,"right")}if(!L.locked){F.cursor("w-resize")}H.removeTagClass("MOVE","-checked")}else{linb.message("no enough space!")}}else{E.width(M._handlerSize);A.hide();L.hide=true;if(L.pos=="before"){N.reClass(/left/g,"right")}else{N.reClass(/right/g,"left")}if(!L.locked){F.cursor("default")}H.addTagClass("MOVE","-checked")}H.box.resize(H,B.width(),null)}return false}}}},DataModel:{dataBinder:null,dataField:null,value:null,disabled:null,position:"absolute",type:{listbox:["vertical","horizontal"],ini:"vertical",action:function(E,F){if(E!=F){var C=this,A=C.getSubNode("ITEM",true),B=C.getSubNode("MOVE",true),G=C.getSubNode("CMD",true);B.add(A).add(G);if(E=="vertical"){B.reClass(/(-left)(\b)/ig,"-top$2");B.reClass(/(-right)(\b)/ig,"-bottom$2");A.each(function(H){linb(H).height(linb(H).width())}).left(0).right("auto").top("auto").bottom("auto")}else{B.reClass(/(-top)(\b)/ig,"-left$2");B.reClass(/(-bottom)(\b)/ig,"-right$2");A.each(function(H){linb(H).width(linb(H).height())}).top(0).bottom("auto").left("auto").right("auto")}var D=C.root.cssSize();C.box.resize(C,D.width,D.height)}}},dock:"fill",listKey:null,width:200,height:200,_handlerSize:6,items:{ini:{},set:function(A){return this.each(function(G){if(G.domNode){var E=G.boxing(),B=linb.dom.getMatix(),D=G.children.copy(),F;G.children.length=0;D.each(function(H){delete H[0].$dockParent;B.addLast(H[0].root)});E.clearItems();linb.dom.$gc();A=G.box.prepareDefaultValue(G,A);E.insertItems(A);D.each(function(H){E.attach.apply(E,H)});B.empty();var C=G.root.cssSize();G.box.resize(G,C.width,C.height)}else{G.properties.items=A}})}}},EventHandlers:{beforeValueSet:null,afterValueSet:null,beforeValueUpdated:null,afterValueUpdated:null,beforeHoverEffect:null,beforeClickEffect:null,beforeNextFocus:null},prepareDefaultValue:function(C,B){var A,D=[],E=[];B.each(function(F){if(F.id=="main"){A=F}else{if(F.pos=="before"){D.push(F)}else{E.push(F)}}});A=A||{};A.id="main";A.min=A.min||10;B.length=0;B.insertAny(D,0);B.insertAny(A);B.insertAny(E);B.each(function(F){F.id=_.isStr(F.id)?F.id:C.$id+":"+_.id();F.min=F.min||10;if(F.id!="main"){F.size=parseInt(F.size)||20;F.locked=_.bool(F.locked,false);F.hide=_.bool(F.hide,false);F.cmd=_.bool(F.cmd,true)}});return B},prepareData:function(A){var B=A.properties;if(!B.items||B.items.constructor!=Array){B.items=_.clone([{id:"before",pos:"before",locked:false,size:60,min:50,max:200},{id:"after",pos:"after",locked:false,size:60,min:50,max:200}])}A.properties.items=this.prepareDefaultValue(A,A.properties.items);arguments.callee.upper.call(this,A)},prepareItem:function(A,B){if(B.id=="main"){B.cls1=A.getClass("ITEM","-main");B.cls2=A.getClass("MOVE","-main");B.cls3=A.getClass("CMD","-main");return }if(A.properties.type=="vertical"){B.size="height:"+B.size+"px"}else{B.size="width:"+B.size+"px"}var C;if(A.properties.type=="vertical"){if(B.pos=="before"){C="top"}else{C="bottom"}}else{if(B.pos=="before"){C="left"}else{C="right"}}B.cls1=A.getClass("ITEM","-"+C);B.cls2=A.getClass("MOVE","-"+C);B.cls3=A.getClass("CMD","-"+C);B.display=B.locked?"display:none":"";B.cmdDisplay=B.cmd?"":"display:none"},createdTrigger:function(){var A,B=this;B.properties.items.each(function(C){if(C.id!="main"){if(C.hide&&(A=B.getSubSerialIdByItemId(C.id))){C.hide=false;B.getSubNode("CMD",A).onMousedown()}}})},resize:function(E,K,I){var N,O=E.properties,F,D,J,C,B,M,L=E.keys.ITEM,A=E.keys.PANEL;var H={},G={};O.items.each(function(P){J=E.getSubSerialIdByItemId(P.id);H[J]={};G[J]={}});if(O.type!="vertical"){if(!_.isNull(K)){M=C=B=0;O.items.each(function(P){if(P.id=="main"){return }J=E.getSubSerialIdByItemId(P.id);if(P.pos=="before"){D=E.getSubNode("ITEM",J);F=D.width();G[J].left=C;C+=F;G[J].right="auto";H[J].right="auto";H[J].left=0;H[J].width=F-(P.locked?0:O._handlerSize)}});O.items.each(function(P){if(P.id=="main"){return }J=E.getSubSerialIdByItemId(P.id);if(P.pos=="after"){D=E.getSubNode("ITEM",J);F=D.width();G[J].right=B;B+=F;G[J].left="auto";H[J].right=0;H[J].left="auto";H[J].width=F-(P.locked?0:O._handlerSize)}},null,true);M=C+B;if(K-M>=0){N=E.getSubSerialIdByItemId("main");H[N].width=K-M;G[N].width=K-M;G[N].left=C}}if(!_.isNull(I)){_.each(H,function(P,Q){P.height=I;G[Q].height=I})}}else{if(!_.isNull(I)){M=C=B=0;O.items.each(function(P){if(P.id=="main"){return }J=E.getSubSerialIdByItemId(P.id);if(P.pos=="before"){D=E.getSubNode("ITEM",J);F=D.height();G[J].top=C;C+=F;G[J].bottom="auto";H[J].top=0;H[J].bottom="auto";H[J].height=F-(P.locked?0:O._handlerSize)}});O.items.each(function(P){if(P.id=="main"){return }J=E.getSubSerialIdByItemId(P.id);if(P.pos=="after"){D=E.getSubNode("ITEM",J);F=D.height();G[J].bottom=B;B+=F;G[J].top="auto";H[J].bottom=0;H[J].top="auto";H[J].height=F-(P.locked?0:O._handlerSize)}},null,true);M=C+B;if(I-M>=0){N=E.getSubSerialIdByItemId("main");H[N].height=I-M;G[N].height=I-M;G[N].top=C}}if(!_.isNull(K)){_.each(H,function(P,Q){P.width=K;G[Q].width=K})}}_.each(H,function(P,Q){E.getSubNode("PANEL",Q).setRegion(P,true)});_.each(G,function(P,Q){E.getSubNode("ITEM",Q).setRegion(P)})}}});Class("linb.UI.TreeGrid","linb.UI.iWidget",{Instance:{_insertRowsToDom:function(C,F,E,B,I){if(E){var J=C.row_SerialIdMapItem[E];if(J&&!J._created){return }}var D,H,K=arguments.callee;var G=[],H=C.getSubNode("HCELL0").width();C.properties.header.each(function(L){G.push(C.getSubNode("HCELL",C.header_ItemIdMapSerialId[L.id]).width())});F.each(function(L){L.rowHandlerWidth=H-L._layer*C.properties.$subMargin;L.cells.each(function(M,N){M.width=G[N]})});var A=C.box.subBuild(C,"rows",F).toDom();if(!B){if(E){D=C.getSubNode("SUB",E)}else{D=C.getSubNode("BODY")}if(I){D.addFirst(A)}else{D.addLast(A)}}else{D=C.getSubNode("CELLS",B);if(I){D.addPre(A)}else{A.get().reverse();D.addNext(A)}}F.each(function(L){L.open=false},this);delete C.$allrowscache},refreshHeader:function(E){var C=this.get(0);C.properties.header=E;var D=C.properties.rows.copy();this.removeAllRows();var A=C.box.prepareHeader(C,E);var B=C.box.subBuild(C,"header",A).toDom();C.getSubNode("HCELL",true).remove();C.getSubNode("HCELLS").addLast(B);this.insertRows(D)},insertRows:function(D,C,A,I){var G=this.constructor,B=this.get(0),J=B.properties;C=B.row_ItemIdMapSerialId[C];A=B.row_ItemIdMapSerialId[A];var K=G.prepareItems(B,D,C);var E,H=B.row_SerialIdMapItem;if(!C){E=(J.rows||(J.rows=[]))}else{E=(H[C].sub||(H[C].sub=[]))}if(!A){E.insertAny(D,I?0:-1)}else{var F=E.subIndexOf("_serialId",A);E.insertAny(D,I?F:(F+1))}this._insertRowsToDom(B,K,C,A,I);if(!B.properties.iniFold){B.boxing().openRows(K,true)}return this},removeRows:function(D){var C=this.get(0),A=C.cells_SerialIdMapItem,B=[];D=_.isArr(D)?D:[D];D.each(function(J){if(!(J=C.row_ItemIdMapSerialId[J])){return }var I;if(I=C.row_SerialIdMapItem[J]){var G=I._cells,H=I.id,F;_.each(G,function(K){delete A[K].header._cells[H];delete A[K];C.cacheSubId(K._serialId,"cell")});if(F=I._pid?(F=C.row_SerialIdMapItem[I._pid])?F.sub:null:C.properties.row){F.filter(function(K){return K._serialId!=J})}delete C.row_ItemIdMapSerialId[H];delete C.row_SerialIdMapItem[J];C.cacheSubId(serialId,"row");B.push(C.getSubNode("CELLS",J));if(I.sub){var E=[];I.sub.each(function(K){E.push(K.id)});this.removeRows(E)}}},this);linb(B,false).remove();return this},removeAllRows:function(){var B=this.get(0);for(var A in B.cells_SerialIdMapItem){B.cacheSubId(A,"cell")}for(var A in B.row_SerialIdMapItem){B.cacheSubId(A,"row")}_.each(B.header_SerialIdMapItem,function(C){C._cells={}});B.row_SerialIdMapItem={};B.cells_SerialIdMapItem={};B.row_ItemIdMapSerialId={};B.properties.rows.length=0;B.getSubNode("BODY").empty();B.getSubNode("SCROLL").scrollTop(0).scrollLeft(0);return this},resetContent:function(){var A=this.get(0);_.each(A.$cache_editor,function(C,B){C.reBoxing().hide()});this.removeAllRows();return this},updateColumn:function(C,D){var E=this.get(0),B=E.header_SerialIdMapItem[E.header_ItemIdMapSerialId[C]];if(!B){return }var A=B._cells;_.each(D,function(G,F){E.cells_SerialIdMapItem[A[F]].value=G;E.getSubNode("CELLA",A[F]).html(G,false)})},updateCellbyRowCol:function(D,B,C){var A;if(A=this.constructor.getCellId(this.get(0),D,B)){this.constructor.changeCellValue(this.get(0),A,C)}return this},updateCell:function(B,A){this.constructor.changeCellValue(this.get(0),B,A);return this},openRows:function(B,A){if(B&&B.length){B.each(function(C){if(C.sub&&C.sub.length&&!C.iniFold&&!C._checked){this.openRow(C.id,A)}},this)}},openRow:function(D,A){var B=this.get(0),C=B.row_SerialIdMapItem[B.row_ItemIdMapSerialId[D]];if(C&&!C._checked){B.box.setSub(B,C,A)}},scrollTo:function(C){var B=this.get(0),A=B.getSubNode("SCROLL");C=C=="top"?0:C=="bottom"?A.scrollHeight():C;A.scrollTop(C)}},Initialize:function(){this.mapKeys(["ALT"]);var A=this.getBehavior("default");A.HCELLA={};A.HCELL0A={};A.CELLA.onKeydown=A.CELL0A.onKeydown=A.HCELLA.onKeydown=A.HCELL0A.onKeydown=function(D,I,B){var Q=linb.event.getKey(I),O=Q[0],C=Q[2],N=linb([B],false),F=D.root.nextFocus(true,true,false),M=D.root.nextFocus(false,true,false);switch(O){case"tab":if(C){if(B!=F.get(0)){F.focus();return false}}else{if(B!=M.get(0)){M.focus();return false}}break;case"left":var E=N.nextFocus(false,true,false);if(N.get(0)==F.get(0)){M.focus()}else{N.nextFocus(false)}return false;break;case"right":var E=N.nextFocus(true,false,false);if(N.get(0)==M.get(0)){F.focus()}else{N.nextFocus()}return false;break;case"up":case"down":var H=1,P=N.parent().get(0);var J=P.parentNode.childNodes.length;while(P=P.previousSibling){H++}P=N.parent(2).get(0);if(!D.$allrowscache){var K=[];K.push(D.getSubNode("HCELLS").get(0));K.insertAny(D.getSubNode("CELLS",true).get(),-1);K.filter(function(R){return !!R.offsetWidth});D.$allrowscache=K}var G=D.$allrowscache.indexOf(P);var L=D.$allrowscache.length;if(O=="up"){G--;if(G==-1){G=L-1;H--;if(H==0){H=J}}}else{G++;if(G==L){G=0;H++;if(H==J+1){H=1}}}node=linb(D.$allrowscache[G]).first().next(H-1).first();if(!node.isEmpty()){node.focus()}return false;break}};this.setBehavior("default",A)},Static:{$recursive:true,Templates:{"default":{tagName:"div",style:"{_style}",BORDER:{tagName:"div",BOX:{tagName:"div",HEADER:{$order:0,tagName:"div",HCELLS:{tagName:"div",style:"height:{headerHeight}px;",HCELL0:{$order:0,style:"{tdfDisplay};width:{rowHandlerWidth}px;",HCELL0A:{tagName:"a",href:"javascript:;",tabindex:"{tabindex}",HCELLHANDLER:{tagName:"div",style:"{thhandlerDisplay}"},ROWHANDLER:{tagName:"div",style:"{tdfhandlerDisplay}"}}},OTHERHCELLS:{$order:1,tagName:"text",text:"{header}"}}},SCROLL:{$order:1,tagName:"div",BODY:{tagName:"div",text:"{rows}"}},FOOTER:{$order:2}}},$dynamic:{header:{HCELL:{style:"width:{width}px",HCELLA:{tagName:"a",href:"javascript:;",tabindex:"{_tabindex}",text:"{caption}",SORT:{style:"{sortDisplay}"},HCELLHANDLER:{$order:2,tagName:"div",style:"{thhandlerDisplay}"}}}},rows:{ROW:{tagName:"div",className:"{cls}",CELLS:{tagName:"div",style:"height:{rowHeight}px;",CELL0:{$order:0,style:"{tdfDisplay};width:{rowHandlerWidth}px;",CELL0A:{tagName:"a",href:"javascript:;",tabindex:"{_tabindex}",MARK:{style:"{display}"},ROWHANDLER:{tagName:"div",style:"{tdfhandlerDisplay}"}}},OTHERCELLS:{tagName:"text",$order:1,text:"{cells}"}},SUB:{$order:1,tagName:"div"}}},"rows.cells":function(F,E,C,B,A){if(C.type=="checkbox"){var D=B+".checkbox"}else{var D=B+".input"}linb.UI.$doTemplate(F,E,C,D,A)},"rows.cells.input":{CELL:{style:"width:{width}px;",className:"{cellCls}",CELLA:{tagName:"a",href:"javascript:;",tabindex:"{_tabindex}",text:"{caption}"}}},"rows.cells.checkbox":{CELL:{style:"width:{width}px;",className:"{cellCls}",CELLA:{tagName:"a",href:"javascript:;",tabindex:"{_tabindex}",CHECKBOX:{className:"{checkboxCls}"}}}},MARK:{}}}},Appearances:{"default":{KEY:{display:"block",position:"absolute"},BOX:{display:"block",position:"relative",overflow:"hidden"},HEADER:{position:"absolute",left:0,top:0},SCROLL:{position:"absolute",left:0,overflow:"auto"},BODY:{position:"absolute",display:"block",left:0,top:0,overflow:"visible"},"SORT, SORT-checked":{width:"15px",height:"15px",position:"absolute",right:"0px",bottom:"0px"},SORT:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -191px top",null,"linb.UI.Public")},"HCELL-mouseover SORT":{$order:1,"background-position":"-191px -15px"},"HCELL-mousedown SORT":{$order:2,"background-position":"-191px -30px"},"SORT-checked":{$order:3,"background-position":"-206px top"},"HCELL-mouseover SORT-checked":{$order:4,"background-position":"-206px -15px"},"HCELL-mousedown SORT-checked":{$order:5,"background-position":"-206px -30px"},HCELLHANDLER:{position:"absolute",width:"4px",top:"0px",height:"100%",right:"0px",cursor:"e-resize","font-size":0,"line-height":0,background:linb.UI.getCSSImgPara("handler.v.gif")},"HCELLS, CELLS":{"overflow-y":linb.browser.ie6?"hidden":"",position:linb.browser.ie6||linb.browser.opr?"relative":null,"white-space":"nowrap","padding-bottom":"2px","font-size":0,"line-height":0,display:"block"},"CELLS-mouseover CELL":{$order:4,"background-color":"#d9e8fb"},"CELLS-active CELL, CELL-active":{$order:5,"background-color":"#316AC5"},"CELLS-active CELLA, CELL-active CELLA":{$order:5,color:"white"},"HCELL0, CELL0":{"background-color":"#d4d0c8",height:"100%",border:"1px solid","border-color":"#fff #ACA899 #ACA899 #fff",padding:0},"HCELL0A, CELL0A":{"-moz-box-flex":linb.browser.gek?"1":"",display:"block",position:"relative",overflow:"hidden",height:"100%","font-weight":"bold","font-size":"12px","line-height":"20px"},CELL0A:{"text-align":"left"}," TDFCAPTION":{"font-weight":"bold"},ROWHANDLER:{position:"absolute",height:"4px",left:"0px",width:"100%",bottom:"0px",cursor:"n-resize",background:linb.UI.getCSSImgPara("handler.h.gif"),"font-size":0,"line-height":0},HCELL:{"background-color":" #d4d0c8",height:"100%",border:"1px solid","border-color":"#fff #ACA899 #ACA899 #fff",padding:0},ROW:{_position:"relative","font-size":0,"line-height":0,"background-color":" #fff"},CELL:{"padding-top":"1px","padding-left":"1px","border-bottom":"1px solid #ACA899","border-right":"1px solid #ACA899",height:"100%",overflow:linb.browser.ie6?"hidden":""},"ALT > CELLS":{"background-color":"#f1f1f1"},"CELL-label":{"background-color":"#F3F3F3"},"CELL-input":{},"CELL-number":{"text-align":"right"},"CELL-checkbox":{"text-align":"center"},HCELLA:{position:"relative"},"HCELLA, CELLA":{display:"block",overflow:"hidden","-moz-box-flex":linb.browser.gek?"1":"",height:"100%",width:linb.browser.ie?"100%":"","font-size":"12px","line-height":"20px"},"HCELLA, HCELL0A":{"text-align":"center","font-weight":"bold"},CHECKBOX:{cursor:"pointer",width:"16px",height:"16px",background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -112px top",null,"linb.UI.Public")},"CELL-mouseover CHECKBOX":{$order:1,"background-position":"-112px -17px"},"CELL-mousedown CHECKBOX":{$order:2,"background-position":"-112px -34px"},"CHECKBOX-checked":{$order:3,"background-position":"-96px top"},"CELL-mouseover CHECKBOX-checked":{$order:4,"background-position":"-96px -17px"},"CELL-mousedown CHECKBOX-checked":{$order:5,"background-position":"-96px -34px"},SUB:{_zoom:"1",_position:"relative","margin-left":"16px","font-size":"12px","line-height":"20px",overflow:"hidden",display:"none"},MARK:{width:"16px",height:"16px",background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -161px top",null,"linb.UI.Public")},"CELL0-mouseover MARK":{$order:1,"background-position":"-161px -15px"},"CELL0-mousedown MARK":{$order:2,"background-position":"-161px -30px"},"MARK-checked":{$order:3,width:"16px",height:"16px","background-position":"-176px top"},"CELL0-mouseover MARK-checked":{$order:4,"background-position":"-176px -15px"},"CELL0-mousedown MARK-checked":{$order:5,"background-position":"-176px -30px"},"CELLS-dragover":{"border-top":"solid 2px #ff6600"},"HCELL-dragover":{$order:3,"border-left":"solid 2px #ff6600"}}},Behaviors:{"default":{_hoverEffect:{CELLS:"CELLS",CELL:"CELL",CELL0:"CELL0",HCELL:"HCELL"},_clickEffect:{CELL:"CELL",CELL0:"CELL0",HCELL:"HCELL"},onRewh:function(A,B,D){var C=A.root;A.box.resize(A,B.width?C.width():null,C.height?C.height():null)},SCROLL:{onScroll:function(A,B,C){var D=linb(C).scrollLeft();if(A.oldPos!=D){A.getSubNode("HEADER").left(-D);A.oldPos=D}}},HCELLHANDLER:{onMousedown:function(G,I,A){var D=G.properties,E=linb(A),H=E.parent(2).width()-D.minColW,J=G.getSubNode("SCROLL"),C=J.absPos().left+J.width()-linb.event.getPos(I).left-4,B=G.getSubSerialId(A.id),F=G.header_SerialIdMapItem[B];if(D.disabled){return false}if(F&&F.disabled){return false}E.startDrag(I,{horizontal:true,type:"blank",offset_left:H,offset_right:C,move:false})},onDragbegin:function(A,B,C){linb.dragDrop.proxyIn.setStyle({height:A.root.height()+"px",width:"4px",backgroundColor:"#ddd",cursor:"e-resize"})},onDrag:function(B,C,E){var D=linb.dragDrop,A=0;if(D.x<=D.limit_left||D.x>=D.limit_right){A=true}if(A){if(!B._limited){linb.dragDrop.proxyIn.setStyle("backgroundColor","#ff6600");B._limited=true}}else{if(B._limited){linb.dragDrop.proxyIn.setStyle("backgroundColor","#ddd");B._limited=0}}},onDragstop:function(F,G,A){var E=linb(A).parent(2),I=E.width()+linb.dragDrop.getOffset().x;E.width(I);var B=[],H=[];if(A.parentNode.id.startWith(F.keys.HCELL0A)){var C=F.row_SerialIdMapItem,D=F.properties;_.each(F.row_ItemIdMapSerialId,function(K){B.push(F.getSubNodeId(F.keys.CELL0,K));H.push(I-C[K]._layer*D.$subMargin)});B.each(function(L,K){linb(L).width(H[K])})}else{var J=F.header_SerialIdMapItem[F.getSubSerialId(A.id)]._cells;_.each(J,function(K){B.push(F.getSubNodeId(F.keys.CELL,K))});linb(B).width(I)}F.getSubNode("SCROLL").onScroll();F._limited=0}},ROWHANDLER:{onMousedown:function(D,E,A){var B=D.properties,H=D.row_SerialIdMapItem[D.getSubSerialId(A.id)],C=linb(A),I=C.parent(3).height()-B.minRowH,G=D.getSubNode("SCROLL"),F=G.absPos().top+G.height()-linb.event.getPos(E).top-4;if(B.disabled||(H&&H.disabled)){return false}C.startDrag(E,{vertical:true,type:"blank",offset_top:I,offset_bottom:F,move:false})},onDragbegin:function(A,B,C){linb.dragDrop.proxyIn.setStyle({width:A.root.width()+"px",height:"4px",backgroundColor:"#ddd",cursor:"n-resize"})},onDrag:function(B,C,E){var D=linb.dragDrop,A=0;if(D.y<=D.limit_top||D.y>=D.limit_bottom){A=true}if(A){if(!B._limited){linb.dragDrop.proxyIn.setStyle("backgroundColor","#ff6600");B._limited=true}}else{if(B._limited){linb.dragDrop.proxyIn.setStyle("backgroundColor","#ddd");B._limited=0}}},onDragstop:function(B,C,E){var D=linb(E).parent(3),A=D.height()+linb.dragDrop.getOffset().y;if(linb.browser.ie&&A%2==1){A+=1}D.height(A);if(E.parentNode.id.startWith(B.keys.HCELL0A)){B.box.resize(B,null,B.root.height())}B._limited=0}},MARK:{onClick:function(A,C,E){var B=A.properties,D=A.row_SerialIdMapItem[A.getSubSerialId(E.id)];if(B.disabled||D.disabled){return false}if(!D.sub){return false}A.box.setSub(A,D);return false}},HCELL0:{onClick:function(A,B,C){linb(C).first().focus();return false}},HCELL:{onClick:function(F,I,A){var C=F.properties,B=F.getSubSerialId(A.id),D=F.header_SerialIdMapItem[B];linb(A).first().focus();if(!C.colSortable||false===D.colSortable){return false}if(C.disabled||D.disabled){return false}var G=D._order||false,L=D.type||"input",H=C.header.indexOf(D),K=arguments.callee,J=K.fun||(K.fun=function(Q,W,S,U,R){var e,X,Z=arguments.callee;if(W){e=W.sub;X=Q.getSubNode("SUB",W._serialId).get(0)}else{W={_created:true};e=Q.properties.rows;X=Q.getSubNode("BODY").get(0)}var P=[],N=[],M=[],d=[];e.each(function(b){if(b.sub&&b.sub.length>1){Z(Q,b,S,U,R)}P[P.length]=b.cells[S].value;N[N.length]=N.length});switch(U){case"number":N.sort(!R?function(b,c){b=parseFloat(P[b])||0;c=parseFloat(P[c])||0;return b>c?1:b==c?0:-1}:function(b,c){b=parseFloat(P[b])||0;c=parseFloat(P[c])||0;return b<c?1:b==c?0:-1});break;case"date":N.sort(!R?function(b,c){b=Date.parse(new Date(P[b]));c=Date.parse(new Date(P[c]));return b>c?1:b==c?0:-1}:function(b,c){b=Date.parse(new Date(P[b]));c=Date.parse(new Date(P[c]));return b<c?1:b==c?0:-1});break;default:N.sort(!R?function(b,c){b=P[b];c=P[c];return b>c?1:b==c?0:-1}:function(b,c){b=P[b];c=P[c];return b<c?1:b==c?0:-1})}var V=W._created,Y=_.copy(e),T;if(V){P=X.childNodes}N.each(function(c,b){e[b]=Y[c];if(V){M[b]=P[c]}});if(V){M.each(function(c,b){X.appendChild(c);if(b%2){d[d.length]=c}});if(Q.properties.altRowsBg){var O=Q.getClass("ALT");linb(M,false).removeClass(O);linb(d,false).addClass(O)}}});J(F,"",H,L,G);F.getSubNode("SORT",true).display("none");var E=F.getSubNode("SORT",D._serialId).display("block");if(D._order=!D._order){F.addTagClass("SORT","-checked",E)}else{F.removeTagClass("SORT","-checked",E)}delete F.$allrowscache;return false},onMousedown:function(A,B,E){if(!A.properties.colDragable||false===A.header_SerialIdMapItem[A.getSubSerialId(E.id)].colDragable){return }if(false===A.boxing().beforeColumnDrag(A,A.getSubSerialId(E.id))){return }var F=linb.event.getPos(B),D=linb([E],false),C=A.getSubSerialId(E.id);D.startDrag(B,{drop2:true,type:"copy",cursor:"pointer",target_clone:true,target_left:F.left+12,target_top:F.top+12,move:false,defer:1,key:(A.properties.colDragKey||A.$id)+":col",data:D.id()})},onDragbegin:function(A,B,C){linb(C).onMouseout(true,{$force:true}).onMouseup(true)},beforeMouseover:function(A,B,C){if(false===A.box._colDragCheck(A,C)){return }linb.dragDrop._current=this;A.addTagClass("HCELL","-dragover",linb([C]))},beforeMouseout:function(A,B,C){if(false===A.box._colDragCheck(A,C)){return }linb.dragDrop._current=null;A.removeTagClass("HCELL","-dragover",linb(C))},onDrop:function(F,J,A){if(false===F.box._colDragCheck(F,A)){return }var D=F.properties,I=linb.dragDrop.data&&F.getSubSerialId(linb.dragDrop.data),E=F.getSubSerialId(A.id);if(false===F.boxing().beforeColumnMoved(F,I,E)){return }F.removeTagClass("HCELL","-dragover",linb(A));var K=D.header.subIndexOf("_serialId",I),G=D.header.subIndexOf("_serialId",E);if(K===G||K===G-1){return }var B=F.header_SerialIdMapItem,H=B[I],C=B[E];F.getSubNode("HCELL",E).addPre(linb.dragDrop.data);_.each(C._cells,function(O,N){F.getSubNode("CELL",O).addPre(F.getSubNode("CELL",H._cells[N]))});var M=D.header[K];D.header.removeFrom(K);D.header.insertAny(M,G);var L=F.itemsSearch(D.rows,true,true);L.each(function(N){M=N.cells[K];N.cells.removeFrom(K);N.cells.insertAny(M,G)});F.boxing().afterColumnMoved(F,I,E);delete F.$allrowscache}},CELL0:{onClick:function(B,D,F){var C=B.properties,A=B.getSubSerialId(F.id),E=B.row_SerialIdMapItem[A];if(C.disabled||E.disabled){return false}if(E.sub){B.getSubNode("MARK",A).onClick(true)}linb(F).first().focus();return false},onMousedown:function(D,F,A){var B=D.properties,E=D.getSubSerialId(A.id),I=D.row_SerialIdMapItem[E],G=I._layer;if(B.disabled||I.disabled){return false}if(!B.rowDragable||I.rowDragable===false){return }if(false===D.boxing().beforeRowDrag(D,I)){return }var H=linb.event.getPos(F),C=linb([A],false).parent(2);linb([A],false).startDrag(F,{drop2:true,type:"copy",cursor:"pointer",target_clone:true,target_left:H.left+12,target_top:H.top+12,move:false,defer:1,key:(B.rowDragKey||D.$id)+":row"+(B.rowDragToAny?"":(":"+G)),data:C.id()})},onDragbegin:function(A,B,C){linb(C).onMouseout(true,{$force:true}).onMouseup(true)},beforeMouseover:function(A,B,C){if(false===A.box._rowDragCheck(A,C)){return }linb.dragDrop._current=this;linb.dragDrop.showDDMark(C)},beforeMouseout:function(A,B,C){if(false===A.box._rowDragCheck(A,C)){return }linb.dragDrop._current=null;linb.dragDrop.showDDMark(null)},onDrop:function(A,B,C){if(false===A.box._rowDragCheck(A,C)){return }linb.dragDrop.showDDMark(null);A.box._rowDrop(A,C,true);return false}},CELL0A:{onFocus:function(A,B,C){if(A.properties.activeMode=="row"){var C=A.getSubNode("CELLS",A.getSubSerialId(C.id)).get(0);if(A.$activeRow==C.id){return true}A.box.activeRow(A,C.id)}}},CELLS:{beforeMouseover:function(A,B,C){if(false===A.box._rowDragCheck(A,C)){return }linb.dragDrop._current=this;A.addTagClass("CELLS","-dragover",linb([C]))},beforeMouseout:function(A,B,C){if(false===A.box._rowDragCheck(A,C)){return }linb.dragDrop._current=null;A.removeTagClass("CELLS","-dragover",linb(C))},onDrop:function(A,B,C){if(false===A.box._rowDragCheck(A,C)){return }A.removeTagClass("CELLS","-dragover",linb(C));A.box._rowDrop(A,C);return false},onClick:function(B,D,F){var C=B.properties,A=B.getSubSerialId(F.id),E=B.row_SerialIdMapItem[A];if(C.disabled||E.disabled){return false}B.box.activeRow(B,F.id);return false},onDblclick:function(B,D,F){var C=B.properties,A=B.getSubSerialId(F.id),E=B.row_SerialIdMapItem[A];if(C.disabled||E.disabled){return false}if(B.onDblClickRow){B.boxing().onDblClickRow(B,E,D,F)}return false}},CELL:{onClick:function(B,D,E){var A=B.cells_SerialIdMapItem[B.getSubSerialId(E.id)],C=B.box;linb(E).first().focus();if(C.getCellPro(B,A,"disabled")){return false}if(C.getCellPro(B,A,"editable")){if(C.getCellPro(B,A,"type")=="checkbox"){C.changeCellValue(B,A,!A.value)}}return false}},CELLA:{onFocus:function(B,E,G){var D=B.properties,C=B.box,A=B.cells_SerialIdMapItem[B.getSubSerialId(G.id)],F=D.activeMode,H;if(F=="cell"){if(C.getCellPro(B,A,"disabled")){return false}H=linb(G).parent().id();C.activeCell(B,H)}else{if(F=="row"){if(D.disabled||A._row.disabled){return false}H=linb(G).parent(2).id();C.activeRow(B,H)}}if(C.getCellPro(B,A,"editable")){C.editCell(B,A._serialId)}}}}},DataModel:{listKey:null,tabindex:{action:function(A){if(this.domNode){this.root.dig("A").tabIndex(A)}}},dock:"fill",rowDragKey:"",rowDragToAny:true,colDragKey:"",altRowsBg:{ini:true,action:function(A){if(this.domNode){}}},editable:true,$subMargin:16,iniFold:true,left:0,top:0,position:"absolute",width:300,height:200,minColW:5,minRowH:20,rowHandlerWidth:20,headerHeight:{ini:20,action:function(A){this.getSubNode("HCELLS").height(A);this.box.resize(this,this.root.width(),this.root.height())}},rowHeight:{ini:20,action:function(A){this.getSubNode("CELLS",true).height(A)}},cellDfWidth:80,colResizer:{ini:true,action:function(A){this.getSubNode("HCELLHANDLER",true).display(A?"":"none")}},rowHandler:{ini:true,action:function(A){this.getSubNode("HCELL0").display(A?"":"none");this.getSubNode("CELL0",true).display(A?"":"none")}},rowResizer:{ini:true,action:function(A){this.getSubNode("ROWHANDLER",true).display(A?"":"none")}},colSortable:{ini:true,action:function(A){this.getSubNode("SORT",true).display("none")}},header:{ini:{},set:function(A){return this.each(function(B){if(B.domNode){B.boxing().refreshHeader(A)}else{B.properties.header=A}})}},rows:{ini:{},set:function(A){return this.each(function(B){if(B.domNode){B.boxing().removeAllRows().insertRows(A)}else{B.properties.rows=A}})}},colDragable:true,rowDragable:true,activeMode:{ini:"row",listbox:["row","cell"],action:function(B){if(this.domNode){var A=this;if(A.$activeCell){A.removeTagClass("CELL","-active",linb(A.$activeCell))}if(A.$activeRow){A.removeTagClass("CELLS","-active",linb(A.$activeRow))}}}}},EventHandlers:{onRequestData:function(A,B,C){},beforeColumnSort:function(B,C,A){},afterColumnSort:function(B,C,A){},beforeRowDrag:function(A,B){},beforeRowMoved:function(C,B,A){},afterRowMoved:function(C,B,A){},beforeColumnDrag:function(A,B){},beforeColumnMoved:function(C,B,A){},afterColumnMoved:function(C,B,A){},beforeRowActive:function(A,B){},afterRowActive:function(A,B){},beforeCellActive:function(B,A){},afterCellActive:function(B,A){},onDblClickRow:function(A,D,B,C){}},createdTrigger:function(){if(!this.properties.iniFold){this.boxing().openRows(this.properties.rows,true)}},iniProfile:function(){this.$cache_editor={}},beforeSerialized:function(B){var A,C=B.copy();C.properties=_.copy(B.properties);C.properties.header=linb.UI.pickObj(B.properties.header);C.properties.rows=linb.UI.pickObj(B.properties.rows);return C},_clsCache:{},_resetRowHandler:function(D,F,E,C,G){var B=arguments.callee,A=E-G*C;F._layer=G;D.getSubNode("CELL0",F._serialId).width(A);if(F.sub){++G;_.each(F.sub,function(H){B(D,H,E,C,G)})}},_colDragCheck:function(F,H){var A=linb.dragDrop,E=A.dragKey,G=A.data;if(!E||!G){return false}var C=(F.properties.colDragKey||F.$id)+":col";if(E!=C){return false}if(F.getKey(G)!=F.keys.HCELL){return false}var D=linb.dragDrop.data&&F.getSubSerialId(G),B=F.getSubSerialId(H.id);if(D==B){return }},_rowDragCheck:function(D,A){var K=linb.dragDrop,J=K.dragKey,F=K.data;if(!J||!F){return false}var I=(D.properties.rowDragKey||D.$id)+":row"+(D.properties.rowDragToAny?"":(":"+H));if(J!=I){return false}if(D.getKey(F)!=D.keys.ROW){return false}var E=linb.dragDrop.data&&D.getSubSerialId(F),B=D.getSubSerialId(A.id),L=D.row_SerialIdMapItem[B],H=L._layer;if(E==B){return false}var C=A,G=linb.dom.byId(F);do{if(C==G){return false}}while((C&&(C=C.parentNode)&&C!=D.domNode))},_rowDrop:function(E,A,K){var B=E.row_SerialIdMapItem,H=linb.dragDrop.data&&E.getSubSerialId(linb.dragDrop.data),D=B[H],C=E.getSubSerialId(A.id),O=B[C],L=K?O._layer+1:O._layer;if(false===E.boxing().beforeRowMoved(E,H,C,K)){return }var N,J,G,I=D._pid,F=I?B[I].sub:E.properties.rows,M=F.subIndexOf("_serialId",H);if(K){N=O._serialId,J;if(O.sub){J=O.sub}else{J=O.sub=[];E.getSubNode("MARK",O._serialId).display("block")}G=-1}else{N=O._pid;J=N?B[N].sub:E.properties.rows;G=J.subIndexOf("_serialId",C)}if(N==I&&(G==M||G==M+1)){return }if(K&&!O._created){E.box.setSub(E,O,true);O._created=true}if(E.properties.rowHandler){if(N!==I){D._pid=N;E.box._resetRowHandler(E,D,E.getSubNode("HCELL0").width(),E.properties.$subMargin,L||0)}}F.removeFrom(M);J.insertAny(D,G);if(K){E.getSubNode("SUB",C).addLast(linb.dragDrop.data)}else{E.getSubNode("ROW",C).addPre(linb.dragDrop.data)}E.boxing().afterRowMoved(E,H,C,K);delete E.$allrowscache},prepareData:function(A){A.row_ItemIdMapSerialId={};A.row_SerialIdMapItem={};A.cells_SerialIdMapItem={};var B=A.data,C=A.properties;B.thhandlerDisplay=C.colResizer?"":"display:none";B.tdfhandlerDisplay=C.rowResizer?"":"display:none";B.tdfDisplay=C.rowHandler?"":"display:none";if(C.header&&C.header.constructor!=Array){C.header=_.clone([{id:"col1",caption:"col1",type:"input",width:50},{id:"col2",caption:"col2",type:"input",width:80}])}if(C.rows&&C.rows.constructor!=Array){C.rows=_.clone([{id:"row1",cells:["cell11","cell12"]},{id:"row2",cells:[{value:"cell21",type:"label"},"cell22"],sub:[{id:"row21",cells:["cell31",{value:"cell32",type:"number"}]}]}])}B.header=this.prepareHeader(A,C.header);arguments.callee.upper.call(this,A);B.rows=this.prepareItems(A,C.rows)},prepareHeader:function(B,D){var F=B.header_ItemIdMapSerialId={},E=B.header_SerialIdMapItem={},A=linb.UI.subSerialIdTag,G=B.properties,C=[],H,I;D.each(function(K,J){H=B.pickSubId("header");K._cells={};K[A]=H;E[H]=K;I={width:K.width||G.cellDfWidth,sortDisplay:"display:none",tdfDisplay:G.rowHandler?"":"display:none"};I[A]=H;I._tabindex=G.tabindex;I.thhandlerDisplay=G.colResizer?"":"display:none";linb.UI.copyItem(K,I);F[K.id]=H;C.push(I)});return C},prepareItems:function(C,A,L){var H=C.properties,V=C.row_ItemIdMapSerialId,U=C.row_SerialIdMapItem,R=C.cells_SerialIdMapItem,K=L?U[L]?(U[L]._layer+1):0:0,E=linb.UI.subSerialIdTag,T=C.box.getCellPro,M=arguments.callee,I=[],B=C.getClass("ALT"),Q,D,J,G,S,F,N,W;for(var P=0,O=A.length;P<O;P++){Q=C.pickSubId("row");G=A[P];G._pid=L;G._cells={};G._layer=K;G[E]=Q;G._tabindex=H.tabindex;U[Q]=G;J={id:G.id};J.rowHeight=H.rowHeight;J.rowHandlerWidth=H.rowHandlerWidth;J.tdfDisplay=H.rowHandler?"":"display:none";J.tdfhandlerDisplay=H.rowResizer?"":"display:none";if(H.altRowsBg){J.cls=P%2?B:""}D=J.cells=[];J[E]=Q;J.display=G.sub?"":"display:none";V[G.id]=Q;G.cells.each(function(Y,X){F=H.header[X];N={width:F.width};if(typeof Y=="object"){linb.UI.copyItem(Y,N)}else{N.value=Y;Y=G.cells[X]={value:Y}}Y._row=G;Y._header=F;N.type=T(C,Y,"type")||"input";W=T(C,Y,"render");N.caption=W?W(N.value):N.value;Y[E]=N[E]=C.pickSubId("cell");N.cellCls=this._clsCache[N.type]||(this._clsCache[N.type]=C.getClass("CELL","-"+N.type));switch(N.type){case"checkbox":N.checkboxCls=this._clsCache[N.type+":"+N.value]||(this._clsCache[N.type+":"+N.value]=C.getClass("CHECKBOX",N.value?"-checked":""));break}N._tabindex=H.tabindex;D.push(N);R[N[E]]=Y;G._cells[F.id]=N[E];F._cells[G.id]=N[E]},this);linb.UI.copyItem(G,J);I.push(J)}return I},setSub:function(E,L,I){var B=E.domId,K=E.keys.MARK,J=E.keys.SUB,F=E.row_ItemIdMapSerialId[L.id],G=E.getSubNode("MARK",F),C=E.getSubNode("SUB",F);if(linb.thread.exists(E.key+E.id)){return }if(L._checked){var H=C.height();C.fx({height:[H,0]},function(){C.height(H)},function(){C.display("none").height("auto")},200,8,"inexp",E.key+E.id).start();E.removeTagClass("MARK","-checked",G);L._checked=false}else{var D=function(Q,W,N,S,P,M,V){var O=Q.properties;if(!W._created){delete W.sub;W._created=true;P.display("none");Q.boxing().insertRows(M,W.id)}if(!V){var U=P.height(true);P.fx({height:[0,U]},function(){P.setStyle({height:"0px",display:"block"})},function(){P.setStyle({height:"auto"})},200,8,"outexp",Q.key+Q.id).start()}else{P.display("block")}if(O.rowHandler){var T=Q.getSubNode("HCELL0").width(),R=(W._layer+2)*O.$subMargin;if(T<R){Q.getSubNode("HCELL0").width(R);Q.getSubNode("CELL0",true).widthBy(R-T)}}Q.addTagClass("MARK","-checked",S).addTagClass("MARK","-mouseover",S);W._checked=true};var A=L.sub;if(A&&A.length){D(E,L,B,G,C,A,I);if(I){A.each(function(M){if(M.sub&&M.sub.length&&!M.iniFold&&!M._checked){E.box.setSub(E,M,true)}})}}else{linb.thread(null,[function(M){if(E.onRequestData){E.boxing().onRequestData(E,L,M)}else{linb.thread(M).abort()}},function(M){A=linb.thread(M).getCache("response");if(A){D(E,L,B,G,C,A,I);D=null}}],null,null,function(M){E.addTagClass("MARK","-busy",G);linb(B).busy(false)},function(){E.removeTagClass("MARK","-busy",G);linb(B).free()}).start()}}delete E.$allrowscache},getCellId:function(B,D,C){var A=B.row_ItemIdMapSerialId[D],E=B.row_SerialIdMapItem[A];return E&&E._cells&&E._cells[C]},changeCellValue:function(D,F,E){var A;if(typeof F=="string"){A=D.cells_SerialIdMapItem[F]}else{A=F;F=A._serialId}if(!A){return }var C=D.box.getCellPro(D,A,"type")||"input",B=D.box.getCellPro(D,A,"render");if(A.value!=E){if(false===D.boxing().beforeValueUpdated(D,A,A.value,E)){return }switch(C){case"checkbox":if(E){D.addTagClass("CHECKBOX","-checked",D.getSubNode("CHECKBOX",F))}else{D.removeTagClass("CHECKBOX","-checked",D.getSubNode("CHECKBOX",F))}break;case"number":E=parseFloat(E);case"listbox":case"timepicker":case"datepicker":case"colorpicker":default:D.getSubNode("CELLA",F).text(B?B(E):E)}A.value=E;D.boxing().afterValueUpdated(D,A,A.value,E)}},activeCell:function(C,E){if(C.properties.activeMode!="cell"){return }var B=C.getSubSerialId(E),D=C.cells_SerialIdMapItem,A=D[B];if(false===C.boxing().beforeCellActive(C,A)){return }if(C.$activeCell){C.removeTagClass("CELL","-active",linb(C.$activeCell))}C.addTagClass("CELL","-active",linb(E));C.$activeCell=E;C.boxing().afterCellActive(C,A)},activeRow:function(C,E){if(C.properties.activeMode!="row"){return }var A=C.getSubSerialId(E),D=C.row_SerialIdMapItem,B=D[A];if(false===C.boxing().beforeRowActive(C,B)){return }if(C.$activeRow){C.removeTagClass("CELLS","-active",linb(C.$activeRow))}C.addTagClass("CELLS","-active",linb(E));C.$activeRow=E;C.boxing().afterRowActive(C,B)},getCellPro:function(C,A,B){return A[B]||A._row[B]||A._header[B]||C.properties[B]},editCellbyRowCol:function(A,C,B){return this.editCell(A,this.getCellId(A,C,B))},editCell:function(E,C){var K=typeof C=="string"?E.cells_SerialIdMapItem[C]:C;if(!K){return }var A=this;var F=E.getSubNode("CELL",C),D=E.getSubNode("SCROLL"),B=F.absPos(null,D),M=F.cssSize(),H=E.box.getCellPro(E,K,"type")||"input",J=E.box.getCellPro(E,K,"format"),G,L;if(H=="checkbox"){F.first().focus();return }if(E.$cache_editor[H]){G=E.$cache_editor[H]}else{switch(H.split(":")[0]){case"label":return ;break;case"number":case"input":case"textarea":linb.SC("linb.UI.Input");break;case"checkbox":break;case"listbox":case"combobox":case"popbox":case"getter":case"helpinput":case"cmdbox":case"popbox":case"timepicker":case"datepicker":case"colorpicker":linb.SC("linb.UI.ComboInput");break;case"button":linb.SC("linb.UI.Button");break;default:}switch(H.split(":")[0]){case"label":return ;break;case"number":case"input":G=linb.create("Input");break;case"textarea":G=linb.create("Input",{inputArea:"textarea"});break;case"listbox":case"combobox":case"helpinput":case"timepicker":case"datepicker":case"colorpicker":G=new linb.UI.ComboInput;G.setType(H);G.create();break;case"getter":case"popbox":case"cmdbox":case"popbox":G=new linb.UI.ComboInput;G.setType(H).onClickButton(function(O){var N=O.$cell;if(typeof N.event=="function"){N.event.call(E._host||E,E,N,O)}});G.create();break;case"checkbox":break;case"button":G=linb.create("Button",{caption:"..."},{onClick:function(O){var N=O.$cell;if(typeof N.event=="function"){N.event.call(E._host||E,E,N,O)}}});break;default:}G.reBoxing().setStyle({position:"absolute",display:"none"});D.attach(G);E.$cache_editor[H]=G}G.get(0).$cell=K;if(K.items){G.setItems(K.items)}if(L=E.box.getCellPro(E,K,"listKey")){G.setListKey(L)}G.setValue(K.value,true);if(K.$tag){if(G.setCaption){G.setCaption(K.$tag)}else{if(G.setValue){G.setValue(K.$tag)}}}var I=function(){if(G){G.updateUIValue(G.getCtrlValue());G.beforeValueUpdated(null).beforeNextFocus(null);if(G.onFormatCheck){G.onFormatCheck(null)}if(G.setValueFormat){G.setValueFormat("")}G.setValue("",true);G.reBoxing().hide();G=null}};G.beforeValueUpdated(function(P,O,N){A.changeCellValue(E,C,N)}).beforeNextFocus(function(R,O,N,Q){I();var P=linb.event.getEventPara(Q);if(P.keyCode=="enter"){P.keyCode="down"}E.getSubNode("CELLA",K._serialId).onKeydown(true,P);return false});if(J){if(typeof J=="function"){if(G.onFormatCheck){G.onFormatCheck(J)}}else{if(G.setValueFormat){G.setValueFormat(J)}}L=E.box.getCellPro(E,K,"tipsErr");if(L&&G.setTipsErr){G.setTipsErr(L)}}G.reBoxing().setBlurTrigger(G.get(0).$id,function(){I();return false});if(H=="textarea"){G.reBoxing().width(200).height(100).popToTop(F,D,4)}else{G.reBoxing().width(M.width+3).height(M.height+3).setStyle({display:"block"});G.reBoxing().show((B.left-1)+"px",(B.top-1)+"px")}_.asyRun(function(){if(G){G.activate()}})},showTips:function(A,C,E){var D=C.id;if(A.properties.disabled){return }if(A.getKey(D)!=A.keys.CELLA){return }var B=A.cells_SerialIdMapItem[A.getSubSerialId(D)];if(B&&B.value){linb.UI.Tips.show(E,{tips:B.value});return true}else{return false}},resize:function(D,A,C){D.getSubNode("BORDER").cssSize({width:A,height:C});var B;if(C){B=D.getSubNode("HEADER").realHeight()}D.getSubNode("BOX").cssSize({width:A?A:null,height:C?C:null});D.getSubNode("SCROLL").setRegion({top:B?B:null,width:A?A:null,height:C?(C-B):null}).onScroll()}}});Class("linb.UI.Dialog",["linb.UI.Widget","linb.UI.iContainer"],{Instance:{html:function(A){this.get(0).getSubNode("PANEL").html(A)},show:function(A,B,D,C){A=A||linb(document.body);return this.each(function(H){if(H.$show){return }var G,I=H.properties,E=H.boxing(),F=function(){H.$show=true;A.attach(H.boxing());var K=H.root.topZindex(),J=H.root.zIndex();H.root.zIndex(K>J?K:J).show(D?(parseInt(D)||0)+"px":null,C?(parseInt(C)||0)+"px":null);if(B&&!H.$inModal){H.box.modal(H)}H.box.active(H);H.root.nextFocus()};if(G=I.fromRegion){linb.dom.fxProxy(G,I,null,F,240,8,"inexp").start()}else{F()}})},hide:function(){this.each(function(B){delete B.$show;if(B.$inModal){B.box.unModal(B)}if(B.properties.status=="max"||B.properties.status=="min"){B.box.restore(B)}B.root.hide();var A=B.properties.fromRegion;if(A){linb.dom.fxProxy(B.properties,A,null,null,240,8,"outexp").start()}});return this},close:function(){return this.each(function(C){if(C.beforeClose&&false===C.boxing().beforeClose(C)){return }var B=C.properties.fromRegion,A=function(){C.boxing().destroy()};if(B){linb.dom.fxProxy(C.properties,B,null,A,240,8,"outexp").start()}else{A()}})},removePanel:function(){this.destroy()},getPanelPara:function(){return _.copy(this.get(0).properties)},getPanelChildren:function(){return this.get(0).children}},Initialize:function(){var A=this.getTemplate("default");_.merge(A.FRAME.BORDER,{TITLE:{tagName:"div",style:"height:{_titleHeight}px;",ICON:{$order:0},CAPTION:{$order:1,text:"{caption}"},CMDS:{$order:2,OPT:{style:"{optDisplay}",$order:0},MIN:{$order:1,style:"{minDisplay}"},RESTORE:{$order:2,style:"display:none;"},MAX:{$order:3,style:"{maxDisplay}"},CLOSE:{$order:4,style:"{closeDisplay}"},PIN:{$order:5,style:"{pinDisplay}"},LAND:{$order:6,style:"{landDisplay}"}}},PANEL:{tagName:"div",$order:2,text:linb.UI.$childTag},STATUS:{tagName:"div",$order:3}},"all");this.setTemplate("default",A)},Static:{Dropable:["PANEL"],Dragable:["LAND"],Appearances:{"default":{BORDER:{"border-left":"solid 1px #EEE","border-top":0,"border-right":"solid 1px #BBB","border-bottom":"solid 1px #BBB","background-color":"#F3F3F3"},PANEL:{position:"absolute",left:0,overflow:"auto"},STATUS:{position:"absolute",left:0,bottom:0,height:0,"*font-size":0,"*line-height":0},TITLE:{position:"absolute",left:0,top:0,height:0,"white-space":"nowrap",background:linb.UI.getCSSImgPara("barvbg.gif"," repeat-x left top",null,"linb.UI.Public"),"*font-size":0,"*line-height":0},"TITLE-focus":{$order:1,"background-position":"right -22px"},ICON:{height:"16px",width:"16px",margin:"4px 0 0 4px"},CAPTION:{margin:"4px 0 0 4px",color:"#555","font-weight":"bold","font-size":"12px"},CMDS:{position:"absolute",top:0,right:0,"text-align":"right","vertical-align":"middle",background:linb.UI.getCSSImgPara("barvbg.gif"," repeat-x left top",null,"linb.UI.Public"),height:"100%",cursor:"default"},"CMDS-focus":{$order:1,"background-position":"right -22px"},"CMDS span":{position:"relative",margin:"4px 4px 2px 0",width:"15px",height:"15px","vertical-align":"middle",cursor:"default"},OPT:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat -240px top",null,"linb.UI.Public")},"OPT-mouseover":{$order:2,"background-position":"-240px -16px"},"OPT-mousedown":{$order:3,"background-position":"-240px -32px"},MIN:{background:linb.UI.getCSSImgPara("cmds.gif"," -16px 0",null,"linb.UI.Public"),$order:0},"MIN-mouseover":{$order:1,"background-position":" -16px -16px"},"MIN-mousedown":{$order:2,"background-position":"-16px -32px"},RESTORE:{background:linb.UI.getCSSImgPara("cmds.gif"," -32px 0",null,"linb.UI.Public")},"RESTORE-mouseover":{$order:1,"background-position":"-32px -16px"},"RESTORE-mousedown":{$order:2,"background-position":"-32px -32px"},MAX:{background:linb.UI.getCSSImgPara("cmds.gif"," -48px 0",null,"linb.UI.Public")},"MAX-mouseover":{$order:1,"background-position":"-48px -16px"},"MAX-mousedown":{$order:2,"background-position":"-48px -32px"},PIN:{background:linb.UI.getCSSImgPara("cmds.gif"," 0 0",null,"linb.UI.Public")},"PIN-mouseover":{$order:1,"background-position":"0 -16px"},"PIN-mousedown":{$order:2,"background-position":" 0 -32px"},"PIN-checked, PIN-checked-mouseover":{$order:2,"background-position":"0 -32px"},CLOSE:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat  -64px 0",null,"linb.UI.Public")},"CLOSE-mouseover":{$order:1,"background-position":"-64px -16px"},"CLOSE-mousedown":{$order:2,"background-position":"-64px -32px"},LAND:{background:linb.UI.getCSSImgPara("cmds.gif"," no-repeat  -80px 0",null,"linb.UI.Public")},"LAND-mouseover":{$order:1,"background-position":"-80px -16px"},"LAND-mousedown":{$order:2,"background-position":"-80px -32px"}}},Behaviors:{"default":{_hoverEffect:{OPT:"OPT",PIN:"PIN",MIN:"MIN",MAX:"MAX",RESTORE:"RESTORE",CLOSE:"CLOSE",LAND:"LAND"},_clickEffect:{OPT:"OPT",PIN:"PIN",MIN:"MIN",MAX:"MAX",RESTORE:"RESTORE",CLOSE:"CLOSE",LAND:"LAND"},onMousedown:function(A,B){A.box.active(A)},onDragstop:function(A){var C=A.root.cssPos(),B=A.properties;B.left=C.left;B.top=C.top},TITLE:{onMousedown:function(A,C,D){if(A.getKey(linb.event.getSrc(C).parentNode.id)==A.keys.CMDS){return }if(A.properties.movable&&!A._locked){A.box.active(A);var B={defer:1,target_parent:A.root.parent()};if(A.properties.dragKey){B.data={data:[A.$id],domId:D.id}}A.root.startDrag(C,B)}},onDblclick:function(A,B,C){if(A.getKey(linb.event.getSrc(B).parentNode.id)==A.keys.CMDS){return }if(!A.properties.maxBtn){return }if(A.properties.status=="max"){A.box.restore(A)}else{A.box.max(A)}}},PIN:{onClick:function(C,D,E){var B=C.keys.PIN,A=C.properties;A.pinned=!A.pinned;if(A.pinned){C.addTagClass("PIN","-checked",null,true)}else{C.removeTagClass("PIN","-checked")}C._locked=A.pinned;if(A.resizable){if(!A.pinned){if(A.status!="min"&&C.$resizer){C.$resizer.show()}}else{if(C.$resizer){C.$resizer.hide()}}}}},MIN:{onClick:function(A,B,C){A.box.min(A)}},MAX:{onClick:function(A,B,C){A.box.max(A)}},RESTORE:{onClick:function(A,B,C){A.box.restore(A)}},OPT:{onClick:function(A,B,C){A.boxing().onTriggerOption(A,B,C)}},CLOSE:{onClick:function(A,B,C){A.boxing().close()}}}},DataModel:{$border:1,value:null,tips:null,dataField:null,dataBinder:null,border:null,disabled:null,dock:{hidden:true},shadow:true,resizable:true,movable:true,minBtn:{ini:true,action:function(A){var B=this.getSubNode("MIN");if(A){B.inlineBlock()}else{B.display("none")}}},maxBtn:{ini:true,action:function(A){var B=this.getSubNode("MAX");if(A){B.inlineBlock()}else{B.display("none")}}},optBtn:{ini:false,action:function(A){this.getSubNode("OPT").display(A?"":"none")}},closeBtn:{ini:true,action:function(A){var B=this.getSubNode("CLOSE");if(A){B.inlineBlock()}else{B.display("none")}}},pinBtn:{ini:true,action:function(A){var B=this.getSubNode("PIN");if(A){B.inlineBlock()}else{B.display("none")}}},landBtn:{ini:false,action:function(A){var B=this.getSubNode("LAND");if(A){B.inlineBlock()}else{B.display("none")}}},width:300,height:300,minWidth:200,minHeight:100,_titleHeight:22,position:"absolute",fromRegion:{hidden:true,ini:null},status:{ini:"normal",listbox:["normal","min","max"],action:function(C,D){var B=this,A=B.box;if(C=="min"){A.min(B,D)}else{if(C=="max"){A.max(B,D)}else{A.restore(B,D)}}}}},EventHandlers:{beforeValueSet:null,afterValueSet:null,beforeValueUpdated:null,afterValueUpdated:null,beforeHoverEffect:null,beforeClickEffect:null,beforeNextFocus:null,beforeClose:function(A){},onTriggerOption:function(A,B,C){}},createdTrigger:function(){this.destroyTrigger=function(){var A=this;if(A.$inModal){A.box.unModal(A)}}},renderedTrigger:function(){var B=this,C=B.properties,A=B.box;if(C.status=="min"){A.min(B)}else{if(C.status=="max"){A.max(B)}else{A.resize(B,C.width,C.height)}}},prepareData:function(C){arguments.callee.upper.call(this,C);var D=C.data,B="display:none";D.minDisplay=D.minBtn?"":B;D.maxDisplay=D.maxBtn?"":B;D.optDisplay=D.optBtn?"":B;D.closeDisplay=D.closeBtn?"":B;D.pinDisplay=D.pinBtn?"":B;D.landDisplay=D.landBtn?"":B;D.iconDisplay=D.icon?"":B;var A=C.properties.status;if(A=="min"||A=="max"){C.$noR=C.$noS=1}},min:function(C,D){var B=C.boxing().reBoxing(),F=C.box,A=B.parent(),I=C.properties;if((D||I.status)=="max"){F.unMax(C)}else{F.refreshRegion(C)}C.getSubNodes(["PANEL","STATUS"]).display("none");if(I.minBtn){C.getSubNode("RESTORE").inlineBlock();C.getSubNode("MIN").display("none")}if(I.resizable&&C.$resizer){C.$resizer.hide()}if(I.shadow){C.boxing()._unShadow(false)}I.status="min";var H=B.height(),G=C.getSubNode("BORDER").height(),E=C.getSubNode("TITLE").height();B.cssSize({width:I.minWidth,height:E+H-G},true)},max:function(C,B){var E=C.boxing().reBoxing(),D=E.parent(),A=C.properties;if((B||A.status)=="min"){C.box.unMin(C)}else{C.box.refreshRegion(C)}if(A.pinBtn){C.getSubNode("PIN").display("none")}if(A.maxBtn){C.getSubNode("MAX").display("none");C.getSubNode("RESTORE").inlineBlock()}C.old_m=A.movable;A.movable=false;if(A.resizable&&C.$resizer){C.$resizer.hide()}if(A.shadow){C.boxing()._unShadow(false)}A.status="max";C.boxing().setDock("fill")},restore:function(C,B){var D=C.boxing().reBoxing();var A=C.properties;if((B||A.status)=="max"){C.box.unMax(C)}if((B||A.status)=="min"){C.box.unMin(C)}C.getSubNode("RESTORE").display("none");A.status="normal"},unMax:function(B){var A=B.properties;B.getSubNode("MAX").inlineBlock();if(A.pinBtn){B.getSubNode("PIN").inlineBlock()}A.movable=B.old_m;if(A.shadow){B.boxing()._shadow()}if(A.resizable&&!A.pinned&&B.$resizer){B.$resizer.show()}B.boxing().setDock("none");B.box.resize(B,A.width,A.height)},unMin:function(B){var A=B.properties;B.getSubNodes(["PANEL","STATUS"]).display("block");B.getSubNode("MIN").inlineBlock();if(A.shadow){B.boxing()._shadow()}if(A.resizable&&!A.pinned&&B.$resizer){B.$resizer.show()}B.root.cssSize({width:A.width,height:A.height});B.box.resize(B,A.width,A.height)},active:function(C){var A=this;if(A.activeWndId==C.$id){return }A.deActive();var E=linb(A.activeWndId=C.domId),D=E.topZindex(),B=E.zIndex();E.zIndex(D>B?D:B);C.addTagClass("TITLE","-focus");C.addTagClass("CMDS","-focus");A.activeWndId=C.$id},deActive:function(A){var A;if(A=linb.UI._cache[this.activeWndId]){A.removeTagClass("TITLE","-focus");A.removeTagClass("CMDS","-focus")}delete this.activeWndId},modal:function(C){var L=C.root,J,A=L.parent(),K;if(!A.isEmpty()){if(!C.$inModal){if(!C.$modalDiv){C.$modalDiv=new linb.UI.Div({position:"absolute"}).setCustomAppearance({KEY:"overflow:hidden;display:block;z-index:0;cursor:wait;background-image:url("+linb.ini.path+"bg.gif)"})}K=C.$modalDiv;A.attach(K);K.setDock("cover",true);K=K.reBoxing();K.display("block").onMousedown(function(){return false}).topZindex(true);L.zIndex((parseInt(K.zIndex())||0)+1);var E={},I=C.root.dig("*",function(M){return M.tabIndex>0}).get();for(var F=0,B;B=I[F++];){(E[B.tabIndex]=E[B.tabIndex]||[]).push(B);B.tabIndex=-1}var G=C.$focusHash={},H=linb([document.body]).dig("*",function(M){return M.tabIndex>0}).get();for(var F=0,B;B=H[F++];){(G[B.tabIndex]=G[B.tabIndex]||[]).push(B);B.tabIndex=-1}for(var F in E){G=E[F];for(var D in G){G[D].tabIndex=F}}linb.event.focusHook.push([C.domNode,function(){linb([C.domNode]).nextFocus()}]);C.$inModal=true}}},unModal:function(D){if(D.$inModal){D.$modalDiv.setDock("none");D.getSubNode("BORDER").addLast(D.$modalDiv.reBoxing().display("none"));D.$inModal=false;var E=D.$focusHash,C;for(var B in E){C=E[B];for(var A in C){C[A].tabIndex=B}}_.breakO(D.$focusHash,2);linb.event.focusHook.pop()}},refreshRegion:function(A){if(!A.root){return }return _.merge(A.properties,A.root.getRegion(),"all")},_adjust:function(E,B,H){B=B||"";if(!H){H=B;B=""}var G=E.$div.reBoxing(),A="linb:temp:dialog",F=arguments.callee;if(!linb.dom.byId(A)){D=F._cache=G.clone(false);linb([document.body]).addLast(D);D.setStyle({width:"auto",height:"auto",overflow:"visible",position:"absolute",visibility:"visible",left:linb.dom.hide_value}).id(A,true)}var D=F._cache;D.html(H,false);var C=D.cssSize();G.html(H);if(C.width>500){C.width=500;G.width(500);C.height=G.offsetHeight()+10}if(C.height>400){C.height=400}if(C.width<100){C.width=100}if(C.height<30){C.height=30}G.cssSize(C).overflow("auto").show();E.setCaption(B).setWidth(C.width+30).setHeight(C.height+80);E.$cmd.reBoxing().left((C.width+30-E.$cmd.reBoxing().width())/2)},alert:function(B,F,A){var E=arguments.callee,D=E.dialog;E.onOK=A;if(!D){D=E.dialog=new linb.UI.Dialog({caption:B||"Alert",minBtn:false,maxBtn:false,pinBtn:false,resizable:false,left:200,top:200},{beforeClose:function(){D.$div.reBoxing().html("",false);D.hide();_.tryF(E.onOK);E.onOK=null;return false}});linb.SC("linb.UI.Button");var G=new linb.UI.Div({bottom:10,width:60,height:24,CA:{KEY:"overflow:visible"}});D.$cmd=G;var C=new linb.UI.Button({caption:"OK",width:60,tabindex:1},{onClick:function(){D.$div.reBoxing().html("",false);D.hide();_.tryF(A)}});G.attach(C);D.$btn=C;var H=new linb.UI.Div({left:10,top:10,CA:{KEY:"overflow:visible"}});D.$div=H;D.attach(G).attach(H).create()}this._adjust(D,B,F);D.show(linb([document.body]),true);_.asyRun(function(){D.$btn.activate()})},confirm:function(H,D,G,I){var F=arguments.callee,E=F.dialog;F.onYes=G,F.onNo=I;if(!E){E=F.dialog=new linb.UI.Dialog({caption:H||"Alert",minBtn:false,maxBtn:false,pinBtn:false,resizable:false,left:200,top:200},{beforeClose:function(){E.$div.reBoxing().html("",false);E.hide();_.tryF(F.onNo);F.onNo=null;return false}});linb.SC("linb.UI.Button");var C=new linb.UI.Div({bottom:10,width:140,height:24});E.$cmd=C;var B=new linb.UI.Button({caption:"Yes",width:60,tabindex:1,left:0},{onClick:function(){E.$div.reBoxing().html("",false);_.tryF(F.onYes);F.onYes=null;E.hide()}});C.attach(B);B=new linb.UI.Button({caption:"No",tabindex:1,width:60,left:80},{onClick:function(){E.$div.reBoxing().html("",false);_.tryF(F.onNo);F.onNo=null;E.hide()}});C.attach(B);E.$btn=B;var A=new linb.UI.Div({left:10,top:10}).setCustomAppearance({KEY:"overflow:visible"});E.$div=A;E.attach(C).attach(A).create()}this._adjust(E,H,D);E.show(linb([document.body]),true);_.asyRun(function(){E.$btn.activate()})},pop:function(J,F,E,C,I){var H=arguments.callee,G=H.dialog;if(!G){G=new linb.UI.Dialog({caption:J||"Alert",minBtn:false,maxBtn:false,pinBtn:false,resizable:false,left:200,top:200});linb.SC("linb.UI.Button");var D=new linb.UI.Div({bottom:10,width:60,height:24});G.$cmd=D;var B=new linb.UI.Button({caption:E||"OK",tabindex:1,width:60},{onClick:function(){G.destroy()}});D.attach(B);G.$btn=B;var A=new linb.UI.Div({left:10,top:10}).setCustomAppearance({KEY:"overflow:visible"});G.$div=A;G.attach(D).attach(A).create()}this._adjust(G,J,F);G.show(linb([document.body]),false,C,I);_.asyRun(function(){G.$btn.activate()});return G},prompt:function(A){},resize:function(A,K,C){var L=arguments.callee.upper.apply(this,arguments),G={},J=A.getSubNode("TITLE"),I=A.getSubNode("PANEL"),H=A.getSubNode("STATUS"),B,F,E,D;if(C){B=L.height,E=J.height(),D=H.height();G.top=E;if(B-E-D>0){G.height=B-E-D}}if(K){F=L.width;G.width=F}I.setRegion(G,true);if(F){J.add(H).width(F)}}}});Class("linb.UI.TextEditor",["linb.UI.Widget","linb.UI.iForm"],{Instance:{activate:function(){var A=this.get(0);A.getSubNode("INPUT").focus();return this},setCtrlValue:function(A){if(_.isNull(A)||!_.exists(A)){A=""}return this.each(function(C){var D=C.getSubNode("INPUT").get(0);if(D.value.replace(/(\r\n|\r)/g,"\n")!=A.replace(/(\r\n|\r)/g,"\n")){var B=D.scrollTop;D.value=A;D.scrollTop=B}})},getCtrlValue:function(B){var A=this.get(0);return A.getSubNode("INPUT").value().replace(/(\r\n|\r)/g,"\n").replace(/( +)(\n)/g,"$2").replace(/\t/g,"    ")},prepareMaps:function(){return this.each(function(A){A._maps=A._maps||{}})},setTempMaps:function(A){return this.each(function(B){B._maps2=A||{}})},disabled:function(A){arguments.callee.upper.call(this,A);return this.each(function(B){B.getSubNode("INPUT").disabled(A)})},readonly:function(A){return this.each(function(B){B.getSubNode("INPUT").readonly(A).background(A?"#F4F4F4":"")})}},Initialize:function(){var A=this.getTemplate("default");_.merge(A.FRAME.BORDER,{BOX:{tagName:"div",INPUT:{tagName:"textarea",tabindex:"{tabindex}"}},BAK1:{},BAK2:{tagName:"div"}},"all");this.setTemplate("default",A)},Static:{Appearances:{"default":{KEY:{overflow:"hidden"},BOX:{display:"block",position:"absolute",width:"100%",height:"100%",left:0,top:0,overflow:linb.browser.gek?"auto":""},INPUT:{"font-family":"Courier New, Courier, monospace","font-size":"12px",position:"relative",left:0,top:0,border:0,margin:0,padding:0,overflow:"auto","overflow-y":(linb.browser.gek||linb.browser.ie)?"auto":"","overflow-x":(linb.browser.gek||linb.browser.ie)?"hidden":""},"BAK1, BAK2":{"font-family":"Courier New, Courier, monospace","font-size":"12px",position:"absolute",visibility:"hidden",left:"-10000px",top:"-10000px"}}},Behaviors:{"default":{INPUT:{onChange:function(A,B,C){A.boxing().updateUIValue(C.value)},afterKeydown:function(E,F,G){if(E.properties.disabled||E.properties.readonly){return }if(E.$change){delete E.$change}var D=linb.event.getKey(F),B=D[0];switch(B){case"tab":E.box.insertAtCaret(E,"    ");E.$pos=E.box.getParas(E)[0];return false;case"enter":var C=E.box.getParas(E);str=C[1];var A=str.length-str.ltrim().length;if(str.charAt(str.length-1)=="{"){A+=4}if(A){E.box.insertAtCaret(E,((linb.browser.ie||linb.browser.opr)?"\r\n":"\n")+" ".repeat(A));E.$enter=true;return false}break;default:if(E.tips){E.tips.destroy();E.tips=null}}},afterKeypress:function(C,F,A){if(C.properties.disabled||C.properties.readonly){return }var K=linb.event.getKey(F),D=K[0];var H=arguments.callee,B=H.map||(H.map={space:1,enter:1,backspace:1,tab:1,"delete":1});if(D.length==1||B[D]){C.$change=true}switch(D){case"tab":if(linb.browser.opr){_.asyRun(function(){C.box.setCaretTo(A,C.$pos)})}return false;case"enter":if(C.$enter){delete C.$enter;return false}case"}":if(K[2]){var M=C.box.getParas(C);var E=M[0],G=M[1],I=M[2],J=M[3];if(/ {4}$/.test(G)){var L=linb(A).scrollTop();J.value=J.value.substr(0,E).replace(/ {4}$/,"}")+J.value.substr(E,J.value.length);linb(J).onChange();C.box.setCaretTo(J,E-4+1,L);return false}}break}},afterKeyup:function(C,F,G){var B=linb.event.getKey(F),A=B[0];var D=arguments.callee,E=D.map||(D.map={space:1,enter:1,backspace:1,tab:1,"delete":1});if(A.length==1||E[A]){C.$change=true}if(C.$change){delete C.$change;if(C.onKeyPress){C.boxing().onKeyPress(C,F,G)}}}}}},DataModel:{icon:null,iconPos:null,tabindex:{action:function(A){if(this.domNode){this.getSubNode("INPUT").tabIndex(A)}}},left:0,top:0,width:200,height:200,position:"absolute",readonly:{ini:false,action:function(A){this.boxing().readonly(A)}}},EventHandlers:{onKeyPress:function(A,B,C){}},createdTrigger:function(){if(this.properties.readonly){this.boxing().readonly(true)}},resize:function(D,A,C){var B=arguments.callee.upper.apply(this,arguments);D.getSubNode("BOX").cssSize(B);D.getSubNode("INPUT").cssSize(B)},insertAtCaret:function(D,G){var H,A,C=D.getSubNode("INPUT"),E;E=C.scrollTop()||null;C.onChange();C=C.get(0);if(linb.browser.ie){linb(C).focus();var B=document.selection.createRange();if(B.parentElement()!=C){return false}B.text="";var F=linb.UI.getCaretPos(C);C.value=C.value.substr(0,F[0])+G+C.value.substr(F[0],C.value.length);H=F[0]}else{H=C.selectionStart;A=C.selectionEnd;C.value=C.value.substr(0,H)+G+C.value.substr(A,C.value.length)}if(H!=null){this.setCaretTo(C,H+G.length,E)}else{C.value+=G}},setCaretTo:function(H,G,B){linb(H).focus();var I,F,C,A=linb(H);if(_.isNumb(B)){A.scrollTop(B)}if(B===true){if(A.tagName().toLowerCase()=="textarea"&&A.scrollHeight()!==A.offsetHeight()){I=A.value().substr(0,G);F=A.clone().id("").setStyle({visibility:"hidden",position:"absolute",left:5000+"px"}).value(I);linb([document.body],false).addLast(F);C=Math.max((F.scrollHeight()>F.offsetHeight())?F.scrollHeight()-30:0,0);A.scrollTop(C);F.remove()}}if(linb.browser.ie){G=H.value.substr(0,G).replace(/\r\n/g,"\n").length;var D=H.createTextRange();D.move("character",G);D.select()}else{try{H.setSelectionRange(G,G)}catch(E){}}},getParas:function(F){var C=F.getSubNode("INPUT"),J=arguments.callee,D=J.reg||(J.reg=/\r\n/g);v=C.get(0).value;loc=linb.UI.getCaretPos(C.get(0));if(loc[0]<0){loc[0]=0}var H=0,G=v.substr(0,loc[0]).match(D);if(G){H=G.length}v=v.replace(D,"\n");var I=v.substr(0,loc[0]-H);var P=I.lastIndexOf("\n"),Q=I.substr(P+1,loc[0]-P),O=C.clientWidth(),B=F.getSubNode("BAK1"),A=F.getSubNode("BAK2");if(I.charAt(I.length-1)=="\n"){I+="*"}A.width(O);var N=B.html(Q.replace(/ /g,"&nbsp;"),false).width(),M=A.html(I.replace(/\n/g,"<br />"),false).height()-C.scrollTop();if(N>O){A.html(Q,false);var L=Q;var E=A.height();while(L){L=L.replace(/ [^ ]*$/,"");A.html(L,false);if(A.height()!=E){break}}L=Q.substr(L.length,Q.length-L.length);N=B.html(L,true).width()}B.html("",false);A.html("",false);var K=F.root.absPos();K.left+=N;K.top+=M;return[loc[0],Q,K,C.get(0),I]}}});Class("linb.UI.Calendar","linb.UI.DatePicker",{Instance:{},Initialize:function(){var J=this,R=linb.event.eventhandler,G=linb.event.eventhandler2,K=linb.UI.$ID,A=linb.UI.$CLS,W=J.KEY;J.mapKeys(["H","W","D","TD"]);var H='<colgroup><col width="2%"/><col width="14%"/><col width="14%"/><col width="14%"/><col width="14%"/><col width="14%"/><col width="14%"/><col width="14%"/></colgroup>',C='<thead><tr height="1%"><th id="'+W+"-H:"+K+':7" class="'+A+'-h #H_CC#"></th>',B="</tr></thead>",F='<th id="'+W+"-H:"+K+':@" class="'+A+'-h #H_CC#">@</th>',O="<tbody>",M="</tbody>",V="<tr>",T="</tr>",E='<th id="'+W+"-W:"+K+':@"  class="'+A+'-w #W_CC#">@</th>',D='<td id="'+W+"-TD:"+K+':@" class="'+A+'-td #TD_CC#"  unselectable="on" onclick="'+R+'" ><div id="'+W+"-D:"+K+':@" class="'+A+'-d #D_CC#" unselectable="on" onmouseover="'+G+'" onmouseout="'+G+'" ondrop="'+G+'" ></div></td>',I,Q,P,N,L,U=[],S=[];for(Q=0;Q<7;Q++){S[S.length]=F.replace(/@/g,Q)}N=L=0;for(Q=0;Q<48;Q++){P=Q%8;U[U.length]=(P==0?V:"")+(P==0?E:D).replace(/@/g,P==0?L:N)+(P===7?T:"");if(P!==0){N++}else{L++}}I=H+C+S.join("")+B+O+U.join("")+M;J.setTemplate("default",{tagName:"div",style:"{_style}",onselectstart:"return false",BORDER:{tagName:"div",BODY:{$order:1,tagName:"table",cellpadding:"0",cellspacing:"0",width:"100%",text:I}}})},Static:{Dropable:["D"],Behaviors:{"default":{_hoverEffect:{},_clickEffect:{},onRewh:function(C,E,G){var F=C.domNode.style,D=parseInt,H=null,A=H,B=H;if(E.height){B=D(F.height)||H}if(E.width){A=D(F.width)||H}if(B||A){C.box.resize(C,A,B)}}}},DataModel:{handleHeight:null,tipsHeight:null,closeBtn:null,dock:"fill",dropKeys:"iEvent",$borderW:1},_getDayNodes:function(A){return A.$day||(A.$day=A.getSubNode("D",true))},Appearances:{"default":{D:{position:"relative"}}},EventHandlers:{},prepareData:function(A){linb.UI.iWidget.prepareData.call(this,A)},resize:function(D,A,C){var F=D.properties,E=function(H){return D.getSubNode(H)},G=2*F.$borderW,B;if(C&&C!=F.height){E("BORDER").height(B=C-G);E("BODY").height(B);B=B-F.headHeight-6;D.box._getDayNodes(D).height(B/6)}}}});Class("linb.UI.IFrame",["linb.UI.iWidget","linb.UI.iMisc"],{Instance:{_start:false,submit:function(F,E,C,G,D){var B=this,A=function(){B.get(0)._start=true;E=_.hash(E);G=_.str(G,"get").toUpperCase();F=_.str(F);var L=B.get(0),K=[];_.each(E,function(N,M){K.push('<textarea id="'+M+'" name="'+M+'">'+(typeof N=="object"?_.serialize(N):N)+"</textarea>")});var H='<form target="'+B.get(0).domId+'" action="'+F+'" method="'+G+'">'+K.join("")+"</form>";var J=L._form=H.toDom(false);linb.dom.getMatix().addLast(J);_.each(C,function(N,M){N.get(0).id=M;N.get(0).name=M;J.addLast(N)});var I=J.get(0);if(D){if(I.encoding){I.encoding="multipart/form-data"}I.enctype="multipart/form-data"}if(linb.browser.ie6){linb.temp.cancelBeforeload=true}I.submit();L._time=_.asyRun(function(){B.clear();B.onTimeout(L)},L.properties.timeout)};if(linb.browser.opr){_.asyRun(A,10)}else{A()}},clear:function(){var A=this.get(0);A._start=false;if(A._form){A._form.remove()}clearTimeout(A._time)}},Initialize:function(){},Static:{cssNone:true,Templates:{"default":{style:"{_style}",frameborder:"0",marginheight:"0",marginwidth:"0",tagName:"iFrame",name:"{name}",src:"{src}"}},Behaviors:{"default":{onLoad:function(B){if(!B._start){return }var A=B.box.getBody(B.domNode).innerHTML;B.boxing().clear();if(B.onResponse){if(linb.browser.opr){A=A.replace(/&quot;/g,'"')}B.boxing().onResponse(B,A)}}}},Appearances:{"default":{}},DataModel:{timeout:30000,width:100,height:100,src:{ini:"about:blank",action:function(A){if(this.domNode){this.root.src(A)}}}},EventHandlers:{onResponse:function(B,A){},onTimeout:function(A){}},prepareData:function(A){arguments.callee.upper.apply(this,arguments);var B=A.data;B.name=A.key+":"+linb.UI.$ID+":"},getBody:function(A){return(A.contentWindow||A).document.body}}});var _img_app=linb.getPath("img/","app.gif");var _img_widgets=linb.getPath("img/","widgets.gif");CONF={dftLang:"en",img_app:_img_app,img_widgets:_img_widgets,phpPath:linb.ini.appPath+"request.php",prjPath:"projects/",requestKey:"VisualJS",path_link:"http://www.linb.net",path_video:"http://linb.googlecode.com/files/video.html",path_forum:"http://groups.google.com/group/linb",path_download:"http://code.google.com/p/linb/downloads/list",path_gpllicence:"http://www.gnu.org/licenses/gpl-3.0.txt",path_licence:"license.txt",path_purchase:"http://linb.googlecode.com/files/purchase.html",mapWidgets:{},widgets:[{id:"linb.UI.iForm",caption:"Form Elements",group:true,icon:_img_app,iconPos:"-48px -48px",sub:[{id:"linb.UI.Tag",caption:"Tag Element",icon:_img_widgets,iconPos:"left top",dragable:true},{id:"linb.UI.Div",caption:"Div Element",icon:_img_widgets,iconPos:"-624px top",dragable:true},{id:"linb.UI.Label",caption:"Label",icon:_img_widgets,iconPos:"-16px top",dragable:true},{id:"linb.UI.Link",caption:"Link",icon:_img_widgets,iconPos:"-32px top",dragable:true},{id:"linb.UI.Button",caption:"Button",icon:_img_widgets,iconPos:"-48px top",dragable:true,Appearances:["default","link","block"],Behaviors:["dblclick"]},{id:"linb.UI.CheckBox",caption:"CheckBox",icon:_img_widgets,iconPos:"-96px top",dragable:true},{id:"linb.UI.Input",caption:"Input",icon:_img_widgets,iconPos:"-112px top",dragable:true},{id:"linb.UI.TextEditor",caption:"TextEditor",icon:_img_widgets,iconPos:"-128px top",dragable:true},{id:"linb.UI.List",caption:"List",icon:_img_widgets,iconPos:"-192px top",dragable:true},{id:"linb.UI.ComboInput",caption:"ComboInput",icon:_img_widgets,iconPos:"-144px top",dragable:true},{id:"linb.UI.ProgressBar",caption:"ProgressBar",icon:_img_widgets,iconPos:"-608px top",dragable:true},{id:"linb.UI.Range",caption:"Range",icon:_img_widgets,iconPos:"left -16px",dragable:true},{id:"linb.UI.ComboButton",caption:"ComboButton",icon:_img_widgets,iconPos:"-80px top",dragable:true},{id:"linb.UI.TimePicker",caption:"TimePicker",icon:_img_widgets,iconPos:"-240px top",dragable:true},{id:"linb.UI.DatePicker",caption:"DatePicker",icon:_img_widgets,iconPos:"-256px top",dragable:true},{id:"linb.UI.ColorPicker",caption:"ColorPicker",icon:_img_widgets,iconPos:"-272px top",dragable:true},{id:"linb.UI.RadioBox",caption:"RadioBox",icon:_img_widgets,iconPos:"-208px top",dragable:true},{id:"linb.UI.Poll",caption:"Poll",icon:_img_widgets,iconPos:"-208px -16px",dragable:true},{id:"linb.UI.Group",caption:"Group",icon:_img_widgets,iconPos:"-224px top",dragable:true}]},{id:"linb.UI.iContainer",caption:"Containers",group:true,icon:_img_app,iconPos:"-48px -48px",sub:[{id:"linb.UI.Panel",caption:"Panel",icon:_img_widgets,iconPos:"-288px top",dragable:true},{id:"linb.UI.Fieldset",caption:"Fieldset",icon:_img_widgets,iconPos:"-224px top",dragable:true},{id:"linb.UI.PanelBar",caption:"PanelBar",icon:_img_widgets,iconPos:"-672px top",dragable:true},{id:"linb.UI.Block",caption:"Block",icon:_img_widgets,iconPos:"-304px top",dragable:true},{id:"linb.UI.Layout",caption:"Layout",icon:_img_widgets,iconPos:"-336px top",dragable:true},{id:"linb.UI.ColLayout",caption:"ColLayout",icon:_img_widgets,iconPos:"-336px top",dragable:true},{id:"linb.UI.Tabs",caption:"Tabs",icon:_img_widgets,iconPos:"-352px top",dragable:true},{id:"linb.UI.Stacks",caption:"Stacks",icon:_img_widgets,iconPos:"-368px top",dragable:true},{id:"linb.UI.ButtonViews",caption:"ButtonViews",icon:_img_widgets,iconPos:"-384px top",dragable:true},{id:"linb.UI.Dialog",caption:"Dialog",icon:_img_widgets,iconPos:"-320px top",dragable:true}]},{id:"linb.UI.iNavigator",caption:"Navigators",group:true,icon:_img_app,iconPos:"-48px -48px",sub:[{id:"linb.UI.PageBar",caption:"PageBar",icon:_img_widgets,iconPos:"-48px -16px",dragable:true},{id:"linb.UI.PopMenu",caption:"PopMenu",icon:_img_widgets,iconPos:"-400px top",dragable:true},{id:"linb.UI.MenuBar",caption:"MenuBar",icon:_img_widgets,iconPos:"-416px top",dragable:true},{id:"linb.UI.ToolBar",caption:"ToolBar",icon:_img_widgets,iconPos:"-432px top",dragable:true},{id:"linb.UI.LinkList",caption:"LinkList",icon:_img_widgets,iconPos:"-16px -16px",dragable:true},{id:"linb.UI.FoldingList",caption:"FoldingList",icon:_img_widgets,iconPos:"-32px -16px",dragable:true},{id:"linb.UI.Gallery",caption:"Gallery",icon:_img_widgets,iconPos:"-448px top",dragable:true},{id:"linb.UI.TreeBar",caption:"TreeBar",icon:_img_widgets,iconPos:"-464px top",dragable:true},{id:"linb.UI.TreeGrid",caption:"TreeGrid",icon:_img_widgets,iconPos:"-480px top",dragable:true}]},{id:"linb.UI.iSchedule",caption:"Schedules",group:true,icon:_img_app,iconPos:"-48px -48px",sub:[{id:"linb.UI.Calendar",caption:"Calendar",icon:_img_widgets,iconPos:"-496px top",dragable:true},{id:"linb.UI.TimeLine",caption:"TimeLine",icon:_img_widgets,iconPos:"-528px top",dragable:true}]}],ComFactoryProfile:{_iniMethod:"create",about:{cls:"VisualJS.About"},addFile:{cls:"VisualJS.AddFile"},delFile:{cls:"VisualJS.DelFile"},prjPro:{cls:"VisualJS.ProjectPro"},prjSel:{cls:"VisualJS.ProjectSelector"}}};new function(){var A=function(C,D){var B=arguments.callee;C.each(function(E){D[E.id]=E;if(E.sub&&E.sub.length){B(E.sub,D)}})};CONF.mapWidgets={};A(CONF.widgets,CONF.mapWidgets);linb.ini.appLangKey="VisualJS"};(linb.Locale.en||(linb.Locale.en={})).VisualJS={message:"System message!",noMessage:"No message yet!",soon:"Coming soon",ok:"OK",cancel:"Cancel",notsave:"Not save",notsave2:"Your are closing a tab that has unsaved changes. Would you want to close without saving?",notsave3:"Unsaved changes exist. Do you want to continue?",checkOK:"Congratulations! no syntax error yet!",menu:{file:"Project",newproject:"New Project",openproject:"Open Project",closeproject:"Close Project",save:"Save",saveall:"Save All",tools:"Tools",command:"Command Window",spy:"Components Spy",build:"Build",debug:"Debug",release:"Release",setting:"Build Setting",help:"Help",forum:"to forum...",license:"License",gpllicense:"GPL License",clicense:"Commercial License",purchase:"Purchase License",download:"Download source code...",about:"About..."},tool:{newp:"Create a new project",open:"Select a project to open",save:"Save file",saveall:"Save all changed files",command:"Open command window",spy:"Open widget spy window",debug:"Debug the current project",release:"Release the current project",ec:"to Chinese",manual:"Manual",api:"API",demo:"Demos",flash:"Flash video show"},tool2:{"new":"create a new file",del:"delete the current file",refresh:"refresh project files",refreshOK:"Project refreshed!"},pm:{title:"Project Manager",html:"HTML files",js:"Class files"},ps:{noselected:"select a project first",noprj:"No project yet!",getting:"Getting project list...",saved:"Save $0 file(s) OK!",noSaved:"No dirty files yet!"},projectPro:{name:"Project Name :","class":"Class Name :",pagefile:"Page File :",classfile:"Class File :",onlyword:"Only allow word(3-15)",invalid:"Some fileds are invalid!"},dialog:{newone:"Create a new project...",select:"Select a project to open"},pageEditor:{formatted:"Formatted code"},classEditor:{nv:"Normal View",sv:"Struct View",dv:"Design View",nvtips:"View all code in a textarea",svtips:"View code in Class struct way",dvtips:"Visual IDE for design UI widgets",codeerr:"Can't parse code with the error: $0!"},pageEditor:{format:"Fromat View",check:"Syntax Check",reset:"Reset Code",formattips:"Format code to a new dialog",checktips:"Check the code",resettips:"Reset the code to original text"},classtool:{err1:"Code format is invalid, check the code please!",err2:"Code format is invalid, check the code please!",err3:"Code format is invalid, check the code please!",err4:"Code format is invalid, check the code please!",noClass:"Not a jsLinb class file!"},designer:{emptyContent:"Empty content first...",prepare:"Prepare Classes...",createContent:"Refresh design content...",loading:"Loading ",comCodeErr:'An error exists in function "iniComponents", return to check the code please!',nameExists:'A widget named "$0" exists already!',domIdExists:'A DOM node wich id "$0" exists already!',domIdValid:"DOM id must be char and number only",confirmdel:"Delete?",confirmdel2:"Do you want to delete the $0 selected  widgets?",wlist:"Widgets List",weditor:"Widget Editor",gridcol1:"property",gridcol2:"value",colneOK:"Clone $0 widgets OK!",tool:{tocode:"serialize to JS code",tojson:"serialize to JSON code",left:"align to left",center:"align to center",right:"align to right",top:"align to top",middle:"align to middle",bottom:"align to botttom",width:"same width",wh:"same width and height",height:"same height",toplayer:"to top layer",bottomlayer:"to bottom layer",gridxy:"set position to grid",gridwh:"set size to grid",clone:"clone selected controls","delete":"delete"}},addfile:{caption:"Add file to Project...",sel:"Select the target file(dir)",filename:"File Name",filenameformat:"2 - 9 chars only",add:"Add",iDir:"Folder",iHtml:"HTML file",iCSS:"CSS file",iJs:"JS file",iPhp:"PHP file",target:"Target",filetype:"File Type",notarget:"No target file or folder to build.."},delfile:{caption:"Delete files to Project...",sel:"Select the target file(dir)",notarget:"No target file or folder to delete..",confirmdel:"Delete?",confirmdel2:"Do you want to delete the $0 selected  files(dirs)?"}};Class("VisualJS","linb.Com",{Constructor:function(){var A=this,B=linb.message;arguments.callee.upper.apply(A,arguments);SPA=this;A.curProject=null;A.Message=[];linb.message=function(C){if(A.Message.length>20){A.Message.pop()}if(typeof C!="string"){C=String(C)}if(/</.test(C)){C=C.replace(/</g,"&lt; ")}A.Message.unshift({id:_.id(),caption:C});A.toolbar.updateItem("info",C.left(50));B.apply(null,arguments)}},Instance:{events:{beforeCreated:function(){linb.dom.setCover("Created",true)},onLoadBaseClass:function(A,C,B){linb.dom.setCover("Load Base Class: "+B,true)},onLoadResource:function(){linb.dom.setCover("Load Resource",true)},onCodeLoaded:function(A,C,B){linb.dom.setCover("Load widgets: "+A.KEY+B)},onReady:function(A){linb.ComFactory.setProfile(CONF.ComFactoryProfile);this.menubar.setItems([{id:"file",caption:"$VisualJS.menu.file",sub:[{id:"newproject",caption:"$VisualJS.menu.newproject",icon:CONF.img_app,iconPos:"-32px top"},{id:"openproject",caption:"$VisualJS.menu.openproject",add:"Ctrl+Alt+O",icon:CONF.img_app,iconPos:"-48px top"},{id:"closeproject",caption:"$VisualJS.menu.closeproject"},{type:"split"},{id:"saveall",caption:"$VisualJS.menu.saveall",add:"Ctrl+Alt+S",icon:CONF.img_app,iconPos:"-96px top"}]},{id:"build",caption:"$VisualJS.menu.build",sub:[{id:"debug",caption:"$VisualJS.menu.debug",icon:CONF.img_app,iconPos:"top left",add:"F9"},{id:"release",caption:"$VisualJS.menu.release",icon:CONF.img_app,iconPos:"-64px top",add:"Ctrl+F9"}]},{id:"help",caption:"$VisualJS.menu.help",sub:[{id:"forum",caption:"$VisualJS.menu.forum"},{id:"download",caption:"$VisualJS.menu.download",icon:CONF.img_app,iconPos:"-144px 0px"},{type:"split"},{id:"license",caption:"$VisualJS.menu.license",sub:[{id:"gpllicense",caption:"$VisualJS.menu.gpllicense"},{id:"clicense",caption:"$VisualJS.menu.clicense"},{id:"purchase",caption:"$VisualJS.menu.purchase"}]},{type:"split"},{id:"flash",icon:CONF.img_app,iconPos:"-128px -17px",caption:"$VisualJS.tool.flash"},{id:"demo",icon:CONF.img_app,iconPos:"-48px -64px ",caption:"$VisualJS.tool.demo"},{type:"split"},{id:"about",caption:"$VisualJS.menu.about"}]}]);this.toolbar.setItems([{id:"only",sub:[{id:"newproject",icon:CONF.img_app,iconPos:"-32px top",tips:"$VisualJS.tool.newp"},{id:"openproject",icon:CONF.img_app,iconPos:"-48px top",tips:"$VisualJS.tool.open"},{type:"split"},{id:"saveall",icon:CONF.img_app,iconPos:"-96px top",tips:"$VisualJS.tool.saveall"},{type:"split"},{id:"debug",icon:CONF.img_app,iconPos:"top left",tips:"$VisualJS.tool.debug"},{id:"release",icon:CONF.img_app,iconPos:"-64px top",tips:"$VisualJS.tool.release"},{type:"split"},{id:"download",tips:"$VisualJS.menu.download",icon:CONF.img_app,iconPos:"-144px 0px"},{id:"flash",icon:CONF.img_app,iconPos:"-128px -17px",tips:"$VisualJS.tool.flash"},{id:"demo",icon:CONF.img_app,iconPos:"-48px -64px ",tips:"$VisualJS.tool.demo"},{type:"split"},{id:"ec",icon:CONF.img_app,iconPos:"-98px -16px",tips:"$VisualJS.tool.ec"},{type:"split"},{id:"info",icon:CONF.img_app,iconPos:"-286px -64px ",caption:"$VisualJS.noMessage",tips:"$VisualJS.message"}]}]);this.floatLogo.setCustomAppearance({KEY:"background-image:url("+linb.getPath("img/","logo.gif")+");position:absolute;top:0px;right:0px;width:120px;height:60px;z-index:100;cursor:pointer;"})},afterShow:function(E){var C="prj",D="([&|?|#]|\\b)("+C+"=)([^&]*)([&]?)",A=location.href.match(new RegExp(D)),B=_.isNull(A)?"":decodeURIComponent(A[3]);if(B){B=CONF.prjPath+B;linb.request(CONF.phpPath,_.serialize({key:CONF.requestKey,para:{action:"open",hashCode:_.id(),path:B}}),function(F){var G=_.unserialize(F);if(G&&!G.error){E._openproject(B,G)}else{linb.message(F)}})}E.proxy=new linb.UI.IFrame({height:1,left:-10000,top:-10000,src:"javascript:;"});linb(document.body).attach(E.proxy);E.$infoList=new linb.UI.List({shadow:true,resizable:true,width:400}).setCustomAppearance("ITEM","border-bottom:dashed 1px gray").create()}},base:["linb.UI","linb.date"],required:["linb.UI.List","linb.UI.PopMenu","linb.UI.MenuBar","linb.UI.ToolBar","linb.UI.Layout","linb.UI.Tabs","linb.UI.TreeBar","linb.UI.Dialog","linb.UI.PanelBar","linb.UI.IFrame","linb.UI.Tips","linb.UI.Shadow","linb.UI.Resizer","linb.UI.Edge","linb.UI.Div"],background:["VisualJS.ProjectSelector","VisualJS.ProjectPro","VisualJS.PageEditor","VisualJS.ClassTool","VisualJS.ClassEditor","VisualJS.ClassStruct","VisualJS.ObjectEditor","VisualJS.Designer","VisualJS.AddFile","VisualJS.DelFile","VisualJS.About","linb.coder","linb.UI.Label","linb.UI.Button","linb.UI.CheckBox","linb.UI.Input","linb.UI.ComboInput","linb.UI.Group","linb.UI.IconList","linb.UI.RadioBox","linb.UI.Block","linb.UI.Stacks","linb.UI.ButtonViews","linb.UI.TextEditor","linb.UI.TreeGrid"],_addfile:function(F,E,B,C){var A=this.treebarPrj,D;if(C!="/"){B=B+C;D=E+"/"+B}else{D=E=E+"/"+B}linb.request(CONF.phpPath,_.serialize({key:CONF.requestKey,para:{action:"add",hashCode:_.id(),type:C=="/"?"dir":"file",path:E,filename:B}}),function(G){var J=_.unserialize(G);if(J&&J.OK){var I;if(C=="/"){I="-48px top"}else{var H=B.split(".");switch(H[1].toLowerCase()){case"html":I="-112px -48px";break;case"css":I="-208px -48px";break;case"js":I="-16px -48px";break;default:I="-96px -48px"}}A.insertItems([{id:D,caption:B,icon:CONF.img_app,iconPos:I,value:D,sub:C=="/"?[]:null}],F)}else{linb.message(G)}})},_delfile:function(C){var A=this.treebarPrj,B=this.tabsMain;arr=C.split(";"),a=[];arr.each(function(E,D){a[D]=E});linb.request(CONF.phpPath,_.serialize({key:CONF.requestKey,para:{action:"del",hashCode:_.id(),path:a}}),function(E){var G=_.unserialize(E);if(G&&G.OK){A.removeItems(arr);var F=B.getItems(),D=[];F.each(function(H){if(!A.getSubSerialIdByItemId(H.id)){D.push(H.id)}},null,true);B.removeItems(D)}else{linb.message(E)}})},_projecttool_onclick:function(C,E,B,D){var A=this;switch(E){case"new":linb.ComFactory.getCom("addFile",null,function(){this.host=A;this.setProperties({icon:CONF.img_app,iconPos:"-0px -16px",caption:"$VisualJS.tool2.new",onOK:A._addfile,fromRegion:linb(D).getRegion(true),items:A.curPrjFiles});this.show(linb([document.body]))});break;case"delete":linb.ComFactory.getCom("delFile",null,function(){this.host=A;this.setProperties({fromRegion:linb(D).getRegion(true),icon:CONF.img_app,iconPos:"-80px -16px",caption:"$VisualJS.tool2.del",items:A.curPrjFiles,onOK:A._delfile});this.show(linb([document.body]))});break;case"refresh":linb.request(CONF.phpPath,_.serialize({key:CONF.requestKey,para:{action:"open",hashCode:_.id(),path:A.curProject}}),function(F){var G=_.unserialize(F);if(!G||G.error){linb.message(F)}else{_.tryF(A._openproject,[A.curProject,G],A);linb.message(linb.getRes("VisualJS.tool2.refreshOK"))}});break}},_dirtyWarn:function(F){var D=this,E,B=this.tabsMain,C=B.getItems(),A=this.treebarPrj;C.each(function(G){if(G._dirty){return !(E=true)}});if(E){linb.UI.Dialog.confirm(linb.getRes("VisualJS.notsave"),linb.getRes("VisualJS.notsave3"),F)}else{F()}},_closeproject:function(G){var E=this,F,C=this.tabsMain,D=C.getItems(),A=this.treebarPrj;D.each(function(H){if(H._dirty){return !(F=true)}});var B=function(){C.clearItems();A.clearItems();E.curProject=null;this.curPrjFiles=[];E.projecttool.setDisabled(true);if(typeof G=="function"){G()}};if(F){linb.UI.Dialog.confirm(linb.getRes("VisualJS.notsave"),linb.getRes("VisualJS.notsave2"),B)}else{B()}},_tabsmain_beforepageclose:function(A,B,C){if(B._dirty){linb.UI.Dialog.confirm(linb.getRes("VisualJS.notsave"),linb.getRes("VisualJS.notsave2"),function(){A.boxing().removeItems(B.id)});return false}},_tabsmain_afterpageclose:function(A,B,C){if(B.$obj){B.$obj.destroy()}},_tabsmain_beforeValueUpdated:function(C,B,A){var D=this.tabsMain.getItemByItemId(B);if(!D){return }if(t=D.$obj){if(t.getText()===false){return false}}},_tabmain_onitemselected:function(A,B,C){_.tryF(function(){if(B.$obj){B.$obj.activate()}})},_treebarprj_onitemselected:function(C,M,A){if(!M.id){return }var G=this,I=M.caption.split(".")[1];if(I!="js"&&I!="html"&&I!="css"&&I!="php"){linb.dom.submit(M.id);return }var J=M.value,E=J.split("/"),B=E[E.length-1],F=B.split(".")[1],H=F=="js"?"-16px -48px":"-128px -48px";F=F=="js"?"class":F;var D=G.tabsMain,L=linb([A],false).getRegion(true),K=D.reBoxing().getRegion(true);if(D.getItemByItemId(J)){D.fireItemClickEvent(J)}else{linb.dom.fxProxy(L,K,null,function(){var P={id:J,tips:J,caption:B,closeBtn:true,icon:CONF.img_app,iconPos:H},O=D.getItems();D.insertItems([P],O.length?O[O.length-1].id:null);D.fireItemClickEvent(J);var N=function(Q){var R=P.id;var S=function(U,V,T){D.markDirty(U.properties.keyId,T)};P.newText=P.text=Q;if(F!="class"){linb.ComFactory.newCom("VisualJS.PageEditor",function(){this.host=G;this.setProperties({text:Q,checkType:F,keyId:R});this.setEvents("onValueChanged",S);this.show(null,D.getCurPanel());P.$obj=this})}else{linb.ComFactory.newCom("VisualJS.ClassEditor",function(){this.host=G;this.setProperties({$design:G.curProject,checkType:"js",text:Q,keyId:R});this.setEvents("onValueChanged",S);this.show(null,D.getCurPanel());P.$obj=this})}};if(F!="php"){linb.request(J,"",N)}else{linb.request(CONF.phpPath,_.serialize({key:CONF.requestKey,para:{action:"getfile",hashCode:_.id(),path:J}}),N)}},240,8,"inexp").start()}},iniComponents:function(){var B=this,D=B._nodes=[],A=linb.UI,C=function(E){D.push(E.get(0))};C((new A.ToolBar).host(B,"toolbar").setDockOrder("2").setItems([]).onClick("_toolbar_onclick"));C((new A.MenuBar).host(B,"menubar").setDockOrder("1").setItems([]).onMenuSelected("_menubar_onclick"));C((new A.Div).host(B,"floatLogo").afterCreated(function(E){E.root.onClick(function(){linb.dom.submit(CONF.path_link)})}));C((new A.Layout).host(B,"layout").setLeft(0).setTop(0).setItems([{id:"before",pos:"before",locked:false,size:150,min:50,max:300,cmd:true,hide:false},{id:"main",min:10}]).setType("horizontal"));B.layout.attach((new A.PanelBar).host(B,"panelbar2").setCaption("$VisualJS.pm.title").setIcon(CONF.img_app).setIconPos("-128px -48px"),"before");B.panelbar2.attach((new A.TreeBar).host(B,"treebarPrj").setSelMode("none").setPosition("relative").setDock("none").setItems([]).setIniFold(false).setGroup(true).onItemSelected("_treebarprj_onitemselected"));B.layout.attach((new A.Tabs).host(B,"tabsMain").setLeft(0).setTop(0).setItems([]).beforeValueUpdated("_tabsmain_beforeValueUpdated").beforePageClose("_tabsmain_beforepageclose").afterPageClose("_tabsmain_afterpageclose").onItemSelected("_tabmain_onitemselected"),"main");B.layout.attach((new A.ToolBar).host(B,"projecttool").setDock("bottom").setHandler(false).setAlign("right").setDisabled(true).setItems([{id:"only",sub:[{id:"refresh",icon:CONF.img_app,iconPos:"-113px -16px",tips:"$VisualJS.tool2.refresh"},{type:"split"},{id:"new",icon:CONF.img_app,iconPos:"-0px -16px",tips:"$VisualJS.tool2.new"},{id:"delete",icon:CONF.img_app,iconPos:"-80px -16px",tips:"$VisualJS.tool2.del"}]}]).afterCreated(function(E){E.getSubNode("ITEMS").setStyle({borderLeftWidth:0,borderRightWidth:0,borderBottomWidth:0})}).onClick("_projecttool_onclick"),"before");return D},_toolbar_onclick:function(B,D,A,C){this._menubar_onclick(this.menubar.get(0),D,null,C)},_openproject:function(E,H){this.curProject=E;var B=this.treebarPrj;H.sort(function(I,J){return I.layer<J.layer?1:I.layer==J.layer?(I.type>J.type?1:I.type==J.type?(I.location>J.location?1:-1):-1):-1});var G=E.split("/"),D=G[G.length-1],C,F={"*":{id:E,caption:D,icon:CONF.img_app,iconPos:"-128px -48px",value:E,sub:[]}},A=[F["*"]];H.each(function(J){if(!J.type){C="-48px top"}else{var I=J.name.split(".");switch(I[1].toLowerCase()){case"html":C="-112px -48px";break;case"css":C="-208px -48px";break;case"js":C="-16px -48px";break;default:C="-96px -48px"}}F[J.id]={id:J.location,caption:J.name,icon:CONF.img_app,iconPos:C,value:J.location};if(!J.type){F[J.id].sub=[]}F[J.pid].sub.push(F[J.id])});B.clearItems();B.insertItems(A);this.curPrjFiles=B.getItems();this.projecttool.setDisabled(false)},_menubar_onclick:function(D,B,L,A){var M=this;switch(B){case"newproject":var K=function(){linb.ComFactory.getCom("prjPro",null,function(){this.host=M;this.setProperties({caption:"$VisualJS.dialog.newone",projectName:"linbApp",jsLINBPath:"",className:"App",readonly:false,icon:CONF.img_app,iconPos:"-32px top",fromRegion:linb(A).getRegion(true),onOK:M._openproject});this.show(linb([document.body]))})};if(this.curProject){this._closeproject(K)}else{K()}break;case"closeproject":if(!this.curProject){linb.message(linb.getRes("VisualJS.ps.noprj"));return }this._closeproject();break;case"openproject":var K=function(){linb.ComFactory.getCom("prjSel",null,function(){this.host=M;this.setProperties({caption:linb.getRes("VisualJS.dialog.select"),icon:CONF.img_app,iconPos:"-48px top",fromRegion:linb(A).getRegion(true),onOK:M._openproject});this.show(linb([document.body]))})};if(this.curProject){this._closeproject(K)}else{K()}break;case"saveall":if(!this.curProject){linb.message(linb.getRes("VisualJS.ps.noprj"));return }var F=this.tabsMain,G=0,E;var I=F.getItems();I.each(function(O){if(O._dirty){G++;var N=O.$obj.getText();if(false===N){E="err";return false}linb.request(CONF.phpPath,_.serialize({key:CONF.requestKey,para:{action:"save",hashCode:_.id(),path:O.id,content:N}}),function(P){if(_.unserialize(P).OK){O.$obj.resetEnv(N);F.markDirty(O,false,true)}},function(P){linb.message(P)},null,{method:"POST"})}},this);if(!E){if(G){linb.message(linb.getRes("VisualJS.ps.saved",G))}else{linb.message(linb.getRes("VisualJS.ps.noSaved"))}}break;case"ec":linb.reLang(linb.lang=="en"?"cn":"en",function(){M.menubar.reset()});break;case"flash":linb.dom.submit(CONF.path_video);break;case"demo":linb.dom.submit("demo.html");break;case"info":if(!this.Message.length){return }var H=this.$infoList,C=H.reBoxing();H.setItems(this.Message.copy());C.popToTop(A,null,4);var J=function(){C.hide();linb.event.hookKey("esc",0,0,0,null)};C.setBlurTrigger(H.get(0).$id,J);linb.event.hookKey("esc",0,0,0,J);break;case"debug":if(!M.curProject){linb.message(linb.getRes("VisualJS.ps.noprj"));return }M._dirtyWarn(function(){linb.dom.submit(M.curProject)});break;case"release":if(!M.curProject){linb.message(linb.getRes("VisualJS.ps.noprj"));return }M._dirtyWarn(function(){M.proxy.submit(CONF.phpPath,{key:CONF.requestKey,para:{path:M.curProject,action:"release"}},null,"POST")});break;case"forum":linb.dom.submit(CONF.path_forum);break;case"download":linb.dom.submit(CONF.path_download);break;case"gpllicense":linb.dom.submit(CONF.path_gpllicence);break;case"clicense":linb.dom.submit(CONF.path_licence);break;case"purchase":linb.dom.submit(CONF.path_purchase);break;case"about":linb.ComFactory.getCom("about",null,function(){this.show(linb([document.body]))});break;default:linb.message(linb.getRes("VisualJS.soon"))}}},Initialize:function(){linb.BookMark.hookLinkClick(null);window.onbeforeunload=function(A){if(linb.browser.ie6&&linb.temp.cancelBeforeload){delete linb.temp.cancelBeforeload;return }return" "}}});Class("VisualJS.PageEditor","linb.Com",{Instance:{iniUI:function(){var A=this;if(A.properties.checkType!="js"){A.toolbar.hideItem("check")}A.setText(A.properties.text)},eval2:function(txt){var r=true,iframe=document.createElement("iframe");iframe.style.display="none";document.body.appendChild(iframe);frames[frames.length-1].document.write("<script>var Class=function(a,b,c){}, _={}, linb={};var MSIE/*@cc_on =1@*/;parent.sandbox=MSIE?this:{eval:function(s){return eval(s)}}<\/script>");txt=txt.trim();try{try{sandbox.eval(txt)}catch(a){sandbox.eval("("+txt+")")}}catch(e){linb.message(_.Error(e));r=false}finally{document.body.removeChild(iframe)}return r},check:function(A){switch(this.properties.checkType){case"js":return this.eval2(A);break}return true},getText:function(B){var C=this,A=C.texteditor.getUIValue().replace(/\r\n/g,"\n");if(C.properties.text!=A){if(false!==B){if(C.check(A)===false){return false}}return A}else{return C.properties.text}},activate:function(){if(this.texteditor){var A=this;_.asyRun(function(){A.texteditor.activate();A=null})}},setReadonly:function(A){this.texteditor.setReadonly(A)},setText:function(A,B){var C=this;A=A||"";C.properties.text=A.replace(/\r\n/g,"\n");C.texteditor.setValue(A,true);C._dirty=false;return C},resetEnv:function(A){this._dirty=false;this.properties.text=A||txt.replace(/\r\n/g,"\n")},_texteditor_onKeyPress:function(E,G,H){var C=this,D=C._dirty,B,A,F=H.value.replace(/\r\n/g,"\n");C._dirty=C.properties.text!==F;if(D!=C._dirty){_.tryF(C.events.onValueChanged,[C,E,C._dirty,F],C.host)}},iniComponents:function(){var B=this,D=B._nodes=[],A=linb.UI,C=function(E){D.push(E.get(0))};C((new A.Panel).host(B,"panel").setDock("fill"));B.panel.attach((new A.ToolBar).host(B,"toolbar").setItems([{id:"only",sub:[{id:"format",caption:"$VisualJS.pageEditor.format",icon:"img/App.gif",iconPos:"-32px -48px",type:"button",tips:"$VisualJS.pageEditor.formattips"},{id:"check",caption:"$VisualJS.pageEditor.check",icon:"img/App.gif",iconPos:"0 -48px",type:"button",tips:"$VisualJS.pageEditor.checktips"}]}]).onClick("_toolbar_onclick"));B.panel.attach((new A.TextEditor).host(B,"texteditor").setDock("fill").setCaption("texteditor").onKeyPress("_texteditor_onKeyPress"));return D},_toolbar_onclick:function(B,C){var A=this;linb.dom.UIAction(function(){switch(C){case"format":var F=linb.coder.parse(A.texteditor.getUIValue(),A.properties.checkType,["plain"]);var E=new linb.UI.Dialog();E.setLeft(100).setTop(100).setWidth(300).setHeight(200).setStatus("max").setMinBtn(false).setMaxBtn(false).setCaption("$VisualJS.pageEditor.formatted").create();E.html(F);E.show(linb(document.body),true);break;case"check":var D=A.getText();if(D!==false){linb.message(linb.getRes("VisualJS.checkOK"))}break}})}}});Class("VisualJS.ClassTool",null,{Static:{isClassText:function(B){var A=new RegExp("^(\\s*\\/\\*[^*@]*\\*+([^\\/][^*]*\\*+)*\\/\\s*)|^(\\s*\\/\\/[^\\n]*\\s*)");while(A.test(B)){B=B.replace(A,"")}return/^\s*Class\(/.test(B)},getClassObject:function(str){str=str.slice(str.indexOf("{")+1,str.lastIndexOf("}"));return eval("({"+str+"})")},getCodeFromStruct:function(D){try{var B=arguments.callee,A=[];if(D){if(D.sub){if(D.frame){_.each(D.sub,function(F,E){if(!_.isNull(F.comments)){A.push((F.comments||"")+E+":"+(F.code?F.code:F.sub?B.call(this,F):""))}},this);return D.frame.replace("*1",D.name||"").replace("*2",D.pname||"").replace("*3",A.join(",").replace(/\$/g,"$$$"))}else{return""}}else{return(D.code||"").replace(/^[\r\n]*/,"")}}else{return""}}catch(C){linb.message(linb.getRes("VisualJS.classtool.err2"))+":"+_.Error(C);return false}},parseSingleBlock:function(A){try{var C=new RegExp("^(\\s*\\/\\*[^*@]*\\*+([^\\/][^*]*\\*+)*\\/\\s*)|^(\\s*\\/\\/[^\\n]*\\s*)"),B=new RegExp("(\\s*\\/\\*[^*@]*\\*+([^\\/][^*]*\\*+)*\\/\\s*)|^(\\s*\\/\\/[^\\n]*\\s*)$"),G,F,D;while(B.test(A)){A=A.replace(B,"")}G=A;while(C.test(G)){G=G.replace(C,"")}G=G.replace(/\s*/,"");if(!G){return{comments:null,code:null}}F="\n"+A.replace(G,"");D=G.replace(/\s*$/,"");G=linb.coder.replace(G,[["(^|\\n)\\s*\\/\\*[^*@]*\\*+([^\\/][^*]*\\*+)*\\/\\s*",""],["\\n\\s*\\/\\/[^\\n]*\\s*",""],[/\s+(\/[^\/\n\r\*][^\/\n\r]*\/m?g?i?)\s*[:,;\r\n]/,""],[/[^\w\x24\/'"*)\]\?:]\/[^\/\n\r\*][^\/\n\r]*\/m?g?i?\s*[:,;\r\n]/,""]]);D=D.replace(/([}\]])[^}\]]*$/,"$1");G=linb.coder.replace(D,[["'(\\\\.|[^'\\\\])*'",""],['"(\\\\.|[^"\\\\])*"',""]]);while(/(\{([^\{\}]*)\})|(\[([^\[\]]*)\])/.test(G)){G=G.replace(/\s*(((function\s*([\w$]+\s*)?\(\s*([\w$\s,]*)\s*\)\s*)?(\{([^\{\}]*)\}))|(\[([^\[\]]*)\]))/g,"")}if(G.trim()!=""){return false}return{comments:F,code:D}}catch(E){linb.message(linb.getRes("VisualJS.classtool.err3")+":"+_.Error(E));return false}},getClassStruct:function(str){str=str.replace(/(\r\n|\r)/g,"\n").replace(/( +)(\n)/g,"$2").replace(/\t/g,"    ");var t,index=1,index1=1,cache={},cache1={},result,result2,code=function(str,i){var ret="#"+(index++)+"#";cache[ret]=str[0];return ret},code1=function(str){var ret="`"+(index1++);cache1[ret]=str[0];return ret},restore=function(str){return str.replace(/#(\d+)#/g,function(m){return cache[m]})},restore1=function(str){return str.replace(/`(\d+)/g,function(m){return cache1[m]})};str=linb.coder.replace(str,[["(^|\\n)\\s*\\/\\*[^*@]*\\*+([^\\/][^*]*\\*+)*\\/[^\\n]*",code],["(^|\\n)\\s*\\/\\/[^\\n]*",code],[/\s+(\/[^\/\n\r\*][^\/\n\r]*\/m?g?i?)\s*[:,;\r\n]/,code],[/[^\w\x24\/'"*)\]\?:]\/[^\/\n\r\*][^\/\n\r]*\/m?g?i?\s*[:,;\r\n]/,code]]);str=linb.coder.replace(str,[["'(\\\\.|[^'\\\\])*'",code1],['"(\\\\.|[^"\\\\])*"',code1]]);var frame=str.replace(/(^[^{]*\{)\s*((.|[\r\n])*)([^\s])(\s*}[^}]*$)/,"$1*3$5").replace(/(#\d+#)+/g,""),o={sub:{}};if(t=str.match(/^((#\d+#)+)/)){o.comments=restore(t[0])}else{o.comments=""}t=str.split(",");o.name=restore1(cache1["`1"].replace(/[\'\" ]*/g,""));o.pname=restore(restore1(t[1]).replace(/[\'\" ]*/g,""));o.frame=restore1(frame.replace(o.name,"*1").replace(o.pname,"*2"));str=str.slice(str.indexOf("{")+1,str.lastIndexOf("}"));result=o.sub;var index2=1,cache2={},code2=function(str){var ret="'~"+index2+++"'";cache2[ret]=str;return ret},code3=function(a,b,str){if(a.indexOf("~")!=-1){return a}var ret="'~"+index2+++"'";cache2[ret]=str;return b+ret},restore2=function(str){if(str.indexOf("~")==-1){return str}str=cache2["'"+str+"'"];while(/'~\d+'/.test(str)){str=str.replace(/'~\d+'/g,function(m){return cache2[m]})}return str};while(/(\{([^\{\}]*)\})|(\[([^\[\]]*)\])/.test(str)){str=str.replace(/\s*(((function\s*([\w$]+\s*)?\(\s*([\w$\s,]*)\s*\)\s*)?(\{([^\{\}\[\]]*)\}))|(\[([^\[\]\{\}]*)\]))/g,code2)}str=linb.coder.replace(str,["\\s+",code]);str=str.replace(/((#\d+#)+)([\w]+)((#\d+#)*):/g,function(z,a,b,c){result[c]={comments:restore(a)};return c+":"});str=str.replace(/(#\d+#)/g,"");var obj=eval("({"+str+"})");["Constructor","Initialize","Before","After"].each(function(i){if(obj[i]){result[i]=result[i]||{};result[i].code=restore(restore1(restore2(obj[i])))}else{result[i]={}}"code,comments".toArr().each(function(j){result[i][j]=_.exists(result[i][j])?result[i][j]:null})});var obj2;["Instance","Static"].each(function(i){if(obj[i]){var temp=cache2["'"+obj[i]+"'"];var frame=temp.replace(/(^[^{]*\{)\s*((.|[\r\n])*)([^\s])(\s*}[^}]*$)/,"$1*3$5");temp=temp.replace(/(#\d+#)*\s*(\})$/g,"$2");temp="("+temp+")";temp=linb.coder.replace(temp,["\\s+",code]);result[i]=result[i]||{};result2=result[i].sub={};result[i].frame=frame;temp=temp.replace(/(:)([^,\}]+)/g,code3);temp=restore1(temp);temp=temp.replace(/((#\d+#)+)([\w]+)((#\d+#)*):/g,function(z,a,b,c){result2[c]={comments:restore(a)};return c+":"});temp=temp.replace(/(#\d+#)/g,"");obj2=eval(temp);_.each(obj2,function(o,j){result2[j]=result2[j]||{};result2[j].code=restore(restore1(restore2(o)))})}else{result[i]={}}"code,comments,sub,frame".toArr().each(function(j){result[i][j]=_.exists(result[i][j])?result[i][j]:null})});return o}}});Class("VisualJS.ClassEditor","linb.Com",{Instance:{views:null,events:{afterCreated:function(B,C){var A=B;B.views={};linb.ComFactory.newCom("VisualJS.PageEditor",function(){var D=this;D.host=B;D.setProperties({text:B.properties.text,checkType:"js"});D.setEvents("onValueChanged",function(H,F,E,G){_.tryF(B.events.onValueChanged,[B,H,A.properties.textO!=G],B.host)});D.show(null,B.buttonview,"normal");B.views.normal=D},C)}},activate:function(){var B=this,C;if(!B.views){return }var A=B.buttonview.getUIValue();if(C=B.views[A]){if(C.created){C.activate()}}},beforeDestroy:function(){_.each(this.views,function(A){A.destroy()})},getText:function(){var A=this.buttonview.getUIValue();return this.views[A].getText()},setText:function(A,B){var C=this,D=C.properties;A=A.replace(/\r\n/g,"\n");D.textO=D.text=A;D.clsStruct=D.clsObject=null;C.views[C.buttonview.getUIValue()].setText(A,B);return C},resetEnv:function(C){var A=this,B=A.properties;if(!C){C=A.getText()}B.clsStruct=B.clsObject=null;B.textO=B.text=C;A.views[A.buttonview.getUIValue()].resetEnv(C)},_buttonview_aftercreated:function(A){A.getSubNode("PANEL",true).setStyle({borderBottom:"0",borderLeft:"0",borderRight:"0"})},_buttonview_beforeValueUpdated:function(D,E,G){var I=this,B=I.properties,H;if(!I.views){return }if((H=I.views[E])&&H.created){var A=H.getText();if(false===A){return false}else{if(E=="normal"){if(!VisualJS.ClassTool.isClassText(A)){B.clsStruct=B.clsObject=null;linb.message(linb.getRes("VisualJS.classtool.noClass"));return false}}if(B.text!=A||!B.clsStruct||!B.clsObject){try{B.clsStruct=VisualJS.ClassTool.getClassStruct(A);B.clsObject=VisualJS.ClassTool.getClassObject(A)}catch(F){B.clsStruct=B.clsObject=null;linb.message(linb.getRes("VisualJS.classEditor.codeerr",_.Error(F)));return false}B.text=A}if(E!="normal"){var C=H.properties;C.text=A;C.clsStruct=B.clsStruct;C.clsObject=B.clsObject}}}else{return false}},_buttonview_onitemselected:function(C,D,F){var A=this,E=A.properties,B;if(!A.views){return }if(!(B=A.views[D.id])){if(D.id=="struct"){linb.ComFactory.newCom("VisualJS.ClassStruct",function(){this.setHost(A).setProperties({text:E.text,clsStruct:E.clsStruct,clsObject:E.clsObject}).setEvents({onValueChanged:function(I,H,G){_.tryF(A.events.onValueChanged,[this,I,(E.textO!=E.text)||G],A.host)}});this.show(null,A.buttonview,"struct");A.views.struct=this})}else{if(D.id=="design"){linb.ComFactory.newCom("VisualJS.Designer",function(){this.setHost(A).setProperties({$design:E.$design,text:E.text,clsStruct:E.clsStruct,clsObject:E.clsObject}).setEvents({onValueChanged:function(I,H,G){_.tryF(A.events.onValueChanged,[this,I,(E.textO!=E.text)||G],A.host)}});this.show(null,A.buttonview,"design");A.views.design=this})}}}else{linb([F],false).UIAction(function(G){if(B.created){if(D.id=="struct"||D.id=="design"){B.properties.clsStruct=E.clsStruct;B.properties.clsObject=E.clsObject}B.setText(E.text,false,G).activate()}})}},base:["linb.UI"],required:["linb.UI.Tabs","linb.UI.ButtonViews","VisualJS.ClassTool"],parepareData:function(A){A.textO=A.text},iniComponents:function(){var B=this,D=B._nodes=[],A=linb.UI,C=function(E){D.push(E.get(0))};C((new A.ButtonViews).host(B,"buttonview").setLeft(0).setTop(0).setItems([{id:"normal",caption:"$VisualJS.classEditor.nv",icon:"img/App.gif",iconPos:"-80px -48px",tips:"$VisualJS.classEditor.nvtips"},{id:"struct",caption:"$VisualJS.classEditor.sv",icon:"img/App.gif",iconPos:"-32px -48px",tips:"$VisualJS.classEditor.svtips"},{id:"design",caption:"$VisualJS.classEditor.dv",icon:"img/App.gif",iconPos:"-192px -48px",tips:"$VisualJS.classEditor.dvtips"}]).setValue("normal").setHandleSize("28").beforeValueUpdated("_buttonview_beforeValueUpdated").afterCreated("_buttonview_aftercreated").onItemSelected("_buttonview_onitemselected"));return D}}});Class("VisualJS.ClassStruct","linb.Com",{Instance:{events:{afterShow:function(A){A.setText(A.properties.text,true)}},iniExComs:function(B){var A=this;linb.ComFactory.newCom("VisualJS.PageEditor",function(){var C=this;C.host=A;C.setProperties({checkType:"js"});C.setEvents("onValueChanged",function(E,F,D){_.tryF(A.events.onValueChanged,[E,F,A.$dirty||D],A.host)});C.show(null,A.layoutFill,"main",B);A.PageEditor=C},B)},activate:function(){this.PageEditor.activate()},check:function(A){return this.PageEditor.check(A)},getText:function(){var C=this,E=C.properties,D=C.refer,B=C.PageEditor.getText(false);if(B===false){return false}if(C.$dirty||E.temptext!=B){if(D){if(false===C.check(B)){return false}var A=VisualJS.ClassTool.parseSingleBlock(B);if(false===A){linb.message(linb.getRes("VisualJS.classtool.err1"));return false}E.temptext=B;D.comments=A.comments;D.code=A.code;B=VisualJS.ClassTool.getCodeFromStruct(E.clsStruct);return E.clsStruct.comments.replace(/^[\r\n]*/,"")+B}}return E.text},setText:function(E,H){var K=this,A=K.properties;E=E.replace(/\r\n/g,"\n");if(H||A.text!=E){A.text=E;var F=A.clsStruct,B=A.clsObject;value=K.treebarClass.getUIValue();K.treebarClass.setValue(null,true);var G=[{id:"Class",caption:"Class",caption:F.name,icon:"img/App.gif",iconPos:"-16px -48px",group:true,sub:[{id:"Constructor",caption:"Constructor",icon:"img/App.gif",iconPos:"-32px -32px"},{id:"Instance",caption:"Instance",icon:"img/App.gif",iconPos:"-16px -32px",sub:[]},{id:"Static",caption:"Static",icon:"img/App.gif",iconPos:"-16px -32px",sub:[]},{id:"Initialize",caption:"Initialize",icon:"img/App.gif",iconPos:"-32px -32px"},{id:"Before",caption:"Before",icon:"img/App.gif",iconPos:"-32px -32px"},{id:"After",caption:"After",icon:"img/App.gif",iconPos:"-32px -32px"}]}];var J,C,I,D=G[0].sub;J=A.clsStruct.sub;if(J){C=J.Instance;if(C&&(C=C.sub)){_.each(C,function(M,L){I="img/App.gif";iconPos=(typeof B.Instance[L]=="function")?"-32px -32px":"0 -32px";if(_.isHash(B.Instance[L])){I="block.gif"}D[1].sub.push({id:"Instance."+L,caption:L,icon:I,iconPos:iconPos})})}C=J.Static;if(C&&(C=C.sub)){_.each(C,function(M,L){I=(typeof B.Static[L]=="function")?"function.gif":"property.gif";if(_.isHash(B.Static[L])){I="block.gif"}D[2].sub.push({id:"Static."+L,caption:L,icon:"img/"+I})})}}delete K.refer;K.treebarClass.setItems(G);if(value){if(K.treebarClass.selectItem(value)){return K}}K.PageEditor.setText(E||"").setReadonly(true)}K.resetEnv(E);return K},resetEnv:function(B){var A=this;if(!B){B=A.getText()}A.$dirty=false;A.properties.text=B;A.PageEditor.resetEnv(B)},_treebarclass_beforevalueupdated:function(F,E,D){var C=this,G=C.PageEditor;if(!C.refer){return }var B=G.getText();if(B===false){return false}if(C.properties.temptext!=B){if(false===C.check(B)){return false}var A=VisualJS.ClassTool.parseSingleBlock(B);if(false===A){linb.message(linb.getRes("VisualJS.classtool.err1"));return false}C.refer.comments=A.comments;C.refer.code=A.code;C.$dirty=true}},_treebarclass_onitemselected:function(B,D,C){if(!D.id){return }var A=this,F=A.PageEditor,E=D.id;linb([C],false).UIAction(function(K){var N=A.properties.clsStruct,I,H,G;var M,J;switch(E){case"Class":J=VisualJS.ClassTool.getCodeFromStruct(N);break;case"Static":case"Instance":case"Constructor":case"Initialize":case"Before":case"After":N=N.sub;if(N=N[E]){if(N.sub){J=VisualJS.ClassTool.getCodeFromStruct(N)}}break;default:N=N.sub;G=E.split(".");N=N[G[0]];N=N.sub;N=N[G[1]]}M=(N?(N.comments||""):"");if(M){M=M.replace(/^[\r\n]*/,"")}J=J||(N&&N.code)||"";linb.thread.suspend(K);var I=linb([C],false).getRegion(true),L=F.texteditor.reBoxing().getRegion(true);linb.dom.fxProxy(I,L,null,function(){F.setText(A.properties.temptext=M+J).activate();F.setReadonly(E=="Class"||E=="Instance"||E=="Static")},240,8,"inexp").start();A.refer=N;linb.thread.resume(K)})},iniComponents:function(){var B=this,D=B._nodes=[],A=linb.UI,C=function(E){D.push(E.get(0))};C((new A.Layout).host(B,"layoutFill").setLeft(0).setTop(0).setItems([{id:"before",pos:"before",locked:false,size:150,min:50,max:200,cmd:false}]).setType("horizontal"));B.layoutFill.attach((new A.TreeBar).host(B,"treebarClass").setLeft(0).setTop(0).setGroup(false).setItems([]).setIniFold(false).onItemSelected("_treebarclass_onitemselected").beforeValueUpdated("_treebarclass_beforevalueupdated"),"before");return D}}});Class("VisualJS.ObjectEditor","linb.Com",{Instance:{iniExComs:function(B){var A=this;linb.ComFactory.newCom("VisualJS.PageEditor",function(){var C=this;C.host=A;C.setProperties({checkType:"js"});C.show(null,A.dialog,null,B);A.PageEditor=C},B)},check:function(A){return this.PageEditor.check(A)},_dialog_beforeclose:function(A){this.dialog.hide();return false},_btncancel_onclick:function(){this.dialog.close()},_btnok_onclick:function(){var B=this,C=B.properties,A=B.PageEditor.getText(false);if(A===false){return false}if(C.text!=A){if(false===B.check(A)){return false}C.result=VisualJS.ClassTool.parseSingleBlock(A);if(false===C.result){linb.message(linb.getRes("VisualJS.classtool.err1"));return false}C.text=A;C.object=_.unserialize(C.text)||null;_.tryF(C.onOK,[B],B.host)}B.dialog.close()},customAttach:function(A){var B=this,D=B.properties,C=B.dialog;C.setCaption(D.caption).setIcon(D.icon).setIconPos(D.iconPos);B.PageEditor.setText(D.text);if(D.fromRegion){C.setFromRegion(D.fromRegion)}if(!C.get(0).root){C.create()}C.show(A,true);return false},iniComponents:function(){var B=this,D=B._nodes=[],A=linb.UI,C=function(E){D.push(E.get(0))};C((new A.Dialog).host(B,"dialog").setLeft(216).setTop(80).setWidth(500).setMaxBtn(false).setMinBtn(false).setCaption("dialog").beforeClose("_dialog_beforeclose"));B.dialog.attach((new A.Panel).host(B,"panelB").setDock("bottom").setHeight(35));B.panelB.attach((new A.Panel).host(B,"panelR").setDock("right").setWidth(284));B.panelR.attach((new A.Button).host(B,"btnCancel").setLeft(64).setTop(8).setWidth("100").setCaption("Cancel").setIcon("img/App.gif").setIconPos("-16px -16px").onClick("_btncancel_onclick"));B.panelR.attach((new A.Button).host(B,"btnOK").setLeft(176).setTop(8).setWidth("100").setCaption("OK").setIcon("img/App.gif").setIconPos("-64px -16px").onClick("_btnok_onclick"));return D}}});Class("VisualJS.ProjectPro","linb.Com",{Instance:{customAttach:function(){var A=this,B=A.properties;A.dialog.setCaption(B.caption).setIcon(B.icon).setIconPos(B.iconPos);A.inputName.setValue(B.projectName,true);A.inputClassName.setValue(B.className,true);A._refreshLabel(B.projectName);if(B.fromRegion){A.dialog.setFromRegion(B.fromRegion)}A.inputName.setDisabled(B.readonly);A.inputClassName.setDisabled(B.readonly);A.dialog.show(A.parent,true)},iniComponents:function(){var B=this,D=B._nodes=[],A=linb.UI,C=function(E){D.push(E.get(0))};C((new A.Dialog).host(B,"dialog").setLeft(100).setTop(100).setWidth(540).setHeight(220).setMinBtn(false).setMaxBtn(false).setResizable(false).setCaption("dialog").onHotKeydown("_dialog_onhotkey").beforeClose("_dialog_beforeclose"));B.dialog.attach((new A.Input).host(B,"inputName").setLeft(126).setTop(16).setTipsErr("$VisualJS.projectPro.onlyword").setValueFormat("^\\w{3,15}$").afterValueUpdated("_inputname_aftervalueupdated"));B.dialog.attach((new A.Label).host(B,"label1").setLeft(14).setTop(18).setWidth(104).setCaption("$VisualJS.projectPro.name"));B.dialog.attach((new A.Label).host(B,"label3").setLeft(30).setTop(82).setWidth(88).setCaption("$VisualJS.projectPro.classfile"));B.dialog.attach((new A.Label).host(B,"label5").setLeft(38).setTop(50).setWidth(80).setCaption("$VisualJS.projectPro.class"));B.dialog.attach((new A.Button).host(B,"btnCancel").setLeft(262).setTop(152).setWidth(90).setTabindex("0").setCaption("$VisualJS.cancel").setIcon("img/App.gif").setIconPos("-16px -16px").onClick("_btncancel_onclick"));B.dialog.attach((new A.Input).host(B,"inputClassName").setLeft(126).setTop(48).setValueFormat("^\\w{3,15}$").setTipsErr("$VisualJS.projectPro.onlyword"));B.dialog.attach((new A.Label).host(B,"label7").setLeft(126).setTop(114).setWidth(384).setHAlign("left").setCaption("label7"));B.dialog.attach((new A.Label).host(B,"label2").setLeft(30).setTop(114).setWidth(88).setCaption("$VisualJS.projectPro.pagefile"));B.dialog.attach((new A.Label).host(B,"label8").setLeft(126).setTop(82).setWidth(384).setHAlign("left").setCaption("label8"));B.dialog.attach((new A.Button).host(B,"btnOK").setLeft(374).setTop(152).setWidth(90).setCaption("$VisualJS.ok").setIcon("img/App.gif").setIconPos("-64px -16px").onClick("_btnok_onclick"));return D},_dialog_beforeclose:function(A){this.dialog.hide();return false},_btncancel_onclick:function(){this.dialog.close()},_btnok_onclick:function(){var A=this;if(A.inputName.checkUIValueValid()===false||A.inputClassName.checkUIValueValid()===false){linb.message(linb.getRes("VisualJS.projectPro.invalid"));return }var B=A.projectName=A.inputName.updateValue().getValue();A.className=A.inputClassName.updateValue().getValue();linb.request(CONF.phpPath,_.serialize({key:CONF.requestKey,para:{action:"new",hashCode:_.id(),path:this.projectName,className:this.className}}),function(C){var D=_.unserialize(C);if(!D||D.error){linb.message(C)}else{_.tryF(A.properties.onOK,["projects/"+B,D],A.host)}A.dialog.close()},function(C){linb.message(C)})},_inputname_aftervalueupdated:function(B,A,C){this._refreshLabel(C)},_refreshLabel:function(C,B){var A=this;B=B||"index";A.label7.setCaption(linb.ini.appPath+"projects/"+C+"/"+B+".html");A.label8.setCaption(linb.ini.appPath+"projects/"+C+"/VisualJS/js/"+B+".js")},_dialog_onhotkey:function(C,B,E,A,D){if(B=="esc"){C.boxing().close()}}}});Class("VisualJS.ProjectSelector","linb.Com",{Instance:{customAttach:function(){var A=this,B=A.dialog,C=A.properties;B.setCaption(C.caption).setIcon(C.icon).setIconPos(C.iconPos);A.listName.setUIValue("").setItems([]);if(C.fromRegion){B.setFromRegion(C.fromRegion)}B.show(A.parent,true);linb.dom.setCover(linb.getRes("VisualJS.ps.getting"));linb.request(CONF.phpPath,_.serialize({key:CONF.requestKey,para:{action:"open",hashCode:_.id(),path:"projects",deep:"0"}}),function(E){var D=_.unserialize(E);if(!D||D.error){linb.message(E)}else{if(D&&D.length){A.properties.projectList=[];D.each(function(F){if(F.type===0){A.properties.projectList.push({id:F.location,caption:F.name})}})}A.listName.setItems(C.projectList);linb.dom.setCover(false)}},function(){linb.dom.setCover(false)})},iniComponents:function(){var B=this,D=B._nodes=[],A=linb.UI,C=function(E){D.push(E.get(0))};C((new A.Dialog).host(B,"dialog").setLeft(100).setTop(100).setWidth(340).setHeight(190).setMinBtn(false).setMaxBtn(false).setResizable(false).setCaption("dialog").onHotKeydown("_dialog_onhotkey").beforeClose("_dialog_beforeclose"));B.dialog.attach((new A.List).host(B,"listName").setDock("top").setHeight(120).setItems([]));B.dialog.attach((new A.Button).host(B,"btnCancel").setLeft(140).setTop(130).setWidth(90).setZIndex("1").setCaption("$VisualJS.cancel").setIcon("img/App.gif").setIconPos("-16px -16px").onClick("_btncancel_onclick"));B.dialog.attach((new A.Button).host(B,"btnOK").setLeft(230).setTop(130).setWidth(90).setZIndex("1").setCaption("$VisualJS.ok").setIcon("img/App.gif").setIconPos("-64px -16px").onClick("_btnok_onclick"));return D},_btncancel_onclick:function(){this.dialog.close()},_btnok_onclick:function(){var A=this,B=A.projectName=A.listName.getUIValue();if(!A.projectName){linb.message(linb.getRes("VisualJS.ps.noselected"));return }linb.request(CONF.phpPath,_.serialize({key:CONF.requestKey,para:{action:"open",hashCode:_.id(),path:this.projectName}}),function(C){var D=_.unserialize(C);if(!D||D.error){linb.message(C)}else{_.tryF(A.properties.onOK,[B,D],A.host)}A.dialog.close()})},_dialog_beforeclose:function(A){this.dialog.hide();return false},_dialog_onhotkey:function(C,B,E,A,D){if(B=="esc"){C.boxing().close()}}}});Class("VisualJS.Designer","linb.Com",{Instance:{panelHeight:600,panelWidth:800,dropPosition:"absolute",dropOffset:10,events:{afterShow:function(A,B){var D="img/designer/toolbar.gif",C="$VisualJS.designer.tool.";A.proxy=linb.create('<div style="position:absolute;border:dashed 1px blue;overflow:visible;left:-100px;top:-100px;z-index:1000"></div>');A.resizer=linb.create("Resizer",{dragArgs:{grid_width:this.dropOffset,grid_height:this.dropOffset},zIndex:linb.dom.top_zIndex});A.resizer.host(A).onItemsSelected(function(F,E){this.pProfile.setSelectFromResizer.call(this.pProfile,E)}).onActive(function(E){this._focus()}).onUpdate(function(I,J,H,F){A._change();var G=this;if(J){var E=false;J.each(function(P){P=linb([P],false);var L=linb.cache.dom[P.get(0).id],N=L.boxing(),K=L.properties,M=L.box.getDataModel();if(H){var S=null,O=null;if(H.width){if(K&&!M.width){E=true}else{switch(K.dock){case"top":case"bottom":case"fill":case"cover":case"width":E=true;break;case"left":case"right":case"height":E=true;default:P.widthBy(H.width,true);S=N.refreshWidth()}}}if(H.height){if(K&&!M.height){E=true}else{switch(K.dock){case"left":case"right":case"fill":case"cover":case"height":E=true;break;case"top":case"bottom":case"width":E=true;default:P.heightBy(H.height,true);O=N.refreshHeight()}}}G._sizeUpdated(P,{width:S,height:O})}if(F){var R=null,Q=null;if(F.left){if(K&&!M.left){E=true}else{switch(K.dock){case"top":case"bottom":case"left":case"right":case"fill":case"cover":case"width":E=true;break;case"height":E=true;default:P.leftBy(F.left);R=N.refreshLeft()}}}if(F.top){if(K&&!M.top){E=true}else{switch(K.dock){case"left":case"right":case"top":case"bottom":case"fill":case"cover":case"height":E=true;break;case"width":E=true;default:P.topBy(F.top);Q=N.refreshTop()}}}G._posUpdated(P,{left:R,top:Q})}});if(E){I.boxing().rePosSize()}}}).onFocusChange(function(F,E){if(this.tempSelected){this.SelectedFocus=E;_.resetRun("$profilegrid$",this._refreshProfileGrid,0,[this.tempSelected],this)}}).onRegionClick(function(K,L){var H=linb.event.getPos(L),F,J,E,I;var G=function(R,Y,W){var T=arguments.callee,N,O,U,X,Q,M={},S=W.absPos(),V=W.offsetWidth(),P=W.offsetHeight();M.left=Y.left-S.left;M.top=Y.top-S.top;R.each(function(Z){if(N=Z[0].root){if(Z[0].children.length){if(O=T(Z[0].children,Y,N)){return false}}U=N.absPos(null,W);X=N.offsetWidth();Q=N.offsetHeight();if(M.left>U.left&&M.top>U.top&&M.left<U.left+X&&M.top<U.top+Q&&M.left<V&&M.top<P){O=Z[0].$id;return false}}});return O};if(!(F=this.tempSelected)||!F.length){return }F.each(function(M){J=linb.UIProfile.getFromCacheId(M);I=G(J.children,H,J.root);if(I){return false}});if(I){this.selectWidget([I]);return false}});A.holder=linb.create('<div style="display:none;"></div>');A.panelDiv.reBoxing().addLast(A.holder);A.holder.addLast(A.resizer);A.holder.addLast(A.proxy);A.proxy.get(0).zIndexIgnore=true;A.toolbar.setItems([{id:"code",sub:[{id:"format",icon:"img/App.gif",iconPos:"-32px -48px",type:"button",tips:C+"tocode"},{id:"json",icon:"img/App.gif",iconPos:"-128px -64px",type:"button",tips:C+"tojson"}]},{id:"align",sub:[{id:"left",caption:"",icon:D,iconPos:"0 top",tips:C+"left"},{id:"center",caption:"",icon:D,iconPos:"-16px top",tips:C+"center"},{id:"right",caption:"",icon:D,iconPos:"-32px top",tips:C+"right"},{id:"s1",type:"split"},{id:"top",caption:"",icon:D,iconPos:"-48px top",tips:C+"top"},{id:"middle",caption:"",icon:D,iconPos:"-64px top",tips:C+"middle"},{id:"bottom",caption:"",icon:D,iconPos:"-80px top",tips:C+"bottom"},{id:"s2",type:"split"},{id:"w",caption:"",icon:D,iconPos:"-96px top",tips:C+"width"},{id:"wh",caption:"",icon:D,iconPos:"-112px top",tips:C+"wh"},{id:"h",caption:"",icon:D,iconPos:"-128px top",tips:C+"height"}]},{id:"pos",sub:[{id:"zindex1",caption:"",icon:D,iconPos:"-144px top",tips:C+"toplayer"},{id:"zindex2",caption:"",icon:D,iconPos:"-160px top",tips:C+"bottomlayer"},{id:"s1",type:"split"},{id:"repos",caption:"",icon:D,iconPos:"-176px top",tips:C+"gridxy"},{id:"resize",caption:"",icon:D,iconPos:"-192px top",tips:C+"gridwh"},{id:"s2",type:"split"},{id:"clone",caption:"",icon:D,iconPos:"-240px top",tips:C+"clone"}]},{id:"del",sub:[{id:"delete",caption:"",icon:D,iconPos:"-256px top",tips:C+"delete"}]}]);A.treebarCom.setItems(_.clone(CONF.widgets)).setCustomBehavior({BAR:{onMousedown:function(F,H,J){var L=J.id,I=F.getSubSerialId(L),E=F.properties,G=F.getItemByDom(L),K=linb.event.getPos(H);if(G.dragable){F.getSubNode("ICON",I).startDrag(H,{drop2:true,icon:linb.ini.path+"onDrag.gif",dragMode:"add",cursor:"pointer",target_left:K.left+12,target_top:K.top+12,move:false,key:G.dragKey||F.properties.dragKey,data:{type:G.id,iconPos:G.iconPos}});F.removeTagClass("BAR","-mouseover",linb([J]));A._clearSelect();A._setSelected([],true)}}}});A.focusBtn=linb.create('<a href="javascript;" style="position:absolute;left:-10000px;top:-10000px;width:1px;height:1px;">o</a>');A.focusBtn.onKeydown(function(K,T,J){if(!A.resizer){return }var V=linb.event.getKey(T),Q=V[0],L=V[1],S=V[2],I=1,P=A.resizer.reBoxing(),G=A.resizer.get(0),R=P.cssPos(),E=P.cssSize(),M=G.properties.dragArgs.grid_height,F=G.properties.dragArgs.grid_width;var N,U=false,O=null,H=null;switch(Q){case"up":U=true;if(L){I=-1}else{if(S){I=(N=(R.top+E.height)%M)?-N:-M}else{I=(N=R.top%M)?-N:-M}}if(S){P.heightBy(I);G.regions.heightBy(I);O={width:0,height:I}}else{P.topBy(I);H={left:0,top:I}}break;case"down":U=true;if(L){I=1}else{if(S){I=(N=(R.top+E.height)%M)?M-N:M}else{I=(N=R.top%M)?M-N:M}}if(S){P.heightBy(I);G.regions.heightBy(I);O={width:0,height:I}}else{P.topBy(I);H={left:0,top:I}}break;case"left":U=true;if(L){I=-1}else{if(S){I=(N=(R.left+E.width)%F)?-N:-F}else{I=(N=R.left%F)?-N:-F}}if(S){G.regions.widthBy(I);P.widthBy(I);O={width:I,height:null}}else{P.leftBy(I);H={left:I,top:0}}break;case"right":U=true;if(L){I=1}else{if(S){I=(N=(R.left+E.width)%F)?F-N:F}else{I=(N=R.left%F)?F-N:F}}if(S){P.widthBy(I);G.regions.widthBy(I);O={width:I,height:null}}else{P.leftBy(I);H={left:I,top:0}}break;case"delete":A._deleteSelected();A._focus();break;case"esc":A._clearSelect();A._setSelected([],true);break}if(U){G.boxing().onUpdate(G,G._target,O,H);return false}}).onFocus(function(G,E,F){clearTimeout(A.timer);A.resizer.active(false)}).onBlur(function(G,E,F){A.timer=_.asyRun(function(){if(A.resizer){A.resizer.inActive()}},200)});A.layoutBase.reBoxing().addFirst(A.focusBtn);A._enablePanelDesign(A.canvas.get(0));A.setText(A.properties.text,true,B)},onSelected:function(D,C,B){var A=null,F=B&&B[B.length-1];if(F){var E=linb.getObject(F);if(E){A=E}}D.listObject.setCtrlValue(A?A.alias:"page",true);_.resetRun("$profilegrid$",D._refreshProfileGrid,0,[B],D)},onReady:function(A){A.canvas.setWidth(A.panelWidth).setHeight(A.panelHeight);A.panelBG.setWidth(A.panelWidth).setHeight(A.panelHeight)}},_detatchResizer:function(){var A=this;A.holder.addLast(A.resizer);A.holder.addLast(A.proxy);A.pProfile=A.pNode=null},_attachResizer:function(B,C){var A=this;A.proxy.display("none");A.resizer.resetTarget(null,false);linb(C).addLast(A.resizer).addLast(A.proxy);A.pProfile=B;A.pNode=C;_.merge(A.resizer.get(0).properties.dragArgs,{grid_width:A.dropOffset,grid_height:A.dropOffset},"all")},_focus:function(){this.focusBtn.focus()},_setSelected:function(E,B){var C=this,A=C.toolbar,D;E=_.arr(E);C.tempSelected=E;C.SelectedFocus=E.length-1;A.disableGroup("align",E.length>1?false:true);if(E.length>0&&(D=linb.UIProfile.getFromCacheId(E[0]))){A.disableGroup("pos",!D.box.hasDomRoot)}else{A.disableGroup("pos",true)}A.disableGroup("del",E.length>0?false:true);if(B){C.events.onSelected.apply(C.parent,[C,C.pProfile,E])}C._focus();return C},_sizeUpdated:function(D,C){var B,A=this;if(!(B=A.profileGrid.get(0).$widget)){return }if(linb.cache.dom[D.get(0).id]==B.get(B.length()-1)){_.asyRun(function(){if(C.width!==null){A.profileGrid.updateCellbyRowCol("properties:width","value",C.width,true)}if(C.height!==null){A.profileGrid.updateCellbyRowCol("properties:height","value",C.height,true)}})}},_posUpdated:function(D,A){var C,B=this;if(!(C=B.profileGrid.get(0).$widget)){return }if(linb.cache.dom[D.get(0).id]==C.get(C.length()-1)){_.asyRun(function(){if(A.left!==null){B.profileGrid.updateCellbyRowCol("properties:left","value",A.left,true)}if(A.top!==null){B.profileGrid.updateCellbyRowCol("properties:top","value",A.top,true)}})}},parseFun:function(A){var C=A;var B=new RegExp("^(\\s*\\/\\*[^*@]*\\*+([^\\/][^*]*\\*+)*\\/\\s*)|^(\\s*\\/\\/[^\\n]*\\s*)");while(B.test(C)){C=C.replace(B,"")}C=C.replace(/\s*/,"");if(!C){return{comments:null,code:null}}if(false===this.check(C.replace(/\s*$/,""))){return false}return{comments:"\n"+A.replace(C,""),code:C.replace(/\s*$/,"")}},_designable:function(B){var C=arguments.callee,A=this;A._giveHandler(B);B.properties.$design=A.properties.$design;if(linb.cache.$dropPool[B.box.KEY]){A._enablePanelDesign(B)}if(B.children&&B.children.length){B.children.each(function(D){C.call(A,D[0])})}B.$addOns=function(D){C.call(A,D)}},_WidgetsSelected:function(B){var A=this;this._setSelected(B,true);this.iconlist.updateUIValue(null)},_clearSelect:function(A){this.resizer.resetTarget(null,false);this._detatchResizer();this.iconlist.updateUIValue(null)},_deleteSelected:function(){if(!this.tempSelected||!this.tempSelected.length){return }var A=this;linb.UI.Dialog.confirm(linb.getRes("VisualJS.designer.confirmdel"),linb.getRes("VisualJS.designer.confirmdel2",this.tempSelected.length),function(){var D=linb.UI.getByCacheId(A.tempSelected);if(!D.isEmpty()){var C=[];var B=linb.UI.getByCacheId(A.tempSelected);B.each(function(F){if(!F.box.hasDomRoot){A.iconlist.removeItems(F.$id)}});B.destroy()}else{var E=linb.getObject(A.tempSelected[0]);if(E.box["linb.DataSource"]){A.iconlist.removeItems(A.tempSelected)}E.boxing().destroy()}A._clearSelect(A.pProfile);A._setSelected(null,true)})},_giveHandler:function(C){var D=function(F){var E=F.split(":");return E[0].split("-")[0]+":"+E[1]+":"},A=function(){return };var B=this;C.root.beforeClick(A).afterClick(A).onClick(function(K,I,J){var E=linb.event.getSrc(I),L=E.id;if(L==linb.langId){L=E.parentNode.id}if(D(L)!=(L=D(J.id))){return }var G,F=linb.event.currentKey,H=linb.cache.dom[L];if(!H){return }if(B.pProfile&&(B.pProfile!=H.parent)){B.pProfile.selected=[]}if(G=H.parent){if(F&&F[2]){G.reSelectObject.call(G,H,H.root.parent())}else{G.selectObject.call(G,H,H.root.parent())}}return false})},_enablePanelDesignFace:function(B,A){B.getSubNode(A,true).addClass("panel").addEventHandler("drop").addEventHandler("mousedown").addEventHandler("click").addEventHandler("drag").addEventHandler("dragstop").addEventHandler("mouseup")},_enablePanelDesign:function(A){var J,I=A.box.KEY,F=linb.cache.$dropPool,G=this,E,C,K=this,B={beforeMouseover:function(N,P,Q){var L=linb.dragDrop,M=L.dragKey,O=L.data;if(!M||!O||!(new RegExp("\\b"+M+"\\b")).test(N.box.getDropKeys(N,this))||O.parentId==N.$id||(O.data&&O.data.exists(N.$id))||(N.onDropTest&&(false===N.boxing().onDropTest(N,M,O)))){return }L._current=Q;_.resetRun("showDDMark",L.showDDMark,0,[this],L);var R=(R=N.getItemByDom(Q))&&R.id;if(N.onDragEnter){N.boxing().onDragEnter(N,P,this,R)}},beforeDrop:function(M,c,U){K._change();var f,Y=linb.dragDrop.x,X=linb.dragDrop.y,W=linb.dragDrop.dragKey,P=linb.dragDrop.dragData,O=P.type,T=P.iconPos,g=P.data,S=P.pos,Z,R=K.dropOffset,d=function(){var l=arguments.callee.page;if(!linb.SC(O).hasDomRoot){var q=linb.create(O,{$design:K.properties.$design}).get(0);l.iconlist.insertItems([{id:q.$id,icon:"img/widgets.gif",iconPos:T}],null,false);l.iconlist.updateUIValue(q.$id)}else{if(K.dropPosition=="absolute"){var h=linb(U).absPos(),e={left:parseInt((Y-h.left)/R)*R,top:parseInt((X-h.top)/R)*R};f=new (linb.SC(linb.iBox.$type[O]))({$design:K.properties.$design});f.create();var m=f.get(0).properties;if(!m.$left){f.setLeft(["top","bottom","width","fill","cover"].exists(m.dock)?0:e.left)}if(!m.$top){f.setTop(["left","right","height","fill","cover"].exists(m.dock)?0:e.top)}if(!m.$position){f.setPosition("absolute")}f.setZIndex(1)}else{f=new (linb.SC(linb.iBox.$type[O]))({$design:K.properties.$design});f.create()}var n=f.get(0);l._designable(n);n._host=l;var k=n.box.$EventHandlers;for(var j in k){n[j]=k[j]}Z=[f["linb.iBox"]?n.$id:f.$id];if(f["linb.UI"]){M.boxing().attach(f,M.getItemIdByDom(U))}M.setSelectFromPanel.call(M,U,Z);U=null}};d.page=G;if(O){if(linb.SC.evalPath(O)){d()}else{linb.dom.UIAction(function(){linb.dom.setCover(linb.getRes("VisualJS.designer.loading")+O);linb.SC(O,true,d)})}}else{var L=linb(U).absPos(),b={left:parseInt((Y-L.left)/R)*R,top:parseInt((X-L.top)/R)*R};var V;Z=g;f=linb.UI.getByCacheId(Z);var Q,N;f.each(function(h,e){if(e===0){Q=h.properties.left;N=h.properties.top}else{Q=Math.min(h.properties.left,Q);N=Math.min(h.properties.top,N)}});f.each(function(e){if(e.properties.dock!="none"){e.box.dock(e,true)}else{e.boxing().setLeft(e.properties.left-Q+b.left).setTop(e.properties.top-N+b.top)}});M.boxing().attach(f,M.getItemIdByDom(U));M.setSelectFromPanel.call(M,U,Z)}},onMousedown:function(O,P,R){if(linb.event.getSrc(P)!==R){return }var Q=linb(R),S=linb.event.getPos(P),L=Q.absPos(),M=Q.clientWidth(),N=Q.clientHeight();if(S.left-L.left>M){return }if(S.top-L.top>N){return }O._offsetPos=L;O._scrollTop=Q.scrollTop();O._scrollLeft=Q.scrollLeft();G._attachResizer(O,R);O._selregion={};var S=linb.event.getPos(P);linb(R).startDrag(P,{move:false,type:"blank",cursor:"crosshair",target_left:S.left,target_top:S.top,defer:1});O.$dragging=false},onClick:function(L,M,N){if(linb.event.getSrc(M)!==N){return }K._clearSelect(L);L.setSelectFromPanel.call(L,this,[])},beforeDrag:function(O,Q,R){var N,L=linb.dragDrop,S=L.getOffset(),M=G.proxy;var P=O._selregion;if((N=S.x)<0){S.x=-N}if((N=S.y)<0){S.y=-N}P.left=Math.min(L.ox,L.x)-O._offsetPos.left+O._scrollLeft;P.top=Math.min(L.oy,L.y)-O._offsetPos.top+O._scrollTop;P.width=S.x;P.height=S.y;M.setRegion(P);if(!O.$dragging){M.display("block");O.$dragging=true}},beforeDragstop:function(P,d,T){var R=P._selregion,Z=G.proxy,W=[],U,Y,X,c,O,b,N,S,M,Q,L,V=this;S=R.left;M=R.top;Q=S+R.width;L=M+R.height;if(Y=P.children){Y.each(function(e,f){e=e[0];if(e.domNode.parentNode===V&&e.domNode.style.display!="none"&&e.domNode.style.visibility!="hidden"){X=e.root;c=X.offsetLeft();O=X.offsetTop();b=c+X.width();N=O+X.height();if(Q>c&&b>S&&L>O&&N>M){W.push(e.$id)}}});P.setSelectFromPanel.call(P,this,W)}_.asyRun(function(){Z.display("none")})},onMouseup:function(L,M,N){_.asyRun(function(){G.proxy.display("none")})}};var H=A.properties.dropKeys.split(/[^\w]+/);H.filter(function(L){return !!L});if(H.indexOf("iDesign")==-1){H.push("iDesign")}A.properties.dropKeys=H.join(":");if(J=F[I]){var D=J[0];if(A.keys.KEY==A.keys[D]){E=B}else{E={};E[D]=B}A._CB=E;A.resetCache();G._enablePanelDesignFace(A,D)}_.merge(A,{selectObject:function(N,M){var L=this,O=N.$id;return this.setSelectFromPanel(M,[O])},reSelectObject:function(N,M){var L=this;id=N.$id;if(L.selected&&L.selected.exists(id)){L.selected.removeValue(id)}else{(L.selected||(L.selected=[])).push(id)}return this.setSelectFromPanel(M,L.selected)},setSelectFromResizer:function(M){var L=this;L.selected=M;return this.resetSelectRel()},setSelectFromPanel:function(N,M){var L=this;if(K.pProfile!==L||K.pNode!==N){K._clearSelect(L);K._attachResizer(L,N)}L.selected=M;K.resizer.resetTarget(linb.UI.getByCacheId(L.selected).reBoxing(),false);return this.resetSelectRel()},resetSelectRel:function(){var M=this;if(M.selected&&M.selected.length){var L=K.resizer.get(0).properties;L.dragArgs={key:"iDesign",grid_width:K.dropOffset,grid_height:K.dropOffset,data:{parentId:M.$id,data:M.selected}}}else{K._clearSelect(M)}_.tryF(K._WidgetsSelected,[M.selected],K);K._focus()}},"all")},_refreshProfileGrid:function(B){var L=this;this.profileGrid.resetContent();if(!B||!B.length){var M=this.canvas.get(0);var I=[];var G=_.get(this.properties.clsObject,["Static","EventHandlers"]);if(!G){G=linb.Com.EventHandlers}var E=_.get(this.properties.clsObject,["Instance","events"]);var D=function(T){var R;var S=_.get(T.clsStruct,["sub","Instance","sub","events","code"]);if(S){S=_.unserialize(S)}else{S={}}var Q=S[T.funName]||("_"+T.funName.toLowerCase());var Y=_.get(T.clsStruct,["sub","Instance","sub",Q]);var V=(Y?(Y.comments||""):"");if(V){V=V.replace(/^[\r\n]*/,"")}if(Y&&Y.code){R=Y&&Y.code;T.mapName=S[T.funName]}else{if(!T.ini){return""}R=" ".repeat(8)+T.ini.toString().replace(/\n/g,"\n"+" ".repeat(8));T.mapName="_"+T.funName.toLowerCase();var W=_.get(T.clsStruct,["sub","Instance","sub"]);if(W[T.mapName]){var U=1,X;while(W[X=T.mapName+"_"+(++U)]){}T.mapName=X}}return V+R};_.each(G,function(T,R){var Q=function(V,U){var X=U.$tagVar;var W=V.getSubNode("CELL",U._serialId);linb.ComFactory.newCom("VisualJS.ObjectEditor",function(){this.host=L;this.setProperties({icon:"img/App.gif",iconPos:"-32px -32px",text:D(X),caption:X.widgetName+" => "+X.funName,fromRegion:W.getRegion(true),tagVar:X,onOK:function(b){this._change();var Z=b.properties.tagVar;if(b.properties.result.code!==null){_.set(Z.clsStruct,["sub","Instance","sub",Z.mapName,"code"],b.properties.result.code);_.set(Z.clsStruct,["sub","Instance","sub",Z.mapName,"comments"],b.properties.result.comments);V.box.changeCellValue(V,U,Z.mapName,true)}else{_.set(Z.clsStruct,["sub","Instance","sub",Z.mapName,"code"],null);_.set(Z.clsStruct,["sub","Instance","sub",Z.mapName,"comments"],null);var Y=_.get(Z.clsStruct,["sub","Instance","sub","events","code"]);if(Y){Y=_.unserialize(Y);delete Y[Z.funName];_.set(Z.clsStruct,["sub","Instance","sub","events","code"],_.serialize(Y))}V.box.changeCellValue(V,U,"",true)}W.focus()}});this.show(linb([document.body]))})},S={widgetName:"page",obj:this.properties.clsObject,clsStruct:this.properties.clsStruct,clsObject:this.properties.clsObject,funName:R,mapName:(E&&E[R])||"",ini:T};I.push({id:"event:"+R,cells:[{value:R,type:null,$tagVar:null,event:null},{value:(E&&E[R])||"",type:"popbox",$tagVar:S,event:Q}]})},this);var P=[{id:"alias",cells:[{value:"alias",type:"label"},{value:"page",type:"label"}]},{id:"domId",cells:[{value:"domId",type:"label"},{value:"*",type:"label"}]},{id:"properties:width",cells:[{value:"width",type:"label"},{value:M.properties.width,type:""}]},{id:"properties:height",cells:[{value:"height",type:"label"},{value:M.properties.height,type:""}]},{id:"UIE",cells:[{value:"events",type:"label"},{value:"",type:"label"}],sub:I}];var K=[];this.profileGrid.insertRows(P);this.profileGrid.get(0).$widget=this.canvas}else{var O,J,N=linb.UI.getByCacheId(B);if(J=N.length()){var M=N.get(this.SelectedFocus);var A=[0,0,0,0,0,0,0,0],H=0;var F=function(R,Q){var U=Q.$tagVar;var S=R.getSubNode("CELL",Q._serialId);var T=U.profile[U.name];linb.ComFactory.newCom("VisualJS.ObjectEditor",function(){this.host=L;this.setProperties({caption:U.widgetName+" => "+U.name,icon:"img/App.gif",iconPos:T.constructor==Array?"-128px -32px":"-16px -32px",text:linb.coder.decode(_.serialize(linb.UI.pickObj(T))),fromRegion:S.getRegion(true),tagVar:U,onOK:function(W){this._change();var V=W.properties.tagVar;V.profile.boxing()[V.funName](W.properties.object);S.focus()}});this.show(linb([document.body]))})};var P=[{id:"key",cells:[{value:"class",type:"label"},{value:"<strong>"+M.key+"</strong>",type:"label"}]},{id:"alias",cells:[{value:"alias",type:"label"},{value:M.alias,type:""}]},{id:"domId",cells:[{value:"domId",type:"label"},{value:M.domId,type:""}]},{id:"template",cells:[{value:"template",type:""},{value:M.template._id,type:"listbox",listKey:M.box.KEY+":template"}]},{id:"appearance",cells:[{value:"appearance",type:""},{value:M.appearance,type:"listbox",listKey:M.box.KEY+":appearance"}]},{id:"behavior",cells:[{value:"behavior",type:""},{value:M.behavior._id,type:"listbox",listKey:M.box.KEY+":behavior"}]},{id:"properties",cells:[{value:"properties",type:"label"},{value:"",type:"label"}],sub:[]},{id:"UIE",cells:[{value:"events",type:"label"},{value:"",type:"label"}],sub:[]},{id:"CA",cells:[{value:"Custom Appearances",type:"label"},{value:"(Collection)",event:F,$tagVar:{name:"CA",funName:"setCustomAppearance",profile:M},type:"popbox:readonly"}]},{id:"CC",cells:[{value:"Custom Class",type:"label"},{value:"(Collection)",event:F,$tagVar:{name:"CC",funName:"setCustomClass",profile:M},type:"popbox:readonly"}]},{id:"CB",cells:[{value:"Custom Behaviors",type:"label"},{value:"(Collection)",event:F,$tagVar:{name:"CB",funName:"setCustomBehavior",profile:M},type:"popbox:readonly"}]},{id:"CF",cells:[{value:"Custom Functions",type:"label"},{value:"(Collection)",event:F,$tagVar:{name:"CF",funName:"setCustomFunction",profile:M},type:"popbox:readonly"}]}];var I=[],C=CONF.mapWidgets[M.box.KEY];O=C&&C.Templates;if(!O){O=[]}if(!O.exists("default")){O.insertAny("default",0)}O.each(function(Q){I.push({id:Q,caption:Q,value:Q})});linb.UI.setCacheList(M.box.KEY+":template",I);I=[];O=C&&C.Appearances;if(!O){O=[]}if(!O.exists("default")){O.insertAny("default",0)}O.each(function(Q){I.push({id:Q,caption:Q,value:Q})});linb.UI.setCacheList(M.box.KEY+":appearance",I);I=[];O=C&&C.Behaviors;if(!O){O=[]}if(!O.exists("default")){O.insertAny("default",0)}O.each(function(Q){I.push({id:Q,caption:Q,value:Q})});linb.UI.setCacheList(M.box.KEY+":behavior",I);I=[];N.each(function(R,Q){if(Q===J-1){return }if(!A[0]&&R.key!=M.key){A[0]=1;H++}if(!A[1]){P[1].cells[1].type="label";A[1]=1;H++}if(!A[2]&&R.template._id!=M.template._id){P[2].cells[1].type="label";A[2]=1;H++}if(!A[3]&&R.appearance!=M.appearance){P[3].cells[1].type="label";A[3]=1;H++}if(!A[4]&&R.behavior._id!=M.behavior._id){P[4].cells[1].type="label";A[4]=1;H++}if(!A[5]){P[5].cells[1].type="label";A[5]=1;H++}if(H==6){return false}});this.profileGrid.insertRows(P);this.profileGrid.get(0).$widget=N}else{N=linb.Base.getByCacheId(B[0]);M=N.profile;var P=[{id:"key",cells:[{value:"class",type:"label"},{value:M.key,type:"label"}]},{id:"alias",cells:[{value:"alias",type:"label"},{value:M.alias,type:""}]},{id:"domId",cells:[{value:"domId",type:"label"},{value:M.domId,type:""}]},{id:"properties",cells:[{value:"properties",type:"label"},{value:"",type:"label"}],sub:[]},{id:"UIE",cells:[{value:"events",type:"label"},{value:"",type:"label"}],sub:[]}];this.profileGrid.insertRows(P);this.profileGrid.get(0).$widget=N}}},_change:function(){this._dirty=true;_.tryF(this.events.onValueChanged,[this,null,this._dirty],this.host)},$toolbar_onclick:function(G,C,H,B){var K=this;switch(H){case"code":switch(C){case"format":case"json":linb.dom.UIAction(function(){var R=new linb.UI.Dialog();R.setLeft(100).setTop(100).setWidth(300).setHeight(200).setStatus("max").setMinBtn(false).setMaxBtn(false).setCaption("Formatted code");R.create();var Q,P;if(K.tempSelected&&K.tempSelected.length){P=[];K.tempSelected.each(function(T){P.push(linb.Profile.getFromCacheId(T))})}else{P=K.getWidgets()}var S;switch(C){case"format":S=linb.coder.parse(K.getJSCode(P),"js",["plain"]);break;case"json":S=linb.coder.format(K.getJSONCode(P),"js",["plain"]);break}R.html(S);R.show(linb(document.body),true)});break}break;case"align":this._change();var F=linb.UI.getByCacheId(this.tempSelected);var D=F.get(this.SelectedFocus),E=D.root,O=E.cssSize(),M=E.cssPos();F.each(function(Q){if(Q.locked){return }var P=Q.root;switch(C){case"left":P.left(M.left);Q.boxing().refreshLeft();break;case"center":P.left(M.left+O.width/2-P.width()/2);Q.boxing().refreshLeft();break;case"right":P.left(M.left+O.width-P.width());Q.boxing().refreshLeft();break;case"top":P.top(M.top);Q.boxing().refreshTop();break;case"middle":P.top(M.top+O.height/2-P.height()/2);Q.boxing().refreshTop();break;case"bottom":P.top(M.top+O.height-P.height());Q.boxing().refreshTop();break;case"w":P.width(O.width);Q.boxing().refreshWidth();break;case"wh":P.width(O.width).height(O.height);Q.boxing().refreshWidth();Q.boxing().refreshHeight();break;case"h":P.height(O.height);Q.boxing().refreshHeight();break}});this.resizer.rePosSize();this._focus();break;case"pos":this._change();var F=linb.UI.getByCacheId(this.tempSelected);var K=this;if("clone"==C){var A=[];var N,A=[],I;var B=linb.UI.getByCacheId(this.tempSelected);var J=B.clone();B.get(0).parent.boxing().attach(J);I=B.get(0).parent.$id;J.each(function(P){A.push(P.$id)});J.each(function(P){K._designable(P)});this.resizer.resetTarget(linb(J));linb.message(linb.getRes("VisualJS.designer.colneOK",A.length));return }var L=0;F.each(function(W){var R=W.boxing();var U=R.reBoxing();switch(C){case"zindex1":if(W.locked){return }if(!L){L=U.topZindex()}U.zIndex(L+1);R.refreshZIndex();break;case"zindex2":if(W.locked){return }U.zIndex(0);R.refreshZIndex();break;case"repos":case"resize":if(W.locked){return }var Q=U.left(),S=U.top(),V=K.dropOffset;U.left(parseInt(Q/V)*V).top(parseInt(S/V)*V);if(C=="resize"){var P=U.width(),T=U.height();U.width((parseInt((P+V-1)/V))*V).height((parseInt((T+V-1)/V))*V)}K.resizer.rePosSize();R.refreshLeft();R.refreshTop();R.refreshWidth();R.refreshHeight();break}});this._focus();break;case"del":this._change();if("delete"==C){this._deleteSelected()}break}},$profilegrid_afterrowactive:function(A,B){A.box.editCellbyRowCol(A,B.id,"value");return false},$profilegrid_beforevalueupdated:function(C,N,D,H){this._change();var J=this;try{var I,O,K,A,M,L,G=C.$widget;L=H;if((I=N._row.id.split(":")).length>1){K=I[0];M=I[1]}else{M=N._row.id}switch(K){case"properties":A="set"+M.initial();if(G.get(0)==this.canvas.get(0)){this.canvas[A](L);this.panelBG[A](L)}else{G.each(function(P){P.boxing()[A](L)});if(["left","top","width","height","right","bottom","dock","dockOrder"].exists(M)){this.resizer.rePosSize()}}break;case"event":if(G.get(0)==this.canvas.get(0)){if(H){var B=_.get(J.properties.clsStruct,["sub","Instance","sub","events","code"]);if(B){B=_.unserialize(B)}else{B={}}B[M]=H;_.set(J.properties.clsStruct,["sub","Instance","sub","events","code"],_.serialize(B));_.set(J.properties.clsStruct,["sub","Instance","sub","events","comments"],_.get(J.properties.clsStruct,["sub","Instance","sub","events","comments"]||"\n"+" ".repeat(8)));_.set(J.properties.clsObject,["Instance","events",M],H)}}else{G.each(function(P){if(H){P[M]=H;_.set(J.properties.clsObject,["Instance",M],H)}else{delete P[M]}})}break;default:if(M=="domId"){if(G.get(0).$domId!=L&&!/^[\w]*$/.test(L)){linb.message(linb.getRes("VisualJS.designer.domIdValid",L));return false}if(String(L).trim()==""){L=G.get(0).$domId;_.asyRun(function(){C.box.changeCellValue(C,N,L,true)});return false}if(G.get(0).$domId!=L&&linb.dom.byId(L)){linb.message(linb.getRes("VisualJS.designer.domIdExists",L));return false}this.listObject.setCtrlValue(L,true);G.setDomId(L)}else{if(M=="alias"){var E=this.getNames();if(E[L]){linb.message(linb.getRes("VisualJS.designer.nameExists",L));return false}this.listObject.setCtrlValue(L,true)}G[M](L)}}}catch(F){throw (F);return false}},$profilegrid_onrequestdata:function(C,S,I){var D,B=[],H,E=this,L=S.id,K=this,A=C.$widget,Q=A.length();var U=A.get(Q-1),N=U.box.$DataModel,P,T,R,G,F,O,M;if(L=="properties"){_.each(U.box.$DataStruct,function(X,V){if(["_","$"].exists(V.charAt(0))){return }if(N[V].hidden){return }R=null;G="";D="";if(N[V].readonly){T="";type="label"}else{if(N[V].listbox){type="listbox";R=[];T=U.key+":properties:"+V;if(_.isFun(N[V].listbox)){var W=N[V].listbox;R=function(){var Y=W.call(U),Z=[];Y.each(function(b){Z.push({id:b,caption:b,value:b})});return Z}}else{if(_.isObj(N[V].listbox[0])){R=N[V].listbox.copy()}else{N[V].listbox.each(function(Z,Y){R.push({id:Z,caption:Z})})}}linb.UI.setCacheList(T,R)}else{if(N[V].combobox){type="combobox";R=[];if(_.isFun(N[V].combobox)){var W=N[V].combobox;R=function(){var Y=W.call(U),Z=[];Y.each(function(b){Z.push({id:b,caption:b})});return Z}}else{if(_.isObj(N[V].combobox[0])){R=N[V].combobox.copy()}else{N[V].combobox.each(function(Z,Y){R.push({id:Z,caption:Z})})}}T=U.key+":properties:"+V;linb.UI.setCacheList(T,R)}else{if(N[V].helpinput){T=U.key+":properties:"+V;type="helpinput";R=N[V].helpinput.copy();linb.UI.setCacheList(T,R)}else{if(N[V].trigger){T="";type="getter";M=V;F=function(b,Y,e){var d=Y.$tagVar;var c=d.profile.boxing()["trigger"+d.name.initial()];_.tryF(c,null,d.profile.boxing());var Z="try again";e.boxing().updateUIValue(Z);b.box.changeCellValue(b,Y,Z,true)};O={profile:U,name:V}}else{if(_.isBool(X)){T="";type="checkbox";G=V}else{if(_.isObj(X)){T="";type="popbox:readonly";G=null;F=function(Z,Y){var d=Y.$tagVar;var b=Z.getSubNode("CELL",Y._serialId);var c=d.profile.boxing()["get"+d.name.initial()]();linb.ComFactory.newCom("VisualJS.ObjectEditor",function(){this.host=E;this.setProperties({caption:d.widgetName+" => "+d.name,icon:"img/App.gif",iconPos:c.constructor==Array?"-128px -32px":"-16px -32px",text:linb.coder.decode(_.serialize(linb.UI.pickObj(c))),fromRegion:b.getRegion(true),tagVar:d,onOK:function(h){this._change();var g,f=h.properties.tagVar;f.profile.boxing()["set"+d.name.initial()](h.properties.object);if(["dockMargin"].exists(d.name)){K.resizer.rePosSize()}b.focus();if(d.name=="items"){if(null===h.properties.object){f.profile.boxing().setItems([])}if(g=linb.cache.$dropPool[f.profile.box.KEY]){var e=g[0];K._enablePanelDesignFace(f.profile,e)}}}});this.show(linb([document.body]))})};O={widgetName:U.alias,profile:U,name:V};D="(Collection)"}else{T="";type=""}}}}}}}D=D||U.properties[V];if(_.isStr(D)){}B.push({id:"properties:"+V,cells:[{value:V,type:"",$tag:"",event:"",$tagVar:"",listKey:""},{value:D,type:type,$tag:G,event:F,$tagVar:O,listKey:T}]})})}B.sort(function(V,W){V=V.cells[0].value;W=W.cells[0].value;return V>W?1:V==W?0:-1});if(L=="UIE"){var J=function(d){var Z;var b=typeof d.profile[d.funName]=="string"?d.profile[d.funName]:("_"+d.widgetName.toLowerCase()+"_"+d.funName.toLowerCase());var Y=_.get(d.clsStruct,["sub","Instance","sub",b]);var c=(Y?(Y.comments||""):"");if(c){c=c.replace(/^[\r\n]*/,"")}if(Y&&Y.code){Z=Y&&Y.code;d.mapName=b}else{Z=" ".repeat(8)+d.ini.toString().replace(/\n/g,"\n"+" ".repeat(8));d.mapName="_"+d.widgetName.toLowerCase()+"_"+d.funName.toLowerCase();var X=_.get(d.clsStruct,["sub","Instance","sub"]);if(X[d.mapName]){var W=1,V;while(X[V=d.mapName+"_"+(++W)]){}d.mapName=V}}return c+Z};F=function(W,V){var Y=V.$tagVar;var X=W.getSubNode("CELL",V._serialId);linb.ComFactory.newCom("VisualJS.ObjectEditor",function(){this.host=E;this.setProperties({icon:"img/App.gif",iconPos:"-32px -32px",caption:Y.widgetName+" => "+Y.funName,text:J(Y),fromRegion:X.getRegion(true),tagVar:Y,onOK:function(b){this._change();var Z=b.properties.tagVar;if(b.properties.result.code!==null){_.set(Z.clsStruct,["sub","Instance","sub",Z.mapName,"code"],b.properties.result.code);_.set(Z.clsStruct,["sub","Instance","sub",Z.mapName,"comments"],b.properties.result.comments);Z.profile[Z.funName]=Z.mapName;W.box.changeCellValue(W,V,Z.mapName,true)}else{_.set(Z.clsStruct,["sub","Instance","sub",Z.mapName,"code"],null);_.set(Z.clsStruct,["sub","Instance","sub",Z.mapName,"comments"],null);Z.profile[Z.funName]=Z.profile.box.$EventHandlers[Z.funName];W.box.changeCellValue(W,V,"",true)}X.focus()}});this.show(linb([document.body]))})};_.each(U.box.$EventHandlers,function(W,V){O={profile:U,clsStruct:E.properties.clsStruct,widgetName:U.alias,funName:V,ini:W};B.push({id:"event:"+V,cells:[{value:V,type:null,$tagVar:null},{value:typeof U[V]=="string"?U[V]:"",type:"popbox",$tagVar:O,event:F}]})})}A.each(function(Y,X){if(X===(Q-1)){return }if(L=="properties"){var W=[],V=0;B.each(function(b,Z){if(V==B.length){return false}if(!W[Z]&&Y.properties[b.cells[0].value]!==U.properties[b.cells[0].value]){b.cells[1].type="label";W[Z]=1;V++}})}if(L=="UIE"){B.length=0}});linb.thread(I).setCache("response",B)},$iconlist_aftervalueupdated:function(C,B,A){if(A){this.resizer.resetTarget(null,false);this._setSelected([A],true)}},$listobject_onlistshow:function(C,G){var F=this;if(!F.objlistBlock){F.objlistBlock=new linb.UI.Block({width:200,height:200,shadow:true});F.frame=linb.create('<div style="z-index:2000;background-color:red;position:absolute;font-size:0;line-height:0;display:none;">').opacity(0.3);linb(document.body).addLast(F.frame);F.treebarObj=new linb.UI.TreeBar({group:false,selMode:"none",caption:null},{onItemSelected:function(H,I,J){F.selectWidget(I.id);H.parent.root.display("none");F.frame.display("none");H.boxing().clearItems();_.asyRun(function(){F._focus()})},beforeHoverEffect:function(I,J,K,H){if(!J){return }if(J.id==this.canvas.get(0).$id){return }if(H=="mouseover"){_.resetRun("",function(){var L=linb._object[J.id];if(L&&(L=L.root)){F.frame.setRegion(L.getRegion(true)).display("block")}},100)}else{_.resetRun("",function(){F.frame.display("none")},100)}}},F);F.objlistBlock.attach(F.treebarObj).create()}var B=[];var A=function(L,I,N){var H=arguments.callee,J,M={id:L.$id,caption:L.alias,icon:(J=N[L.box.KEY])?J.icon:"",iconPos:(J=N[L.box.KEY])?J.iconPos:""};I.push(M);if(L.children&&L.children.length){var K=[];M.sub=K;L.children.each(function(O){H.call(null,O[0],K,N)})}};A(F.canvas.get(0),B,CONF.mapWidgets);F.treebarObj.setItems(B).toggleNode(F.canvas.get(0).$id,true);var E=F.objlistBlock.reBoxing();E.popToTop(C.root);var D=function(){E.display("none");F.treebarObj.clearItems();F.frame.display("none");linb.event.hookKey("esc",0,0,0,null)};E.setBlurTrigger("design:pop:objecttree",D);linb.event.hookKey("esc",0,0,0,D)},getWidgets:function(B){if(!B){this._clearSelect(this.canvas.get(0))}var A=[],D=this.canvas.get(0).children;D.each(function(E){A.push(E[0])});var C=this.iconlist.getItems();if(C&&C.length){C.each(function(F,E){A.push(linb.Profile.getFromCacheId(F.id))})}A.clean();return A},getJSONCode:function(A){A.sort(function(B,C){B=parseInt(B.properties.tabindex)||0;C=parseInt(C.properties.tabindex)||0;return B>C?1:B==C?0:-1});return"return this._nodes = linb.create("+_.serialize(A)+").get();"},getJSCode:function(B){B.sort(function(E,F){E=parseInt(E.properties.tabindex)||0;F=parseInt(F.properties.tabindex)||0;return E>F?1:E==F?0:-1});var D=this,C,A=[];A.push("// [[code created by designer, don't change it manually\n");A.push("var t=this, n=t._nodes=[], u=linb.UI, f=function(c){n.push(c.get(0))};");fun=function(L,I,G,H){var M=arguments.callee,K=L.box["linb.UI"],F=L.beforeSerialized(),E=F.alias,J;delete F.id;if(F.properties&&F.properties.dropKeys){F.properties.dropKeys=F.properties.dropKeys.replace(/\biDesign\b/,"").replace(/[^\w]+/g,":").replace(/^[^\w]+/,"").replace(/[^\w]+$/,"");if(F.properties.dropKeys==L.box.$DataStruct.dropKeys){delete F.properties.dropKeys}}if(_.isEmpty(F.properties)){delete F.properties}if(_.isEmpty(F.events)){delete F.events}if(_.isEmpty(F.CA)){delete F.CA}if(_.isEmpty(F.CC)){delete F.CC}if(_.isEmpty(F.CB)){delete F.CB}if(_.isEmpty(F.CF)){delete F.CF}H.push("\n\n");if(I){H.push(I+".attach(")}else{H.push("f(")}H.push("\n(new "+F.key.replace("linb.UI","u")+")");H.push('\n.host(t,"'+E+'")');if(F.domId!=F.$domId){H.push('\n.setDomId("'+F.domId+'")')}if(F.template){H.push('\n.template("'+F.template+'")')}if(F.behavior){H.push('\n.behavior("'+F.behavior+'")')}if(F.appearance){H.push('\n.appearance("'+F.appearance+'")')}if(F.properties){_.each(F.properties,function(O,N){H.push("\n.set"+N.initial()+"("+_.serialize(O)+")")})}if(F.events){_.each(F.events,function(O,N){H.push("\n."+N+"("+_.serialize(O)+")")})}if(F.CA){H.push("\n.setCustomAppearance("+_.serialize(F.CA)+")")}if(F.CC){H.push("\n.setCustomClass("+_.serialize(F.CC)+")")}if(F.CB){H.push("\n.setCustomBehavior("+_.serialize(F.CB)+")")}if(F.CF){H.push("\n.setCustomFunction("+_.serialize(F.CF)+")")}if(I){H.push("\n"+(G?(", "+G):"")+");")}else{H.push("\n);")}if(L.children&&L.children.length){L.children.each(function(R){var O=R[0],N=[],Q;for(var P=1;P<R.length;P++){switch(typeof R[P]){case"number":N.push(R[P]);break;case"string":N.push("'"+R[P]+"'");break}}if(N.length){Q=N.join(",")}else{Q=null}M.call(this,O,"t."+E,Q,H)},this)}};B.each(function(E){fun(E,null,null,A)});A.push("\n\n");A.push("return n;\n");A.push("// ]]code created by designer");return A.join("")},getClassList:function(B){var D=this,C,E={};var A=function(G){var F=arguments.callee;E[G.box.KEY]=1;if(G.children&&G.children.length){G.children.each(function(H){F.call(null,H[0])})}};B.each(function(F){A(F)});return _.toArr(E,true)},getNames:function(){var B=this.getWidgets(true);var D=this,C,E={};var A=function(G){var F=arguments.callee;E[G.alias]=1;if(G.children&&G.children.length){G.children.each(function(H){F.call(null,H[0])})}};B.each(function(F){A(F)});return E},selectWidget:function(C){var A=linb.UIProfile.getFromCacheId(C);var B=A.parent;if(B.setSelectFromPanel){B.setSelectFromPanel.call(B,A.root.parent(),C);this._setSelected([C],true)}else{this._clearSelect();this._setSelected(null,true)}},activate:function(){},resetEnv:function(A){this._dirty=false;this.properties.text=A||this.getText();this._clearSelect();this._setSelected([],true)},setText:function(A,B,G){A=A.replace(/\r\n/g,"\n");if(B||this.properties.text!=A){this.properties.text=A;var D=this.properties.clsStruct;var F=this.properties.clsObject;var C=_.get(D,["sub","Instance","sub","iniComponents","code"]);if(C==this.properties.comCode){return this}var E=this;linb.thread.asyUI(G,[function(){linb.dom.setCover(linb.getRes("VisualJS.designer.emptyContent"))},function(){E.canvas.reBoxing().empty().gc();linb.dom.setCover(linb.getRes("VisualJS.designer.prepare"))},function(H){linb.thread.suspend(H);linb.SC.group(F.Instance.required,function(I){linb.dom.setCover(linb.getRes("VisualJS.designer.loading")+" "+I+"...")},function(){linb.dom.setCover(linb.getRes("VisualJS.designer.createContent"));linb.thread.resume(H)})},function(){try{var H=F.Instance.iniComponents.call(null);E.iconlist.clearItems();var I=[];H.filter(function(K){if(!K.box.hasDomRoot){I.push(K);return false}});E.canvas.attach(linb.UI.pack(H,false));H.each(function(K){E._designable(K)});I.each(function(K){K.properties.$design=E.properties.$design;E.iconlist.insertItems([{id:K.$id,icon:"img/widgets.gif",iconPos:CONF.mapWidgets[K.box.KEY].iconPos}],null,false)});if(E.layoutBase.reBoxing().display()=="none"){E.layoutBase.reBoxing().display("block");E.layoutBase.reBoxing().parent().background("")}}catch(J){E.iconlist.clearItems();E.canvas.reBoxing().empty().gc();E.layoutBase.reBoxing().display("none");E.layoutBase.reBoxing().parent().background("url(img/error.gif)");linb.message(linb.getRes("VisualJS.designer.comCodeErr"));linb.message(_.Error(J))}}])}this.resetEnv(A);return this},getText:function(){if(this._dirty){var B=this.getWidgets(),C=this.properties.clsStruct.sub.Instance;if(!B.length){if(_.get(C,["sub","iniComponents","comments"])){_.set(C,["sub","iniComponents","comments"],null)}}else{if(!_.get(C,["sub","iniComponents","comments"])){_.set(C,["sub","iniComponents","comments"],"\n"+" ".repeat(8))}C.sub.iniComponents.code=("function(){\n"+this.getJSCode(B)).replace(/\n/g,"\n"+" ".repeat(12))+"\n"+" ".repeat(8)+"}"}var A=this.properties.clsObject.Instance.required||[];A.merge(this.getClassList(B));var D=this.properties.clsObject.Instance.base||[];A.each(function(E){E=linb.SC(E);if(E.Dependency){D.merge(E.Dependency)}});_.set(C,["sub","base","code"],_.serialize(D));if(!_.get(C,["sub","base","comments"])){_.set(C,["sub","base","comments"],"\n"+" ".repeat(8))}_.set(C,["sub","required","code"],_.serialize(A));if(!_.get(C,["sub","required","comments"])){_.set(C,["sub","required","comments"],"\n"+" ".repeat(8))}return VisualJS.ClassTool.getCodeFromStruct(this.properties.clsStruct)}return this.properties.text},iniComponents:function(){var B=this,D=B._nodes=[],A=linb.UI,C=function(E){D.push(E.get(0))};C((new A.Layout).host(B,"layoutBase").setLeft(0).setTop(0).setItems([{id:"main",min:10},{id:"after",pos:"after",locked:false,cmd:false,size:270,min:100,max:300,hide:false}]).setType("horizontal"));B.layoutBase.attach((new A.IconList).host(B,"iconlist").setDock("bottom").setHeight(20).setItemWidth(16).setItemHeight(16).setItemPadding(1).setZIndex(10).setItems([]).setCustomAppearance({KEY:"background:#FFFACD",ITEMS:"padding:2px"}).afterValueUpdated("$iconlist_aftervalueupdated"),"main");B.layoutBase.attach((new A.ToolBar).host(B,"toolbar").onClick("$toolbar_onclick"),"main");B.layoutBase.attach((new A.Layout).host(B,"layoutLeft").setLeft(0).setTop(0).setItems([{id:"main",min:10},{id:"after",pos:"after",locked:false,size:300,min:100,max:500,cmd:true,hide:false}]),"after");B.layoutLeft.attach((new A.ComboInput).host(B,"listObject").setDock("top").setType("popbox").setReadonly(true).setItems([]).onClickButton("$listobject_onlistshow"),"after");B.layoutLeft.attach((new A.TreeGrid).host(B,"profileGrid").setHeader([{id:"name",caption:"$VisualJS.designer.gridcol1",width:80,type:"label"},{id:"value",caption:"$VisualJS.designer.gridcol2",width:130,type:"input"}]).setRows([]).setRowHandlerWidth(30).setAltRowsBg(false).setRowDragable(false).setColSortable(false).beforeValueUpdated("$profilegrid_beforevalueupdated").onRequestData("$profilegrid_onrequestdata").afterRowActive("$profilegrid_afterrowactive"),"after");B.layoutLeft.attach((new A.TreeBar).host(B,"treebarCom").setLeft(0).setTop(0).setItems([]).setGroup(true).setSelMode("none").setDragKey("iDesign"),"main");B.layoutBase.attach((new A.Div).host(B,"panelDiv").setDock("fill").afterCreated(function(E){E.root.addClass("linbdesign")}).setCustomAppearance({KEY:"overflow:auto;"}),"main");B.panelDiv.attach((new A.Div).host(B,"panelBG").setTop(5).setLeft(5).setCustomAppearance({KEY:"background-color:#FFFEF6;"}));B.panelBG.attach((new A.Div).host(B,"panelBGl").setCustomAppearance({KEY:"font-size:0;line-height:0;position:absolute;left:0;top:0;width:10px;height:100%;background:url(img/designer/left.gif) left top"}));B.panelBG.attach((new A.Div).host(B,"panelBGb").setCustomAppearance({KEY:"font-size:0;line-height:0;position:absolute;left:0;bottom:0;height:10px;width:100%;background:url(img/designer/top.gif) left bottom"}));B.panelBG.attach((new A.Div).host(B,"panelBGt").setCustomAppearance({KEY:"font-size:0;line-height:0;position:absolute;left:0;top:0;height:10px;width:100%;background:url(img/designer/top.gif) left top"}));B.panelBG.attach((new A.Div).host(B,"panelBGr").setCustomAppearance({KEY:"font-size:0;line-height:0;position:absolute;right:0;top:0;width:10px;height:100%;background:url(img/designer/left.gif) top right"}));B.panelDiv.attach((new A.Panel).host(B,"canvas").setTop(5).setLeft(5).setZIndex(10).setCustomAppearance({KEY:"overflow:hidden"}));return D}},Static:{destroy:function(){this.objlistBlock.destroy();arguments.callee.upper.apply(this,arguments)}},Initialize:function(){linb.css.add(linb.UI.buildCSSText({".linbdesign .panel":{"background-image":"url(img/designer/bg.gif)","background-position":"left top"}}),"linb.UI.design")}});Class("VisualJS.AddFile","linb.Com",{Instance:{customAttach:function(C){var B=this,E=B.dialog,F=B.properties;if(F.fromRegion){E.setFromRegion(F.fromRegion)}E.setCaption(F.caption).setIcon(F.icon).setIconPos(F.iconPos);if(!E.get(0).root){E.create()}B.treebar.resetValue();B.input.resetValue();B.inputTarget.resetValue();B.comboinput.setValue(".js",true);E.show(C,true);var A=linb.UI.pickObj(F.items||[]),D=function(H){var G=arguments.callee;H.filter(function(K,J){var I=K.sub;if(I){G(K.sub)}if(I&&!I.length){delete K.sub}return !!I})};D(A);B.treebar.clearItems().insertItems(A)},iniComponents:function(){var B=this,D=B._nodes=[],A=linb.UI,C=function(E){D.push(E.get(0))};C((new A.Dialog).host(B,"dialog").setLeft(240).setTop(80).setWidth(430).setHeight(270).setResizable(false).setMinBtn(false).setMaxBtn(false).setPinBtn(false).setCaption("dialog").onHotKeydown("_dialog_onhotkey").beforeClose("_dialog_beforeclose"));B.dialog.attach((new A.Button).host(B,"btnCancel").setLeft(80).setTop(210).setWidth(90).setCaption("$VisualJS.cancel").setIcon("img/App.gif").setIconPos("-16px -16px").onClick("_btncancel_onclick"));B.dialog.attach((new A.Label).host(B,"label4").setLeft(10).setTop(180).setWidth(70).setCaption("$VisualJS.addfile.target"));B.dialog.attach((new A.ComboInput).host(B,"comboinput").setValue(".js").setLeft(300).setTop(150).setWidth(110).setReadonly(true).setType("listbox").setItems([{id:"/",caption:"$VisualJS.addfile.iDir"},{id:".html",caption:"$VisualJS.addfile.iHtml"},{id:".css",caption:"$VisualJS.addfile.iCSS"},{id:".js",caption:"$VisualJS.addfile.iJs"},{id:".php",caption:"$VisualJS.addfile.iPhp"}]).afterValueUpdated("_refresh"));B.dialog.attach((new A.PanelBar).host(B,"panelbar2").setDock("top").setHeight(140).setZIndex(1).setCaption("$VisualJS.addfile.sel"));B.panelbar2.attach((new A.TreeBar).host(B,"treebar").setDock("none").setPosition("relative").setItems([]).setIniFold(false).onItemSelected("_refresh"));B.dialog.attach((new A.Label).host(B,"label1").setLeft(10).setTop(150).setWidth(70).setCaption("$VisualJS.addfile.filename"));B.dialog.attach((new A.Button).host(B,"btnOK").setLeft(250).setTop(210).setWidth(90).setCaption("$VisualJS.ok").setIcon("img/App.gif").setIconPos("-64px -16px").onClick("_btnok_onclick"));B.dialog.attach((new A.Label).host(B,"label3").setLeft(230).setTop(150).setWidth(70).setCaption("$VisualJS.addfile.filetype"));B.dialog.attach((new A.Input).host(B,"input").setLeft(80).setTop(150).setWidth(140).setValueFormat("^[\\w_]{2,18}$").setTipsErr("$VisualJS.addfile.filenameformat").afterValueUpdated("_refresh"));B.dialog.attach((new A.Input).host(B,"inputTarget").setLeft(80).setTop(180).setWidth(330).setReadonly(true));return D},_dialog_beforeclose:function(A){this.dialog.hide();return false},_btncancel_onclick:function(A,C,B){this.dialog.close()},_refresh:function(){var B=this,D=B.treebar.getUIValue(),C=B.input.getUIValue(),A=B.comboinput.getUIValue();if(D&&C&&A){B.inputTarget.setValue(D+"/"+C+A,true)}},_btnok_onclick:function(C,E,D){var A=this,B=A.inputTarget.getValue();if(!B){linb.message(linb.getRes("VisualJS.addfile.notarget"))}else{_.tryF(A.properties.onOK,[A.treebar.getUIValue(),A.treebar.getUIValue(),A.input.getUIValue(),A.comboinput.getUIValue()],A.host);A.dialog.close()}},_dialog_onhotkey:function(C,B,E,A,D){if(B=="esc"){C.boxing().close()}}}});Class("VisualJS.DelFile","linb.Com",{Instance:{customAttach:function(C){var B=this,F=B.properties,E=B.dialog;if(F.fromRegion){E.setFromRegion(F.fromRegion)}E.setCaption(F.caption).setIcon(F.icon).setIconPos(F.iconPos);if(!E.get(0).root){E.create()}B.treebar.resetValue();E.show(C,true);var A=linb.UI.pickObj(F.items),D=function(H){var G=arguments.callee;H.filter(function(J,I){delete J.group;if(J.sub&&J.sub.length){G(J.sub)}})};D(A);B.treebar.clearItems().insertItems(A)},_dialog_beforeclose:function(A){this.dialog.hide();return false},iniComponents:function(){var B=this,D=B._nodes=[],A=linb.UI,C=function(E){D.push(E.get(0))};C((new A.Dialog).host(B,"dialog").setLeft(247).setTop(120).setWidth(433).setHeight(210).setResizable(false).setMinBtn(false).setMaxBtn(false).setPinBtn(false).setCaption("dialog").onHotKeydown("_dialog_onhotkey").beforeClose("_dialog_beforeclose"));B.dialog.attach((new A.Button).host(B,"btnCancel").setLeft(80).setTop(150).setWidth(90).setCaption("$VisualJS.cancel").setIcon("img/App.gif").setIconPos("-16px -16px").onClick("_btncancel_onclick"));B.dialog.attach((new A.Button).host(B,"btnOK").setLeft(250).setTop(150).setWidth(90).setCaption("$VisualJS.ok").setIcon("img/App.gif").setIconPos("-64px -16px").onClick("_btnok_onclick"));B.dialog.attach((new A.PanelBar).host(B,"panelbar2").setDock("top").setHeight(140).setZIndex(1).setCaption("$VisualJS.delfile.sel").setCloseBtn(false).setLandBtn(false));B.panelbar2.attach((new A.TreeBar).host(B,"treebar").setDock("none").setPosition("relative").setItems([]).setIniFold(false).setSelMode("multi").beforeValueUpdated("_treebar_beforevalueupdated").onItemSelected("_treebar_onitemselected"));return D},_btncancel_onclick:function(A,C,B){this.dialog.close()},_btnok_onclick:function(C,E,D){var B=this.treebar.getUIValue(),A=this;if(!B){linb.message(linb.getRes("VisualJS.delfile.notarget"))}else{linb.UI.Dialog.confirm(linb.getRes("VisualJS.delfile.confirmdel"),linb.getRes("VisualJS.delfile.confirmdel2",B.split(";").length),function(){_.tryF(A.properties.onOK,[B],A.host);A.dialog.close()})}},_treebar_beforevalueupdated:function(D,B,E,C){var A=E.split(";");A.sort();A.filter(function(I,G){for(var H=0,F=this.length;H<F;H++){if(H==G){break}if(this[G].startWith(this[H])){return false}}});return A.join(";")},_dialog_onhotkey:function(C,B,E,A,D){if(B=="esc"){C.boxing().close()}}}});Class("VisualJS.About","linb.Com",{Instance:{customAttach:function(B){var A=this,C=A.dialog,D=A.properties;if(!C.get(0).root){C.create()}C.show(B,true)},iniComponents:function(){var B=this,D=B._nodes=[],A=linb.UI,C=function(E){D.push(E.get(0))};C((new A.Dialog).host(B,"dialog").setLeft(250).setTop(150).setHeight(170).setCaption("$VisualJS.menu.about").setResizable(false).setMinBtn(false).setMaxBtn(false).setPinBtn(false).onHotKeydown("_dialog_onhotkey").beforeClose("_dialog2_beforeclose"));B.dialog.attach((new A.Div).host(B,"div12").setLeft(10).setTop(10).setWidth(260).setHeight(80).setHtml('Powered by jsLinb and phpLINB <br />&copy;2006-2008 All rights reserved by <a href="mailto:&#108;&#105;&#110;&#98;&#46;&#110;&#101;&#116;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;">Yingbo Li</a>'));B.dialog.attach((new A.Button).host(B,"button3").setLeft(120).setTop(100).setCaption("O K").setWidth(50).setZIndex("10").onClick("_button3_onclick"));B.dialog.attach((new A.Div).host(B,"div9").setLeft(90).setTop(65).setWidth("120").setHeight("60").setZIndex("8").afterCreated("_div9_aftercreated").setCustomAppearance({KEY:"background:url(img/logo.gif);cursor:pointer;"}));return D},_div9_aftercreated:function(A){A.root.onClick(function(){linb.dom.submit("http://www.linb.net/VisualJS/")})},_dialog2_beforeclose:function(A){A.boxing().hide();return false},_dialog_onhotkey:function(C,B,E,A,D){if(B=="esc"){C.boxing().close()}},_button3_onclick:function(A,C,B){this.dialog.close()}}});