(function(){Class("linb.UI.TimeLine",["linb.UI","linb.absList","linb.absValue"],{Dependency:["linb.Date"],Instance:{_setCtrlValue:function(J){if(!J){return }if(J.indexOf(":")==-1){return }var C=this.get(0),A=C.properties,F=this.constructor,G=J.split(":"),H=new Date(parseInt(G[0])),I=new Date(parseInt(G[1])),E=F._getX(C,H),D=F._getX(C,I),B;if(A.items.length===0){this.insertItems([{id:"$",caption:A.dftTaskName,from:H,to:I}],null,true)}else{F._resetItem(C,{left:E,width:D-E},C.getSubNodeByItemId("ITEM",A.items[0].id).get(0))}},visibleTask:function(){var D=this.get(0),E=D.properties,C=linb.Date,B=E.items;if(B.length&&!E.multiTasks){target=new Date(B[0].from);if(target<E.dateStart||target>C.add(E.dateStart,"ms",E.width*E._rate)){E.dateStart=target;var A=E.$UIvalue;this.refresh().setUIValue(A)}}return this},_afterInsertItems:function(A){A.box._reArrage(A)},_afterRemoveItems:function(A){A.box._reArrage(A)},_cache:function(){var C=this.get(0),A=this.constructor,B=A._picker;if(B&&B.domNode){C.getSubNode("POOL").append(B.root.css("display","none"))}},getTimeRange:function(){var A=this.get(0),B=A.properties;return[B._smallLabelStart,B._smallLabelEnd]},iniContent:function(){return this.each(function(A){var B=A.properties;A.boxing()._getContent(B._smallLabelStart,B._smallLabelEnd,B._rate,"ini")})},addTasks:function(A){return this.insertItems(A,null,true)},removeTasks:function(A){this.removeItems(A);return this},_getContent:function(D,C,B,A){return this.each(function(F){if(F.onGetContent){var E=F.boxing(),H=function(I){E.addTasks(I)};if(F.onGetContent){var G=E.onGetContent(F,D,C,B,A,H);if(G){H(G)}}}})}},Static:{Templates:{tagName:"div",style:"{_style}",BORDER:{tagName:"div",style:"height:{_bHeight}px;width:{_bWidth}px;",FOCUS:{tagName:"button"},POOL:{tagName:"div",style:"position:absolute;left:0;top:0;width:0;height:0;display:none;"},TBAR:{tagName:"div",className:"uibar-top",style:"{_bardisplay};",TBART:{cellpadding:"0",cellspacing:"0",width:"100%",border:"0",tagName:"table",className:"uibar-t",TBARTR:{tagName:"tr",TBARTDL:{tagName:"td",className:"uibar-tdl"},TBARTDM:{$order:1,width:"100%",tagName:"td",className:"uibar-tdm"},TBARTDR:{$order:2,tagName:"td",className:"uibar-tdr"}}},BARCMDL:{tagName:"div",className:"uibar-cmdl",DATE:{$order:0,style:"{dateDisplay}"},PRE:{$order:2},ZOOMIN:{$order:3,style:"{zoomDisplay}"},ZOOMOUT:{$order:4,style:"{zoomDisplay}"},NEXT:{$order:5}},BARCMDR:{tagName:"div",className:"uibar-cmdr",onselectstart:"return false",unselectable:"on",OPT:{className:"uicmd-opt",style:"{optDisplay}",$order:0},CLOSE:{$order:4,className:"uicmd-close ",style:"{closeDisplay}"}}},MAIN:{$order:2,tagName:"div",className:"uicon-main",MAINI:{tagName:"div",className:"uicon-maini",MAINC:{tagName:"div",BAND:{$order:2,tagName:"div",style:"left:{_band_left}px;width:{_band_width}px;",BIGLABEL:{tagName:"div",style:"{_showBigLabel}",text:"{_bigMarks}"},SMALLLABEL:{$order:1,tagName:"div",text:"{_smallMarks}"}},VIEW:{$order:3,tagName:"div",style:"height:{_viewHeight}px;",ITEMS:{tagName:"div",style:"left:{_band_left}px;width:{_band_width}px;",text:"{items}",ACTIVE:{$order:3,tagName:"div"}},SCROLL:{tagName:"div",SCROLLI:{tagName:"div"}}}}}},TAIL:{$order:4,tagName:"div",className:"uicon-main",TIPS:{className:"uicon-maini",style:"z-index:2;{_tipsdisplay};",tagName:"div"}},BBAR:{$order:5,tagName:"div",style:"{_bardisplay};",className:"uibar-bottom-s",BBART:{cellpadding:"0",cellspacing:"0",width:"100%",border:"0",tagName:"table",className:"uibar-t",BBARTR:{tagName:"tr",BBARTDL:{tagName:"td",className:"uibar-tdl"},BBARTDM:{$order:1,width:"100%",tagName:"td",className:"uibar-tdm"},BBARTDR:{$order:2,tagName:"td",className:"uibar-tdr"}}}}},$dynamic:{_bigMarks:{LABELT:{id:null,className:null,tagName:"div",onselectstart:"return false",unselectable:"on",style:"width:{width}px;left:{left}px;",text:"{text}"}},_smallMarks:{LABELB:{id:null,className:null,tagName:"div",onselectstart:"return false",unselectable:"on",style:"width:{width}px;left:{left}px;",text:"{text}"}},items:{ITEM:{tagName:"div",className:"{itemClass} {disabled}",style:"left:{_left}px;width:{_width}px;{_top};{_height};{itemStyle}",MIN:{$order:0,tagName:"div",style:"{_minDisplay}"},NORMAL:{$order:1,tagName:"div",style:"{_normalDisplay};{_height};{_border}{_background}",LEFT:{$order:1,tagName:"div"},HEAD:{$order:2,tagName:"div"},CON:{$order:3,tagName:"div",text:"{caption}"},RIGHT:{$order:4,tagName:"div"}}}}}},Behaviors:{DropableKeys:["ITEMS"],HoverEffected:{PRE:"PRE",NEXT:"NEXT",ZOOMIN:"ZOOMIN",ZOOMOUT:"ZOOMOUT",DATE:"DATE",OPT:"OPT",CLOSE:"CLOSE",MIN:"MIN",NORMAL:"NORMAL"},ClickEffected:{PRE:"PRE",NEXT:"NEXT",ZOOMIN:"ZOOMIN",ZOOMOUT:"ZOOMOUT",DATE:"DATE",OPT:"OPT",CLOSE:"CLOSE",MIN:"MIN"},onSize:function(C,E){var F=C.domNode.style,D=parseInt,G=null,A=G,B=G;if(E.height){B=D(F.height)||G}if(E.width){A=D(F.width)||G}if(B){linb.UI.$tryResize(C,A,B)}},CLOSE:{onClick:function(B,C,D){if(B.properties.disabled){return }var A=B.boxing();if(false===A.beforeClose(B,D)){return }A.destroy();return false}},OPT:{onClick:function(A,B,C){if(A.properties.disabled){return }A.boxing().onShowOptions(A,B,C)}},onClick:function(A,B){A.box._focus(A)},BAND:{onMousedown:function(C,F,A){if(C.pauseA||C.pause){return }var H=C.properties,B=-H._band_left,D=linb.Date,G=H._rate,I=linb.Event.getPos(F),E=H._band_width-B-H.width;if(H.minDate&&H._smallLabelStart<H.minDate){B-=D.diff(H._smallLabelStart,H.minDate,"ms")/G}if(H.maxDate&&H._smallLabelEnd>H.maxDate){E-=D.diff(H.maxDate,H._smallLabelEnd,"ms")/G}if(B<0){B=0}if(E<0){E=0}linb([A]).startDrag(F,{targetReposition:false,dragType:"blank",horizontalOnly:true,targetLeft:I.left,targetTop:I.top,maxLeftOffset:E,maxRightOffset:B})},onDragstop:function(A,B,C){A.box._rePosition(A);A.box._focus(A)},onDrag:function(C,D,E){var B=C.box._getMoveNodes(C),A=linb.DragDrop.getProfile();B.left(C.properties._band_left+A.offset.x)}},SCROLL:{onScroll:function(A,B,C){A.getSubNode("ITEMS").top(-linb([C]).scrollTop())}},ITEMS:{onMouseover:function(A,B,C){if(linb.DragDrop.getProfile().isWorking){return }A.$itemspos=linb([C]).offset()},onMousemove:function(B,D){var E=linb.DragDrop.getProfile();if(E.isWorking){if(B.$$ondrag){B.box._moveActive(B,B.$active,E.x-B.$dd_ox,B.properties._unitPixs)}}else{var I=B.properties,C=linb.Date,J=I._smallLabelStart,A=I._rate,H=I._timeFormat,F=B.$itemspos;if(F&&I.showTips){var G=linb.Event.getPos(D);B.box._setTips(B,C.getText(C.add(J,"ms",(G.left-F.left)*A),H))}}},onMouseout:function(A,B,C){if(linb.DragDrop.getProfile().isWorking){return }if(A.properties.showTips){A.box._setTips(A,"")}},onMousedown:function(B,C,F){var E=B.properties;if(E.disabled||E.readonly){return }if(B.pauseA||B.pause){return }if(linb.Event.getSrc(C)!=F){return }var D=B.getSubNode("ACTIVE"),A=linb.Event.getPos(C).left;D.css({display:"block",width:"0"}).offset({left:A,top:null});D.startDrag(C,{dragType:"none"})},onMouseup:function(A,B,C){A.box._focus(A)}},ACTIVE:{onDragbegin:function(A,B,C){A.$dd_ox=linb.DragDrop.getProfile().x;A.$dd_oleft=parseInt(C.style.left)||0;linb([C,C.parentNode]).css("cursor","e-resize")},onDrag:function(C,D,G){var A=C.$dd_oleft,F=linb.DragDrop.getProfile().x,B,E;if((E=F-C.$dd_ox)>=0){B=E}else{A=A+E;B=-E}C.box._moveActive(C,G,A,B)},onDragstop:function(E,G,A){var B=E.box._deActive(E);linb([A,A.parentNode]).css("cursor","");var F=E.box,I=F._getTime(E,B.left),J=F._getTime(E,B.left+B.width),C=E.properties,D,K,H=E.boxing();if(E.properties.multiTasks){D={id:_.id(),caption:C.dftTaskName,from:I,to:J};if(E.beforeNewTasks&&false===H.beforeNewTasks(E,[D])){}else{H.addTasks([D])}}else{H.setUIValue(I+":"+J)}E.$dd_ox=E.$dd_oleft=null}},FOCUS:{onFocus:function(A,B,C){},onBlur:function(A,B,C){_.resetRun(A.KEY+":focus",function(){A.getSubNode("TBAR").tagClass("-focus",false)})},onKeydown:function(E,H,B){if(E.pauseA||E.pause){return }E.pause=true;var K=E.properties,F=linb.Date,I=K._rate,G=30,C=E.box._getMoveNodes(E),J=C.left(),A=K._band_left,D=K._scroll_offset;D=K._scroll_offset=D>G?D:D*1.05;switch(linb.Event.getKey(H)[0]){case"left":case"up":if(K.minDate&&F.add(K.dateStart,"ms",(A-J-D)*I)<K.minDate){D=F.diff(K.minDate,K.dateStart,"ms")/I+(A-J)}if(D<0){D=0}C.left(J+D);break;case"right":case"down":if(K.maxDate&&F.add(K.dateStart,"ms",(A-J+D+K.width)*I)>K.maxDate){D=F.diff(K.dateStart,K.maxDate,"ms")/I-(A-J+K.width)}if(D<0){D=0}C.left(J-D);break}if((J+G>0)||(J+C.width()-K.width-G<0)){E.box._rePosition(E)}E.pause=false;return false},onKeyup:function(A,C){var B=A.properties;B._scroll_offset=B._scrollRate;A.box._rePosition(A)}},PRE:{onClick:function(F,G){if(F.pauseA||F.pause){return }var D=F.properties,C=linb.Date,E=D._rate,H=F.box._getMoveNodes(F),B=D._band_left,A=0;if(D.minDate&&D._smallLabelStart<D.minDate){A-=C.diff(D._smallLabelStart,D.minDate,"ms")/E}F.pause=true;H.animate({left:[B,A]},null,function(){F.box._rePosition(F);F.pause=false},200,Math.max(5,(A-B)/100),"sineInOut").start()}},NEXT:{onClick:function(F,G){if(F.pauseA||F.pause){return }var D=F.properties,C=linb.Date,E=D._rate,H=F.box._getMoveNodes(F),B=D._band_left,A=D.width-D._band_width;if(D.maxDate&&D._smallLabelEnd>D.maxDate){A+=C.diff(D.maxDate,D._smallLabelEnd,"ms")/E}if(B>A){F.pause=true;H.animate({left:[B,A]},null,function(){F.box._rePosition(F);F.pause=false},200,Math.max(5,(B-A)/100),"sineInOut").start()}}},ZOOMIN:{onClick:function(B,E){if(B.pauseA||B.pause){return }var D=B.properties,C=B.box,G=C.$zoom,A=_.arr.indexOf(G,D._unitParas),F;if(A>0){D.timeSpanKey=G[A-1][0];F=B.getSubNodes(["VIEW","BAND"]);B.box._refresh(B)._focus(B)}}},ZOOMOUT:{onClick:function(B,E){if(B.pauseA||B.pause){return }var D=B.properties,C=B.box,G=C.$zoom,A=_.arr.indexOf(G,D._unitParas),F;if(A<G.length-1){D.timeSpanKey=G[A+1][0];F=B.getSubNodes(["VIEW","BAND"]);B.box._refresh(B)._focus(B)}}},DATE:{onClick:function(B,E,G){if(B.pauseA||B.pause){return }var A=B.box,D=B.boxing(),H=B.properties.dateStart,F,C;if(A._picker&&A._picker.domNode){F=A._picker.boxing()}else{F=linb.create("DatePicker");A._picker=F.get(0);F.beforeClose(function(){this.boxing()._cache();return false}).beforeUIValueSet(function(N,J,I){var K=this,M=K.getSubNodes(["VIEW","BAND"]),L=K.boxing(),N=K.properties;N.dateStart=I;K.box._refresh(K)._focus(K);L._cache()})}F.setValue(H,true).host(B);C=F.reBoxing();C.popToTop(G);C.setBlurTrigger(B.key+" - "+B.$id,function(){D._cache()});linb.Event.keyboardHook("esc",0,0,0,function(){D._cache();A._focus(B);linb.Event.keyboardHook("esc")})}},ITEM:{onClick:function(A,B,C){if(A.onClickTask){A.boxing().onClickTask(A,A.getItemByDom(C),B,C)}},onDragbegin:function(C,E,G){var A=C.getItemByDom(G),B=C.$dd_type,F=B?"e-resize":"move",D=C.$active;C.$dd_ox=linb.DragDrop.getProfile().x;C.$dd_oleft=parseInt(G.style.left);C.$dd_owidth=parseInt(G.style.width);linb([D]).css("display","block").cssPos({left:C.$dd_oleft,top:null}).width(C.$dd_owidth-2);linb([D,D.parentNode]).css("cursor",F)},onDrag:function(C,E,A){var H,I,D=linb.DragDrop.getProfile().x-C.$dd_ox,B=C.$dd_oleft,G=C.$dd_owidth,F=C.$dd_type;if(F=="left"){if(D<G){H=B+D;I=B+G-H}else{H=B+G;I=D-G}}else{if(F=="right"){if(-D<G){H=B;I=G+D}else{H=B+D+G;I=-D-G}}else{H=B+D;I=G}}C.box._moveActive(C,C.$active,H,I)},onDragstop:function(A,E,F){var D=A.box,C=A.box._deActive(A),B=A.$active;var H=D._getTime(A,C.left),G=D._getTime(A,C.left+C.width);if(A.properties.multiTasks){if(A.beforeTaskUpdated&&false===A.boxing().beforeTaskUpdated(A,A.getItemByDom(F),H,G)){}else{D._resetItem(A,C,F)}}else{A.boxing().setUIValue(H+":"+G)}A.$dd_type=null;linb([B,B.parentNode]).css("cursor","")}},HEAD:{onMousedown:function(A,C,E){var D=A.properties,B=A.getItemByDom(E);if(D.disabled||B.disabled){return }if(A.beforeDragTask&&false===A.boxing().beforeDragTask(A,B,C,E)){return }if(D.readonly||B.readonly){return }linb([E]).parent(2).startDrag(C,{dragDefer:1,dragType:"none"})}},LEFT:{onMousedown:function(A,C,E){var D=A.properties,B=A.getItemByDom(E);if(D.disabled||D.readonly||B.readonly||B.disabled){return }A.$dd_type="left";linb([E]).parent(2).startDrag(C,{dragDefer:1,dragType:"none"})}},RIGHT:{onMousedown:function(A,C,E){var D=A.properties,B=A.getItemByDom(E);if(D.disabled||D.readonly||B.readonly||B.disabled){return }A.$dd_type="right";linb([E]).parent(2).startDrag(C,{dragDefer:1,dragType:"none"})}}},DataModel:{$borderW:0,readonly:false,width:400,height:200,leftSpanCount:{ini:0,inner:1},rightSpanCount:{ini:0,inner:1},increment:0,zoomable:{ini:true,action:function(A){if(this.properties.timeSpanKey){this.getSubNodes(["ZOOMIN","ZOOMOUT"]).css("display",A?"":"none")}}},dftTaskName:"task",taskHeight:{ini:16,action:function(A){this.getSubNode("ITEM",true).height(A)}},timeSpanKey:{ini:"1 d",action:function(){this.box._refresh(this)}},unitPixs:{action:function(){this.box._refresh(this)}},smallLabelCount:{inner:1},smallLabelUnit:{inner:1,listbox:_.toArr(linb.Date.$TIMEUNIT,true)},smallLabelFormat:{inner:1,listbox:_.toArr(linb.Date.$TEXTFORMAT,true)},bigLabelCount:{inner:1},bigLabelUnit:{inner:1,listbox:_.toArr(linb.Date.$TIMEUNIT,true)},bigLabelFormat:{inner:1,listbox:_.toArr(linb.Date.$TEXTFORMAT,true)},timeFormat:{inner:1,listbox:_.toArr(linb.Date.$TEXTFORMAT,true)},showBar:{ini:true,action:function(B){this.getSubNode("TBAR").css("display",B?"":"none");var D=this.properties,A=D.width,C=D.height;D.width=D.height=0;linb.UI.$tryResize(this,A,C);D.width=A,D.height=C}},showTips:{ini:true,action:function(B){this.getSubNode("TIPS").css("display",B?"":"none");var D=this.properties,A=D.width,C=D.height;D.width=D.height=0;linb.UI.$tryResize(this,A,C);D.width=A,D.height=C}},showBigLabel:{ini:true,action:function(B){this.getSubNode("BIGLABEL").css("display",B?"":"none");var D=this.properties,A=D.width,C=D.height;D.width=D.height=0;linb.UI.$tryResize(this,A,C);D.width=A,D.height=C}},_scrollRate:5,multiTasks:{ini:false,action:function(){this.box._refresh(this)}},minDate:{ini:null,action:function(A){if(A>this.properties.dateStart){this.box._refresh(this)}}},maxDate:{ini:null,action:function(A){var B=this.properties;if(A<linb.Date.add(B.dateStart,"ms",B.width*B._rate)){this.box._refresh(this)}}},dateBtn:{ini:true,action:function(A){this.getSubNode("DATE").css("display",A?"":"none")}},closeBtn:{ini:false,action:function(A){this.getSubNode("CLOSE").css("display",A?"":"none")}},optBtn:{ini:false,action:function(A){this.getSubNode("OPT").css("display",A?"":"none")}},fixWidth:true,dateStart:{ini:new Date,action:function(){this.box._refresh(this)}}},EventHandlers:{beforeClose:function(A,B){},onShowOptions:function(A,B,C){},onGetContent:function(C,F,E,A,B,D){},beforeTaskUpdated:function(B,A,D,C){},beforeNewTasks:function(A,B){},beforeDelTasks:function(B,A){},beforeDragTask:function(B,A,C,D){},onClickTask:function(B,A,C,D){}},Appearances:{".setting-timeline":{height:"6px"},MAINI:{"padding-top":"4px"},MAINC:{overflow:"hidden",position:"relative",border:"solid 1px #648CB4",background:"#fff"},"BARCMDL span":{$order:0,position:"relative",width:"15px",height:"15px",margin:"2px","vertical-align":"middle",cursor:"default"},FOCUS:{position:"absolute","font-size":"0",width:"1px",height:"1px",left:"-100px",top:"-100px","line-height":"0",border:"0"},"BAND, VIEW, BIGLABEL, SMALLLABEL":{position:"relative"},VIEW:{width:linb.browser.ie6?"100%":null,overflow:"hidden"},SCROLL:{"z-index":500,position:"absolute","font-size":"0","line-height":"0",right:0,top:0,height:"100%",width:"18px",overflow:"auto","overflow-x":linb.browser.opr?null:"hidden"},SCROLLI:{height:"1000px",width:"1px"},BIGLABEL:{"z-index":3,height:"16px","background-color":"#C8E2FC",cursor:"move","border-bottom":"solid 1px #7BA3CB"},SMALLLABEL:{"z-index":4,height:"14px","background-color":"#C8E2FC",cursor:"move","border-bottom":"solid 1px #648CB4"},ITEMS:{position:"relative",background:linb.UI.$bg("bars.gif"," left top")},"BIGLABEL div, SMALLLABEL div":{"border-left":"solid 1px #7BA3CB","text-align":"center",position:"absolute",cursor:"move","-moz-user-select":linb.browser.gek?"none":"",top:0,overflow:"visible",height:"100%"},"BIGLABEL div":{$order:2,"text-align":"left","padding-left":"4px"},TIPS:{position:"relative",height:"14px","font-size":"12px","line-height":"14px","text-align":"center"},ACTIVE:{"z-index":300,position:"relative","border-left":"1px dashed","border-right":"1px dashed",left:"-100px",width:"0",background:0,height:"100%"},"ZOOMIN, ZOOMOUT, DATE, PRE, NEXT, MIN":{background:linb.UI.$bg("icons.gif","no-repeat",true)},ZOOMIN:{$order:1,"background-position":"-360px -70px"},"ZOOMIN-mouseover":{$order:2,"background-position":"-360px -90px"},"ZOOMIN-mousedown":{$order:3,"background-position":"-360px -110px"},ZOOMOUT:{$order:1,"background-position":"-380px -70px"},"ZOOMOUT-mouseover":{$order:2,"background-position":"-380px -90px"},"ZOOMOUT-mousedown":{$order:3,"background-position":"-380px -110px"},DATE:{$order:1,"background-position":"-340px -70px"},"DATE-mouseover":{$order:2,"background-position":" -340px -90px"},"DATE-mousedown":{$order:3,"background-position":" -340px -110px"},PRE:{$order:1,"background-position":"-260px -70px",top:"0"},"PRE-mouseover":{$order:2,"background-position":"-260px -90px"},"PRE-mousedown":{$order:3,"background-position":"-260px -110px"},NEXT:{$order:1,position:"absolute","background-position":"-280px -70px",top:"0"},"NEXT-mouseover":{$order:2,"background-position":"-280px -90px"},"NEXT-mousedown":{$order:3,"background-position":"-280px -110px"},ITEM:{position:"absolute",overflow:"visible"},"MIN, NORMAL":{position:"relative",height:"16px",overflow:"hidden","z-index":"1"},MIN:{width:"16px","background-position":"-320px -70px",cursor:"pointer"},"MIN-mouseover":{"background-position":"-320px -90px"},"MIN-mousedown":{"background-position":"-320px -110px"},NORMAL:{cursor:"pointer","background-color":"#B3D7FB",border:"solid 1px #648CB4"},"NORMAL-mouseover":{$order:2,"border-color":"red"},"LEFT, HEAD, RIGHT":{position:"absolute",top:0,height:"100%"},HEAD:{background:linb.UI.$bg("handler.gif"," left top",true),width:"6px",left:"3px",cursor:"move","z-index":5},"LEFT, RIGHT":{width:"2px","z-index":10},LEFT:{cursor:"e-resize",left:0},RIGHT:{cursor:"w-resize",right:0},CON:{"padding-left":"12px",position:"relative",height:"100%",overflow:"hidden"}},RenderTrigger:function(){var B=this,C=B.properties,A=B.box;B.$active=B.getSubNode("ACTIVE").get(0);A._ajustHeight(B);B.boxing().iniContent()},_onDropMarkShow:function(){linb.DragDrop.setDragIcon("add");return false},_onDropMarkClear:function(){linb.DragDrop.setDragIcon();return false},_onDragEnter:function(C,E,F){var B=C.properties,A=linb.Event.getPos(E),D=B._unitPixs/2;linb(C.$active).css("display","block");C.$dd_ox=linb([F]).offset().left+D;C.$$ondrag=true},_onDragLeave:function(A){A.$$ondrag=A.$dd_ox=null;A.box._deActive(A)},_onDrop:function(C){C.$$ondrag=C.$dd_ox=null;var E=C.box._deActive(C),B={id:_.id(),caption:C.properties.dftTaskName},D=C.box,A=C.boxing();B.from=D._getTime(C,E.left);B.to=D._getTime(C,E.left+E.width);B._dropData=linb.DragDrop.getProfile().dragData;if(C.beforeNewTasks&&false===A.beforeNewTasks(C,[B])){}else{A.addTasks([B])}},_prepareData:function(D){var a=D.properties,k={},h=linb.Date,T=h.$TIMEUNIT,B="display:none",e=D.box.$zoom,c=0,W,g,X,b,E,j,A,U,F,S,Z,I,Q,L,J,G,V,R,O,C;k.dateDisplay=a.dateBtn?"":B;k.closeDisplay=a.closeBtn?"":B;k.optDisplay=a.optBtn?"":B;k._showBigLabel=a.showBigLabel?"":B;a._scroll_offset=a._scrollRate;a._lines=[{}];k._bWidth=a.width-2*a.$borderW;k._bHeight=a.height-2*a.$borderW;a._viewHeight=k._bHeight;k._tipsdisplay=a.showTips?"":B;k._bardisplay=a.showBar?"":B;if(a.timeSpanKey){_.arr.each(e,function(d){if(d[0]===a.timeSpanKey){F=a._unitParas=d;return false}});if(!F){F=a._unitParas=e[a.timeSpanKey="1 d"]}}k.zoomDisplay=(a.zoomable&&F)?"":B;if(F){a._unitPixs=a.unitPixs||F[1];a._smallLabelCount=a.smallLabelCount||F[2];a._smallLabelUnit=a.smallLabelUnit||F[3];a._smallLabelFormat=a.smallLabelFormat||F[4];a._bigLabelCount=a.bigLabelCount||F[5];a._bigLabelUnit=a.bigLabelUnit||F[6];a._bigLabelFormat=a.bigLabelFormat||F[7];a._timeFormat=a.timeFormat||F[8]}W=a._unitPixs;O=a._smallLabelCount;R=a._smallLabelUnit;C=a._smallLabelFormat;Z=(Math.ceil(a.width/W)||0);I=a.leftSpanCount?a.leftSpanCount:Z;Q=a.rightSpanCount?a.rightSpanCount:Z;L=Z+I+Q;U=a._rate=T[R]*O/W;if(a.maxDate&&h.add(a.dateStart,"ms",a.width*U)>a.maxDate){a.dateStart=h.add(a.maxDate,"ms",-a.width*U)}if(a.minDate&&a.dateStart<a.minDate){a.dateStart=a.minDate}S=h.getTimSpanStart(a.dateStart,R,O);G=a._smallLabelStart=h.add(S,R,-I*O);V=a._smallLabelEnd=h.add(G,R,L*O);a._band_width=Math.ceil(h.diff(G,V,"ms")/U);a._band_left_fix=a._band_left=-Math.ceil(h.diff(G,a.dateStart,"ms")/U);J=a._smallMarks=[];E=0;b=h.get(G,C);for(g=0;g<L;g++){j=h.add(G,R,O*(g+1));A=Math.ceil(h.diff(G,j,"ms")/U);J.push({left:E,width:A-E,text:b});E=A;b=h.getText(j,C)}if(a.showBigLabel){var K,Y,N,H,l,P=a._bigLabelCount,M=a._bigLabelUnit,f=a._bigLabelFormat;N=a._bigMarks=[];H=a._bigLabelStart=h.getTimSpanStart(G,M,P);l=a._bigLabelEnd=h.getTimSpanEnd(V,M,P);K=h.diff(H,l,M)/P;Y=h.diff(G,H,"ms")/U;b=h.getText(H,f);E=0;for(g=0;g<K;g++){j=h.add(H,M,P*(g+1));A=h.diff(H,j,"ms")/U;N.push({left:Math.ceil(E+Y),width:Math.ceil(A-E),text:b});E=A;b=h.getText(j,f)}}return arguments.callee.upper.call(this,D,k)},_prepareItem:function(F,G,A,C){var B=this,E=F.properties,D;if(!G.id){G.id=_.id()}if(!G.caption){G.caption=E.dftTaskName}G._min=false;G._left=B._getX(F,G.from);G._width=Math.max(B._getX(F,G.to)-G._left,0);if(E.multiTasks){if(G._width<=16){G._width=16;G._min=true}}G._minDisplay=G._min?"":"display:none";G._normalDisplay=G._min?"display:none":"";D=B._getLinePos(F,G);G._top=E.multiTasks?"top:"+(G._min?0:((E.taskHeight+3)*(D-1)+16+3))+"px":"";G._height="height:"+(E.multiTasks?G._min?"16px":E.taskHeight+"px":"100%");G._border=E.multiTasks?"":"border-top:0;border-bottom:0";G._background=G.background?"background:"+G.background+";":"";E._lines=E._lines||[{}];E._lines[D][G.id]=G;G._line=D;A._left=G._left;A._width=G._width;A._min=G._min;A._line=G._line},$zoom:[["10 ms",54,10,"ms","ms",100,"ms","hnsms","hnsms"],["100 ms",54,100,"ms","ms",1,"s","hns","hnsms"],["1 s",30,1,"s","s",10,"s","hns","hnsms"],["10 s",30,10,"s","s",60,"s","hns","hnsms"],["1 n",30,1,"n","n",10,"n","dhn","hns"],["5 n",30,5,"n","n",30,"n","mdhn","hns"],["10 n",30,10,"n","n",60,"n","mdhn","hns"],["30 n",30,30,"n","n",4,"h","ymdh","mdhn"],["1 h",30,1,"h","h",6,"h","ymdh","mdhn"],["2 h",30,2,"h","h",12,"h","ymdh","mdhn"],["6 h",30,6,"h","h",24,"h","ymd","mdhn"],["1 d",24,1,"d","w",1,"ww","ymd","ymdh"],["1 w",30,1,"ww","ww",4,"ww","ymd","ymd"],["15 d",30,15,"d","d",2,"m","ymd","ymd"],["1 m",30,1,"m","m",1,"q","yq","ymd"],["1 q",30,1,"q","q",1,"y","y","ymd"],["1 y",48,1,"y","y",10,"y","y","ym"],["1 de",48,1,"de","de",100,"y","y","ym"],["1 c",48,1,"c","c",1000,"y","y","y"]],_focus:function(A){A.getSubNode("FOCUS").focus(1)},_getTips:function(C){var A,B="$dd_tooltip";if(A=C[B]||(C[B]=C.getSubNode("TIPS").get(0).childNodes[0])){return A.nodeValue}else{return C.getSubNode("TIPS").get(0).innerHTML}},_rr:/\<[^>]*\>/g,_setTips:function(C,E,D){if(!D&&C.pauseA){return }var A,B="$dd_tooltip";E=E.replace(this._rr,"");if(A=C[B]||(C[B]=C.getSubNode("TIPS").get(0).childNodes[0])){if(A.nodeValue!=E){A.nodeValue=E}}else{C.getSubNode("TIPS").get(0).innerHTML=E}},_getX:function(B,C){var A=B.properties,D=new Date;D.setTime(C);return(Math.ceil(linb.Date.diff(A._smallLabelStart,D,"ms")||0)/A._rate)},_getTime:function(D,A,B){var C=D.properties;C=linb.Date.add(C._smallLabelStart,"ms",A*C._rate);return B?C:C.getTime()},_moveActive:function(G,B,K,M){var D=Math.ceil,O=G.properties,H=linb.Date,P=O._smallLabelStart,A=O._rate,N=O._timeFormat,C="ms",J=B.style,I="px",F,E,L;if(L=O.increment){F=Math.floor((M+L-1)/L);K=Math.floor(K/L)*L;M=F*L}F=(D(K)||0);E=((D(M)||0)-2);if(E>0){J.left=F+I;J.width=E+I;if(O.showTips){G.box._setTips(G,H.getText(H.add(P,C,K*A),N)+" - "+H.getText(H.add(P,C,(K+M)*A),N))}}},_deActive:function(D){var C=D.$active.style,A=parseInt(C.left)||0,B=(parseInt(C.width)||0)+2;C.left="-1000px";if(D.properties.showTips){D.box._setTips(D,"")}return{left:A,width:B}},_minusLeft:function(C,B,E,D){var A=C.properties;while((D--)>0){E.first().remove();temp=B.shift()}},_minusRight:function(C,B,E,D){var A=C.properties;while((D--)>0){E.last().remove();temp=B.pop()}},_addLeft:function(A,R,K,D,B){var I=A.properties,P=linb.Date,S=R+"Marks",L=I[S],G=I[R+"LabelStart"],E=I[R+"LabelUnit"],J=I[R+"LabelCount"],C=I[R+"LabelFormat"],Q=I._rate,N=[],O,F,H,M;O=0;F=P.getText(G,C);for(M=0;M<D;M++){H=P.add(G,E,J*(M+1));width=P.diff(G,H,"ms")/Q;N.push({left:Math.ceil(O+(B||0)-3e-13),width:Math.ceil(width-O),text:F});O=width;F=P.getText(H,C)}N.reverse();K.prepend(_.str.toDom(A.buildItems(S,N)));_.arr.insertAny(L,N.reverse(),0)},_addRight:function(A,H,R,L,D,B){var I=A.properties,P=linb.Date,S=R+"Marks",M=I[S],F=I[R+"LabelStart"],E=I[R+"LabelUnit"],K=I[R+"LabelCount"],C=I[R+"LabelFormat"],Q=I._rate,O=[],J,G,N;J=H;for(N=0;N<D;N++){G=P.add(H,E,K*(N+1));O.push({left:Math.ceil(P.diff(F,J,"ms")/Q+(B||0)-3e-13),width:Math.ceil(P.diff(J,G,"ms")/Q),text:P.getText(J,C)});J=G}L.append(_.str.toDom(A.buildItems(S,O)));_.arr.insertAny(M,O,-1)},_getMoveNodes:function(A){return A.$moveban=A.$moveban||A.getSubNodes(["BAND","ITEMS"])},_rePosition:function(D,F){D.pause=true;var S=this,Y=linb.Date,O=D.properties,b=O._rate,M,U,T,I=D.getSubNode("SMALLLABEL"),Q=S._getMoveNodes(D),N=F||Q.left(),J=N-O._band_left_fix;if(Math.abs(J)/O._unitPixs>=1||F){var L=parseInt(J/O._unitPixs),c=O._smallLabelStart,K=O._smallLabelEnd,G=-L*O._smallLabelCount,R,V,E;V=O._smallLabelStart=Y.add(O._smallLabelStart,O._smallLabelUnit,G);E=O._smallLabelEnd=Y.add(O._smallLabelEnd,O._smallLabelUnit,G);R=Math.ceil(Y.diff(V,c,"ms")/b);Q.left(N-R);O._band_width=Math.ceil(Y.diff(V,E,"ms")/b);_.arr.each(O.items,function(d){d._left+=R;D.box._trimTask(D,d)});I.children().each(function(d){d.style.left=(parseFloat(d.style.left)||0)+R+"px"});_.arr.each(O._smallMarks,function(d){d.left+=R});if(L>0){S._minusRight(D,O._smallMarks,I,L);S._addLeft(D,"_small",I,L)}else{S._minusLeft(D,O._smallMarks,I,-L);S._addRight(D,K,"_small",I,-L)}if(O.multiTasks){var A=[];_.arr.each(O.items,function(d){if(d._left>=O._band_width||(d._left+d._width)<=0){delete O._lines[d._line][d.id];A.push(d.id)}});D.boxing().removeItems(A);if(D.onGetContent){D.boxing()._getContent(L>0?V:K,L>0?c:E,O._rate,L>0?"left":"right")}S._reArrage(D)}if(O.showBigLabel){var P=D.getSubNode("BIGLABEL"),B=O._bigLabelUnit,H=O._bigLabelCount,Z,X,W,C,a;K=O._bigLabelEnd;P.children().each(function(d){d.style.left=(parseFloat(d.style.left)||0)+R+"px"});_.arr.each(O._bigMarks,function(d){d.left+=R});C=Y.getTimSpanStart(V,B,H);X=Math.ceil(Y.diff(V,O._bigLabelStart,B)/H);W=Math.ceil(Y.diff(O._bigLabelEnd,E,B)/H);if(X){Z=Y.diff(V,C,"ms")/b;O._bigLabelStart=C;if(X>0){S._addLeft(D,"_big",P,X,Z)}else{S._minusLeft(D,O._bigMarks,P,-X)}}if(W){Z=Y.diff(V,C,"ms")/b;O._bigLabelEnd=Y.add(O._bigLabelEnd,B,W*H);if(W<0){S._minusRight(D,O._bigMarks,P,-W)}else{S._addRight(D,K,"_big",P,W,Z)}}}}O._band_left=Q.left();O.dateStart=S._getTime(D,-O._band_left,1);D.pause=false},_trimTask:function(D,E){var C=-12,A=E._left,B=E._width,F=D.properties._band_width;if(A<C){if(A+B<C){B=0}else{B=B+A-C}A=C}if(A>F+12){A=F+12}this._setItemNode(D,E,"left",A+"px");if(A+B>F-C){B=F-C-A}if(B>=0){this._setItemNode(D,E,"width",B+"px")}},_setItemNode:function(C,D,B,E){var A=C.getSubNodeByItemId("ITEM",D.id).get(0);A.style[B]=E},_getLinePos:function(D,E){if(E._min){return 0}var C=D.properties,A=false,B=0;_.arr.each(C._lines,function(F,G){if(G===0){return }A=true;_.each(F,function(H){if(E.id!==H.id){if(((E._left+E._width)>=H._left)&&((H._left+H._width)>=E._left)){return A=false}}});if(A){B=G;return false}});if(!A){B=C._lines.push({})-1}return B},_reArrage:function(D){var A=this,E,C,B=D.properties;B._lines.length=1;B.items.sort(function(F,G){return F.from>G.from?1:F.from==G.from?0:-1});_.arr.each(B.items,function(F){if(F._line===0){return }index=A._getLinePos(D,F);B._lines[index][F.id]=F;if(F._line!==index){F._line=index;if(B.multiTasks){A._setItemNode(D,F,"top",((B.taskHeight+3)*(index-1)+16+3)+"px")}}});C=B._linesHeight=(B._lines.length+1)*(B.taskHeight);A._ajustHeight(D)},_resetItem:function(D,C,A){var B=D.properties,I=D.getItemByDom(A),E=B._band_width+12,F=function(J,K){return D.getSubNodeByItemId(J,K)},H=D.box,G=Math.max;if(C.left){I._left=C.left;I.from=H._getTime(D,C.left);A.style.left=C.left+"px"}if(C.width){I._width=G(C.width,0);I.to=H._getTime(D,C.left+C.width);if(B.multiTasks){if(I._width<=16){I._width=C.width=16;if(!I._min){I._min=true;F("NORMAL",I.id).css("display","none");F("MIN",I.id).css("display","block")}}else{if(I._min){delete I._line;I._min=false;F("NORMAL",I.id).css("display","block");F("MIN",I.id).css("display","none")}if(C.left+C.width>E){C.width=E-C.left}}}A.style.width=C.width+"px";if(linb.browser.ie&&!B.multiTasks){linb([A.parentNode]).ieRemedy()}}H._reArrage(D)},_ajustHeight:function(C){var A=C.properties,F=function(L){return C.getSubNode(L)},I=F("VIEW"),G=F("ITEMS"),J=F("SCROLL"),B=F("SCROLLI"),E,H,K=A._linesHeight||0,D=I.height();E=Math.max(K,D);G.height(E);B.height(E);H=K>D;J.css("display",H?"block":"none");G.top(H?-J.scrollTop():0)},_showTips:function(F,E,G){if(F.onShowTips){return F.boxing().onShowTips(F,E,G)}if(!linb.Tips){return }var J=F.properties,B=E.id,H=J._timeFormat,C=F.getSubId(B),A=F.SubSerialIdMapItem,I=A&&A[C],D=linb.Date;if(J.disabled){return }if(I&&I.disabled){return }if(I){I.tips='<p style="font-weight:bold">'+I.caption+"</p>"+D.getText(new Date(I.from),H)+" - "+D.getText(new Date(I.to),H);linb.Tips.show(G,I);return true}else{return false}},_beforeSerialized:function(B){var A=B.properties.width,C=arguments.callee.upper.call(this,B);C.properties.width=A;return C},_onresize:function(D,C,M){var B=D.properties,H=function(Q){return D.getSubNode(Q)},J=H("TBAR").height(),E=H("BBAR").height(),L=H("TAIL").height(),P=H("BIGLABEL").height(),G=H("SMALLLABEL").height(),I=2*B.$borderW,F=3,O;var A=linb.UI.$CSSCACHE,K=".setting-timeline:height",N=A[K]||(A[K]=parseInt(linb.CSS.$getCSSValue(".setting-timeline","height"))||0);if(M){H("BORDER").height(O=M-I);H("VIEW").height(O=O-(B.showTips?L:0)-F-(B.showBigLabel?P:0)-G-(B.showBar?(J+E):0)-N);this._ajustHeight(D)}if(C&&C!=B.width){H("BORDER").width(C-I);if(!B.fixWidth){_.resetRun(D.$id+":refresh",function(){D.box._refresh(D)._focus(D)})}}},_refresh:function(A){A.boxing().clearItems().refresh().setUIValue(A.properties.$UIvalue);return this}}});Class("linb.UI.LinkList",["linb.UI.List"],{Initialize:function(){var A=this.getTemplate();A.$dynamic={items:{ITEM:{className:"{itemClass} {disabled}",style:"margin:{itemMargin}px;{itemStyle}",LINK:{$order:1,tagName:"a",href:"{href1}",tabindex:"{_tabindex}",text:"{caption}"}}}};this.setTemplate(A)},Static:{Appearances:{ITEMS:{position:"relative",overflow:"auto","overflow-x":(linb.browser.ie||linb.browser.gek)?"hidden":""},ITEM:{"vertical-align":"middle",position:"relative",background:linb.UI.$bg("icons.gif","no-repeat left -130px",true),"border-right":"solid 1px #7C9CBC",height:"16px",padding:"3px","white-space":"nowrap"},"ITEM-mouseover, ITEM-mousedown, ITEM-checked":{},"ITEM-mouseover":{$order:1,"background-position":"left -153px"},"ITEM-mousedown":{$order:2,"background-position":"left -176px"},"ITEM-checked":{$order:2,"background-position":"left -176px"},LINK:{display:linb.$inlineBlock,zoom:linb.browser.ie6?1:null,"vertical-align":"middle",padding:"1pt 4px 1pt 12px"}},DataModel:({itemMargin:{ini:0,action:function(A){this.getSubNode("ITEM",true).css("margin",A+"px")}},tabindex:{action:function(D){var B=this,C=B.keys,A=function(E,F){B.getSubNode(E,true).attr("tabIndex",F)};if(B.domNode){A("LINK",D)}}}}),Behaviors:{ITEM:{onClick:null,onKeydown:null},LINK:{onClick:function(A,B){return !!linb.Event.getKey(B)[2]},onMousedown:function(B,E,F){if(linb.Event.getBtn(E)!="left"){return }var A=B.properties,D=B.getItemByDom(F),C=B.boxing();if(A.disabled||D.disabled){return false}C.onItemClick(B,D,F)}}},EventHandlers:{onItemSelected:null,onItemClick:function(A,B,C){}},_prepareItem:function(A,B){var C=A.properties;B._tabindex=C.tabindex;B.itemMargin=C.itemMargin}}});Class("linb.UI.Poll","linb.UI.List",{Instance:{fillContent:function(E,D){var B=this.get(0),A,C;if(B.domNode){if(C=B.getItemByItemId(E)){A=B.getSubNodeByItemId("BODY",E).html("");if(D){C._obj=D;C._fill=true;if(typeof D=="string"){A.html(D)}else{A.append(D.render(true))}}else{C._obj=C._fill=null}}}return this},_setOptCap:function(A,B){return this.each(function(E){var C=E.properties.items,D=E.queryItems(E.properties.items,function(F){return F.id==A.id},false,true);if(D&&(D=D[0])){D.caption=B;if(E.domNode){E.getSubNodeByItemId("CAPTION",D.id).html(B)}}})},getBindEditor:function(){return this.get(0)._bind},_insertOpt:function(A){if(!A.id){A.id="$"+_()}this.insertItems([A],null,false);return this},_removeOpt:function(A){this.removeItems([A],"OUTER");return this},_setDirtyMark:function(){return this}},Initialize:function(){var B=this;B.addTemplateKeys(["EDIT"]);var C=B.getTemplate();C.TITLE={$order:2,tagName:"DIV",style:"{titleDisplay}",text:"{title}",className:"uibg-bar uiborder-outset {disabled} {_cls}"};C.TAIL={$order:20,tagName:"DIV",className:"uibg-bar uiborder-outset {disabled}",text:"{cmds}"};C.$dynamic={items:{OUTER:{tagName:"div",className:"uibg-bar uiborder-outset",TOGGLE:{className:"uicmd-toggle",style:"{_togdisplay}"},ITEM:{tagName:"a",href:linb.$href,tabindex:"{_tabindex}",className:"{itemClass} {disabled}",style:"{itemStyle}",OPTION:{$order:0,tagName:"DIV",MARK:{$order:1,className:"{_optclass}"}},CAPTION:{$order:1,tagName:"DIV",text:"{caption}",className:"{disabled} {_itemcls}"},CHART:{$order:2,tagName:"DIV",style:"{_display}",CAST:{$order:0,text:"{message}"},PROGRESS:{$order:1,style:"background-position: -{_per}px -200px;",PROGRESSI:{}},DEL:{$order:2,className:"ui-btn",style:"{_del}",DELI:{className:"ui-btni",DELC:{className:"ui-btnc",DELA:{tagName:"button",text:"{removeText}"}}}}},CLEAR:{$order:3,tagName:"DIV"}},BODY:{$order:1,tagName:"DIV",text:"{_body}"}}},cmds:{CMD:{className:"ui-btn",CMDI:{className:"ui-btni",CMDC:{className:"ui-btnc",CMDA:{tagName:"a",href:linb.$href,tabindex:"{_tabindex}",text:"{caption}"}}}}}};B.setTemplate(C);var D=function(J,I,L,M,O){var H,K,F=J.properties,N=function(Q){var P=J.boxing();switch(L){case"1":if(P.beforeOptionChanged(J,O,Q)!==false){P._setOptCap(O,Q)}break;case"2":if(P.beforeOptionAdded(J,Q)!==false){var R="["+Q.replace(/[^\w_]*/g,"")+"]";P._insertOpt({caption:Q,id:R});if(!J.properties.editable){J.boxing().fireItemClickEvent(R)}}break;default:if(P.beforeTitleChanged(J,Q)!==false){P.setTitle(Q)}}};if(J.onCustomEdit){if(H=J._bind=J.boxing().onCustomEdit(J,I,L,M,O,N)){K=true}}if(!K){H=J._bind;if(!H){var G={type:F.editorType,saveBtn:true,left:-10000,top:-10000};J._bind=H=linb.create("ComboInput",G);H.onHotKeydown(function(Q,P){if(P=="enter"){Q.boxing().onSave(Q);return false}else{if(P=="esc"){H.hide();return false}}});J.root.append(H)}var E=I.cssRegion(true,J.root);if(E.height>H.getHeight()){H.setHeight(E.height)}else{E.top-=3}if(E.top<0){E.top=0}H.setValue(M||"",true).setWidth(E.width+(parseInt(I.css("paddingLeft"))||0)+(parseInt(I.css("paddingRight"))||0)).onSave(function(R){var S=R.properties,P=S.$UIvalue,Q=S.value;if(P!=Q){N(P)}_.asyRun(function(){H.hide()})}).reBoxing().setBlurTrigger(H.KEY+":"+H.$id,function(){H.hide()}).show(E.left+"px",E.top+"px");_.asyRun(function(){H.activate()})}};C=B.getBehavior();var A=C.ITEM.onClick;C.ITEM.onClick=function(F,I,J){var H=F.properties,G=F.getItemByDom(J),E=G.id=="$custom"||G.editable;if(H.disabled){return }if(H.editable){D(F,F.getSubNodeByItemId("CAPTION",G.id),E?"2":"1",E?"":G.caption,G)}else{if(E){D(F,F.getSubNodeByItemId("CAPTION",G.id),"2")}else{A.apply(this,arguments)}}};C.TITLE={onClick:function(E,H,I){var G=E.properties,F=E.getItemByDom(I);if(G.disabled){return }if(G.editable){D(E,E.getSubNode("TITLE"),"3",G.title)}}};C.DEL={onClick:function(F,I,J){var H=F.properties,E=F.boxing(),G=F.getItemByDom(J);if(H.disabled){return }if(E.beforeOptionRemoved(F,G)!==false){E._removeOpt(G.id)}return false}};C.CMD={onClick:function(F,H,I){var G=F.properties,E=F.getSubId(I.id);if(G.disabled){return }F.boxing().onClickButton(F,E,I)}};C.TOGGLE={onClick:function(H,J,F){var K=H.properties,L=K.items,P=H.getItemByDom(F),M=H.getSubId(F.id),G=linb([F]),I=H.getSubNode("BODY",M),O;if(P._show){G.tagClass("-checked",false);I.css("display","none")}else{G.tagClass("-checked");I.css("display","block");if(!P._fill){P._fill=true;var N=function(Q){H.boxing().fillContent(P.id,P._body=Q)};if(H.onGetContent){var E=H.boxing().onGetContent(H,P,N);if(E){N(E)}}else{N(H.box._buildBody(H,P))}}}P._show=!P._show}};B.setBehavior(C)},Static:{DIRTYKEY:"MARK",ITEMKEY:"OUTER",Appearances:{KEY:{"font-size":"12px",zoom:linb.browser.ie?1:null},"TITLE, ITEMS, TAIL":{position:"relative",overflow:"auto","line-height":"14px"},TAIL:{zoom:linb.browser.ie?1:null,padding:"5px 0 5px 40px"},CMD:{margin:"3px","white-space":"nowrap","vertical-align":"middle"},TITLE:{"font-weight":"bold",padding:"4px"},ITEMS:{"overflow-x":(linb.browser.ie||linb.browser.gek)?"hidden":"",zoom:linb.browser.ie?1:null},OUTER:{position:"relative",zoom:linb.browser.ie?1:null,"padding-left":"15px"},TOGGLE:{position:"absolute",left:0,top:"4px"},BODY:{display:"none","padding-left":"27px"},ITEM:{display:"block",position:"relative",zoom:linb.browser.ie?1:null,padding:"4px 2px 4px 2px"},OPTION:{position:"absolute",left:"2px",top:"4px"},CAPTION:{"float":"left",zoom:linb.browser.ie?1:null,"margin-left":"24px",display:linb.browser.ie6?"inline":null},"EDIT, EDITS":{$order:2,"float":"none","background-color":"#EBEADB",cursor:"pointer",display:linb.browser.ie6?"block":null},CHART:{"float":"right"},CLEAR:{clear:"both","text-align":"right"},"PROGRESS, PROGRESSI":{background:linb.UI.$bg("icons.gif","no-repeat",true),width:"200px",height:"14px",border:0,"line-height":0,"font-size":0},PROGRESS:{$order:1,"margin-left":"2px","background-position":"-180px -200px"},PROGRESSI:{$order:1,"background-position":"-200px -216px"},DEL:{margin:"0 0 0 4px"}},DataModel:{$checkbox:1,title:{action:function(A){this.getSubNode("TITLE").html(A)}},selMode:{ini:"single",listbox:["single","multi"],action:function(){this.boxing().refresh()}},cmds:{ini:[]},noTitle:{ini:false,action:function(A){this.getSubNode("TITLE").css("display",A?"none":"")}},toggle:{ini:false,action:function(A){this.getSubNode("TOGGLE",true).css("display",A?"":"none")}},removeText:{ini:"remove",action:function(A){this.getSubNode("DEL",true).text(A)}},editable:{ini:false,action:function(C){var B=this,D,A;B.getSubNode("DEL",true).css("display",C?"":"none");D=B.getSubNode("CAPTION",true).merge(B.getSubNode("TITLE"));A=B.getClass("EDIT");if(C){D.addClass(A)}else{D.removeClass(A)}}},newOption:{ini:"",action:function(C){var B=this,F="$custom",A="_special",D,E=B._cs;if(!C){if(E){E.remove()}}else{if(!E){D={id:F,caption:C};D[linb.UI.$tag_subId]=A;E=B.buildItems("items",B.box._prepareItems(B,[D]));B.getSubNode("ITEMS").addNext(B._cs=_.str.toDom(E))}else{B.getSubNodeByItemId("CAPTION",A).html(C)}}}},editorType:"none"},Behaviors:{HoverEffected:{DEL:"DEL",CMD:"CMD",ITEM:"MARK"},ClickEffected:{DEL:"DEL",CMD:"CMD",ITEM:"MARK"}},EventHandlers:{beforeTitleChanged:function(A,B){},beforeOptionAdded:function(A,B){},beforeOptionRemoved:function(A,B){},beforeOptionChanged:function(A,B,C){},onCustomEdit:function(B,D,A,E,C,F){},onClickButton:function(B,A,C){},onGetContent:function(A,B,C){}},RenderTrigger:function(){var A=this,B=A.properties.newOption;if(B){A.boxing().setNewOption(B,true)}},_prepareData:function(E){var G=arguments.callee.upper.call(this,E),B=E.properties;if(B.editable){G._cls=E.getClass("EDIT")}G.titleDisplay=B.noTitle?"display:none":"";var A=B.cmds,D;if(A&&A.length){var C=linb.UI.$tag_subId,I;I=G.cmds=[];for(var H=0,J=A,F=J.length;H<F;H++){if(typeof J[H]=="string"){J[H]={id:J[H]}}if(!J[H].caption){J[H].caption=J[H].id}J[H].id=J[H].id.replace(/[^\w]/g,"_");D=linb.UI.adjustData(E,J[H]);I.push(D);D._tabindex=B.tabindex;D[C]=D.id}}return G},_prepareItem:function(A,B){var D=A.properties,C=A.CF;B._tabindex=D.tabindex;if(typeof C.formatCaption=="function"){B.caption=C.formatCaption(B.caption)}B._body=B._body||"Loading...";if(B.id!="$custom"){B._togdisplay=((D.toggle&&B.toggle!==false)||B.toggle)?"":"display:none;";B._optclass=D.selMode=="multi"?"uicmd-check":"uicmd-radio";B._display="";B.percent=parseFloat(B.percent)||0;if(B.percent<0){B.percent=0}if(B.percent>1){B.percent=1}B._per=200*(1-B.percent)}else{B._optclass="uicmd-add";B._togdisplay=B._display="display:none;";B._per=0;B._itemcls=A.getClass("EDITS")}B.removeText=D.removeText;B._del="display:none;";if((("editable" in B)&&B.editable)||D.editable){B._itemcls=A.getClass("EDIT");B._del=""}},_buildBody:function(A,B){return B.text?"<pre>"+B.text.replace(/</g,"&lt;")+"</pre>":""},_onresize:function(){}}});Class("linb.UI.FoldingList",["linb.UI.List"],{Instance:{fillContent:function(E,D){var B=this.get(0),A,C;if(B.domNode){if(C=B.getItemByItemId(E)){A=B.getSubNodeByItemId("BODYI",E).html("");if(D){C._obj=D;C._fill=true;if(typeof D=="string"){A.html(D)}else{A.append(D.render(true))}}else{C._obj=C._fill=null}}}return this},toggle:function(C){var E=this.get(0);if(E.domNode){var G=E.properties,H=G.items,L=E.getItemByItemId(C),B=E.getSubIdByItemId(C),D=E.getSubNode("ITEM",B),F=E.getSubNode("TOGGLE",B),I=D.next(),K;if(L._show){if(G.activeLast&&H.length){if(H[H.length-1].id==L.id){return false}}D.tagClass("-checked",false);F.tagClass("-checked",false);if(I){I.tagClass("-prechecked",false)}}else{D.tagClass("-checked");F.tagClass("-checked");if(I){I.tagClass("-prechecked")}if(!L._fill){var J=function(M){E.boxing().fillContent(L.id,L._body=M)};if(E.onGetContent){var A=E.boxing().onGetContent(E,L,J);if(A){J(A)}}else{J(E.box._buildBody(E,L))}}}L._show=!L._show}return this}},Initialize:function(){var A=this.getTemplate();A.$dynamic={items:{ITEM:{tagName:"div",className:"{_checked} {_precheked} {itemClass} {disabled}",style:"{itemStyle}",HEAD:{tagName:"div",HL:{tagName:"div"},HR:{tagName:"div"},TITLE:{tagName:"a",href:linb.$href,TLEFT:{$order:0,tagName:"div",TOGGLE:{$order:0,className:"uicmd-toggle {_tlgchecked}"},CAP1:{$order:1,text:"{title}"}},TRIGHT:{$order:1,tagName:"div",style:"{_capDisplay}",CAP2:{$order:0,text:"{caption}"},OPT:{$order:1,className:"uicmd-opt",style:"{_opt}"}}}},BODY:{$order:1,tagName:"div",className:"uibg-base",BODYI:{$order:0,tagName:"div",text:"{_body}"},CMDS:{$order:1,tagName:"div",text:"{cmds}"}},TAIL:{$order:4,tagName:"div",TL:{tagName:"div"},TR:{tagName:"div"}}}},"items.cmds":{$order:2,CMD:{className:"ui-btn",CMDI:{className:"ui-btni",CMDC:{className:"ui-btnc",CMDA:{tagName:"a",href:linb.$href,tabindex:"{_tabindex}",text:"{caption}"}}}}}};this.setTemplate(A)},Static:{Appearances:{KEY:{padding:"2px"},ITEMS:{border:0,position:"relative",zoom:linb.browser.ie?1:null,"padding-top":"8px"},ITEM:{border:0,zoom:linb.browser.ie?1:null,"margin-top":"-9px",padding:0,"font-family":'"Verdana", "Helvetica", "sans-serif"',position:"relative",overflow:"hidden"},"HEAD, BODY, BODYI, TAIL":{position:"relative"},CMDS:{padding:"4px 8px 2px 18px",position:"relative",background:linb.UI.$bg("border_left.gif","repeat-y left top #EEE")},CMD:{margin:"2px 4px 2px 4px"},BODY:{display:"none","border-right":"solid 1px #CCC",zoom:linb.browser.ie?1:null,position:"relative",overflow:"auto",background:linb.UI.$bg("border_left.gif","repeat-y left top")},BODYI:{padding:"2px 8px 0 8px",background:linb.UI.$bg("border_left.gif","repeat-y left top"),position:"relative"},"ITEM-checked":{$order:2,"margin-bottom":"12px"},"ITEM-checked BODY":{$order:2,display:"block"},"HL, HR, TL, TR":{position:"absolute","_font-size":0,"_line-height":0,width:"8px",background:linb.UI.$bg("corner.gif","no-repeat")},"HL, HR":{height:"30px"},"ITEM-prechecked HL":{"background-position":"left top"},"ITEM-prechecked HR":{"background-position":"right top"},"TL, TR":{height:"20px"},HL:{top:0,left:0,"background-position":"left -37px"},HR:{top:0,right:0,"background-position":"right -37px"},TL:{bottom:0,left:0,"background-position":"left bottom"},TR:{bottom:0,right:0,"background-position":"right bottom"},HEAD:{position:"relative",zoom:linb.browser.ie?1:null,background:linb.UI.$bg("border_top.gif","#fff repeat-x left top"),overflow:"hidden"},TITLE:{$order:1,height:"26px",display:"block",position:"relative","white-space":"nowrap",overflow:"hidden"},TAIL:{"_font-size":0,"_line-height":0,position:"relative",height:"5px",background:linb.UI.$bg("border_bottom.gif","repeat-x left bottom #EEE")},"CAP1, CAP2":{padding:"3px"},CAP1:{color:"#666","white-space":"nowrap",font:"bold 12px arial,sans-serif",color:"#00681C"},"ITEM-checked CAP1":{$order:2,"font-weight":"normal"},TLEFT:{position:"absolute",left:"4px",top:"2px","white-space":"nowrap",overflow:"hidden"},TRIGHT:{position:"absolute",right:"4px",top:"2px","white-space":"nowrap",overflow:"hidden"}},Behaviors:{HoverEffected:{ITEM:null,HEAD:"HEAD",OPT:"OPT",CMD:"CMD"},ClickEffected:{ITEM:null,HEAD:"HEAD",CMD:"CMD"},ITEM:{onClick:null,onKeydown:null},HEAD:{onClick:function(A,B,C){A.boxing().toggle(A.getItemIdByDom(C));return false}},CMD:{onClick:function(A,B,C){if(A.onClickButton){A.boxing().onClickButton(A,A.getItemByDom(C.parentNode),C.id.split("_")[1],C)}return false}},OPT:{onMousedown:function(){return false},onClick:function(A,B,C){A.boxing().onShowOptions(A,A.getItemByDom(C),B,C);return false}}},DataModel:({value:null,tabindex:{action:function(A){if(this.domNode){this.getSubNode("HEAD",true).attr("tabIndex",A)}}},cmds:{ini:[]},activeLast:false}),EventHandlers:{onGetContent:function(B,C,A){},onClickButton:function(A,B,C,D){},onShowOptions:function(A,B,C,D){}},RenderTrigger:function(){var B=this,D=B.properties,A=D.items,C;if(D.activeLast&&A.length>0){C=A[A.length-1];B.boxing().fillContent(C.id,C._body)}},_prepareItems:function(C,A,B){if(A.length){A[0]._precheked=C.getClass("ITEM","-prechecked");if(C.properties.activeLast){var D=A[A.length-1];D._show=true;D._fill=true;D._body=C.onGetContent?C.boxing().onGetContent(C,D):C.box._buildBody(C,D)}}return arguments.callee.upper.apply(this,arguments)},_prepareItem:function(E,J){var B=E.properties,D,K="display:none";J._tabindex=B.tabindex;if(!J.caption){J._capDisplay=K}else{J.caption=J.caption.replace(/</g,"&lt;")}J._opt=J.optBtn?"":K;J._body=J._body||"Loading...";if(J._show){J._checked=E.getClass("ITEM","-checked");J._tlgchecked=E.getClass("TOGGLE","-checked")}var A=J.cmds||B.cmds;if(A&&A.length){var C=linb.UI.$tag_subId,H;H=J.cmds=[];for(var G=0,I=A,F=I.length;G<F;G++){if(typeof I[G]=="string"){I[G]={id:I[G]}}if(!I[G].caption){I[G].caption=I[G].id}I[G].id=I[G].id.replace(/[^\w]/g,"_");D=linb.UI.adjustData(E,I[G]);H.push(D);D[C]=J[C]+"_"+D.id}}},_buildBody:function(A,B){return B.text?"<pre>"+B.text.replace(/</g,"&lt;")+"</pre>":""}}});Class("linb.UI.Range",["linb.UI","linb.absValue"],{Instance:{_setCtrlValue:function(A){return this.each(function(E){var C=E.properties,J=C.captionTpl,K=function(O){return E.getSubNode(O)},G=function(O,P){O.cssPos({left:E[P],top:I._x2y(E[P])})},F=function(P,O){P.get(0).style.width=O+"px"},M=K("CAPTION"),N=K("IND1"),L=K("IND2"),D=K("RULER1"),B=K("RULER3"),I=E.box,H=I._v2a(A);E._rate=300/(C.max-C.min);E._v1=Math.round((H[0]-C.min)/(C.max-C.min)*300);E._v2=Math.round((1-(C.max-H[1])/(C.max-C.min))*300);M.html(I._buildTpl(C.singleValue,J,H,C.unit),false);G(N,"_v1");G(L,"_v2");F(D,E._v1+8);F(B,E._v2+8)})},_setDirtyMark:function(){return this.each(function(D){if(!D.properties.dirtyMark){return }if(!D.domNode){return }var C=D.properties,E=D.getSubNode("BOX"),B=C.value!==C.$UIvalue,A=linb.UI.$css_tag_dirty;if(D.beforeDirtyMark&&false===D.boxing().beforeDirtyMark(D,B)){return }if(B){E.addClass(A)}else{E.removeClass(A)}})}},Static:{Templates:{style:"{_style}",BOX:{tagName:"div",RULER:{tagName:"div",IND1:{tagName:"a",href:linb.$href,tabindex:"{tabIndex}",style:"{_single}"},IND2:{tagName:"a",href:linb.$href,tabindex:"{tabIndex}"},RULER1:{$order:2,style:"{_single}"},RULER3:{}},TAIL:{tagName:"div",CAPTION:{tagName:"div"},MIN:{text:"{min}"},MAX:{text:"{max}"}}}},Appearances:{"KEY, RULER, IND1, IND1":{"font-size":0,"line-height":0,position:"relative"},BOX:{position:"absolute",left:0,top:0,width:"316px"},"CAPTION, IND1, TAIL, MIN":{"font-size":"12px","line-height":"14px"},RULER:{$order:1,position:"relative",height:"30px",overflow:"visible","margin-bottom":"3px",background:linb.UI.$bg("bg.png"),_background:"none",_filter:linb.UI.$ieBg("bg.png")},"RULER1, RULER3":{position:"absolute",left:0,top:0,height:"30px",width:"300px"},RULER1:{background:linb.UI.$bg("bg.png"),_background:"none",_filter:linb.UI.$ieBg("bg.png")},RULER3:{background:linb.UI.$bg("front.png"),_background:"none",_filter:linb.UI.$ieBg("front.png")},"IND1,IND2":{display:linb.$inlineBlock,zoom:linb.browser.ie6?1:null,"z-index":"2",width:"15px",height:"14px",position:"absolute"},IND1:{background:linb.UI.$bg("icons.gif","no-repeat left -225px",true),left:"0px",top:"11px"},IND2:{background:linb.UI.$bg("icons.gif","no-repeat -15px -225px",true),left:"300px",top:"1px"},TAIL:{$order:2,width:"300px",position:"relative"},CAPTION:{position:"relative","text-align":"center"},MIN:{position:"absolute",left:0,top:0},MAX:{position:"absolute",right:0,top:0}},Behaviors:{IND1:{onKeydown:function(A,B,C){A.box._keydown.apply(A.box,[A,B,C,0])},onMousedown:function(B,E,F){var D=B.properties,C=B.box,A=C._v2a(D.$UIvalue);linb([F]).startDrag(E,{widthIncrement:D.steps?D.width/D.steps:null,dragType:"move",targetReposition:true,horizontalOnly:true,maxLeftOffset:Math.floor(B._v1),maxRightOffset:Math.floor(B._v2-B._v1),dragCursor:"default"});linb([F]).css("zIndex",10).focus();B.getSubNode("IND2").css("zIndex",5)},onDrag:function(A,B,D){var C=linb.DragDrop.getProfile();A.box._ondrag.apply(A.box,[A,C.curPos.left,D,0])},onDragstop:function(C,G,A){var B=C.properties,E=C.boxing(),H=C._rate,I=linb.DragDrop.getProfile(),F,D=B.$UIvalue.split(":");C._v1=I.curPos.left;D[0]=Math.floor((C._v1)/H+B.min);E.setUIValue(D.join(":"));if(C._v1==C._v2){linb([A]).css("zIndex",10);C.getSubNode("IND2").css("zIndex",5)}}},IND2:{onKeydown:function(A,B,C){A.box._keydown.apply(A.box,[A,B,C,1])},onMousedown:function(B,E,F){var D=B.properties,C=B.box,A=C._v2a(D.$UIvalue);linb([F]).startDrag(E,{widthIncrement:D.steps?D.width/D.steps:null,dragType:"move",targetReposition:true,horizontalOnly:true,maxLeftOffset:Math.floor(B._v2-B._v1),maxRightOffset:Math.floor(300-B._v2),dragCursor:"default"});linb([F]).css("zIndex",10).focus();B.getSubNode("IND1").css("zIndex",5)},onDrag:function(A,B,D){var C=linb.DragDrop.getProfile();A.box._ondrag.apply(A.box,[A,C.curPos.left,D,1])},onDragstop:function(C,G,A){var B=C.properties,E=C.boxing(),H=C._rate,I=linb.DragDrop.getProfile(),F,D=B.$UIvalue.split(":");C._v2=I.curPos.left;D[1]=Math.floor((C._v2)/H+B.min);E.setUIValue(D.join(":"))}}},DataModel:{position:"absolute",width:{ini:300,readonly:true},height:{ini:46,readonly:true},min:{ini:0,action:function(){var B=this,C,D=B.properties,A=B.boxing();A.refresh();if(D.$UIvalue!=(C=this.box._ensureValue(B,D.$UIvalue))){A.setValue(C)}}},max:{ini:100,action:function(){var B=this,C,D=B.properties,A=B.boxing();A.refresh();if(D.$UIvalue!=(C=this.box._ensureValue(B,D.$UIvalue))){A.setValue(C)}}},unit:{ini:"",action:function(){this.boxing()._setCtrlValue(this.properties.$UIvalue)}},steps:0,captionTpl:{ini:"{fromvalue}{unit} - {tovalue}{unit}",action:function(){this.boxing()._setCtrlValue(this.properties.$UIvalue)}},value:"0:100",singleValue:{ini:false,action:function(A){this.boxing().refresh()}}},_prepareData:function(B){var D=arguments.callee.upper.call(this,B);var C=B.properties,A=B.box._v2a(C.value);D._single=C.singleValue?"display:none":"";C.min=parseFloat(C.min);C.max=parseFloat(C.max);D.min=D.min+C.unit;D.max=D.max+C.unit;return D},_ensureValue:function(B,I){var A=B.properties,H=I.split(":"),D=A.min,F=A.max,G=[],E=function(J){return parseFloat(J)},C=function(J){return Math.min(F,Math.max(D,J))};G[0]=E(H[0]);G[1]=E(H[1]);G[0]=Math.min(G[0],G[1]);if(!D){D=G[0]}if(!F){F=G[1]}G[0]=C(G[0]);G[1]=C(G[1]);return G.join(":")},_v2a:function(A){return typeof A=="string"?A.split(":"):A},_buildTpl:function(D,B,A,C){return D?A[1]+C:B.replace(/\{fromvalue\}/g,A[0]).replace(/\{tovalue\}/g,A[1]).replace(/\{unit\}/g,C)},_x2y:function(A){return Math.floor(15+1-(A)*(15/300))},_keydown:function(C,G,A,H){var M=linb.Event.getKey(G);if(M[0]=="left"||M[0]=="right"){var N=A.style,B=parseInt(N.left),L=C.properties,I=L.steps,J=300/I,K,E=function(O){return parseInt(C.getSubNode(O).get(0).style.left)};B+=M[0]=="left"?-1:1;if(I){B=B-B%J;if(M[0]=="right"){B+=J}}if(!L.singleValue){if(H===0){K=E("IND2");if(B>K){B=K}}else{K=E("IND1");if(B<K){B=K}}}if(B<0){B=0}if(B>300){B=300}N.left=B+"px";C.box._ondrag.apply(C.box,[C,B,A,1]);var F=C._rate,D=L.$UIvalue.split(":");if(H===0){C._v1=B;D[0]=Math.floor((C._v1)/F+L.min)}else{C._v2=B;D[1]=Math.floor((C._v2)/F+L.min)}C.boxing().setUIValue(D.join(":"))}},_ondrag:function(F,E,A,O){var C=F.properties,K=linb.DragDrop.getProfile(),I=F.box,L=function(P){return F.getSubNode(P)},G=function(Q,P){Q.get(0).style.width=P+"px"},M=L("CAPTION"),D=L("RULER1"),B=L("RULER3"),N,J,H=this._v2a(C.$UIvalue);A.style.top=this._x2y(E)+"px";N=Math.floor((E)/F._rate+C.min);if(O){H[1]=N;G(B,E+8)}else{H[0]=N;G(D,E+8)}M.html(I._buildTpl(C.singleValue,C.captionTpl,H,C.unit),false)},_onresize:function(){}}});Class("linb.UI.Calendar","linb.UI.DatePicker",{Initialize:function(){var K=this,S=linb.Event.$EVENTHANDLER,G=linb.Event.$EVENTHANDLER2,L=linb.UI.$ID,A=linb.UI.$CLS,J=A+"-td-free",X=K.KEY;K.addTemplateKeys(["H","W","DH","DAY","DC","TBODY","TD"]);var H='<colgroup><col width="2%"/><col width="14%"/><col width="14%"/><col width="14%"/><col width="14%"/><col width="14%"/><col width="14%"/><col width="14%"/></colgroup>',C='<thead><tr height="1%"><th id="'+X+"-H:"+L+':7" class="'+A+'-h #H_CC#"></th>',B="</tr></thead>",F='<th id="'+X+"-H:"+L+':@" class="'+A+'-h #H_CC#">@</th>',P='<tbody id="'+X+"-TBODY:"+L+':" >',N="</tbody>",W="<tr>",U="</tr>",E='<th id="'+X+"-W:"+L+':@"  class="'+A+'-w #W_CC#">@</th>',D='<td id="'+X+"-TD:"+L+':@" class="'+A+'-td ! #TD_CC#"  unselectable="on" onclick="'+S+'" ><div id="'+X+"-DAY:"+L+':@" class="'+A+'-day #DAY_CC#" unselectable="on" onmouseover="'+G+'" onmouseout="'+G+'" ondrop="'+G+'" ><div id="'+X+"-DH:"+L+':@" class="'+A+'-dh #DH_CC#" ></div><div id="'+X+"-DC:"+L+':@" class="'+A+'-dc #DC_CC#" ></div></div></td>',I,R,Q,O,M,V=[],T=[];for(R=0;R<7;R++){T[T.length]=F.replace(/@/g,R)}O=M=0;for(R=0;R<48;R++){Q=R%8;V[V.length]=(Q==0?W:"")+(Q==0?E:D).replace(/@/g,Q==0?M:O).replace("!",(Q==1||Q==7)?J:"")+(Q==7?U:"");if(Q!==0){O++}else{M++}}I=H+C+T.join("")+B+P+V.join("")+N;K.setTemplate({tagName:"div",style:"{_style}",onselectstart:"return false",BORDER:{tagName:"div",BODY:{$order:1,tagName:"table",cellpadding:"0",cellspacing:"0",width:"100%",text:I}}})},Static:{Behaviors:{DropableKeys:["DAY"],HoverEffected:{},ClickEffected:{},onSize:function(C,E){var F=C.domNode.style,D=parseInt,G=null,A=G,B=G;if(E.height){B=D(F.height)||G}if(E.width){A=D(F.width)||G}if(B||A){linb.UI.$tryResize(C,A,B)}},TD:{onClick:null}},DataModel:{handleHeight:null,tipsHeight:null,closeBtn:null,value:null,dataBinder:null,dateField:null,dock:"fill",$borderW:1,width:200,height:200},_getLabelNodes:function(A){return A.$day1||(A.$day1=A.getSubNode("DH",true))},_getDayNodes:function(A){return A.$day2||(A.$day2=A.getSubNode("DAY",true))},Appearances:{"DAY, DC":{position:"relative"},DAY:{overflow:"hidden"},DC:{"text-align":"left"},"TD-checked":{}},_onresize:function(D,C,A){var F=D.properties,E=function(H){return D.getSubNode(H)},G=2*F.$borderW,B;if(A){E("BORDER").height(B=A-G);E("BODY").height(B);B=(B-16)/6-1;D.box._getDayNodes(D).height(B)}}}})})();